* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   1
* COACTVWC.cbl
* Options: int("COACTVWC.int") verbose
*          USE(/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/DIRECTIVES/DI
*          RFOLDER/COACTVWC.cbl.dir)
*          USE(/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/DIRECTIVES/DE
*          FAULTDIR/DUMMY.DIR)
*          USE(/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/DIRECTIVES/DE
*          FAULTDIR/DUMMY.DIR)
*          USE(/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/DIRECTIVES/DE
*          FAULTDIR/DUMMY.DIR)
* Setting: NOACCEPTREFRESH
*          NOACU
*          NOACUCOMMENT
*          NOACUSYNC
*          NOACU-UNDERSCORE
*            ADV
*            ALIGN"8 OPT"
*            ALPHALITCONT"MARGIN"
*            ALPHASTART"1"
*            ALTER
*          NOAMODE
*            ANIM
*            ANS85
*            APOST
*            AREACHECK
*            ARITH"EXTEND"
*            ARITHMETIC"ENTCOBOL"
*            ASSIGN"EXTERNAL"
*          NOASSIGN-PRINTER
*          NOAUTOLOCK
*          NOBELL
*            BINLIT"BOOLEAN"
*          NOBOUND
*          NOBRIEF
*          NOBS2000
*            BWZSTAR
*            BYTEMODEMOVE
*            CALLFH"EXTFH"
*          NOCALLRECOVERY
*            CALLSORT"EXTSM"
*            CANCEL
*            CANCELLBR
*          NOCHANGEMESSAGE
*            CHARSET"EBCDIC"
*            CHECKDIV"ENTCOBOL"
*          NOCHECKREFMOD
*          NOCICS
*            CICS-CPY
*          NOCICSOPTIMIZE
*          NOCMPR2
*            COBFSTATCONV
*          NOCOBIDY
*          NOCOBOL370
*          NOCOBOLDIR
*          NOCOMMANDLINELINKAGE
*            COLLECTION"CardDemo"
*          NOCOMP
*            COMP"BINARY"
*            COMP1"FLOAT"
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   2
* COACTVWC.cbl
*            COMP2"FLOAT"
*            COMP-5"2"
*            COMP-6"2"
*            CONFIRM
*          NOCONVERTRET
*            CONVSPACE
*            COPYEXT"cpy,cbl"
*            COPYLBR
*            COPYLIST
*            COPYLISTCOMMENT"7"
*            COPYSEARCH"MF"
*            CSI
*            CURRENCY-SIGN"36"
*            CURRENT-DATE"MMDDYY"
*          NODATA
*            DATACOMPRESS"0"
*          NODATA-CONTEXT
*          NODATAMAP
*            DATE
*            DBCHECK
*            DBCS"3"
*            DBCSSOSI"14""15"
*            DBSPACE
*            DE-EDIT"2"
*            DEFAULTBYTE"0"
*          NODEFAULTCALLS
*            DETECTLOCK
*          NODG
*            DIALECT"ENTCOBOL"
*          NODIRECTIVES-IN-COMMENTS
*            DISPLAY"CONSOLE"
*          NODISPLAYAT
*            DISPLAYPICU"ANSI"
*            DISPSIGN"COMPAT"
*          NODOSVS
*          NODOTNET
*            DPCINDATA"XML"
*            DPCINSUBSCRIPT
*          NODYNAM
*          NOEARLY-RELEASE
*            EBCCOLSEQ"1"
*            ECHO
*          NOECHOALL
*            ENTCOBOL
*          NOEOF1A
*            ERRFORMAT"2"
*            ERRLIST"VERBOSE"
*          NOERRQ
*          NOEXECSQLFLAG
*            EXITPROGRAM"ANSI"
*          NOFASTINIT
*            FASTSORT
*            FCD3
*          NOFCDALIGN
*          NOFCDREG
*            FDCLEAR"3"
*          NOFILESHARE
*            FILETYPE"0"
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   3
* COACTVWC.cbl
*            FLAG"ENTCOBOL"
*            FLAGAS"S"
*          NOFLAGEUC
*          NOFLAGMIG
*          NOFLAGQ
*            FLAGSINEDIT
*          NOFLAGSTD
*            FOLDCALLNAME"UPPER"
*            FOLDCOPYNAME"UPPER"
*            FORM"60"
*            FP-ROUNDING"ENTCOBOL"
*          NOHOSTARITHMETIC
*            HOSTCONTZERO
*            HOST-NUMCOMPARE
*            HOST-NUMMOVE
*            HOSTFD
*          NOHOSTRW
*          NOIBM-MS
*            IBMCOMP
*            IDENTIFIERLEN"30"
*            IDXFORMAT"0"
*          NOIGNOREEXEC
*          NOIL
*          NOILGEN
*          NOILEMIT
*            IMPLICITSCOPE
*            INCFORMAT"PC"
*            INDD"SYSIN 80 R"
*          NOIDYSRCPATH
*            INFORETURN"0"
*          NOINITCALL
*            INITIAL"1"
*          NOINITPTR
*          NOINITBYTYPE
*            INT"COACTVWC.int"
*            INTDATE"ANSI"
*            INTLEVEL"9"
*            IOCONV
*          NOISO2002
*          NOIXNLSKEY
*          NOIXNUMKEY
*          NOJAVACALLABLE
*          NOJAVAGENPROGS
*          NOJAVAGENSTRG
*            JAVAOUTPUTPATH""
*            JAVAPACKAGENAME"com.microfocus.COBOL"
*          NOJVMGEN
*            KEYCHECK
*            KEYCOMPRESS"0"
*          NOLIBRARIAN
*          NOLINE-COUNT
*            LIST"COACTVWC.lst"
*            LISTPATH...
*          ..."/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/LISTINGS/CO"
*            LISTWIDTH"80"
*            LITVAL-SIZE"4"
*          NOLOCALSOURCEFORMAT
*            LOCKTYPE"0"
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   4
* COACTVWC.cbl
*            MAPNAME
*          NOMAINFRAMEFLOATINGPOINT
*          NOMAXERROR
*            METHODDEFAULT"REFERENCE"
*          NOMF
*          NOMFCOMMENT
*          NOMFSYNC
*          NOMOVELENCHECK
*          NOMS
*          NOMVS
*            NATIONAL"1"
*            NATIVE"EBCDIC"
*          NONATIVEFLOATINGPOINT
*          NONCHAR
*          NONLS
*          NONLSCURRENCYLENGTH
*            NSYMBOL"NATIONAL"
*            NULLESCAPE
*          NOODOOSVS
*            ODOSLIDE
*          NOOLDBLANKLINE
*          NOOLDCOPY
*          NOOLDINDEX
*          NOOLDNEXTSENTENCE
*          NOOLDREADINTO
*          NOOLDSTRMIX
*            OOCTRL"-C-E-G+L-P+Q+R-S+W"
*          NOOPTIONAL-FILE
*          NOOS390
*            OSEXT""
*          NOOSVS
*            OUTDD"SYSOUT 121 R"
*            P64
*          NOPANVALET
*            PANVALET-INCLUDES-IN-COMMENTS
*            PERFORM-TYPE"ENTCOBOL"
*          NOPREPLIST
*          NOPREPROCESS
*            PRESERVECASE
*          NOPRINT-EXT
*          NOPROFILE
*          NOPROGID-COMMENT
*          NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE
*            PROTOTYPE"RELAXED"
*            QUAL
*            QUALPROC
*          NOQUERY
*          NOQUOTE
*          NORAWLIST
*            RDW
*            RECMODE"ENTCOBOL"
*          NOREENTRANT
*          NOREF
*          NOREFNO
*            REMAINDER"2"
*            REPLACE"NOKEEPSEQ"
*            REPORT-LINE"256"
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   5
* COACTVWC.cbl
*            RESEQ
*          NORETRYLOCK
*            REWRITE-LS
*          NORM
*          NORM-FILE-ERRORS
*            RTNCODE-SIZE"2"
*            RTNCODE-TYPE"COMP"
*          NORWHARDPAGE
*          NOSAA
*          NOSEG
*          NOSEQCHK
*            SEQUENTIAL"RECORD"
*          NOSERIAL
*            SETTING"COL"
*          NOSHAREOUTDD
*          NOSHOW-DIR
*            SIGN"EBCDIC"
*            SIGN"TRAILING"
*          NOSIGNDISCARD
*          NOSIGNFIXUP
*            SORTTYPE"DFSORT"
*          NOSOURCEENCODING
*            SOURCEFORMAT"FIXED"
*            SOURCETABSTOP"4"
*          NOSPZERO
*          NOSSRANGE
*            STDERR
*            STICKY-LINKAGE"1"
*          NOSTICKY-PERFORM
*            SUPFF
*            SWITCHTYPE"1"
*            SYMBSTART"1"
*            SYSPUNCH"80"
*            TERMPAGE
*          NOTESTCOVER
*            TIME
*          NOTRACE
*          NOTRUNC
*            TRUNCCALLNAME"8"
*            TRUNCCOPY"8"
*            TRUNCINC"10"
*            UNICODE"PORTABLE"
*            VERBOSE
*          NOVISUALSTUDIO
*          NOVSC2
*          NOWARNASERROR
*            WARNING"1"
*            WEBSERVER"CGI"
*          NOWRITELOCK
*          NOWRITETHRU
*          NOXMLGEN
*            XMLPARSE"XMLSS"
*          NOXOPEN
*          NOXREF
*            ZEROLENGTHFALSE
*          NOZEROSEQ
*            ZWB
     1*****************************************************************
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   6
* COACTVWC.cbl
     2* Program:     COACTVWC.CBL                                     *
     3* Layer:       Business logic                                   *
     4* Function:    Accept and process Account View request    *
     5*****************************************************************
     6
     7 IDENTIFICATION DIVISION.
     8 PROGRAM-ID.
     9     COACTVWC.
    10 DATE-WRITTEN.
    11     May 2022.
    12 DATE-COMPILED. 12-Jul-24 07:58.
    15 ENVIRONMENT DIVISION.
    16 INPUT-OUTPUT SECTION.
    17
    18 DATA DIVISION.
    19
    20 WORKING-STORAGE SECTION.
    21 01  WS-MISC-STORAGE.
    22******************************************************************
    23* General CICS related
    24******************************************************************
    25   05 WS-CICS-PROCESSNG-VARS.
    26      07 WS-RESP-CD                          PIC S9(09) COMP
    27                                             VALUE ZEROS.
    28      07 WS-REAS-CD                          PIC S9(09) COMP
    29                                             VALUE ZEROS.
    30      07 WS-TRANID                           PIC X(4)
    31                                             VALUE SPACES.
    32******************************************************************
    33*      Input edits
    34******************************************************************
    35
    36   05  WS-INPUT-FLAG                         PIC X(1).
    37     88  INPUT-OK                            VALUE '0'.
    38     88  INPUT-ERROR                         VALUE '1'.
    39     88  INPUT-PENDING                       VALUE LOW-VALUES.
    40   05  WS-PFK-FLAG                           PIC X(1).
    41     88  PFK-VALID                           VALUE '0'.
    42     88  PFK-INVALID                         VALUE '1'.
    43     88  INPUT-PENDING                       VALUE LOW-VALUES.
    44   05  WS-EDIT-ACCT-FLAG                     PIC X(1).
    45     88  FLG-ACCTFILTER-NOT-OK               VALUE '0'.
    46     88  FLG-ACCTFILTER-ISVALID              VALUE '1'.
    47     88  FLG-ACCTFILTER-BLANK                VALUE ' '.
    48   05  WS-EDIT-CUST-FLAG                     PIC X(1).
    49     88  FLG-CUSTFILTER-NOT-OK               VALUE '0'.
    50     88  FLG-CUSTFILTER-ISVALID              VALUE '1'.
    51     88  FLG-CUSTFILTER-BLANK                VALUE ' '.
    52******************************************************************
    53* Output edits
    54******************************************************************
    55*  05  EDIT-FIELD-9-2                PIC +ZZZ,ZZZ,ZZZ.99.
    56******************************************************************
    57*      File and data Handling
    58******************************************************************
    59   05  WS-XREF-RID.
    60     10  WS-CARD-RID-CARDNUM                 PIC X(16).
    61     10  WS-CARD-RID-CUST-ID                 PIC 9(09).
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   7
* COACTVWC.cbl
    62     10  WS-CARD-RID-CUST-ID-X REDEFINES
    63            WS-CARD-RID-CUST-ID              PIC X(09).
    64     10  WS-CARD-RID-ACCT-ID                 PIC 9(11).
    65     10  WS-CARD-RID-ACCT-ID-X REDEFINES
    66            WS-CARD-RID-ACCT-ID              PIC X(11).
    67   05  WS-FILE-READ-FLAGS.
    68     10 WS-ACCOUNT-MASTER-READ-FLAG          PIC X(1).
    69        88 FOUND-ACCT-IN-MASTER              VALUE '1'.
    70     10 WS-CUST-MASTER-READ-FLAG             PIC X(1).
    71        88 FOUND-CUST-IN-MASTER              VALUE '1'.
    72   05  WS-FILE-ERROR-MESSAGE.
    73     10  FILLER                              PIC X(12)
    74                                             VALUE 'File Error: '.
    75     10  ERROR-OPNAME                        PIC X(8)
    76                                             VALUE SPACES.
    77     10  FILLER                              PIC X(4)
    78                                             VALUE ' on '.
    79     10  ERROR-FILE                          PIC X(9)
    80                                             VALUE SPACES.
    81     10  FILLER                              PIC X(15)
    82                                             VALUE
    83                                             ' returned RESP '.
    84     10  ERROR-RESP                          PIC X(10)
    85                                             VALUE SPACES.
    86     10  FILLER                              PIC X(7)
    87                                             VALUE ',RESP2 '.
    88     10  ERROR-RESP2                         PIC X(10)
    89                                             VALUE SPACES.
    90    10  FILLER                               PIC X(5)
    91                                             VALUE SPACES.
    92******************************************************************
    93*      Output Message Construction
    94******************************************************************
    95   05  WS-LONG-MSG                           PIC X(500).
    96   05  WS-INFO-MSG                           PIC X(40).
    97     88  WS-NO-INFO-MESSAGE                 VALUES
    98                                            SPACES LOW-VALUES.
    99     88  WS-PROMPT-FOR-INPUT                 VALUE
   100         'Enter or update id of account to display'.
   101     88  WS-INFORM-OUTPUT                    VALUE
   102         'Displaying details of given Account'.
   103   05  WS-RETURN-MSG                         PIC X(75).
   104     88  WS-RETURN-MSG-OFF                   VALUE SPACES.
   105     88  WS-EXIT-MESSAGE                     VALUE
   106         'PF03 pressed.Exiting              '.
   107     88  WS-PROMPT-FOR-ACCT                  VALUE
   108         'Account number not provided'.
   109     88  NO-SEARCH-CRITERIA-RECEIVED         VALUE
   110         'No input received'.
   111     88  SEARCHED-ACCT-ZEROES                VALUE
   112         'Account number must be a non zero 11 digit number'.
   113     88  SEARCHED-ACCT-NOT-NUMERIC           VALUE
   114         'Account number must be a non zero 11 digit number'.
   115     88  DID-NOT-FIND-ACCT-IN-CARDXREF       VALUE
   116         'Did not find this account in account card xref file'.
   117     88  DID-NOT-FIND-ACCT-IN-ACCTDAT        VALUE
   118         'Did not find this account in account master file'.
   119     88  DID-NOT-FIND-CUST-IN-CUSTDAT        VALUE
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   8
* COACTVWC.cbl
   120         'Did not find associated customer in master file'.
   121     88  XREF-READ-ERROR                     VALUE
   122         'Error reading account card xref File'.
   123     88  CODING-TO-BE-DONE                   VALUE
   124         'Looks Good.... so far'.
   125*****************************************************************
   126*      Literals and Constants
   127******************************************************************
   128 01 WS-LITERALS.
   129    05 LIT-THISPGM                           PIC X(8)
   130                                             VALUE 'COACTVWC'.
   131    05 LIT-THISTRANID                        PIC X(4)
   132                                             VALUE 'CAVW'.
   133    05 LIT-THISMAPSET                        PIC X(8)
   134                                             VALUE 'COACTVW '.
   135    05 LIT-THISMAP                           PIC X(7)
   136                                             VALUE 'CACTVWA'.
   137    05 LIT-CCLISTPGM                         PIC X(8)
   138                                             VALUE 'COCRDLIC'.
   139    05 LIT-CCLISTTRANID                      PIC X(4)
   140                                             VALUE 'CCLI'.
   141    05 LIT-CCLISTMAPSET                      PIC X(7)
   142                                             VALUE 'COCRDLI'.
   143    05 LIT-CCLISTMAP                         PIC X(7)
   144                                             VALUE 'CCRDSLA'.
   145    05 LIT-CARDUPDATEPGM                           PIC X(8)
   146                                             VALUE 'COCRDUPC'.
   147    05 LIT-CARDUDPATETRANID                        PIC X(4)
   148                                             VALUE 'CCUP'.
   149    05 LIT-CARDUPDATEMAPSET                        PIC X(8)
   150                                             VALUE 'COCRDUP '.
   151    05 LIT-CARDUPDATEMAP                           PIC X(7)
   152                                             VALUE 'CCRDUPA'.
   153
   154    05 LIT-MENUPGM                           PIC X(8)
   155                                             VALUE 'COMEN01C'.
   156    05 LIT-MENUTRANID                        PIC X(4)
   157                                             VALUE 'CM00'.
   158    05 LIT-MENUMAPSET                        PIC X(7)
   159                                             VALUE 'COMEN01'.
   160    05 LIT-MENUMAP                           PIC X(7)
   161                                             VALUE 'COMEN1A'.
   162    05  LIT-CARDDTLPGM                       PIC X(8)
   163                                             VALUE 'COCRDSLC'.
   164    05  LIT-CARDDTLTRANID                    PIC X(4)
   165                                             VALUE 'CCDL'.
   166    05  LIT-CARDDTLMAPSET                    PIC X(7)
   167                                             VALUE 'COCRDSL'.
   168    05  LIT-CARDDTLMAP                       PIC X(7)
   169                                             VALUE 'CCRDSLA'.
   170    05 LIT-ACCTFILENAME                      PIC X(8)
   171                                             VALUE 'ACCTDAT '.
   172    05 LIT-CARDFILENAME                      PIC X(8)
   173                                             VALUE 'CARDDAT '.
   174    05 LIT-CUSTFILENAME                      PIC X(8)
   175                                             VALUE 'CUSTDAT '.
   176    05 LIT-CARDFILENAME-ACCT-PATH            PIC X(8)
   177                                             VALUE 'CARDAIX '.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   9
* COACTVWC.cbl
   178    05 LIT-CARDXREFNAME-ACCT-PATH            PIC X(8)
   179                                             VALUE 'CXACAIX '.
   180    05 LIT-ALL-ALPHA-FROM                    PIC X(52)
   181       VALUE
   182       'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.
   183    05 LIT-ALL-SPACES-TO                     PIC X(52)
   184                                             VALUE SPACES.
   185    05 LIT-UPPER                             PIC X(26)
   186                           VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
   187    05 LIT-LOWER                             PIC X(26)
   188                           VALUE 'abcdefghijklmnopqrstuvwxyz'.
   189
   190******************************************************************
   191*Other common working storage Variables
   192******************************************************************
   193*COPY CVCRD01Y.
   194 01  CC-WORK-AREAS.                                               00010004
   195    05 CC-WORK-AREA.                                              00020001
   196       10 CCARD-AID                         PIC X(5).             00090001
   197          88  CCARD-AID-ENTER                VALUE 'ENTER'.       00100001
   198          88  CCARD-AID-CLEAR                VALUE 'CLEAR'.       00110001
   199          88  CCARD-AID-PA1                  VALUE 'PA1  '.       00120001
   200          88  CCARD-AID-PA2                  VALUE 'PA2  '.       00130001
   201          88  CCARD-AID-PFK01                VALUE 'PFK01'.       00140001
   202          88  CCARD-AID-PFK02                VALUE 'PFK02'.       00150001
   203          88  CCARD-AID-PFK03                VALUE 'PFK03'.       00160001
   204          88  CCARD-AID-PFK04                VALUE 'PFK04'.       00170001
   205          88  CCARD-AID-PFK05                VALUE 'PFK05'.       00180001
   206          88  CCARD-AID-PFK06                VALUE 'PFK06'.       00190001
   207          88  CCARD-AID-PFK07                VALUE 'PFK07'.       00200001
   208          88  CCARD-AID-PFK08                VALUE 'PFK08'.       00210001
   209          88  CCARD-AID-PFK09                VALUE 'PFK09'.       00220001
   210          88  CCARD-AID-PFK10                VALUE 'PFK10'.       00230001
   211          88  CCARD-AID-PFK11                VALUE 'PFK11'.       00240001
   212          88  CCARD-AID-PFK12                VALUE 'PFK12'.       00250001
   213*      10  CCARD-LAST-PROG                  PIC X(8).             00260001
   214       10  CCARD-NEXT-PROG                  PIC X(8).             00270001
   215*      10  CCARD-RETURN-TO-PROG             PIC X(8).             00280001
   216       10  CCARD-NEXT-MAPSET                PIC X(7).             00330001
   217       10  CCARD-NEXT-MAP                   PIC X(7).             00340001
   218*      10  CCARD-RETURN-FLAG                PIC X(1).             00350001
   219*        88  CCARD-RETURN-FLAG-OFF          VALUE LOW-VALUES.     00360001
   220*        88  CCARD-RETURN-FLAG-ON           VALUE '1'.            00370001
   221       10  CCARD-ERROR-MSG                  PIC X(75).            00380001
   222       10  CCARD-RETURN-MSG                 PIC X(75).            00390001
   223         88  CCARD-RETURN-MSG-OFF           VALUE LOW-VALUES.     00400001
   224*      10  CCARD-FUNCTION                   PIC X(1).             00410001
   225*        88  CCARD-NO-VALUE                  VALUE LOW-VALUES.    00420001
   226*        88  CCARD-GET-DATA                  VALUE '1'.           00430001
   227       10 CC-ACCT-ID                        PIC X(11)             00440005
   228                                            VALUE SPACES.
   229       10 CC-ACCT-ID-N REDEFINES CC-ACCT-ID PIC 9(11).
   230       10 CC-CARD-NUM                       PIC X(16)             00460005
   231                                            VALUE SPACES.         00470005
   232       10 CC-CARD-NUM-N REDEFINES CC-CARD-NUM PIC 9(16).
   233       10 CC-CUST-ID                        PIC X(09)             00480005
   234                                            VALUE SPACES.         00490005
   235       10 CC-CUST-ID-N REDEFINES CC-CUST-ID PIC 9(9).             00480005
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  10
* COACTVWC.cbl
   236
   237*
   238* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:00 CDT
   239*
   240
   241******************************************************************
   242*Application Commmarea Copybook
   243*COPY COCOM01Y.
   244******************************************************************
   245* Communication area for CardDemo application programs
   246******************************************************************
   247 01 CARDDEMO-COMMAREA.
   248    05 CDEMO-GENERAL-INFO.
   249       10 CDEMO-FROM-TRANID             PIC X(04).
   250       10 CDEMO-FROM-PROGRAM            PIC X(08).
   251       10 CDEMO-TO-TRANID               PIC X(04).
   252       10 CDEMO-TO-PROGRAM              PIC X(08).
   253       10 CDEMO-USER-ID                 PIC X(08).
   254       10 CDEMO-USER-TYPE               PIC X(01).
   255          88 CDEMO-USRTYP-ADMIN         VALUE 'A'.
   256          88 CDEMO-USRTYP-USER          VALUE 'U'.
   257       10 CDEMO-PGM-CONTEXT             PIC 9(01).
   258          88 CDEMO-PGM-ENTER            VALUE 0.
   259          88 CDEMO-PGM-REENTER          VALUE 1.
   260    05 CDEMO-CUSTOMER-INFO.
   261       10 CDEMO-CUST-ID                 PIC 9(09).
   262       10 CDEMO-CUST-FNAME              PIC X(25).
   263       10 CDEMO-CUST-MNAME              PIC X(25).
   264       10 CDEMO-CUST-LNAME              PIC X(25).
   265    05 CDEMO-ACCOUNT-INFO.
   266       10 CDEMO-ACCT-ID                 PIC 9(11).
   267       10 CDEMO-ACCT-STATUS             PIC X(01).
   268    05 CDEMO-CARD-INFO.
   269       10 CDEMO-CARD-NUM                PIC 9(16).
   270    05 CDEMO-MORE-INFO.
   271       10  CDEMO-LAST-MAP               PIC X(7).
   272       10  CDEMO-LAST-MAPSET            PIC X(7).
   273*
   274* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:57 CDT
   275*
   276
   277 01 WS-THIS-PROGCOMMAREA.
   278    05 CA-CALL-CONTEXT.
   279       10 CA-FROM-PROGRAM                    PIC X(08).
   280       10 CA-FROM-TRANID                     PIC X(04).
   281
   282 01  WS-COMMAREA                             PIC X(2000).
   283
   284*IBM SUPPLIED COPYBOOKS
   285*COPY DFHBMSCA.
   286*----------------------------------------------------------------*
   287* dfhbmsca.cpy
   288*<CR_TAG_DEMO_BEGIN>
   289*
   290*  Copyright (C) 2024 Micro Focus or one of its affiliates.
   291*  All rights reserved.
   292*
   293*  This sample code is supplied for demonstration purposes only
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  11
* COACTVWC.cbl (/opt/microfocus/EnterpriseBuildTools/cpylib/DFHBMSCA.cpy)
   294*  on an "as is" basis and "is for use at your own risk".
   295*
   296*<CR_TAG_DEMO_END>
   297***---------------------------------------------------------*
   298***CONTROL BLOCK NAME= DFHBMSCA                             *
   299***                                                         *
   300***NAME OF MATCHING ASSEMBLER CONTROL BLOCK = NONE          *
   301***                                                         *
   302***DESCRIPTIVE NAME = 3270 ATTRIBUTE VALUES                 *
   303***                                                         *
   304***FUNCTION =  Provides the values for 3270 attribute bytes *
   305***            used by the BMS support.                     *
   306***                                                         *
   307***---------------------------------------------------------*
   308 01      DFHBMSCA.
   309*                                               X'1915'.
   310   02    DFHBMPEM-BIN  PICTURE 9(4) COMP VALUE IS 6421.
   311   02    FILLER REDEFINES DFHBMPEM-BIN.
   312     03  DFHBMPEM  PICTURE X.
   313     03  DFHBMPNL  PICTURE X.
   314*                                               X'0C0D'.
   315   02    DFHBMPFF-BIN  PICTURE 9(4) COMP VALUE IS 3085.
   316   02    FILLER REDEFINES DFHBMPFF-BIN.
   317     03  DFHBMPFF  PICTURE X.
   318     03  DFHBMPCR  PICTURE X.
   319   02    DFHBMASK  PICTURE X   VALUE  IS  '0'.
   320   02    DFHBMUNP  PICTURE X   VALUE  IS  ' '.
   321   02    DFHBMUNN  PICTURE X   VALUE  IS  '&'.
   322   02    DFHBMPRO  PICTURE X   VALUE  IS  '-'.
   323   02    DFHBMBRY  PICTURE X   VALUE  IS  'H'.
   324   02    DFHBMDAR  PICTURE X   VALUE  IS  '<'.
   325   02    DFHBMFSE  PICTURE X   VALUE  IS  'A'.
   326   02    DFHBMPRF  PICTURE X   VALUE  IS  '/'.
   327   02    DFHBMASF  PICTURE X   VALUE  IS  '1'.
   328   02    DFHBMASB  PICTURE X   VALUE  IS  '8'.
   329*                                               X'0E0F'.
   330   02    DFHBMPSO-BIN  PICTURE 9(4) COMP VALUE IS 3599.
   331   02    FILLER REDEFINES DFHBMPSO-BIN.
   332     03  DFHBMPSO  PICTURE X.
   333     03  DFHBMPSI  PICTURE X.
   334*                                               X'0080'.
   335   02    DFHBMEOF-BIN  PICTURE 9(4) COMP VALUE IS 128.
   336   02    FILLER REDEFINES DFHBMEOF-BIN.
   337     03  FILLER    PICTURE X.
   338     03  DFHBMEOF  PICTURE X.
   339*                                               X'0282'.
   340   02    DFHBMCUR-BIN  PICTURE 9(4) COMP VALUE IS 642.
   341   02    FILLER REDEFINES DFHBMCUR-BIN.
   342     03  DFHBMCUR  PICTURE X.
   343     03  DFHBMEC   PICTURE X.
   344*                                               X'0082'.
   345   02    DFHBMFLG-BIN  PICTURE 9(4) COMP VALUE IS 130.
   346       88    DFHERASE VALUES ARE 128, 130.
   347       88    DFHCURSR VALUES ARE   2, 130.
   348   02    FILLER REDEFINES DFHBMFLG-BIN.
   349     03  FILLER    PICTURE X.
   350     03  DFHBMFLG  PICTURE X.
   351   02    DFHBMDET  PICTURE X   VALUE  IS  HIGH-VALUES.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  12
* COACTVWC.cbl (/opt/microfocus/EnterpriseBuildTools/cpylib/DFHBMSCA.cpy)
   352   02    FILLER    PICTURE X.
   353*                                               X'0028'.
   354   02    DFHSA-BIN  PICTURE 9(4) COMP VALUE IS 40.
   355   02    FILLER REDEFINES DFHSA-BIN.
   356     03  FILLER    PICTURE X.
   357     03  DFHSA     PICTURE X.
   358*                                               X'003F'.
   359   02    DFHERROR-BIN  PICTURE 9(4) COMP VALUE IS 63.
   360   02    FILLER REDEFINES DFHERROR-BIN.
   361     03  FILLER    PICTURE X.
   362     03  DFHERROR  PICTURE X.
   363*                                               X'0042'.
   364   02    DFHCOLOR-BIN  PICTURE 9(4) COMP VALUE IS 66.
   365   02    FILLER REDEFINES DFHCOLOR-BIN.
   366     03  FILLER    PICTURE X.
   367     03  DFHCOLOR  PICTURE X.
   368*                                               X'0043'.
   369   02    DFHPS-BIN  PICTURE 9(4) COMP VALUE IS 67.
   370   02    FILLER REDEFINES DFHPS-BIN.
   371     03  FILLER    PICTURE X.
   372     03  DFHPS     PICTURE X.
   373*                                               X'0041'.
   374   02    DFHHLT-BIN  PICTURE 9(4) COMP VALUE IS 65.
   375   02    FILLER REDEFINES DFHHLT-BIN.
   376     03  FILLER    PICTURE X.
   377     03  DFHHLT    PICTURE X.
   378*                                               X'00C0'.
   379   02    DFH3270-BIN   PICTURE 9(4) COMP VALUE IS 192.
   380   02    FILLER REDEFINES DFH3270-BIN.
   381     03  FILLER    PICTURE X.
   382     03  DFH3270   PICTURE X.
   383   02    DFHVAL    PICTURE X   VALUE  IS  'A'.
   384   02    DFHOUTLN  PICTURE X   VALUE  IS  'B'.
   385*                                               X'0046'.
   386   02    DFHBKTRN-BIN  PICTURE 9(4) COMP VALUE IS 70.
   387   02    FILLER REDEFINES DFHBKTRN-BIN.
   388     03  FILLER    PICTURE X.
   389     03  DFHBKTRN  PICTURE X.
   390   02    DFHALL    PICTURE X   VALUE  IS  LOW-VALUES.
   391   02    DFHDFT    PICTURE X   VALUE  IS  HIGH-VALUES.
   392   02    DFHDFCOL  PICTURE X   VALUE  IS  LOW-VALUES.
   393   02    DFHBLUE   PICTURE X   VALUE  IS  '1'.
   394   02    DFHRED    PICTURE X   VALUE  IS  '2'.
   395   02    DFHPINK   PICTURE X   VALUE  IS  '3'.
   396   02    DFHGREEN  PICTURE X   VALUE  IS  '4'.
   397   02    DFHTURQ   PICTURE X   VALUE  IS  '5'.
   398   02    DFHYELLO  PICTURE X   VALUE  IS  '6'.
   399   02    DFHNEUTR  PICTURE X   VALUE  IS  '7'.
   400   02    DFHBASE   PICTURE X   VALUE  IS  LOW-VALUES.
   401   02    DFHDFHI   PICTURE X   VALUE  IS  LOW-VALUES.
   402   02    DFHBLINK  PICTURE X   VALUE  IS  '1'.
   403   02    DFHREVRS  PICTURE X   VALUE  IS  '2'.
   404   02    DFHUNDLN  PICTURE X   VALUE  IS  '4'.
   405*                                               X'0402'.
   406   02    DFHMFIL-BIN  PICTURE 9(4) COMP VALUE IS 1026.
   407   02    FILLER REDEFINES DFHMFIL-BIN.
   408     03  DFHMFIL   PICTURE X.
   409     03  DFHMENT   PICTURE X.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  13
* COACTVWC.cbl (/opt/microfocus/EnterpriseBuildTools/cpylib/DFHBMSCA.cpy)
   410*                                               X'0601'.
   411   02    DFHMFE-BIN  PICTURE 9(4) COMP VALUE IS 1537.
   412   02    FILLER REDEFINES DFHMFE-BIN.
   413     03  DFHMFE    PICTURE X.
   414     03  DFHMT     PICTURE X.
   415*                                               X'0503'.
   416   02    DFHMFT-BIN  PICTURE 9(4) COMP VALUE IS 1283.
   417   02    FILLER REDEFINES DFHMFT-BIN.
   418     03  DFHMFT    PICTURE X.
   419     03  DFHMET    PICTURE X.
   420*                                               X'0007'.
   421   02    DFHMFET-BIN  PICTURE 9(4) COMP VALUE IS 7.
   422   02    FILLER REDEFINES DFHMFET-BIN.
   423     03  FILLER    PICTURE X.
   424     03  DFHMFET   PICTURE X.
   425   02    DFHUNNOD  PICTURE X   VALUE  IS  '('.
   426   02    DFHUNIMD  PICTURE X   VALUE  IS  'I'.
   427   02    DFHUNNUM  PICTURE X   VALUE  IS  'J'.
   428   02    DFHUNNUB  PICTURE X   VALUE  IS  'Q'.
   429   02    DFHUNINT  PICTURE X   VALUE  IS  'R'.
   430   02    DFHUNNON  PICTURE X   VALUE  IS  ')'.
   431   02    DFHPROTI  PICTURE X   VALUE  IS  'Y'.
   432   02    DFHPROTN  PICTURE X   VALUE  IS  '%'.
   433   02    DFHDFFR   PICTURE X   VALUE  IS  LOW-VALUES.
   434*                                               X'0102'.
   435   02    DFHUNDER-BIN  PICTURE 9(4) COMP VALUE IS 258.
   436   02    FILLER REDEFINES DFHUNDER-BIN.
   437     03  DFHUNDER  PICTURE X.
   438     03  DFHRIGHT  PICTURE X.
   439*                                               X'0408'.
   440   02    DFHOVER-BIN  PICTURE 9(4) COMP VALUE IS 1032.
   441   02    FILLER REDEFINES DFHOVER-BIN.
   442     03  DFHOVER   PICTURE X.
   443     03  DFHLEFT   PICTURE X.
   444*                                               X'000F'.
   445   02    DFHBOX-BIN   PICTURE 9(4) COMP VALUE IS 15.
   446   02    FILLER REDEFINES DFHBOX-BIN.
   447     03  FILLER    PICTURE X.
   448     03  DFHBOX    PICTURE X.
   449*                                               X'0001'.
   450   02    DFHSOSI-BIN  PICTURE 9(4) COMP VALUE IS 1.
   451   02    FILLER REDEFINES DFHSOSI-BIN.
   452     03  FILLER    PICTURE X.
   453     03  DFHSOSI   PICTURE X.
   454   02    DFHTRANS  PICTURE X   VALUE  IS  '0'.
   455   02    DFHOPAQ   PICTURE X   VALUE  IS  HIGH-VALUES.
   456*----------------------------------------------------------------*
   457* dfhbmsca.cpy end
   458*----------------------------------------------------------------*
   459*COPY DFHAID.
   460*<CR_TAG_DEMO_BEGIN>
   461*
   462*  Copyright (C) 2024 Micro Focus or one of its affiliates.
   463*  All rights reserved.
   464*
   465*  This sample code is supplied for demonstration purposes only
   466*  on an "as is" basis and "is for use at your own risk".
   467*
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  14
* COACTVWC.cbl (/opt/microfocus/EnterpriseBuildTools/cpylib/DFHAID.cpy)
   468*<CR_TAG_DEMO_END>
   469*----------------------------------------------------------------*
   470* dfhaid.cpy
   471*----------------------------------------------------------------*
   472 01  DFHAID.
   473     02  DFHNULL         PIC X   VALUE IS LOW-VALUE.
   474     02  DFHENTER        PIC X   VALUE IS ''''.
   475     02  DFHCLEAR        PIC X   VALUE IS '_'.
   476     02  DFHPEN          PIC X   VALUE IS '='.
   477     02  DFHOPID         PIC X   VALUE IS 'W'.
   478     02  DFHMSRE         PIC X   VALUE IS 'X'.
   479     02  DFHSTRF         PIC X   VALUE IS ' '.
   480     02  DFHTRIG         PIC X   VALUE IS '"'.
   481     02  DFHPA1          PIC X   VALUE IS '%'.
   482     02  DFHPA2          PIC X   VALUE IS '>'.
   483     02  DFHPA3          PIC X   VALUE IS ','.
   484     02  DFHPF1          PIC X   VALUE IS '1'.
   485     02  DFHPF2          PIC X   VALUE IS '2'.
   486     02  DFHPF3          PIC X   VALUE IS '3'.
   487     02  DFHPF4          PIC X   VALUE IS '4'.
   488     02  DFHPF5          PIC X   VALUE IS '5'.
   489     02  DFHPF6          PIC X   VALUE IS '6'.
   490     02  DFHPF7          PIC X   VALUE IS '7'.
   491     02  DFHPF8          PIC X   VALUE IS '8'.
   492     02  DFHPF9          PIC X   VALUE IS '9'.
   493     02  DFHPF10         PIC X   VALUE IS ':'.
   494     02  DFHPF11         PIC X   VALUE IS '#'.
   495     02  DFHPF12         PIC X   VALUE IS '@'.
   496     02  DFHPF13         PIC X   VALUE IS 'A'.
   497     02  DFHPF14         PIC X   VALUE IS 'B'.
   498     02  DFHPF15         PIC X   VALUE IS 'C'.
   499     02  DFHPF16         PIC X   VALUE IS 'D'.
   500     02  DFHPF17         PIC X   VALUE IS 'E'.
   501     02  DFHPF18         PIC X   VALUE IS 'F'.
   502     02  DFHPF19         PIC X   VALUE IS 'G'.
   503     02  DFHPF20         PIC X   VALUE IS 'H'.
   504     02  DFHPF21         PIC X   VALUE IS 'I'.
   505     02  DFHPF22         PIC X   VALUE IS ' '.
   506*    Note: CICS ECM alters the line above to...
   507*          Value for ASCII  is X'5B'
   508*          Value for EBCDIC is X'4A'
   509     02  DFHPF23         PIC X   VALUE IS '.'.
   510     02  DFHPF24         PIC X   VALUE IS '<'.
   511*----------------------------------------------------------------*
   512* dfhaid.cpy end
   513*----------------------------------------------------------------*
   514
   515*COMMON COPYBOOKS
   516*Screen Titles
   517*COPY COTTL01Y.
   518 01 CCDA-SCREEN-TITLE.
   519   05 CCDA-TITLE01    PIC X(40) VALUE
   520      '      AWS Mainframe Modernization       '.
   521   05 CCDA-TITLE02    PIC X(40) VALUE
   522*     '  Credit Card Demo Application (CCDA)   '.
   523      '              CardDemo                  '.
   524   05 CCDA-THANK-YOU  PIC X(40) VALUE
   525      'Thank you for using CCDA application... '.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  15
* COACTVWC.cbl
   526*
   527* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT
   528*
   529
   530*BMS Copybook
   531*COPY COACTVW.
   532*   Micro Focus COBOL 2017  7.0.00247
   533*   Micro Focus BMS Screen Painter
   534*   MapSet Name   COACTVW
   535*   Date Created  08/05/2022
   536*   Time Created  16:44:44
   537
   538*  Input Data For Map CACTVWA
   539   01 CACTVWAI.
   540      03 FILLER                         PIC X(12).
   541      03 TRNNAMEL                       PIC S9(4) COMP.
   542      03 TRNNAMEF                       PIC X.
   543      03 FILLER REDEFINES TRNNAMEF.
   544         05 TRNNAMEA                       PIC X.
   545      03 FILLER                         PIC X(4).
   546      03 TRNNAMEI                       PIC X(4).
   547      03 TITLE01L                       PIC S9(4) COMP.
   548      03 TITLE01F                       PIC X.
   549      03 FILLER REDEFINES TITLE01F.
   550         05 TITLE01A                       PIC X.
   551      03 FILLER                         PIC X(4).
   552      03 TITLE01I                       PIC X(40).
   553      03 CURDATEL                       PIC S9(4) COMP.
   554      03 CURDATEF                       PIC X.
   555      03 FILLER REDEFINES CURDATEF.
   556         05 CURDATEA                       PIC X.
   557      03 FILLER                         PIC X(4).
   558      03 CURDATEI                       PIC X(8).
   559      03 PGMNAMEL                       PIC S9(4) COMP.
   560      03 PGMNAMEF                       PIC X.
   561      03 FILLER REDEFINES PGMNAMEF.
   562         05 PGMNAMEA                       PIC X.
   563      03 FILLER                         PIC X(4).
   564      03 PGMNAMEI                       PIC X(8).
   565      03 TITLE02L                       PIC S9(4) COMP.
   566      03 TITLE02F                       PIC X.
   567      03 FILLER REDEFINES TITLE02F.
   568         05 TITLE02A                       PIC X.
   569      03 FILLER                         PIC X(4).
   570      03 TITLE02I                       PIC X(40).
   571      03 CURTIMEL                       PIC S9(4) COMP.
   572      03 CURTIMEF                       PIC X.
   573      03 FILLER REDEFINES CURTIMEF.
   574         05 CURTIMEA                       PIC X.
   575      03 FILLER                         PIC X(4).
   576      03 CURTIMEI                       PIC X(8).
   577      03 ACCTSIDL                       PIC S9(4) COMP.
   578      03 ACCTSIDF                       PIC X.
   579      03 FILLER REDEFINES ACCTSIDF.
   580         05 ACCTSIDA                       PIC X.
   581      03 FILLER                         PIC X(4).
   582      03 ACCTSIDI                       PIC 99999999999.
   583      03 ACSTTUSL                       PIC S9(4) COMP.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  16
* COACTVWC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COACTVW.cpy)
   584      03 ACSTTUSF                       PIC X.
   585      03 FILLER REDEFINES ACSTTUSF.
   586         05 ACSTTUSA                       PIC X.
   587      03 FILLER                         PIC X(4).
   588      03 ACSTTUSI                       PIC X(1).
   589      03 ADTOPENL                       PIC S9(4) COMP.
   590      03 ADTOPENF                       PIC X.
   591      03 FILLER REDEFINES ADTOPENF.
   592         05 ADTOPENA                       PIC X.
   593      03 FILLER                         PIC X(4).
   594      03 ADTOPENI                       PIC X(10).
   595      03 ACRDLIML                       PIC S9(4) COMP.
   596      03 ACRDLIMF                       PIC X.
   597      03 FILLER REDEFINES ACRDLIMF.
   598         05 ACRDLIMA                       PIC X.
   599      03 FILLER                         PIC X(4).
   600      03 ACRDLIMI                       PIC X(15).
   601      03 AEXPDTL                        PIC S9(4) COMP.
   602      03 AEXPDTF                        PIC X.
   603      03 FILLER REDEFINES AEXPDTF.
   604         05 AEXPDTA                        PIC X.
   605      03 FILLER                         PIC X(4).
   606      03 AEXPDTI                        PIC X(10).
   607      03 ACSHLIML                       PIC S9(4) COMP.
   608      03 ACSHLIMF                       PIC X.
   609      03 FILLER REDEFINES ACSHLIMF.
   610         05 ACSHLIMA                       PIC X.
   611      03 FILLER                         PIC X(4).
   612      03 ACSHLIMI                       PIC X(15).
   613      03 AREISDTL                       PIC S9(4) COMP.
   614      03 AREISDTF                       PIC X.
   615      03 FILLER REDEFINES AREISDTF.
   616         05 AREISDTA                       PIC X.
   617      03 FILLER                         PIC X(4).
   618      03 AREISDTI                       PIC X(10).
   619      03 ACURBALL                       PIC S9(4) COMP.
   620      03 ACURBALF                       PIC X.
   621      03 FILLER REDEFINES ACURBALF.
   622         05 ACURBALA                       PIC X.
   623      03 FILLER                         PIC X(4).
   624      03 ACURBALI                       PIC X(15).
   625      03 ACRCYCRL                       PIC S9(4) COMP.
   626      03 ACRCYCRF                       PIC X.
   627      03 FILLER REDEFINES ACRCYCRF.
   628         05 ACRCYCRA                       PIC X.
   629      03 FILLER                         PIC X(4).
   630      03 ACRCYCRI                       PIC X(15).
   631      03 AADDGRPL                       PIC S9(4) COMP.
   632      03 AADDGRPF                       PIC X.
   633      03 FILLER REDEFINES AADDGRPF.
   634         05 AADDGRPA                       PIC X.
   635      03 FILLER                         PIC X(4).
   636      03 AADDGRPI                       PIC X(10).
   637      03 ACRCYDBL                       PIC S9(4) COMP.
   638      03 ACRCYDBF                       PIC X.
   639      03 FILLER REDEFINES ACRCYDBF.
   640         05 ACRCYDBA                       PIC X.
   641      03 FILLER                         PIC X(4).
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  17
* COACTVWC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COACTVW.cpy)
   642      03 ACRCYDBI                       PIC X(15).
   643      03 ACSTNUML                       PIC S9(4) COMP.
   644      03 ACSTNUMF                       PIC X.
   645      03 FILLER REDEFINES ACSTNUMF.
   646         05 ACSTNUMA                       PIC X.
   647      03 FILLER                         PIC X(4).
   648      03 ACSTNUMI                       PIC X(9).
   649      03 ACSTSSNL                       PIC S9(4) COMP.
   650      03 ACSTSSNF                       PIC X.
   651      03 FILLER REDEFINES ACSTSSNF.
   652         05 ACSTSSNA                       PIC X.
   653      03 FILLER                         PIC X(4).
   654      03 ACSTSSNI                       PIC X(12).
   655      03 ACSTDOBL                       PIC S9(4) COMP.
   656      03 ACSTDOBF                       PIC X.
   657      03 FILLER REDEFINES ACSTDOBF.
   658         05 ACSTDOBA                       PIC X.
   659      03 FILLER                         PIC X(4).
   660      03 ACSTDOBI                       PIC X(10).
   661      03 ACSTFCOL                       PIC S9(4) COMP.
   662      03 ACSTFCOF                       PIC X.
   663      03 FILLER REDEFINES ACSTFCOF.
   664         05 ACSTFCOA                       PIC X.
   665      03 FILLER                         PIC X(4).
   666      03 ACSTFCOI                       PIC X(3).
   667      03 ACSFNAML                       PIC S9(4) COMP.
   668      03 ACSFNAMF                       PIC X.
   669      03 FILLER REDEFINES ACSFNAMF.
   670         05 ACSFNAMA                       PIC X.
   671      03 FILLER                         PIC X(4).
   672      03 ACSFNAMI                       PIC X(25).
   673      03 ACSMNAML                       PIC S9(4) COMP.
   674      03 ACSMNAMF                       PIC X.
   675      03 FILLER REDEFINES ACSMNAMF.
   676         05 ACSMNAMA                       PIC X.
   677      03 FILLER                         PIC X(4).
   678      03 ACSMNAMI                       PIC X(25).
   679      03 ACSLNAML                       PIC S9(4) COMP.
   680      03 ACSLNAMF                       PIC X.
   681      03 FILLER REDEFINES ACSLNAMF.
   682         05 ACSLNAMA                       PIC X.
   683      03 FILLER                         PIC X(4).
   684      03 ACSLNAMI                       PIC X(25).
   685      03 ACSADL1L                       PIC S9(4) COMP.
   686      03 ACSADL1F                       PIC X.
   687      03 FILLER REDEFINES ACSADL1F.
   688         05 ACSADL1A                       PIC X.
   689      03 FILLER                         PIC X(4).
   690      03 ACSADL1I                       PIC X(50).
   691      03 ACSSTTEL                       PIC S9(4) COMP.
   692      03 ACSSTTEF                       PIC X.
   693      03 FILLER REDEFINES ACSSTTEF.
   694         05 ACSSTTEA                       PIC X.
   695      03 FILLER                         PIC X(4).
   696      03 ACSSTTEI                       PIC X(2).
   697      03 ACSADL2L                       PIC S9(4) COMP.
   698      03 ACSADL2F                       PIC X.
   699      03 FILLER REDEFINES ACSADL2F.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  18
* COACTVWC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COACTVW.cpy)
   700         05 ACSADL2A                       PIC X.
   701      03 FILLER                         PIC X(4).
   702      03 ACSADL2I                       PIC X(50).
   703      03 ACSZIPCL                       PIC S9(4) COMP.
   704      03 ACSZIPCF                       PIC X.
   705      03 FILLER REDEFINES ACSZIPCF.
   706         05 ACSZIPCA                       PIC X.
   707      03 FILLER                         PIC X(4).
   708      03 ACSZIPCI                       PIC X(5).
   709      03 ACSCITYL                       PIC S9(4) COMP.
   710      03 ACSCITYF                       PIC X.
   711      03 FILLER REDEFINES ACSCITYF.
   712         05 ACSCITYA                       PIC X.
   713      03 FILLER                         PIC X(4).
   714      03 ACSCITYI                       PIC X(50).
   715      03 ACSCTRYL                       PIC S9(4) COMP.
   716      03 ACSCTRYF                       PIC X.
   717      03 FILLER REDEFINES ACSCTRYF.
   718         05 ACSCTRYA                       PIC X.
   719      03 FILLER                         PIC X(4).
   720      03 ACSCTRYI                       PIC X(3).
   721      03 ACSPHN1L                       PIC S9(4) COMP.
   722      03 ACSPHN1F                       PIC X.
   723      03 FILLER REDEFINES ACSPHN1F.
   724         05 ACSPHN1A                       PIC X.
   725      03 FILLER                         PIC X(4).
   726      03 ACSPHN1I                       PIC X(13).
   727      03 ACSGOVTL                       PIC S9(4) COMP.
   728      03 ACSGOVTF                       PIC X.
   729      03 FILLER REDEFINES ACSGOVTF.
   730         05 ACSGOVTA                       PIC X.
   731      03 FILLER                         PIC X(4).
   732      03 ACSGOVTI                       PIC X(20).
   733      03 ACSPHN2L                       PIC S9(4) COMP.
   734      03 ACSPHN2F                       PIC X.
   735      03 FILLER REDEFINES ACSPHN2F.
   736         05 ACSPHN2A                       PIC X.
   737      03 FILLER                         PIC X(4).
   738      03 ACSPHN2I                       PIC X(13).
   739      03 ACSEFTCL                       PIC S9(4) COMP.
   740      03 ACSEFTCF                       PIC X.
   741      03 FILLER REDEFINES ACSEFTCF.
   742         05 ACSEFTCA                       PIC X.
   743      03 FILLER                         PIC X(4).
   744      03 ACSEFTCI                       PIC X(10).
   745      03 ACSPFLGL                       PIC S9(4) COMP.
   746      03 ACSPFLGF                       PIC X.
   747      03 FILLER REDEFINES ACSPFLGF.
   748         05 ACSPFLGA                       PIC X.
   749      03 FILLER                         PIC X(4).
   750      03 ACSPFLGI                       PIC X(1).
   751      03 INFOMSGL                       PIC S9(4) COMP.
   752      03 INFOMSGF                       PIC X.
   753      03 FILLER REDEFINES INFOMSGF.
   754         05 INFOMSGA                       PIC X.
   755      03 FILLER                         PIC X(4).
   756      03 INFOMSGI                       PIC X(45).
   757      03 ERRMSGL                        PIC S9(4) COMP.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  19
* COACTVWC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COACTVW.cpy)
   758      03 ERRMSGF                        PIC X.
   759      03 FILLER REDEFINES ERRMSGF.
   760         05 ERRMSGA                        PIC X.
   761      03 FILLER                         PIC X(4).
   762      03 ERRMSGI                        PIC X(78).
   763
   764*  Output Data For Map CACTVWA
   765   01 CACTVWAO REDEFINES CACTVWAI.
   766      03 FILLER                         PIC X(12).
   767      03 FILLER                         PIC X(3).
   768      03 TRNNAMEC                       PIC X.
   769      03 TRNNAMEP                       PIC X.
   770      03 TRNNAMEH                       PIC X.
   771      03 TRNNAMEV                       PIC X.
   772      03 TRNNAMEO                       PIC X(4).
   773      03 FILLER                         PIC X(3).
   774      03 TITLE01C                       PIC X.
   775      03 TITLE01P                       PIC X.
   776      03 TITLE01H                       PIC X.
   777      03 TITLE01V                       PIC X.
   778      03 TITLE01O                       PIC X(40).
   779      03 FILLER                         PIC X(3).
   780      03 CURDATEC                       PIC X.
   781      03 CURDATEP                       PIC X.
   782      03 CURDATEH                       PIC X.
   783      03 CURDATEV                       PIC X.
   784      03 CURDATEO                       PIC X(8).
   785      03 FILLER                         PIC X(3).
   786      03 PGMNAMEC                       PIC X.
   787      03 PGMNAMEP                       PIC X.
   788      03 PGMNAMEH                       PIC X.
   789      03 PGMNAMEV                       PIC X.
   790      03 PGMNAMEO                       PIC X(8).
   791      03 FILLER                         PIC X(3).
   792      03 TITLE02C                       PIC X.
   793      03 TITLE02P                       PIC X.
   794      03 TITLE02H                       PIC X.
   795      03 TITLE02V                       PIC X.
   796      03 TITLE02O                       PIC X(40).
   797      03 FILLER                         PIC X(3).
   798      03 CURTIMEC                       PIC X.
   799      03 CURTIMEP                       PIC X.
   800      03 CURTIMEH                       PIC X.
   801      03 CURTIMEV                       PIC X.
   802      03 CURTIMEO                       PIC X(8).
   803      03 FILLER                         PIC X(3).
   804      03 ACCTSIDC                       PIC X.
   805      03 ACCTSIDP                       PIC X.
   806      03 ACCTSIDH                       PIC X.
   807      03 ACCTSIDV                       PIC X.
   808      03 ACCTSIDO                       PIC X(11).
   809      03 FILLER                         PIC X(3).
   810      03 ACSTTUSC                       PIC X.
   811      03 ACSTTUSP                       PIC X.
   812      03 ACSTTUSH                       PIC X.
   813      03 ACSTTUSV                       PIC X.
   814      03 ACSTTUSO                       PIC X(1).
   815      03 FILLER                         PIC X(3).
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  20
* COACTVWC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COACTVW.cpy)
   816      03 ADTOPENC                       PIC X.
   817      03 ADTOPENP                       PIC X.
   818      03 ADTOPENH                       PIC X.
   819      03 ADTOPENV                       PIC X.
   820      03 ADTOPENO                       PIC X(10).
   821      03 FILLER                         PIC X(3).
   822      03 ACRDLIMC                       PIC X.
   823      03 ACRDLIMP                       PIC X.
   824      03 ACRDLIMH                       PIC X.
   825      03 ACRDLIMV                       PIC X.
   826      03 ACRDLIMO
   827                                              PIC +ZZZ,ZZZ,ZZZ.99.
   828      03 FILLER                         PIC X(3).
   829      03 AEXPDTC                        PIC X.
   830      03 AEXPDTP                        PIC X.
   831      03 AEXPDTH                        PIC X.
   832      03 AEXPDTV                        PIC X.
   833      03 AEXPDTO                        PIC X(10).
   834      03 FILLER                         PIC X(3).
   835      03 ACSHLIMC                       PIC X.
   836      03 ACSHLIMP                       PIC X.
   837      03 ACSHLIMH                       PIC X.
   838      03 ACSHLIMV                       PIC X.
   839      03 ACSHLIMO
   840                                              PIC +ZZZ,ZZZ,ZZZ.99.
   841      03 FILLER                         PIC X(3).
   842      03 AREISDTC                       PIC X.
   843      03 AREISDTP                       PIC X.
   844      03 AREISDTH                       PIC X.
   845      03 AREISDTV                       PIC X.
   846      03 AREISDTO                       PIC X(10).
   847      03 FILLER                         PIC X(3).
   848      03 ACURBALC                       PIC X.
   849      03 ACURBALP                       PIC X.
   850      03 ACURBALH                       PIC X.
   851      03 ACURBALV                       PIC X.
   852      03 ACURBALO
   853                                              PIC +ZZZ,ZZZ,ZZZ.99.
   854      03 FILLER                         PIC X(3).
   855      03 ACRCYCRC                       PIC X.
   856      03 ACRCYCRP                       PIC X.
   857      03 ACRCYCRH                       PIC X.
   858      03 ACRCYCRV                       PIC X.
   859      03 ACRCYCRO
   860                                              PIC +ZZZ,ZZZ,ZZZ.99.
   861      03 FILLER                         PIC X(3).
   862      03 AADDGRPC                       PIC X.
   863      03 AADDGRPP                       PIC X.
   864      03 AADDGRPH                       PIC X.
   865      03 AADDGRPV                       PIC X.
   866      03 AADDGRPO                       PIC X(10).
   867      03 FILLER                         PIC X(3).
   868      03 ACRCYDBC                       PIC X.
   869      03 ACRCYDBP                       PIC X.
   870      03 ACRCYDBH                       PIC X.
   871      03 ACRCYDBV                       PIC X.
   872      03 ACRCYDBO
   873                                              PIC +ZZZ,ZZZ,ZZZ.99.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  21
* COACTVWC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COACTVW.cpy)
   874      03 FILLER                         PIC X(3).
   875      03 ACSTNUMC                       PIC X.
   876      03 ACSTNUMP                       PIC X.
   877      03 ACSTNUMH                       PIC X.
   878      03 ACSTNUMV                       PIC X.
   879      03 ACSTNUMO                       PIC X(9).
   880      03 FILLER                         PIC X(3).
   881      03 ACSTSSNC                       PIC X.
   882      03 ACSTSSNP                       PIC X.
   883      03 ACSTSSNH                       PIC X.
   884      03 ACSTSSNV                       PIC X.
   885      03 ACSTSSNO                       PIC X(12).
   886      03 FILLER                         PIC X(3).
   887      03 ACSTDOBC                       PIC X.
   888      03 ACSTDOBP                       PIC X.
   889      03 ACSTDOBH                       PIC X.
   890      03 ACSTDOBV                       PIC X.
   891      03 ACSTDOBO                       PIC X(10).
   892      03 FILLER                         PIC X(3).
   893      03 ACSTFCOC                       PIC X.
   894      03 ACSTFCOP                       PIC X.
   895      03 ACSTFCOH                       PIC X.
   896      03 ACSTFCOV                       PIC X.
   897      03 ACSTFCOO                       PIC X(3).
   898      03 FILLER                         PIC X(3).
   899      03 ACSFNAMC                       PIC X.
   900      03 ACSFNAMP                       PIC X.
   901      03 ACSFNAMH                       PIC X.
   902      03 ACSFNAMV                       PIC X.
   903      03 ACSFNAMO                       PIC X(25).
   904      03 FILLER                         PIC X(3).
   905      03 ACSMNAMC                       PIC X.
   906      03 ACSMNAMP                       PIC X.
   907      03 ACSMNAMH                       PIC X.
   908      03 ACSMNAMV                       PIC X.
   909      03 ACSMNAMO                       PIC X(25).
   910      03 FILLER                         PIC X(3).
   911      03 ACSLNAMC                       PIC X.
   912      03 ACSLNAMP                       PIC X.
   913      03 ACSLNAMH                       PIC X.
   914      03 ACSLNAMV                       PIC X.
   915      03 ACSLNAMO                       PIC X(25).
   916      03 FILLER                         PIC X(3).
   917      03 ACSADL1C                       PIC X.
   918      03 ACSADL1P                       PIC X.
   919      03 ACSADL1H                       PIC X.
   920      03 ACSADL1V                       PIC X.
   921      03 ACSADL1O                       PIC X(50).
   922      03 FILLER                         PIC X(3).
   923      03 ACSSTTEC                       PIC X.
   924      03 ACSSTTEP                       PIC X.
   925      03 ACSSTTEH                       PIC X.
   926      03 ACSSTTEV                       PIC X.
   927      03 ACSSTTEO                       PIC X(2).
   928      03 FILLER                         PIC X(3).
   929      03 ACSADL2C                       PIC X.
   930      03 ACSADL2P                       PIC X.
   931      03 ACSADL2H                       PIC X.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  22
* COACTVWC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COACTVW.cpy)
   932      03 ACSADL2V                       PIC X.
   933      03 ACSADL2O                       PIC X(50).
   934      03 FILLER                         PIC X(3).
   935      03 ACSZIPCC                       PIC X.
   936      03 ACSZIPCP                       PIC X.
   937      03 ACSZIPCH                       PIC X.
   938      03 ACSZIPCV                       PIC X.
   939      03 ACSZIPCO                       PIC X(5).
   940      03 FILLER                         PIC X(3).
   941      03 ACSCITYC                       PIC X.
   942      03 ACSCITYP                       PIC X.
   943      03 ACSCITYH                       PIC X.
   944      03 ACSCITYV                       PIC X.
   945      03 ACSCITYO                       PIC X(50).
   946      03 FILLER                         PIC X(3).
   947      03 ACSCTRYC                       PIC X.
   948      03 ACSCTRYP                       PIC X.
   949      03 ACSCTRYH                       PIC X.
   950      03 ACSCTRYV                       PIC X.
   951      03 ACSCTRYO                       PIC X(3).
   952      03 FILLER                         PIC X(3).
   953      03 ACSPHN1C                       PIC X.
   954      03 ACSPHN1P                       PIC X.
   955      03 ACSPHN1H                       PIC X.
   956      03 ACSPHN1V                       PIC X.
   957      03 ACSPHN1O                       PIC X(13).
   958      03 FILLER                         PIC X(3).
   959      03 ACSGOVTC                       PIC X.
   960      03 ACSGOVTP                       PIC X.
   961      03 ACSGOVTH                       PIC X.
   962      03 ACSGOVTV                       PIC X.
   963      03 ACSGOVTO                       PIC X(20).
   964      03 FILLER                         PIC X(3).
   965      03 ACSPHN2C                       PIC X.
   966      03 ACSPHN2P                       PIC X.
   967      03 ACSPHN2H                       PIC X.
   968      03 ACSPHN2V                       PIC X.
   969      03 ACSPHN2O                       PIC X(13).
   970      03 FILLER                         PIC X(3).
   971      03 ACSEFTCC                       PIC X.
   972      03 ACSEFTCP                       PIC X.
   973      03 ACSEFTCH                       PIC X.
   974      03 ACSEFTCV                       PIC X.
   975      03 ACSEFTCO                       PIC X(10).
   976      03 FILLER                         PIC X(3).
   977      03 ACSPFLGC                       PIC X.
   978      03 ACSPFLGP                       PIC X.
   979      03 ACSPFLGH                       PIC X.
   980      03 ACSPFLGV                       PIC X.
   981      03 ACSPFLGO                       PIC X(1).
   982      03 FILLER                         PIC X(3).
   983      03 INFOMSGC                       PIC X.
   984      03 INFOMSGP                       PIC X.
   985      03 INFOMSGH                       PIC X.
   986      03 INFOMSGV                       PIC X.
   987      03 INFOMSGO                       PIC X(45).
   988      03 FILLER                         PIC X(3).
   989      03 ERRMSGC                        PIC X.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  23
* COACTVWC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COACTVW.cpy)
   990      03 ERRMSGP                        PIC X.
   991      03 ERRMSGH                        PIC X.
   992      03 ERRMSGV                        PIC X.
   993      03 ERRMSGO                        PIC X(78).
   994
   995
   996*Current Date
   997*COPY CSDAT01Y.
   998 01 WS-DATE-TIME.
   999   05 WS-CURDATE-DATA.
  1000     10  WS-CURDATE.
  1001       15  WS-CURDATE-YEAR         PIC 9(04).
  1002       15  WS-CURDATE-MONTH        PIC 9(02).
  1003       15  WS-CURDATE-DAY          PIC 9(02).
  1004     10 WS-CURDATE-N REDEFINES WS-CURDATE PIC 9(08).
  1005     10  WS-CURTIME.
  1006       15  WS-CURTIME-HOURS        PIC 9(02).
  1007       15  WS-CURTIME-MINUTE       PIC 9(02).
  1008       15  WS-CURTIME-SECOND       PIC 9(02).
  1009       15  WS-CURTIME-MILSEC       PIC 9(02).
  1010     10 WS-CURTIME-N REDEFINES WS-CURTIME PIC 9(08).
  1011   05 WS-CURDATE-MM-DD-YY.
  1012     10  WS-CURDATE-MM             PIC 9(02).
  1013     10  FILLER                    PIC X(01) VALUE '/'.
  1014     10  WS-CURDATE-DD             PIC 9(02).
  1015     10  FILLER                    PIC X(01) VALUE '/'.
  1016     10  WS-CURDATE-YY             PIC 9(02).
  1017   05 WS-CURTIME-HH-MM-SS.
  1018     10  WS-CURTIME-HH             PIC 9(02).
  1019     10  FILLER                    PIC X(01) VALUE ':'.
  1020     10  WS-CURTIME-MM             PIC 9(02).
  1021     10  FILLER                    PIC X(01) VALUE ':'.
  1022     10  WS-CURTIME-SS             PIC 9(02).
  1023   05 WS-TIMESTAMP.
  1024     10  WS-TIMESTAMP-DT-YYYY      PIC 9(04).
  1025     10  FILLER                    PIC X(01) VALUE '-'.
  1026     10  WS-TIMESTAMP-DT-MM        PIC 9(02).
  1027     10  FILLER                    PIC X(01) VALUE '-'.
  1028     10  WS-TIMESTAMP-DT-DD        PIC 9(02).
  1029     10  FILLER                    PIC X(01) VALUE ' '.
  1030     10  WS-TIMESTAMP-TM-HH        PIC 9(02).
  1031     10  FILLER                    PIC X(01) VALUE ':'.
  1032     10  WS-TIMESTAMP-TM-MM        PIC 9(02).
  1033     10  FILLER                    PIC X(01) VALUE ':'.
  1034     10  WS-TIMESTAMP-TM-SS        PIC 9(02).
  1035     10  FILLER                    PIC X(01) VALUE '.'.
  1036     10  WS-TIMESTAMP-TM-MS6       PIC 9(06).
  1037*
  1038* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT
  1039*
  1040
  1041*Common Messages
  1042*COPY CSMSG01Y.
  1043 01 CCDA-COMMON-MESSAGES.
  1044   05 CCDA-MSG-THANK-YOU         PIC X(50) VALUE
  1045        'Thank you for using CardDemo application...      '.
  1046   05 CCDA-MSG-INVALID-KEY       PIC X(50) VALUE
  1047        'Invalid key pressed. Please see below...         '.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  24
* COACTVWC.cbl
  1048*
  1049* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT
  1050*
  1051
  1052*Abend Variables
  1053*COPY CSMSG02Y.
  1054*Skeleton COBOL Copybook
  1055*****************************************************************
  1056* CABENDD.CPY                                                   *
  1057*---------------------------------------------------------------*
  1058* Work areas for abend routine                                  *
  1059*****************************************************************
  1060 01  ABEND-DATA.
  1061   05  ABEND-CODE                            PIC X(4)
  1062       VALUE SPACES.
  1063   05  ABEND-CULPRIT                         PIC X(8)
  1064       VALUE SPACES.
  1065   05  ABEND-REASON                          PIC X(50)
  1066       VALUE SPACES.
  1067   05  ABEND-MSG                             PIC X(72)
  1068       VALUE SPACES.
  1069
  1070
  1071
  1072*
  1073* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT
  1074*
  1075
  1076*Signed on user data
  1077*COPY CSUSR01Y.
  1078 01 SEC-USER-DATA.
  1079   05 SEC-USR-ID                 PIC X(08).
  1080   05 SEC-USR-FNAME              PIC X(20).
  1081   05 SEC-USR-LNAME              PIC X(20).
  1082   05 SEC-USR-PWD                PIC X(08).
  1083   05 SEC-USR-TYPE               PIC X(01).
  1084   05 SEC-USR-FILLER             PIC X(23).
  1085*
  1086* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:59 CDT
  1087*
  1088
  1089*ACCOUNT RECORD LAYOUT
  1090*COPY CVACT01Y.
  1091*****************************************************************
  1092*    Data-structure for  account entity (RECLN 300)
  1093*****************************************************************
  1094 01  ACCOUNT-RECORD.
  1095     05  ACCT-ID                           PIC 9(11).
  1096     05  ACCT-ACTIVE-STATUS                PIC X(01).
  1097     05  ACCT-CURR-BAL                     PIC S9(10)V99.
  1098     05  ACCT-CREDIT-LIMIT                 PIC S9(10)V99.
  1099     05  ACCT-CASH-CREDIT-LIMIT            PIC S9(10)V99.
  1100     05  ACCT-OPEN-DATE                    PIC X(10).
  1101     05  ACCT-EXPIRAION-DATE               PIC X(10).
  1102     05  ACCT-REISSUE-DATE                 PIC X(10).
  1103     05  ACCT-CURR-CYC-CREDIT              PIC S9(10)V99.
  1104     05  ACCT-CURR-CYC-DEBIT               PIC S9(10)V99.
  1105     05  ACCT-ADDR-ZIP                     PIC X(10).
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  25
* COACTVWC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CVACT01Y.c)
  1106     05  ACCT-GROUP-ID                     PIC X(10).
  1107     05  FILLER                            PIC X(178).
  1108*
  1109* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:59 CDT
  1110*
  1111
  1112
  1113*CUSTOMER RECORD LAYOUT
  1114*COPY CVACT02Y.
  1115*****************************************************************
  1116*    Data-structure for card entity (RECLN 150)
  1117*****************************************************************
  1118 01  CARD-RECORD.
  1119     05  CARD-NUM                          PIC X(16).
  1120     05  CARD-ACCT-ID                      PIC 9(11).
  1121     05  CARD-CVV-CD                       PIC 9(03).
  1122     05  CARD-EMBOSSED-NAME                PIC X(50).
  1123     05  CARD-EXPIRAION-DATE               PIC X(10).
  1124     05  CARD-ACTIVE-STATUS                PIC X(01).
  1125     05  FILLER                            PIC X(59).
  1126*
  1127* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:00 CDT
  1128*
  1129
  1130*CARD XREF LAYOUT
  1131*COPY CVACT03Y.
  1132*****************************************************************
  1133*    Data-structure for card xref (RECLN 50)
  1134*****************************************************************
  1135 01 CARD-XREF-RECORD.
  1136     05  XREF-CARD-NUM                     PIC X(16).
  1137     05  XREF-CUST-ID                      PIC 9(09).
  1138     05  XREF-ACCT-ID                      PIC 9(11).
  1139     05  FILLER                            PIC X(14).
  1140*
  1141* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:00 CDT
  1142*
  1143
  1144*CUSTOMER LAYOUT
  1145*COPY CVCUS01Y.
  1146*****************************************************************
  1147*    Data-structure for Customer entity (RECLN 500)
  1148*****************************************************************
  1149 01  CUSTOMER-RECORD.
  1150     05  CUST-ID                                 PIC 9(09).
  1151     05  CUST-FIRST-NAME                         PIC X(25).
  1152     05  CUST-MIDDLE-NAME                        PIC X(25).
  1153     05  CUST-LAST-NAME                          PIC X(25).
  1154     05  CUST-ADDR-LINE-1                        PIC X(50).
  1155     05  CUST-ADDR-LINE-2                        PIC X(50).
  1156     05  CUST-ADDR-LINE-3                        PIC X(50).
  1157     05  CUST-ADDR-STATE-CD                      PIC X(02).
  1158     05  CUST-ADDR-COUNTRY-CD                    PIC X(03).
  1159     05  CUST-ADDR-ZIP                           PIC X(10).
  1160     05  CUST-PHONE-NUM-1                        PIC X(15).
  1161     05  CUST-PHONE-NUM-2                        PIC X(15).
  1162     05  CUST-SSN                                PIC 9(09).
  1163     05  CUST-GOVT-ISSUED-ID                     PIC X(20).
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  26
* COACTVWC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CVCUS01Y.c)
  1164     05  CUST-DOB-YYYY-MM-DD                     PIC X(10).
  1165     05  CUST-EFT-ACCOUNT-ID                     PIC X(10).
  1166     05  CUST-PRI-CARD-HOLDER-IND                PIC X(01).
  1167     05  CUST-FICO-CREDIT-SCORE                  PIC 9(03).
  1168     05  FILLER                                  PIC X(168).
  1169*
  1170* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:00 CDT
  1171*
  1172
  1173 LINKAGE SECTION.
  1174 01  DFHCOMMAREA.
  1175   05  FILLER                                PIC X(1)
  1176       OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.
  1177
*      EIBCALEN
**    COBCH0245S DEPENDING ON item EIBCALEN missing or illegal  : COACTVWC.cbl(245,58,51)
  1178 PROCEDURE DIVISION.
  1179 0000-MAIN.
  1180
  1181     EXEC CICS HANDLE ABEND
**    COBCH0301S Unrecognized verb  : COACTVWC.cbl(250,15,12)
  1182               LABEL(ABEND-ROUTINE)
  1183     END-EXEC
  1184
  1185     INITIALIZE CC-WORK-AREA
  1186                WS-MISC-STORAGE
  1187                WS-COMMAREA
  1188*****************************************************************
  1189* Store our context
  1190*****************************************************************
  1191     MOVE LIT-THISTRANID       TO WS-TRANID
  1192*****************************************************************
  1193* Ensure error message is cleared                               *
  1194*****************************************************************
  1195     SET WS-RETURN-MSG-OFF  TO TRUE
  1196*****************************************************************
  1197* Store passed data if  any                *
  1198*****************************************************************
  1199     IF EIBCALEN IS EQUAL TO 0
**    COBCH0012S Operand EIBCALEN is not declared  : COACTVWC.cbl(268,22,15)
  1200         OR (CDEMO-FROM-PROGRAM = LIT-MENUPGM
  1201         AND NOT CDEMO-PGM-REENTER)
  1202        INITIALIZE CARDDEMO-COMMAREA
  1203                   WS-THIS-PROGCOMMAREA
  1204     ELSE
  1205        MOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA)  TO
  1206                          CARDDEMO-COMMAREA
  1207        MOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:
  1208                         LENGTH OF WS-THIS-PROGCOMMAREA ) TO
  1209                          WS-THIS-PROGCOMMAREA
  1210     END-IF
  1211
  1212*****************************************************************
  1213* Remap PFkeys as needed.
  1214* Store the Mapped PF Key
  1215*****************************************************************
  1216     PERFORM YYYY-STORE-PFKEY
  1217        THRU YYYY-STORE-PFKEY-EXIT
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  27
* COACTVWC.cbl
  1218*****************************************************************
  1219* Check the AID to see if its valid at this point               *
  1220* F3 - Exit
  1221* Enter show screen again
  1222*****************************************************************
  1223     SET PFK-INVALID TO TRUE
  1224     IF CCARD-AID-ENTER OR
  1225        CCARD-AID-PFK03
  1226        SET PFK-VALID TO TRUE
  1227     END-IF
  1228
  1229     IF PFK-INVALID
  1230        SET CCARD-AID-ENTER TO TRUE
  1231     END-IF
  1232
  1233*****************************************************************
  1234* Decide what to do based on inputs received
  1235*****************************************************************
  1236*****************************************************************
  1237*****************************************************************
  1238* Decide what to do based on inputs received
  1239*****************************************************************
  1240     EVALUATE TRUE
  1241        WHEN CCARD-AID-PFK03
  1242******************************************************************
  1243*            XCTL TO CALLING PROGRAM OR MAIN MENU
  1244******************************************************************
  1245             IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES
  1246             OR CDEMO-FROM-TRANID    EQUAL SPACES
  1247                MOVE LIT-MENUTRANID  TO CDEMO-TO-TRANID
  1248             ELSE
  1249                MOVE CDEMO-FROM-TRANID  TO CDEMO-TO-TRANID
  1250             END-IF
  1251             IF CDEMO-FROM-PROGRAM   EQUAL LOW-VALUES
  1252             OR CDEMO-FROM-PROGRAM   EQUAL SPACES
  1253                MOVE LIT-MENUPGM     TO CDEMO-TO-PROGRAM
  1254             ELSE
  1255                MOVE CDEMO-FROM-PROGRAM TO CDEMO-TO-PROGRAM
  1256             END-IF
  1257
  1258             MOVE LIT-THISTRANID     TO CDEMO-FROM-TRANID
  1259             MOVE LIT-THISPGM        TO CDEMO-FROM-PROGRAM
  1260
  1261             SET  CDEMO-USRTYP-USER  TO TRUE
  1262             SET  CDEMO-PGM-ENTER    TO TRUE
  1263             MOVE LIT-THISMAPSET     TO CDEMO-LAST-MAPSET
  1264             MOVE LIT-THISMAP        TO CDEMO-LAST-MAP
  1265*
  1266             EXEC CICS XCTL
**    COBCH0012S Operand EXEC is not declared  : COACTVWC.cbl(335,23,20)
**    COBCH0012S Operand CICS is not declared  : COACTVWC.cbl(335,28,25)
**    COBCH0012S Operand XCTL is not declared  : COACTVWC.cbl(335,33,30)
  1267                       PROGRAM (CDEMO-TO-PROGRAM)
  1268                       COMMAREA(CARDDEMO-COMMAREA)
  1269             END-EXEC
  1270        WHEN CDEMO-PGM-ENTER
  1271******************************************************************
  1272*            COMING FROM SOME OTHER CONTEXT
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  28
* COACTVWC.cbl
  1273*            SELECTION CRITERIA TO BE GATHERED
  1274******************************************************************
  1275             PERFORM 1000-SEND-MAP THRU
  1276                     1000-SEND-MAP-EXIT
  1277             GO TO COMMON-RETURN
  1278        WHEN CDEMO-PGM-REENTER
  1279             PERFORM 2000-PROCESS-INPUTS
  1280                THRU 2000-PROCESS-INPUTS-EXIT
  1281             IF INPUT-ERROR
  1282                PERFORM 1000-SEND-MAP
  1283                   THRU 1000-SEND-MAP-EXIT
  1284                GO TO COMMON-RETURN
  1285             ELSE
  1286                PERFORM 9000-READ-ACCT
  1287                   THRU 9000-READ-ACCT-EXIT
  1288                PERFORM 1000-SEND-MAP
  1289                   THRU 1000-SEND-MAP-EXIT
  1290                GO TO COMMON-RETURN
  1291             END-IF
  1292       WHEN OTHER
  1293             MOVE LIT-THISPGM    TO ABEND-CULPRIT
  1294             MOVE '0001'         TO ABEND-CODE
  1295             MOVE SPACES         TO ABEND-REASON
  1296             MOVE 'UNEXPECTED DATA SCENARIO'
  1297                                 TO WS-RETURN-MSG
  1298             PERFORM SEND-PLAIN-TEXT
  1299                THRU SEND-PLAIN-TEXT-EXIT
  1300     END-EVALUATE
  1301
  1302* If we had an error setup error message that slipped through
  1303* Display and return
  1304     IF INPUT-ERROR
  1305        MOVE WS-RETURN-MSG  TO CCARD-ERROR-MSG
  1306        PERFORM 1000-SEND-MAP
  1307           THRU 1000-SEND-MAP-EXIT
  1308        GO TO COMMON-RETURN
  1309     END-IF
  1310     .
  1311 COMMON-RETURN.
  1312     MOVE WS-RETURN-MSG     TO CCARD-ERROR-MSG
  1313
  1314     MOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA
  1315     MOVE  WS-THIS-PROGCOMMAREA TO
  1316            WS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:
  1317                         LENGTH OF WS-THIS-PROGCOMMAREA )
  1318
  1319     EXEC CICS RETURN
  1320          TRANSID (LIT-THISTRANID)
**    COBCH0012S Operand TRANSID is not declared  : COACTVWC.cbl(389,23,17)
  1321          COMMAREA (WS-COMMAREA)
  1322          LENGTH(LENGTH OF WS-COMMAREA)
  1323     END-EXEC
  1324     .
  1325 0000-MAIN-EXIT.
  1326     EXIT
  1327     .
  1328 0000-MAIN-EXIT.
  1329     EXIT
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  29
* COACTVWC.cbl
  1330     .
  1331
  1332
  1333 1000-SEND-MAP.
  1334     PERFORM 1100-SCREEN-INIT
  1335        THRU 1100-SCREEN-INIT-EXIT
  1336     PERFORM 1200-SETUP-SCREEN-VARS
  1337        THRU 1200-SETUP-SCREEN-VARS-EXIT
  1338     PERFORM 1300-SETUP-SCREEN-ATTRS
  1339        THRU 1300-SETUP-SCREEN-ATTRS-EXIT
  1340     PERFORM 1400-SEND-SCREEN
  1341        THRU 1400-SEND-SCREEN-EXIT
  1342     .
  1343
  1344 1000-SEND-MAP-EXIT.
  1345     EXIT
  1346     .
  1347
  1348 1100-SCREEN-INIT.
  1349     MOVE LOW-VALUES             TO CACTVWAO
  1350
  1351     MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA
  1352
  1353     MOVE CCDA-TITLE01           TO TITLE01O OF CACTVWAO
  1354     MOVE CCDA-TITLE02           TO TITLE02O OF CACTVWAO
  1355     MOVE LIT-THISTRANID         TO TRNNAMEO OF CACTVWAO
  1356     MOVE LIT-THISPGM            TO PGMNAMEO OF CACTVWAO
  1357
  1358     MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA
  1359
  1360     MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM
  1361     MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD
  1362     MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY
  1363
  1364     MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF CACTVWAO
  1365
  1366     MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH
  1367     MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM
  1368     MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS
  1369
  1370     MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF CACTVWAO
  1371
  1372     .
  1373
  1374 1100-SCREEN-INIT-EXIT.
  1375     EXIT
  1376     .
  1377 1200-SETUP-SCREEN-VARS.
  1378*    INITIALIZE SEARCH CRITERIA
  1379     IF EIBCALEN = 0
  1380        SET  WS-PROMPT-FOR-INPUT TO TRUE
  1381     ELSE
  1382        IF FLG-ACCTFILTER-BLANK
  1383           MOVE LOW-VALUES   TO ACCTSIDO OF CACTVWAO
  1384        ELSE
  1385           MOVE CC-ACCT-ID   TO ACCTSIDO OF CACTVWAO
  1386        END-IF
  1387
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  30
* COACTVWC.cbl
  1388        IF FOUND-ACCT-IN-MASTER
  1389        OR FOUND-CUST-IN-MASTER
  1390           MOVE ACCT-ACTIVE-STATUS  TO ACSTTUSO OF CACTVWAO
  1391
  1392           MOVE ACCT-CURR-BAL       TO ACURBALO OF CACTVWAO
  1393
  1394           MOVE ACCT-CREDIT-LIMIT   TO ACRDLIMO OF CACTVWAO
  1395
  1396           MOVE ACCT-CASH-CREDIT-LIMIT
  1397                                    TO ACSHLIMO OF CACTVWAO
  1398
  1399           MOVE ACCT-CURR-CYC-CREDIT
  1400                                    TO ACRCYCRO OF CACTVWAO
  1401
  1402           MOVE ACCT-CURR-CYC-DEBIT TO ACRCYDBO OF CACTVWAO
  1403
  1404           MOVE ACCT-OPEN-DATE      TO ADTOPENO OF CACTVWAO
  1405           MOVE ACCT-EXPIRAION-DATE TO AEXPDTO  OF CACTVWAO
  1406           MOVE ACCT-REISSUE-DATE   TO AREISDTO OF CACTVWAO
  1407           MOVE ACCT-GROUP-ID       TO AADDGRPO OF CACTVWAO
  1408        END-IF
  1409
  1410        IF FOUND-CUST-IN-MASTER
  1411          MOVE CUST-ID              TO ACSTNUMO OF CACTVWAO
  1412*         MOVE CUST-SSN             TO ACSTSSNO OF CACTVWAO
  1413          STRING
  1414              CUST-SSN(1:3)
  1415              '-'
  1416              CUST-SSN(4:2)
  1417              '-'
  1418              CUST-SSN(6:4)
  1419              DELIMITED BY SIZE
  1420              INTO ACSTSSNO OF CACTVWAO
  1421          END-STRING
  1422          MOVE CUST-FICO-CREDIT-SCORE
  1423                                    TO ACSTFCOO OF CACTVWAO
  1424          MOVE CUST-DOB-YYYY-MM-DD  TO ACSTDOBO OF CACTVWAO
  1425          MOVE CUST-FIRST-NAME      TO ACSFNAMO OF CACTVWAO
  1426          MOVE CUST-MIDDLE-NAME     TO ACSMNAMO OF CACTVWAO
  1427          MOVE CUST-LAST-NAME       TO ACSLNAMO OF CACTVWAO
  1428          MOVE CUST-ADDR-LINE-1     TO ACSADL1O OF CACTVWAO
  1429          MOVE CUST-ADDR-LINE-2     TO ACSADL2O OF CACTVWAO
  1430          MOVE CUST-ADDR-LINE-3     TO ACSCITYO OF CACTVWAO
  1431          MOVE CUST-ADDR-STATE-CD   TO ACSSTTEO OF CACTVWAO
  1432          MOVE CUST-ADDR-ZIP        TO ACSZIPCO OF CACTVWAO
  1433          MOVE CUST-ADDR-COUNTRY-CD TO ACSCTRYO OF CACTVWAO
  1434          MOVE CUST-PHONE-NUM-1     TO ACSPHN1O OF CACTVWAO
  1435          MOVE CUST-PHONE-NUM-2     TO ACSPHN2O OF CACTVWAO
  1436          MOVE CUST-GOVT-ISSUED-ID  TO ACSGOVTO OF CACTVWAO
  1437          MOVE CUST-EFT-ACCOUNT-ID  TO ACSEFTCO OF CACTVWAO
  1438          MOVE CUST-PRI-CARD-HOLDER-IND
  1439                                    TO ACSPFLGO OF CACTVWAO
  1440        END-IF
  1441
  1442      END-IF
  1443
  1444*    SETUP MESSAGE
  1445     IF WS-NO-INFO-MESSAGE
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  31
* COACTVWC.cbl
  1446       SET WS-PROMPT-FOR-INPUT TO TRUE
  1447     END-IF
  1448
  1449     MOVE WS-RETURN-MSG          TO ERRMSGO OF CACTVWAO
  1450
  1451     MOVE WS-INFO-MSG            TO INFOMSGO OF CACTVWAO
  1452     .
  1453
  1454 1200-SETUP-SCREEN-VARS-EXIT.
  1455     EXIT
  1456     .
  1457
  1458 1300-SETUP-SCREEN-ATTRS.
  1459*    PROTECT OR UNPROTECT BASED ON CONTEXT
  1460     MOVE DFHBMFSE               TO ACCTSIDA OF CACTVWAI
  1461
  1462*    POSITION CURSOR
  1463     EVALUATE TRUE
  1464        WHEN FLG-ACCTFILTER-NOT-OK
  1465        WHEN FLG-ACCTFILTER-BLANK
  1466             MOVE -1             TO ACCTSIDL OF CACTVWAI
  1467        WHEN OTHER
  1468             MOVE -1             TO ACCTSIDL OF CACTVWAI
  1469     END-EVALUATE
  1470
  1471*    SETUP COLOR
  1472     MOVE DFHDFCOL               TO ACCTSIDC OF CACTVWAO
  1473
  1474     IF FLG-ACCTFILTER-NOT-OK
  1475        MOVE DFHRED              TO ACCTSIDC OF CACTVWAO
  1476     END-IF
  1477
  1478     IF  FLG-ACCTFILTER-BLANK
  1479     AND CDEMO-PGM-REENTER
  1480         MOVE '*'                TO ACCTSIDO OF CACTVWAO
  1481         MOVE DFHRED             TO ACCTSIDC OF CACTVWAO
  1482     END-IF
  1483
  1484     IF  WS-NO-INFO-MESSAGE
  1485         MOVE DFHBMDAR           TO INFOMSGC OF CACTVWAO
  1486     ELSE
  1487         MOVE DFHNEUTR           TO INFOMSGC OF CACTVWAO
  1488     END-IF
  1489     .
  1490
  1491 1300-SETUP-SCREEN-ATTRS-EXIT.
  1492     EXIT
  1493     .
  1494 1400-SEND-SCREEN.
  1495
  1496     MOVE LIT-THISMAPSET         TO CCARD-NEXT-MAPSET
  1497     MOVE LIT-THISMAP            TO CCARD-NEXT-MAP
  1498     SET  CDEMO-PGM-REENTER TO TRUE
  1499
  1500     EXEC CICS SEND MAP(CCARD-NEXT-MAP)
**    COBCH0132S Repeated 'condition-name TO TRUE/FALSE' in SET statement.  : COACTVWC.cbl(569,15,12)
**    COBCH1895S Communication Facility not supported  : COACTVWC.cbl(569,25,22)
**    COBCH0012S Operand MAP is not declared  : COACTVWC.cbl(569,29,27)
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  32
* COACTVWC.cbl
  1501                    MAPSET(CCARD-NEXT-MAPSET)
  1502                    FROM(CACTVWAO)
  1503                    CURSOR
  1504                    ERASE
  1505                    FREEKB
  1506                    RESP(WS-RESP-CD)
  1507     END-EXEC
  1508     .
  1509 1400-SEND-SCREEN-EXIT.
  1510     EXIT
  1511     .
  1512
  1513 2000-PROCESS-INPUTS.
  1514     PERFORM 2100-RECEIVE-MAP
  1515        THRU 2100-RECEIVE-MAP-EXIT
  1516     PERFORM 2200-EDIT-MAP-INPUTS
  1517        THRU 2200-EDIT-MAP-INPUTS-EXIT
  1518     MOVE WS-RETURN-MSG  TO CCARD-ERROR-MSG
  1519     MOVE LIT-THISPGM    TO CCARD-NEXT-PROG
  1520     MOVE LIT-THISMAPSET TO CCARD-NEXT-MAPSET
  1521     MOVE LIT-THISMAP    TO CCARD-NEXT-MAP
  1522     .
  1523
  1524 2000-PROCESS-INPUTS-EXIT.
  1525     EXIT
  1526     .
  1527 2100-RECEIVE-MAP.
  1528     EXEC CICS RECEIVE MAP(LIT-THISMAP)
**    COBCH0305S Procedure name EXEC same as data-name  : COACTVWC.cbl(597,15,12)
**    COBCH0301S Unrecognized verb  : COACTVWC.cbl(597,15,12)
**    COBCH1895S Communication Facility not supported  : COACTVWC.cbl(597,28,22)
**    COBCH0012S Operand MAP is not declared  : COACTVWC.cbl(597,32,30)
  1529               MAPSET(LIT-THISMAPSET)
  1530               INTO(CACTVWAI)
  1531               RESP(WS-RESP-CD)
  1532               RESP2(WS-REAS-CD)
  1533     END-EXEC
  1534     .
  1535
  1536 2100-RECEIVE-MAP-EXIT.
  1537     EXIT
  1538     .
  1539 2200-EDIT-MAP-INPUTS.
  1540
  1541     SET INPUT-OK                  TO TRUE
  1542     SET FLG-ACCTFILTER-ISVALID    TO TRUE
  1543
  1544*    REPLACE * WITH LOW-VALUES
  1545     IF  ACCTSIDI OF CACTVWAI = '*'
  1546     OR  ACCTSIDI OF CACTVWAI = SPACES
  1547         MOVE LOW-VALUES           TO  CC-ACCT-ID
  1548     ELSE
  1549         MOVE ACCTSIDI OF CACTVWAI TO  CC-ACCT-ID
  1550     END-IF
  1551
  1552*    INDIVIDUAL FIELD EDITS
  1553     PERFORM 2210-EDIT-ACCOUNT
  1554        THRU 2210-EDIT-ACCOUNT-EXIT
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  33
* COACTVWC.cbl
  1555
  1556*    CROSS FIELD EDITS
  1557     IF  FLG-ACCTFILTER-BLANK
  1558         SET NO-SEARCH-CRITERIA-RECEIVED TO TRUE
  1559     END-IF
  1560     .
  1561
  1562 2200-EDIT-MAP-INPUTS-EXIT.
  1563     EXIT
  1564     .
  1565
  1566 2210-EDIT-ACCOUNT.
  1567     SET FLG-ACCTFILTER-NOT-OK TO TRUE
  1568
  1569*    Not supplied
  1570     IF CC-ACCT-ID   EQUAL LOW-VALUES
  1571     OR CC-ACCT-ID   EQUAL SPACES
  1572        SET INPUT-ERROR           TO TRUE
  1573        SET FLG-ACCTFILTER-BLANK  TO TRUE
  1574        IF WS-RETURN-MSG-OFF
  1575           SET WS-PROMPT-FOR-ACCT TO TRUE
  1576        END-IF
  1577        MOVE ZEROES       TO CDEMO-ACCT-ID
  1578        GO TO  2210-EDIT-ACCOUNT-EXIT
  1579     END-IF
  1580*
  1581*    Not numeric
  1582*    Not 11 characters
  1583     IF CC-ACCT-ID  IS NOT NUMERIC
  1584     OR CC-ACCT-ID  EQUAL ZEROES
  1585        SET INPUT-ERROR TO TRUE
  1586        SET FLG-ACCTFILTER-NOT-OK TO TRUE
  1587        IF WS-RETURN-MSG-OFF
  1588          MOVE
  1589        'Account Filter must  be a non-zero 11 digit number'      00
  1590                        TO WS-RETURN-MSG
  1591        END-IF
  1592        MOVE ZERO       TO CDEMO-ACCT-ID
  1593        GO TO 2210-EDIT-ACCOUNT-EXIT
  1594     ELSE
  1595        MOVE CC-ACCT-ID TO CDEMO-ACCT-ID
  1596        SET FLG-ACCTFILTER-ISVALID TO TRUE
  1597     END-IF
  1598     .
  1599
  1600 2210-EDIT-ACCOUNT-EXIT.
  1601     EXIT
  1602     .
  1603
  1604 9000-READ-ACCT.
  1605
  1606     SET  WS-NO-INFO-MESSAGE  TO TRUE
  1607
  1608     MOVE CDEMO-ACCT-ID TO WS-CARD-RID-ACCT-ID
  1609
  1610     PERFORM 9200-GETCARDXREF-BYACCT
  1611        THRU 9200-GETCARDXREF-BYACCT-EXIT
  1612
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  34
* COACTVWC.cbl
  1613*    IF DID-NOT-FIND-ACCT-IN-CARDXREF
  1614     IF FLG-ACCTFILTER-NOT-OK
  1615        GO TO 9000-READ-ACCT-EXIT
  1616     END-IF
  1617
  1618     PERFORM 9300-GETACCTDATA-BYACCT
  1619        THRU 9300-GETACCTDATA-BYACCT-EXIT
  1620
  1621     IF DID-NOT-FIND-ACCT-IN-ACCTDAT
  1622        GO TO 9000-READ-ACCT-EXIT
  1623     END-IF
  1624
  1625     MOVE CDEMO-CUST-ID TO WS-CARD-RID-CUST-ID
  1626
  1627     PERFORM 9400-GETCUSTDATA-BYCUST
  1628        THRU 9400-GETCUSTDATA-BYCUST-EXIT
  1629
  1630     IF DID-NOT-FIND-CUST-IN-CUSTDAT
  1631        GO TO 9000-READ-ACCT-EXIT
  1632     END-IF
  1633
  1634
  1635     .
  1636
  1637 9000-READ-ACCT-EXIT.
  1638     EXIT
  1639     .
  1640 9200-GETCARDXREF-BYACCT.
  1641
  1642*    Read the Card file. Access via alternate index ACCTID
  1643*
  1644     EXEC CICS READ
**    COBCH0305S Procedure name EXEC same as data-name  : COACTVWC.cbl(713,15,12)
**    COBCH0301S Unrecognized verb  : COACTVWC.cbl(713,15,12)
  1645          DATASET   (LIT-CARDXREFNAME-ACCT-PATH)
**    COBCH0012S Operand DATASET is not declared  : COACTVWC.cbl(714,23,17)
  1646          RIDFLD    (WS-CARD-RID-ACCT-ID-X)
  1647          KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)
  1648          INTO      (CARD-XREF-RECORD)
  1649          LENGTH    (LENGTH OF CARD-XREF-RECORD)
  1650          RESP      (WS-RESP-CD)
  1651          RESP2     (WS-REAS-CD)
  1652     END-EXEC
  1653
  1654     EVALUATE WS-RESP-CD
  1655         WHEN DFHRESP(NORMAL)
**    COBCH0012S Operand DFHRESP is not declared  : COACTVWC.cbl(724,27,21)
**    COBCH0012S Operand NORMAL is not declared  : COACTVWC.cbl(724,34,29)
  1656            MOVE XREF-CUST-ID               TO CDEMO-CUST-ID
  1657            MOVE XREF-CARD-NUM              TO CDEMO-CARD-NUM
  1658         WHEN DFHRESP(NOTFND)
**    COBCH0368S Exception phrase inappropriate  : COACTVWC.cbl(727,19,16)
  1659            SET INPUT-ERROR                 TO TRUE
  1660            SET FLG-ACCTFILTER-NOT-OK       TO TRUE
  1661            IF WS-RETURN-MSG-OFF
  1662              MOVE WS-RESP-CD               TO ERROR-RESP
  1663              MOVE WS-REAS-CD               TO ERROR-RESP2
  1664              STRING
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  35
* COACTVWC.cbl
  1665              'Account:'
  1666               WS-CARD-RID-ACCT-ID-X
  1667              ' not found in'
  1668              ' Cross ref file.  Resp:'
  1669              ERROR-RESP
  1670              ' Reas:'
  1671              ERROR-RESP2
  1672              DELIMITED BY SIZE
  1673              INTO WS-RETURN-MSG
  1674              END-STRING
  1675            END-IF
  1676         WHEN OTHER
**    COBCH0368S Exception phrase inappropriate  : COACTVWC.cbl(745,19,16)
  1677            SET INPUT-ERROR                 TO TRUE
  1678            SET FLG-ACCTFILTER-NOT-OK                TO TRUE
  1679            MOVE 'READ'                     TO ERROR-OPNAME
  1680            MOVE LIT-CARDXREFNAME-ACCT-PATH TO ERROR-FILE
  1681            MOVE WS-RESP-CD                 TO ERROR-RESP
  1682            MOVE WS-REAS-CD                 TO ERROR-RESP2
  1683            MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG
  1684*                                              WS-LONG-MSG
  1685*          PERFORM SEND-LONG-TEXT
  1686     END-EVALUATE
**    COBCH0564S A scope-delimiter did not have a matching verb and was discarded.  : COACTVWC.cbl(755,23,12)
  1687     .
  1688 9200-GETCARDXREF-BYACCT-EXIT.
  1689     EXIT
  1690     .
  1691 9300-GETACCTDATA-BYACCT.
  1692
  1693     EXEC CICS READ
**    COBCH0305S Procedure name EXEC same as data-name  : COACTVWC.cbl(762,15,12)
**    COBCH0301S Unrecognized verb  : COACTVWC.cbl(762,15,12)
  1694          DATASET   (LIT-ACCTFILENAME)
  1695          RIDFLD    (WS-CARD-RID-ACCT-ID-X)
  1696          KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)
  1697          INTO      (ACCOUNT-RECORD)
  1698          LENGTH    (LENGTH OF ACCOUNT-RECORD)
  1699          RESP      (WS-RESP-CD)
  1700          RESP2     (WS-REAS-CD)
  1701     END-EXEC
  1702
  1703     EVALUATE WS-RESP-CD
  1704         WHEN DFHRESP(NORMAL)
  1705            SET FOUND-ACCT-IN-MASTER        TO TRUE
  1706         WHEN DFHRESP(NOTFND)
**    COBCH0368S Exception phrase inappropriate  : COACTVWC.cbl(775,19,16)
  1707            SET INPUT-ERROR                 TO TRUE
  1708            SET FLG-ACCTFILTER-NOT-OK       TO TRUE
  1709*           SET DID-NOT-FIND-ACCT-IN-ACCTDAT TO TRUE
  1710            IF WS-RETURN-MSG-OFF
  1711              MOVE WS-RESP-CD               TO ERROR-RESP
  1712              MOVE WS-REAS-CD               TO ERROR-RESP2
  1713              STRING
  1714              'Account:'
  1715               WS-CARD-RID-ACCT-ID-X
  1716              ' not found in'
  1717              ' Acct Master file.Resp:'
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  36
* COACTVWC.cbl
  1718              ERROR-RESP
  1719              ' Reas:'
  1720              ERROR-RESP2
  1721              DELIMITED BY SIZE
  1722              INTO WS-RETURN-MSG
  1723              END-STRING
  1724            END-IF
  1725*
  1726         WHEN OTHER
**    COBCH0368S Exception phrase inappropriate  : COACTVWC.cbl(795,19,16)
  1727            SET INPUT-ERROR                 TO TRUE
  1728            SET FLG-ACCTFILTER-NOT-OK                TO TRUE
  1729            MOVE 'READ'                     TO ERROR-OPNAME
  1730            MOVE LIT-ACCTFILENAME           TO ERROR-FILE
  1731            MOVE WS-RESP-CD                 TO ERROR-RESP
  1732            MOVE WS-REAS-CD                 TO ERROR-RESP2
  1733            MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG
  1734*                                              WS-LONG-MSG
  1735*           PERFORM SEND-LONG-TEXT
  1736     END-EVALUATE
**    COBCH0564S A scope-delimiter did not have a matching verb and was discarded.  : COACTVWC.cbl(805,23,12)
  1737     .
  1738 9300-GETACCTDATA-BYACCT-EXIT.
  1739     EXIT
  1740     .
  1741
  1742 9400-GETCUSTDATA-BYCUST.
  1743     EXEC CICS READ
**    COBCH0305S Procedure name EXEC same as data-name  : COACTVWC.cbl(812,15,12)
**    COBCH0301S Unrecognized verb  : COACTVWC.cbl(812,15,12)
  1744          DATASET   (LIT-CUSTFILENAME)
  1745          RIDFLD    (WS-CARD-RID-CUST-ID-X)
  1746          KEYLENGTH (LENGTH OF WS-CARD-RID-CUST-ID-X)
  1747          INTO      (CUSTOMER-RECORD)
  1748          LENGTH    (LENGTH OF CUSTOMER-RECORD)
  1749          RESP      (WS-RESP-CD)
  1750          RESP2     (WS-REAS-CD)
  1751     END-EXEC
  1752
  1753     EVALUATE WS-RESP-CD
  1754         WHEN DFHRESP(NORMAL)
  1755            SET FOUND-CUST-IN-MASTER        TO TRUE
  1756         WHEN DFHRESP(NOTFND)
**    COBCH0368S Exception phrase inappropriate  : COACTVWC.cbl(825,19,16)
  1757            SET INPUT-ERROR                 TO TRUE
  1758            SET FLG-CUSTFILTER-NOT-OK       TO TRUE
  1759*           SET DID-NOT-FIND-CUST-IN-CUSTDAT TO TRUE
  1760            MOVE WS-RESP-CD               TO ERROR-RESP
  1761            MOVE WS-REAS-CD               TO ERROR-RESP2
  1762            IF WS-RETURN-MSG-OFF
  1763              STRING
  1764              'CustId:'
  1765               WS-CARD-RID-CUST-ID-X
  1766              ' not found'
  1767              ' in customer master.Resp: '
  1768              ERROR-RESP
  1769              ' REAS:'
  1770              ERROR-RESP2
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  37
* COACTVWC.cbl
  1771              DELIMITED BY SIZE
  1772              INTO WS-RETURN-MSG
  1773              END-STRING
  1774            END-IF
  1775         WHEN OTHER
**    COBCH0368S Exception phrase inappropriate  : COACTVWC.cbl(844,19,16)
  1776            SET INPUT-ERROR                 TO TRUE
  1777            SET FLG-CUSTFILTER-NOT-OK                TO TRUE
  1778            MOVE 'READ'                     TO ERROR-OPNAME
  1779            MOVE LIT-CUSTFILENAME           TO ERROR-FILE
  1780            MOVE WS-RESP-CD                 TO ERROR-RESP
  1781            MOVE WS-REAS-CD                 TO ERROR-RESP2
  1782            MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG
  1783*                                              WS-LONG-MSG
  1784*           PERFORM SEND-LONG-TEXT
  1785     END-EVALUATE
**    COBCH0564S A scope-delimiter did not have a matching verb and was discarded.  : COACTVWC.cbl(854,23,12)
  1786     .
  1787 9400-GETCUSTDATA-BYCUST-EXIT.
  1788     EXIT
  1789     .
  1790
  1791*****************************************************************
  1792* Plain text exit - Dont use in production                      *
  1793*****************************************************************
  1794 SEND-PLAIN-TEXT.
  1795     EXEC CICS SEND TEXT
**    COBCH0305S Procedure name EXEC same as data-name  : COACTVWC.cbl(864,15,12)
**    COBCH0301S Unrecognized verb  : COACTVWC.cbl(864,15,12)
**    COBCH1895S Communication Facility not supported  : COACTVWC.cbl(864,25,22)
**    COBCH0013S User-name required  : COACTVWC.cbl(864,30,27)
  1796               FROM(WS-RETURN-MSG)
  1797               LENGTH(LENGTH OF WS-RETURN-MSG)
  1798               ERASE
  1799               FREEKB
  1800     END-EXEC
  1801
  1802     EXEC CICS RETURN
  1803     END-EXEC
**    COBCH0012S Operand END-EXEC is not declared  : COACTVWC.cbl(872,19,12)
  1804     .
  1805 SEND-PLAIN-TEXT-EXIT.
  1806     EXIT
  1807     .
  1808*****************************************************************
  1809* Display Long text and exit                                    *
  1810* This is primarily for debugging and should not be used in     *
  1811* regular course                                                *
  1812*****************************************************************
  1813 SEND-LONG-TEXT.
  1814     EXEC CICS SEND TEXT
**    COBCH0305S Procedure name EXEC same as data-name  : COACTVWC.cbl(883,15,12)
**    COBCH0301S Unrecognized verb  : COACTVWC.cbl(883,15,12)
**    COBCH1895S Communication Facility not supported  : COACTVWC.cbl(883,25,22)
**    COBCH0013S User-name required  : COACTVWC.cbl(883,30,27)
  1815               FROM(WS-LONG-MSG)
  1816               LENGTH(LENGTH OF WS-LONG-MSG)
  1817               ERASE
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  38
* COACTVWC.cbl
  1818               FREEKB
  1819     END-EXEC
  1820
  1821     EXEC CICS RETURN
  1822     END-EXEC
  1823     .
  1824 SEND-LONG-TEXT-EXIT.
  1825     EXIT
  1826     .
  1827*****************************************************************
  1828*Common code to store PFKey
  1829******************************************************************
  1830*COPY 'CSSTRPFY'
  1831*    .
**    COBCH0008S Unknown copybook CSSTRPFY specified  : COACTVWC.cbl(900,11,11)
  1832
  1833 ABEND-ROUTINE.
**    COBCH0301S Unrecognized verb  : COACTVWC.cbl(902,20,8)
**    COBCH0010S Word starts or is continued in wrong area of source line  : COACTVWC.cbl(902,20,8)
  1834
  1835     IF ABEND-MSG EQUAL LOW-VALUES
  1836        MOVE 'UNEXPECTED ABEND OCCURRED.' TO ABEND-MSG
  1837     END-IF
  1838
  1839     MOVE LIT-THISPGM       TO ABEND-CULPRIT
  1840
  1841     EXEC CICS SEND
**    COBCH1895S Communication Facility not supported  : COACTVWC.cbl(910,25,22)
  1842                      FROM (ABEND-DATA)
**    COBCH0013S User-name required  : COACTVWC.cbl(911,32,29)
  1843                      LENGTH(LENGTH OF ABEND-DATA)
  1844                      NOHANDLE
  1845     END-EXEC
  1846
  1847     EXEC CICS HANDLE ABEND
  1848          CANCEL
  1849     END-EXEC
  1850
  1851     EXEC CICS ABEND
  1852          ABCODE('9999')
  1853     END-EXEC
  1854     .
  1855
  1856*
  1857* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:32 CDT
  1858*
*      YYYY-STORE-PFKEY-EXIT
**    COBCH0498S Procedure name YYYY-STORE-PFKEY-EXIT undeclared, line 1217  : COACTVWC.cbl(286,40,20)
*      YYYY-STORE-PFKEY
**    COBCH0498S Procedure name YYYY-STORE-PFKEY undeclared, line 1216  : COACTVWC.cbl(285,35,20)
*
*
* Errors
* -Line- Col Code/severity Description
*                          *      EIBCALEN
*   1176  59  245-S        DEPENDING ON item EIBCALEN missing or illegal
*   1181  16  301-S        Unrecognized verb
*   1199  23   12-S        Operand EIBCALEN is not declared
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  39
* COACTVWC.cbl
*   1266  24   12-S        Operand EXEC is not declared
*   1266  29   12-S        Operand CICS is not declared
*   1266  34   12-S        Operand XCTL is not declared
*   1320  24   12-S        Operand TRANSID is not declared
*   1500  16  132-S        Repeated 'condition-name TO TRUE/FALSE' in SET
*                          statement.
*   1500  26 1895-S        Communication Facility not supported
*   1500  30   12-S        Operand MAP is not declared
*   1528  16  305-S        Procedure name EXEC same as data-name
*   1528  16  301-S        Unrecognized verb
*   1528  29 1895-S        Communication Facility not supported
*   1528  33   12-S        Operand MAP is not declared
*   1644  16  305-S        Procedure name EXEC same as data-name
*   1644  16  301-S        Unrecognized verb
*   1645  24   12-S        Operand DATASET is not declared
*   1655  28   12-S        Operand DFHRESP is not declared
*   1655  35   12-S        Operand NORMAL is not declared
*   1658  20  368-S        Exception phrase inappropriate
*   1676  20  368-S        Exception phrase inappropriate
*   1686  24  564-S        A scope-delimiter did not have a matching verb and
*                          was discarded.
*   1693  16  305-S        Procedure name EXEC same as data-name
*   1693  16  301-S        Unrecognized verb
*   1706  20  368-S        Exception phrase inappropriate
*   1726  20  368-S        Exception phrase inappropriate
*   1736  24  564-S        A scope-delimiter did not have a matching verb and
*                          was discarded.
*   1743  16  305-S        Procedure name EXEC same as data-name
*   1743  16  301-S        Unrecognized verb
*   1756  20  368-S        Exception phrase inappropriate
*   1775  20  368-S        Exception phrase inappropriate
*   1785  24  564-S        A scope-delimiter did not have a matching verb and
*                          was discarded.
*   1795  16  305-S        Procedure name EXEC same as data-name
*   1795  16  301-S        Unrecognized verb
*   1795  26 1895-S        Communication Facility not supported
*   1795  31   13-S        User-name required
*   1803  20   12-S        Operand END-EXEC is not declared
*   1814  16  305-S        Procedure name EXEC same as data-name
*   1814  16  301-S        Unrecognized verb
*   1814  26 1895-S        Communication Facility not supported
*   1814  31   13-S        User-name required
*   1831  12    8-S        Unknown copybook CSSTRPFY specified
*   1833  21  301-S        Unrecognized verb
*   1833  21   10-S        Word starts or is continued in wrong area of source
*                          line
*   1841  26 1895-S        Communication Facility not supported
*   1842  33   13-S        User-name required
*                          *      YYYY-STORE-PFKEY-EXIT
*   1217  41  498-S        Procedure name YYYY-STORE-PFKEY-EXIT undeclared,
*                          line 1217
*                          *      YYYY-STORE-PFKEY
*   1216  36  498-S        Procedure name YYYY-STORE-PFKEY undeclared, line 1216
* Micro Focus COBOL                  V9.0 revision 000 Compiler
* (C) Copyright 1984-2024 Micro Focus or one of its affiliates.
*                                                        REF GKR-081900000A0
* Last message on page:   38
* Total Messages:    48
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  40
* COACTVWC.cbl
* Unrecoverable :     0                    Severe  :    48
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:        6416     Code:           0
