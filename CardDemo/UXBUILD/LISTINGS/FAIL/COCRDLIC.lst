* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   1
* COCRDLIC.cbl
* Options: int("COCRDLIC.int") verbose
*          USE(/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/DIRECTIVES/DI
*          RFOLDER/COCRDLIC.cbl.dir)
*          USE(/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/DIRECTIVES/DE
*          FAULTDIR/DUMMY.DIR)
*          USE(/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/DIRECTIVES/DE
*          FAULTDIR/DUMMY.DIR)
*          USE(/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/DIRECTIVES/DE
*          FAULTDIR/DUMMY.DIR)
* Setting: NOACCEPTREFRESH
*          NOACU
*          NOACUCOMMENT
*          NOACUSYNC
*          NOACU-UNDERSCORE
*            ADV
*            ALIGN"8 OPT"
*            ALPHALITCONT"MARGIN"
*            ALPHASTART"1"
*            ALTER
*          NOAMODE
*            ANIM
*            ANS85
*            APOST
*            AREACHECK
*            ARITH"EXTEND"
*            ARITHMETIC"ENTCOBOL"
*            ASSIGN"EXTERNAL"
*          NOASSIGN-PRINTER
*          NOAUTOLOCK
*          NOBELL
*            BINLIT"BOOLEAN"
*          NOBOUND
*          NOBRIEF
*          NOBS2000
*            BWZSTAR
*            BYTEMODEMOVE
*            CALLFH"EXTFH"
*          NOCALLRECOVERY
*            CALLSORT"EXTSM"
*            CANCEL
*            CANCELLBR
*            CHANGEMESSAGE"2000 N"
*            CHARSET"EBCDIC"
*            CHECKDIV"ENTCOBOL"
*          NOCHECKREFMOD
*          NOCICS
*          NOCICS-CPY
*          NOCICSOPTIMIZE
*          NOCMPR2
*            COBFSTATCONV
*          NOCOBIDY
*          NOCOBOL370
*          NOCOBOLDIR
*          NOCOMMANDLINELINKAGE
*            COLLECTION"CardDemo"
*          NOCOMP
*            COMP"BINARY"
*            COMP1"FLOAT"
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   2
* COCRDLIC.cbl
*            COMP2"FLOAT"
*            COMP-5"2"
*            COMP-6"2"
*            CONFIRM
*          NOCONVERTRET
*            CONVSPACE
*            COPYEXT"cpy,cbl"
*            COPYLBR
*            COPYLIST
*            COPYLISTCOMMENT"7"
*            COPYSEARCH"MF"
*            CSI
*            CURRENCY-SIGN"36"
*            CURRENT-DATE"MMDDYY"
*          NODATA
*            DATACOMPRESS"0"
*          NODATA-CONTEXT
*          NODATAMAP
*            DATE
*            DBCHECK
*            DBCS"3"
*            DBCSSOSI"14""15"
*            DBSPACE
*            DE-EDIT"2"
*            DEFAULTBYTE"0"
*          NODEFAULTCALLS
*            DETECTLOCK
*          NODG
*            DIALECT"ENTCOBOL"
*          NODIRECTIVES-IN-COMMENTS
*            DISPLAY"CONSOLE"
*          NODISPLAYAT
*            DISPLAYPICU"ANSI"
*            DISPSIGN"COMPAT"
*          NODOSVS
*          NODOTNET
*            DPCINDATA"XML"
*            DPCINSUBSCRIPT
*          NODYNAM
*          NOEARLY-RELEASE
*            EBCCOLSEQ"1"
*            ECHO
*          NOECHOALL
*            ENTCOBOL
*          NOEOF1A
*            ERRFORMAT"2"
*            ERRLIST"VERBOSE"
*          NOERRQ
*          NOEXECSQLFLAG
*            EXITPROGRAM"ANSI"
*          NOFASTINIT
*            FASTSORT
*            FCD3
*          NOFCDALIGN
*          NOFCDREG
*            FDCLEAR"3"
*          NOFILESHARE
*            FILETYPE"0"
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   3
* COCRDLIC.cbl
*            FLAG"ENTCOBOL"
*            FLAGAS"S"
*          NOFLAGEUC
*          NOFLAGMIG
*          NOFLAGQ
*            FLAGSINEDIT
*          NOFLAGSTD
*            FOLDCALLNAME"UPPER"
*            FOLDCOPYNAME"UPPER"
*            FORM"60"
*            FP-ROUNDING"ENTCOBOL"
*          NOHOSTARITHMETIC
*            HOSTCONTZERO
*            HOST-NUMCOMPARE
*            HOST-NUMMOVE
*            HOSTFD
*          NOHOSTRW
*          NOIBM-MS
*            IBMCOMP
*            IDENTIFIERLEN"30"
*            IDXFORMAT"0"
*          NOIGNOREEXEC
*          NOIL
*          NOILGEN
*          NOILEMIT
*            IMPLICITSCOPE
*            INCFORMAT"PC"
*            INDD"SYSIN 80 R"
*          NOIDYSRCPATH
*            INFORETURN"0"
*          NOINITCALL
*            INITIAL"1"
*          NOINITPTR
*          NOINITBYTYPE
*            INT"COCRDLIC.int"
*            INTDATE"ANSI"
*            INTLEVEL"9"
*            IOCONV
*          NOISO2002
*          NOIXNLSKEY
*          NOIXNUMKEY
*          NOJAVACALLABLE
*          NOJAVAGENPROGS
*          NOJAVAGENSTRG
*            JAVAOUTPUTPATH""
*            JAVAPACKAGENAME"com.microfocus.COBOL"
*          NOJVMGEN
*            KEYCHECK
*            KEYCOMPRESS"0"
*          NOLIBRARIAN
*          NOLINE-COUNT
*            LIST"COCRDLIC.lst"
*            LISTPATH...
*          ..."/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/LISTINGS/CO"
*            LISTWIDTH"80"
*            LITVAL-SIZE"4"
*          NOLOCALSOURCEFORMAT
*            LOCKTYPE"0"
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   4
* COCRDLIC.cbl
*            MAPNAME
*          NOMAINFRAMEFLOATINGPOINT
*          NOMAXERROR
*            METHODDEFAULT"REFERENCE"
*          NOMF
*          NOMFCOMMENT
*          NOMFSYNC
*          NOMOVELENCHECK
*          NOMS
*          NOMVS
*            NATIONAL"1"
*            NATIVE"EBCDIC"
*          NONATIVEFLOATINGPOINT
*          NONCHAR
*          NONLS
*          NONLSCURRENCYLENGTH
*            NSYMBOL"NATIONAL"
*            NULLESCAPE
*          NOODOOSVS
*            ODOSLIDE
*          NOOLDBLANKLINE
*          NOOLDCOPY
*          NOOLDINDEX
*          NOOLDNEXTSENTENCE
*          NOOLDREADINTO
*          NOOLDSTRMIX
*            OOCTRL"-C-E-G+L-P+Q+R-S+W"
*          NOOPTIONAL-FILE
*          NOOS390
*            OSEXT""
*          NOOSVS
*            OUTDD"SYSOUT 121 R"
*            P64
*          NOPANVALET
*            PANVALET-INCLUDES-IN-COMMENTS
*            PERFORM-TYPE"ENTCOBOL"
*          NOPREPLIST
*          NOPREPROCESS
*            PRESERVECASE
*          NOPRINT-EXT
*          NOPROFILE
*          NOPROGID-COMMENT
*          NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE
*            PROTOTYPE"RELAXED"
*            QUAL
*            QUALPROC
*          NOQUERY
*          NOQUOTE
*          NORAWLIST
*            RDW
*            RECMODE"ENTCOBOL"
*          NOREENTRANT
*          NOREF
*          NOREFNO
*            REMAINDER"2"
*            REPLACE"NOKEEPSEQ"
*            REPORT-LINE"256"
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   5
* COCRDLIC.cbl
*            RESEQ
*          NORETRYLOCK
*            REWRITE-LS
*          NORM
*          NORM-FILE-ERRORS
*            RTNCODE-SIZE"2"
*            RTNCODE-TYPE"COMP"
*          NORWHARDPAGE
*          NOSAA
*          NOSEG
*          NOSEQCHK
*            SEQUENTIAL"RECORD"
*          NOSERIAL
*            SETTING"COL"
*          NOSHAREOUTDD
*          NOSHOW-DIR
*            SIGN"EBCDIC"
*            SIGN"TRAILING"
*          NOSIGNDISCARD
*          NOSIGNFIXUP
*            SORTTYPE"DFSORT"
*          NOSOURCEENCODING
*            SOURCEFORMAT"FIXED"
*            SOURCETABSTOP"4"
*          NOSPZERO
*          NOSSRANGE
*            STDERR
*            STICKY-LINKAGE"1"
*          NOSTICKY-PERFORM
*            SUPFF
*            SWITCHTYPE"1"
*            SYMBSTART"1"
*            SYSPUNCH"80"
*            TERMPAGE
*          NOTESTCOVER
*            TIME
*          NOTRACE
*          NOTRUNC
*            TRUNCCALLNAME"8"
*            TRUNCCOPY"8"
*            TRUNCINC"10"
*            UNICODE"PORTABLE"
*            VERBOSE
*          NOVISUALSTUDIO
*          NOVSC2
*          NOWARNASERROR
*            WARNING"1"
*            WEBSERVER"CGI"
*          NOWRITELOCK
*          NOWRITETHRU
*          NOXMLGEN
*            XMLPARSE"XMLSS"
*          NOXOPEN
*          NOXREF
*            ZEROLENGTHFALSE
*          NOZEROSEQ
*            ZWB
     1*****************************************************************
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   6
* COCRDLIC.cbl
     2* Program:     COCRDLIC.CBL                                     *
     3* Layer:       Business logic                                   *
     4* Function:    List Credit Cards
     5*              a) All cards if no context passed and admin user
     6*              b) Only the ones associated with ACCT in COMMAREA
     7*                 if user is not admin
     8*****************************************************************
     9
    10 IDENTIFICATION DIVISION.
    11 PROGRAM-ID.
    12     COCRDLIC.
    13 DATE-WRITTEN.
    14     April 2022.
    15 DATE-COMPILED. 12-Jul-24 07:58.
    18 ENVIRONMENT DIVISION.
    19 INPUT-OUTPUT SECTION.
    20
    21 DATA DIVISION.
    22
    23 WORKING-STORAGE SECTION.
    24
    25
    26 01  WS-MISC-STORAGE.
    27******************************************************************
    28* General CICS related
    29******************************************************************
    30
    31   05 WS-CICS-PROCESSNG-VARS.
    32      07 WS-RESP-CD                          PIC S9(09) COMP
    33                                             VALUE ZEROS.
    34      07 WS-REAS-CD                          PIC S9(09) COMP
    35                                             VALUE ZEROS.
    36      07 WS-TRANID                           PIC X(4)
    37                                             VALUE SPACES.
    38******************************************************************
    39* Input edits
    40******************************************************************
    41   05 WS-INPUT-FLAG                          PIC X(1).
    42     88  INPUT-OK                            VALUES '0'
    43                                                    ' '
    44                                             LOW-VALUES.
    45     88  INPUT-ERROR                         VALUE '1'.
    46   05  WS-EDIT-ACCT-FLAG                     PIC X(1).
    47     88  FLG-ACCTFILTER-NOT-OK               VALUE '0'.
    48     88  FLG-ACCTFILTER-ISVALID             VALUE '1'.
    49     88  FLG-ACCTFILTER-BLANK                VALUE ' '.
    50   05  WS-EDIT-CARD-FLAG                     PIC X(1).
    51     88  FLG-CARDFILTER-NOT-OK               VALUE '0'.
    52     88  FLG-CARDFILTER-ISVALID             VALUE '1'.
    53     88  FLG-CARDFILTER-BLANK                VALUE ' '.
    54   05 WS-EDIT-SELECT-COUNTER                PIC S9(04)
    55                                            USAGE COMP-3
    56                                            VALUE 0.
    57   05 WS-EDIT-SELECT-FLAGS                  PIC X(7)
    58                                            VALUE LOW-VALUES.
    59   05 WS-EDIT-SELECT-ARRAY REDEFINES  WS-EDIT-SELECT-FLAGS.
    60      10 WS-EDIT-SELECT                      PIC X(1)
    61                                            OCCURS 7 TIMES.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   7
* COCRDLIC.cbl
    62         88 SELECT-OK                        VALUES 'S', 'U'.
    63         88 VIEW-REQUESTED-ON                VALUE 'S'.
    64         88 UPDATE-REQUESTED-ON              VALUE 'U'.
    65         88 SELECT-BLANK                     VALUES
    66                                             ' ',
    67                                             LOW-VALUES.
    68   05 WS-EDIT-SELECT-ERROR-FLAGS             PIC X(7).
    69   05 WS-EDIT-SELECT-ERROR-FLAGX     REDEFINES
    70      WS-EDIT-SELECT-ERROR-FLAGS.
    71      10 WS-EDIT-SELECT-ERRORS OCCURS 7 TIMES.
    72         20 WS-ROW-CRDSELECT-ERROR          PIC X(1).
    73            88 WS-ROW-SELECT-ERROR          VALUE '1'.
    74   05 WS-SUBSCRIPT-VARS.
    75      10 I                                  PIC S9(4) COMP
    76                                            VALUE 0.
    77      10 I-SELECTED                         PIC S9(4) COMP
    78                                            VALUE 0.
    79         88 DETAIL-WAS-REQUESTED            VALUES 1 THRU 7.
    80******************************************************************
    81* Output edits
    82******************************************************************
    83   05 CICS-OUTPUT-EDIT-VARS.
    84     10  CARD-ACCT-ID-X                      PIC X(11).
    85     10  CARD-ACCT-ID-N REDEFINES CARD-ACCT-ID-X
    86                                             PIC 9(11).
    87     10  CARD-CVV-CD-X                       PIC X(03).
    88     10  CARD-CVV-CD-N REDEFINES  CARD-CVV-CD-X
    89                                             PIC 9(03).
    90     10  FLG-PROTECT-SELECT-ROWS             PIC X(1).
    91     88  FLG-PROTECT-SELECT-ROWS-NO          VALUE '0'.
    92     88  FLG-PROTECT-SELECT-ROWS-YES         VALUE '1'.
    93******************************************************************
    94* Output Message Construction
    95******************************************************************
    96   05  WS-LONG-MSG                           PIC X(500).
    97   05  WS-INFO-MSG                           PIC X(45).
    98     88  WS-NO-INFO-MESSAGE                 VALUES
    99                                            SPACES LOW-VALUES.
   100     88  WS-INFORM-REC-ACTIONS          VALUE
   101         'TYPE S FOR DETAIL, U TO UPDATE ANY RECORD'.
   102   05  WS-ERROR-MSG                         PIC X(75).
   103     88  WS-ERROR-MSG-OFF                   VALUE SPACES.
   104     88  WS-EXIT-MESSAGE                     VALUE
   105         'PF03 PRESSED.EXITING'.
   106     88  WS-NO-RECORDS-FOUND                 VALUE
   107         'NO RECORDS FOUND FOR THIS SEARCH CONDITION.'.
   108     88  WS-MORE-THAN-1-ACTION              VALUE
   109         'PLEASE SELECT ONLY ONE RECORD TO VIEW OR UPDATE'.
   110     88  WS-INVALID-ACTION-CODE              VALUE
   111         'INVALID ACTION CODE'.
   112   05  WS-PFK-FLAG                           PIC X(1).
   113     88  PFK-VALID                           VALUE '0'.
   114     88  PFK-INVALID                         VALUE '1'.
   115   05  WS-CONTEXT-FLAG                       PIC X(1).
   116     88  WS-CONTEXT-FRESH-START              VALUE '0'.
   117     88  WS-CONTEXT-FRESH-START-NO           VALUE '1'.
   118******************************************************************
   119* File and data Handling
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   8
* COCRDLIC.cbl
   120******************************************************************
   121   05 WS-FILE-HANDLING-VARS.
   122      10  WS-CARD-RID.
   123          20  WS-CARD-RID-CARDNUM            PIC X(16).
   124          20  WS-CARD-RID-ACCT-ID            PIC 9(11).
   125          20  WS-CARD-RID-ACCT-ID-X          REDEFINES
   126              WS-CARD-RID-ACCT-ID            PIC X(11).
   127
   128
   129
   130   05  WS-SCRN-COUNTER               PIC S9(4) COMP VALUE 0.
   131
   132   05  WS-FILTER-RECORD-FLAG                 PIC X(1).
   133     88  WS-EXCLUDE-THIS-RECORD               VALUE '0'.
   134     88  WS-DONOT-EXCLUDE-THIS-RECORD         VALUE '1'.
   135   05  WS-RECORDS-TO-PROCESS-FLAG            PIC X(1).
   136     88  READ-LOOP-EXIT                      VALUE '0'.
   137     88  MORE-RECORDS-TO-READ                VALUE '1'.
   138   05  WS-FILE-ERROR-MESSAGE.
   139     10  FILLER                              PIC X(12)
   140                                             VALUE 'File Error:'.
   141     10  ERROR-OPNAME                        PIC X(8)
   142                                             VALUE SPACES.
   143     10  FILLER                              PIC X(4)
   144                                             VALUE ' on '.
   145     10  ERROR-FILE                          PIC X(9)
   146                                             VALUE SPACES.
   147     10  FILLER                              PIC X(15)
   148                                             VALUE
   149                                             ' returned RESP '.
   150     10  ERROR-RESP                          PIC X(10)
   151                                             VALUE SPACES.
   152     10  FILLER                              PIC X(7)
   153                                             VALUE ',RESP2 '.
   154     10  ERROR-RESP2                         PIC X(10)
   155                                             VALUE SPACES.
   156    10  FILLER                               PIC X(5).
   157
   158******************************************************************
   159* Literals and Constants
   160******************************************************************
   161 01 WS-CONSTANTS.
   162   05  WS-MAX-SCREEN-LINES                    PIC S9(4) COMP
   163                                              VALUE 7.
   164   05  LIT-THISPGM                            PIC X(8)
   165       VALUE 'COCRDLIC'.
   166   05  LIT-THISTRANID                         PIC X(4)
   167       VALUE 'CCLI'.
   168   05  LIT-THISMAPSET                         PIC X(7)
   169       VALUE 'COCRDLI'.
   170   05  LIT-THISMAP                            PIC X(7)
   171       VALUE 'CCRDLIA'.
   172   05  LIT-MENUPGM                            PIC X(8)
   173       VALUE 'COMEN01C'.
   174   05  LIT-MENUTRANID                         PIC X(4)
   175       VALUE 'CM00'.
   176   05  LIT-MENUMAPSET                         PIC X(7)
   177       VALUE 'COMEN01'.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   9
* COCRDLIC.cbl
   178   05  LIT-MENUMAP                            PIC X(7)
   179       VALUE 'COMEN1A'.
   180   05  LIT-CARDDTLPGM                         PIC X(8)
   181       VALUE 'COCRDSLC'.
   182   05  LIT-CARDDTLTRANID                      PIC X(4)
   183       VALUE 'CCDL'.
   184   05  LIT-CARDDTLMAPSET                      PIC X(7)
   185       VALUE 'COCRDSL'.
   186   05  LIT-CARDDTLMAP                         PIC X(7)
   187       VALUE 'CCRDSLA'.
   188   05  LIT-CARDUPDPGM                         PIC X(8)
   189       VALUE 'COCRDUPC'.
   190   05  LIT-CARDUPDTRANID                      PIC X(4)
   191       VALUE 'CCUP'.
   192   05  LIT-CARDUPDMAPSET                      PIC X(7)
   193       VALUE 'COCRDUP'.
   194   05  LIT-CARDUPDMAP                         PIC X(7)
   195       VALUE 'CCRDUPA'.
   196
   197
   198   05  LIT-CARD-FILE                          PIC X(8)
   199                                             VALUE 'CARDDAT '.
   200   05  LIT-CARD-FILE-ACCT-PATH                PIC X(8)
   201
   202                                             VALUE 'CARDAIX '.
   203******************************************************************
   204*Other common working storage Variables
   205******************************************************************
   206*COPY CVCRD01Y.
   207 01  CC-WORK-AREAS.                                               00010004
   208    05 CC-WORK-AREA.                                              00020001
   209       10 CCARD-AID                         PIC X(5).             00090001
   210          88  CCARD-AID-ENTER                VALUE 'ENTER'.       00100001
   211          88  CCARD-AID-CLEAR                VALUE 'CLEAR'.       00110001
   212          88  CCARD-AID-PA1                  VALUE 'PA1  '.       00120001
   213          88  CCARD-AID-PA2                  VALUE 'PA2  '.       00130001
   214          88  CCARD-AID-PFK01                VALUE 'PFK01'.       00140001
   215          88  CCARD-AID-PFK02                VALUE 'PFK02'.       00150001
   216          88  CCARD-AID-PFK03                VALUE 'PFK03'.       00160001
   217          88  CCARD-AID-PFK04                VALUE 'PFK04'.       00170001
   218          88  CCARD-AID-PFK05                VALUE 'PFK05'.       00180001
   219          88  CCARD-AID-PFK06                VALUE 'PFK06'.       00190001
   220          88  CCARD-AID-PFK07                VALUE 'PFK07'.       00200001
   221          88  CCARD-AID-PFK08                VALUE 'PFK08'.       00210001
   222          88  CCARD-AID-PFK09                VALUE 'PFK09'.       00220001
   223          88  CCARD-AID-PFK10                VALUE 'PFK10'.       00230001
   224          88  CCARD-AID-PFK11                VALUE 'PFK11'.       00240001
   225          88  CCARD-AID-PFK12                VALUE 'PFK12'.       00250001
   226*      10  CCARD-LAST-PROG                  PIC X(8).             00260001
   227       10  CCARD-NEXT-PROG                  PIC X(8).             00270001
   228*      10  CCARD-RETURN-TO-PROG             PIC X(8).             00280001
   229       10  CCARD-NEXT-MAPSET                PIC X(7).             00330001
   230       10  CCARD-NEXT-MAP                   PIC X(7).             00340001
   231*      10  CCARD-RETURN-FLAG                PIC X(1).             00350001
   232*        88  CCARD-RETURN-FLAG-OFF          VALUE LOW-VALUES.     00360001
   233*        88  CCARD-RETURN-FLAG-ON           VALUE '1'.            00370001
   234       10  CCARD-ERROR-MSG                  PIC X(75).            00380001
   235       10  CCARD-RETURN-MSG                 PIC X(75).            00390001
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  10
* COCRDLIC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CVCRD01Y.c)
   236         88  CCARD-RETURN-MSG-OFF           VALUE LOW-VALUES.     00400001
   237*      10  CCARD-FUNCTION                   PIC X(1).             00410001
   238*        88  CCARD-NO-VALUE                  VALUE LOW-VALUES.    00420001
   239*        88  CCARD-GET-DATA                  VALUE '1'.           00430001
   240       10 CC-ACCT-ID                        PIC X(11)             00440005
   241                                            VALUE SPACES.
   242       10 CC-ACCT-ID-N REDEFINES CC-ACCT-ID PIC 9(11).
   243       10 CC-CARD-NUM                       PIC X(16)             00460005
   244                                            VALUE SPACES.         00470005
   245       10 CC-CARD-NUM-N REDEFINES CC-CARD-NUM PIC 9(16).
   246       10 CC-CUST-ID                        PIC X(09)             00480005
   247                                            VALUE SPACES.         00490005
   248       10 CC-CUST-ID-N REDEFINES CC-CUST-ID PIC 9(9).             00480005
   249
   250*
   251* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:00 CDT
   252*
   253
   254******************************************************************
   255*  Commarea manipulations
   256******************************************************************
   257*Application Commmarea Copybook
   258*COPY COCOM01Y.
   259******************************************************************
   260* Communication area for CardDemo application programs
   261******************************************************************
   262 01 CARDDEMO-COMMAREA.
   263    05 CDEMO-GENERAL-INFO.
   264       10 CDEMO-FROM-TRANID             PIC X(04).
   265       10 CDEMO-FROM-PROGRAM            PIC X(08).
   266       10 CDEMO-TO-TRANID               PIC X(04).
   267       10 CDEMO-TO-PROGRAM              PIC X(08).
   268       10 CDEMO-USER-ID                 PIC X(08).
   269       10 CDEMO-USER-TYPE               PIC X(01).
   270          88 CDEMO-USRTYP-ADMIN         VALUE 'A'.
   271          88 CDEMO-USRTYP-USER          VALUE 'U'.
   272       10 CDEMO-PGM-CONTEXT             PIC 9(01).
   273          88 CDEMO-PGM-ENTER            VALUE 0.
   274          88 CDEMO-PGM-REENTER          VALUE 1.
   275    05 CDEMO-CUSTOMER-INFO.
   276       10 CDEMO-CUST-ID                 PIC 9(09).
   277       10 CDEMO-CUST-FNAME              PIC X(25).
   278       10 CDEMO-CUST-MNAME              PIC X(25).
   279       10 CDEMO-CUST-LNAME              PIC X(25).
   280    05 CDEMO-ACCOUNT-INFO.
   281       10 CDEMO-ACCT-ID                 PIC 9(11).
   282       10 CDEMO-ACCT-STATUS             PIC X(01).
   283    05 CDEMO-CARD-INFO.
   284       10 CDEMO-CARD-NUM                PIC 9(16).
   285    05 CDEMO-MORE-INFO.
   286       10  CDEMO-LAST-MAP               PIC X(7).
   287       10  CDEMO-LAST-MAPSET            PIC X(7).
   288*
   289* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:57 CDT
   290*
   291
   292 01 WS-THIS-PROGCOMMAREA.
   293      10 WS-CA-LAST-CARDKEY.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  11
* COCRDLIC.cbl
   294         15  WS-CA-LAST-CARD-NUM                PIC X(16).
   295         15  WS-CA-LAST-CARD-ACCT-ID            PIC 9(11).
   296      10 WS-CA-FIRST-CARDKEY.
   297         15  WS-CA-FIRST-CARD-NUM               PIC X(16).
   298         15  WS-CA-FIRST-CARD-ACCT-ID           PIC 9(11).
   299
   300      10 WS-CA-SCREEN-NUM                       PIC 9(1).
   301         88 CA-FIRST-PAGE                          VALUE 1.
   302      10 WS-CA-LAST-PAGE-DISPLAYED              PIC 9(1).
   303         88 CA-LAST-PAGE-SHOWN                     VALUE 0.
   304         88 CA-LAST-PAGE-NOT-SHOWN                 VALUE 9.
   305      10 WS-CA-NEXT-PAGE-IND                    PIC X(1).
   306         88 CA-NEXT-PAGE-NOT-EXISTS             VALUE LOW-VALUES.
   307         88 CA-NEXT-PAGE-EXISTS                 VALUE 'Y'.
   308
   309      10 WS-RETURN-FLAG                        PIC X(1).
   310     88  WS-RETURN-FLAG-OFF                  VALUE LOW-VALUES.
   311     88  WS-RETURN-FLAG-ON                   VALUE '1'.
   312******************************************************************
   313*  File Data Array         28 CHARS X 7 ROWS = 196
   314******************************************************************
   315   05 WS-SCREEN-DATA.
   316      10 WS-ALL-ROWS                         PIC X(196).
   317      10 FILLER REDEFINES WS-ALL-ROWS.
   318         15 WS-SCREEN-ROWS OCCURS  7 TIMES.
   319            20 WS-EACH-ROW.
   320               25 WS-EACH-CARD.
   321                  30 WS-ROW-ACCTNO           PIC X(11).
   322                  30 WS-ROW-CARD-NUM         PIC X(16).
   323                  30 WS-ROW-CARD-STATUS      PIC X(1).
   324
   325 01  WS-COMMAREA                             PIC X(2000).
   326
   327
   328
   329*IBM SUPPLIED COPYBOOKS
   330*COPY DFHBMSCA.
   331*----------------------------------------------------------------*
   332* dfhbmsca.cpy
   333*<CR_TAG_DEMO_BEGIN>
   334*
   335*  Copyright (C) 2024 Micro Focus or one of its affiliates.
   336*  All rights reserved.
   337*
   338*  This sample code is supplied for demonstration purposes only
   339*  on an "as is" basis and "is for use at your own risk".
   340*
   341*<CR_TAG_DEMO_END>
   342***---------------------------------------------------------*
   343***CONTROL BLOCK NAME= DFHBMSCA                             *
   344***                                                         *
   345***NAME OF MATCHING ASSEMBLER CONTROL BLOCK = NONE          *
   346***                                                         *
   347***DESCRIPTIVE NAME = 3270 ATTRIBUTE VALUES                 *
   348***                                                         *
   349***FUNCTION =  Provides the values for 3270 attribute bytes *
   350***            used by the BMS support.                     *
   351***                                                         *
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  12
* COCRDLIC.cbl (/opt/microfocus/EnterpriseBuildTools/cpylib/DFHBMSCA.cpy)
   352***---------------------------------------------------------*
   353 01      DFHBMSCA.
   354*                                               X'1915'.
   355   02    DFHBMPEM-BIN  PICTURE 9(4) COMP VALUE IS 6421.
   356   02    FILLER REDEFINES DFHBMPEM-BIN.
   357     03  DFHBMPEM  PICTURE X.
   358     03  DFHBMPNL  PICTURE X.
   359*                                               X'0C0D'.
   360   02    DFHBMPFF-BIN  PICTURE 9(4) COMP VALUE IS 3085.
   361   02    FILLER REDEFINES DFHBMPFF-BIN.
   362     03  DFHBMPFF  PICTURE X.
   363     03  DFHBMPCR  PICTURE X.
   364   02    DFHBMASK  PICTURE X   VALUE  IS  '0'.
   365   02    DFHBMUNP  PICTURE X   VALUE  IS  ' '.
   366   02    DFHBMUNN  PICTURE X   VALUE  IS  '&'.
   367   02    DFHBMPRO  PICTURE X   VALUE  IS  '-'.
   368   02    DFHBMBRY  PICTURE X   VALUE  IS  'H'.
   369   02    DFHBMDAR  PICTURE X   VALUE  IS  '<'.
   370   02    DFHBMFSE  PICTURE X   VALUE  IS  'A'.
   371   02    DFHBMPRF  PICTURE X   VALUE  IS  '/'.
   372   02    DFHBMASF  PICTURE X   VALUE  IS  '1'.
   373   02    DFHBMASB  PICTURE X   VALUE  IS  '8'.
   374*                                               X'0E0F'.
   375   02    DFHBMPSO-BIN  PICTURE 9(4) COMP VALUE IS 3599.
   376   02    FILLER REDEFINES DFHBMPSO-BIN.
   377     03  DFHBMPSO  PICTURE X.
   378     03  DFHBMPSI  PICTURE X.
   379*                                               X'0080'.
   380   02    DFHBMEOF-BIN  PICTURE 9(4) COMP VALUE IS 128.
   381   02    FILLER REDEFINES DFHBMEOF-BIN.
   382     03  FILLER    PICTURE X.
   383     03  DFHBMEOF  PICTURE X.
   384*                                               X'0282'.
   385   02    DFHBMCUR-BIN  PICTURE 9(4) COMP VALUE IS 642.
   386   02    FILLER REDEFINES DFHBMCUR-BIN.
   387     03  DFHBMCUR  PICTURE X.
   388     03  DFHBMEC   PICTURE X.
   389*                                               X'0082'.
   390   02    DFHBMFLG-BIN  PICTURE 9(4) COMP VALUE IS 130.
   391       88    DFHERASE VALUES ARE 128, 130.
   392       88    DFHCURSR VALUES ARE   2, 130.
   393   02    FILLER REDEFINES DFHBMFLG-BIN.
   394     03  FILLER    PICTURE X.
   395     03  DFHBMFLG  PICTURE X.
   396   02    DFHBMDET  PICTURE X   VALUE  IS  HIGH-VALUES.
   397   02    FILLER    PICTURE X.
   398*                                               X'0028'.
   399   02    DFHSA-BIN  PICTURE 9(4) COMP VALUE IS 40.
   400   02    FILLER REDEFINES DFHSA-BIN.
   401     03  FILLER    PICTURE X.
   402     03  DFHSA     PICTURE X.
   403*                                               X'003F'.
   404   02    DFHERROR-BIN  PICTURE 9(4) COMP VALUE IS 63.
   405   02    FILLER REDEFINES DFHERROR-BIN.
   406     03  FILLER    PICTURE X.
   407     03  DFHERROR  PICTURE X.
   408*                                               X'0042'.
   409   02    DFHCOLOR-BIN  PICTURE 9(4) COMP VALUE IS 66.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  13
* COCRDLIC.cbl (/opt/microfocus/EnterpriseBuildTools/cpylib/DFHBMSCA.cpy)
   410   02    FILLER REDEFINES DFHCOLOR-BIN.
   411     03  FILLER    PICTURE X.
   412     03  DFHCOLOR  PICTURE X.
   413*                                               X'0043'.
   414   02    DFHPS-BIN  PICTURE 9(4) COMP VALUE IS 67.
   415   02    FILLER REDEFINES DFHPS-BIN.
   416     03  FILLER    PICTURE X.
   417     03  DFHPS     PICTURE X.
   418*                                               X'0041'.
   419   02    DFHHLT-BIN  PICTURE 9(4) COMP VALUE IS 65.
   420   02    FILLER REDEFINES DFHHLT-BIN.
   421     03  FILLER    PICTURE X.
   422     03  DFHHLT    PICTURE X.
   423*                                               X'00C0'.
   424   02    DFH3270-BIN   PICTURE 9(4) COMP VALUE IS 192.
   425   02    FILLER REDEFINES DFH3270-BIN.
   426     03  FILLER    PICTURE X.
   427     03  DFH3270   PICTURE X.
   428   02    DFHVAL    PICTURE X   VALUE  IS  'A'.
   429   02    DFHOUTLN  PICTURE X   VALUE  IS  'B'.
   430*                                               X'0046'.
   431   02    DFHBKTRN-BIN  PICTURE 9(4) COMP VALUE IS 70.
   432   02    FILLER REDEFINES DFHBKTRN-BIN.
   433     03  FILLER    PICTURE X.
   434     03  DFHBKTRN  PICTURE X.
   435   02    DFHALL    PICTURE X   VALUE  IS  LOW-VALUES.
   436   02    DFHDFT    PICTURE X   VALUE  IS  HIGH-VALUES.
   437   02    DFHDFCOL  PICTURE X   VALUE  IS  LOW-VALUES.
   438   02    DFHBLUE   PICTURE X   VALUE  IS  '1'.
   439   02    DFHRED    PICTURE X   VALUE  IS  '2'.
   440   02    DFHPINK   PICTURE X   VALUE  IS  '3'.
   441   02    DFHGREEN  PICTURE X   VALUE  IS  '4'.
   442   02    DFHTURQ   PICTURE X   VALUE  IS  '5'.
   443   02    DFHYELLO  PICTURE X   VALUE  IS  '6'.
   444   02    DFHNEUTR  PICTURE X   VALUE  IS  '7'.
   445   02    DFHBASE   PICTURE X   VALUE  IS  LOW-VALUES.
   446   02    DFHDFHI   PICTURE X   VALUE  IS  LOW-VALUES.
   447   02    DFHBLINK  PICTURE X   VALUE  IS  '1'.
   448   02    DFHREVRS  PICTURE X   VALUE  IS  '2'.
   449   02    DFHUNDLN  PICTURE X   VALUE  IS  '4'.
   450*                                               X'0402'.
   451   02    DFHMFIL-BIN  PICTURE 9(4) COMP VALUE IS 1026.
   452   02    FILLER REDEFINES DFHMFIL-BIN.
   453     03  DFHMFIL   PICTURE X.
   454     03  DFHMENT   PICTURE X.
   455*                                               X'0601'.
   456   02    DFHMFE-BIN  PICTURE 9(4) COMP VALUE IS 1537.
   457   02    FILLER REDEFINES DFHMFE-BIN.
   458     03  DFHMFE    PICTURE X.
   459     03  DFHMT     PICTURE X.
   460*                                               X'0503'.
   461   02    DFHMFT-BIN  PICTURE 9(4) COMP VALUE IS 1283.
   462   02    FILLER REDEFINES DFHMFT-BIN.
   463     03  DFHMFT    PICTURE X.
   464     03  DFHMET    PICTURE X.
   465*                                               X'0007'.
   466   02    DFHMFET-BIN  PICTURE 9(4) COMP VALUE IS 7.
   467   02    FILLER REDEFINES DFHMFET-BIN.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  14
* COCRDLIC.cbl (/opt/microfocus/EnterpriseBuildTools/cpylib/DFHBMSCA.cpy)
   468     03  FILLER    PICTURE X.
   469     03  DFHMFET   PICTURE X.
   470   02    DFHUNNOD  PICTURE X   VALUE  IS  '('.
   471   02    DFHUNIMD  PICTURE X   VALUE  IS  'I'.
   472   02    DFHUNNUM  PICTURE X   VALUE  IS  'J'.
   473   02    DFHUNNUB  PICTURE X   VALUE  IS  'Q'.
   474   02    DFHUNINT  PICTURE X   VALUE  IS  'R'.
   475   02    DFHUNNON  PICTURE X   VALUE  IS  ')'.
   476   02    DFHPROTI  PICTURE X   VALUE  IS  'Y'.
   477   02    DFHPROTN  PICTURE X   VALUE  IS  '%'.
   478   02    DFHDFFR   PICTURE X   VALUE  IS  LOW-VALUES.
   479*                                               X'0102'.
   480   02    DFHUNDER-BIN  PICTURE 9(4) COMP VALUE IS 258.
   481   02    FILLER REDEFINES DFHUNDER-BIN.
   482     03  DFHUNDER  PICTURE X.
   483     03  DFHRIGHT  PICTURE X.
   484*                                               X'0408'.
   485   02    DFHOVER-BIN  PICTURE 9(4) COMP VALUE IS 1032.
   486   02    FILLER REDEFINES DFHOVER-BIN.
   487     03  DFHOVER   PICTURE X.
   488     03  DFHLEFT   PICTURE X.
   489*                                               X'000F'.
   490   02    DFHBOX-BIN   PICTURE 9(4) COMP VALUE IS 15.
   491   02    FILLER REDEFINES DFHBOX-BIN.
   492     03  FILLER    PICTURE X.
   493     03  DFHBOX    PICTURE X.
   494*                                               X'0001'.
   495   02    DFHSOSI-BIN  PICTURE 9(4) COMP VALUE IS 1.
   496   02    FILLER REDEFINES DFHSOSI-BIN.
   497     03  FILLER    PICTURE X.
   498     03  DFHSOSI   PICTURE X.
   499   02    DFHTRANS  PICTURE X   VALUE  IS  '0'.
   500   02    DFHOPAQ   PICTURE X   VALUE  IS  HIGH-VALUES.
   501*----------------------------------------------------------------*
   502* dfhbmsca.cpy end
   503*----------------------------------------------------------------*
   504*COPY DFHAID.
   505*<CR_TAG_DEMO_BEGIN>
   506*
   507*  Copyright (C) 2024 Micro Focus or one of its affiliates.
   508*  All rights reserved.
   509*
   510*  This sample code is supplied for demonstration purposes only
   511*  on an "as is" basis and "is for use at your own risk".
   512*
   513*<CR_TAG_DEMO_END>
   514*----------------------------------------------------------------*
   515* dfhaid.cpy
   516*----------------------------------------------------------------*
   517 01  DFHAID.
   518     02  DFHNULL         PIC X   VALUE IS LOW-VALUE.
   519     02  DFHENTER        PIC X   VALUE IS ''''.
   520     02  DFHCLEAR        PIC X   VALUE IS '_'.
   521     02  DFHPEN          PIC X   VALUE IS '='.
   522     02  DFHOPID         PIC X   VALUE IS 'W'.
   523     02  DFHMSRE         PIC X   VALUE IS 'X'.
   524     02  DFHSTRF         PIC X   VALUE IS ' '.
   525     02  DFHTRIG         PIC X   VALUE IS '"'.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  15
* COCRDLIC.cbl (/opt/microfocus/EnterpriseBuildTools/cpylib/DFHAID.cpy)
   526     02  DFHPA1          PIC X   VALUE IS '%'.
   527     02  DFHPA2          PIC X   VALUE IS '>'.
   528     02  DFHPA3          PIC X   VALUE IS ','.
   529     02  DFHPF1          PIC X   VALUE IS '1'.
   530     02  DFHPF2          PIC X   VALUE IS '2'.
   531     02  DFHPF3          PIC X   VALUE IS '3'.
   532     02  DFHPF4          PIC X   VALUE IS '4'.
   533     02  DFHPF5          PIC X   VALUE IS '5'.
   534     02  DFHPF6          PIC X   VALUE IS '6'.
   535     02  DFHPF7          PIC X   VALUE IS '7'.
   536     02  DFHPF8          PIC X   VALUE IS '8'.
   537     02  DFHPF9          PIC X   VALUE IS '9'.
   538     02  DFHPF10         PIC X   VALUE IS ':'.
   539     02  DFHPF11         PIC X   VALUE IS '#'.
   540     02  DFHPF12         PIC X   VALUE IS '@'.
   541     02  DFHPF13         PIC X   VALUE IS 'A'.
   542     02  DFHPF14         PIC X   VALUE IS 'B'.
   543     02  DFHPF15         PIC X   VALUE IS 'C'.
   544     02  DFHPF16         PIC X   VALUE IS 'D'.
   545     02  DFHPF17         PIC X   VALUE IS 'E'.
   546     02  DFHPF18         PIC X   VALUE IS 'F'.
   547     02  DFHPF19         PIC X   VALUE IS 'G'.
   548     02  DFHPF20         PIC X   VALUE IS 'H'.
   549     02  DFHPF21         PIC X   VALUE IS 'I'.
   550     02  DFHPF22         PIC X   VALUE IS ' '.
   551*    Note: CICS ECM alters the line above to...
   552*          Value for ASCII  is X'5B'
   553*          Value for EBCDIC is X'4A'
   554     02  DFHPF23         PIC X   VALUE IS '.'.
   555     02  DFHPF24         PIC X   VALUE IS '<'.
   556*----------------------------------------------------------------*
   557* dfhaid.cpy end
   558*----------------------------------------------------------------*
   559
   560*COMMON COPYBOOKS
   561*Screen Titles
   562*COPY COTTL01Y.
   563 01 CCDA-SCREEN-TITLE.
   564   05 CCDA-TITLE01    PIC X(40) VALUE
   565      '      AWS Mainframe Modernization       '.
   566   05 CCDA-TITLE02    PIC X(40) VALUE
   567*     '  Credit Card Demo Application (CCDA)   '.
   568      '              CardDemo                  '.
   569   05 CCDA-THANK-YOU  PIC X(40) VALUE
   570      'Thank you for using CCDA application... '.
   571*
   572* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT
   573*
   574*Credit Card Search Screen Layout
   575*COPY COCRDSL.
   576*Credit Card List Screen Layout
   577*COPY COCRDLI.
   578*   Micro Focus COBOL 2017  7.0.00247
   579*   Micro Focus BMS Screen Painter
   580*   MapSet Name   COCRDLI
   581*   Date Created  08/05/2022
   582*   Time Created  16:44:44
   583
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  16
* COCRDLIC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COCRDLI.cpy)
   584*  Input Data For Map CCRDLIA
   585   01 CCRDLIAI.
   586      03 FILLER                         PIC X(12).
   587      03 TRNNAMEL                       PIC S9(4) COMP.
   588      03 TRNNAMEF                       PIC X.
   589      03 FILLER REDEFINES TRNNAMEF.
   590         05 TRNNAMEA                       PIC X.
   591      03 FILLER                         PIC X(4).
   592      03 TRNNAMEI                       PIC X(4).
   593      03 TITLE01L                       PIC S9(4) COMP.
   594      03 TITLE01F                       PIC X.
   595      03 FILLER REDEFINES TITLE01F.
   596         05 TITLE01A                       PIC X.
   597      03 FILLER                         PIC X(4).
   598      03 TITLE01I                       PIC X(40).
   599      03 CURDATEL                       PIC S9(4) COMP.
   600      03 CURDATEF                       PIC X.
   601      03 FILLER REDEFINES CURDATEF.
   602         05 CURDATEA                       PIC X.
   603      03 FILLER                         PIC X(4).
   604      03 CURDATEI                       PIC X(8).
   605      03 PGMNAMEL                       PIC S9(4) COMP.
   606      03 PGMNAMEF                       PIC X.
   607      03 FILLER REDEFINES PGMNAMEF.
   608         05 PGMNAMEA                       PIC X.
   609      03 FILLER                         PIC X(4).
   610      03 PGMNAMEI                       PIC X(8).
   611      03 TITLE02L                       PIC S9(4) COMP.
   612      03 TITLE02F                       PIC X.
   613      03 FILLER REDEFINES TITLE02F.
   614         05 TITLE02A                       PIC X.
   615      03 FILLER                         PIC X(4).
   616      03 TITLE02I                       PIC X(40).
   617      03 CURTIMEL                       PIC S9(4) COMP.
   618      03 CURTIMEF                       PIC X.
   619      03 FILLER REDEFINES CURTIMEF.
   620         05 CURTIMEA                       PIC X.
   621      03 FILLER                         PIC X(4).
   622      03 CURTIMEI                       PIC X(8).
   623      03 PAGENOL                        PIC S9(4) COMP.
   624      03 PAGENOF                        PIC X.
   625      03 FILLER REDEFINES PAGENOF.
   626         05 PAGENOA                        PIC X.
   627      03 FILLER                         PIC X(4).
   628      03 PAGENOI                        PIC X(3).
   629      03 ACCTSIDL                       PIC S9(4) COMP.
   630      03 ACCTSIDF                       PIC X.
   631      03 FILLER REDEFINES ACCTSIDF.
   632         05 ACCTSIDA                       PIC X.
   633      03 FILLER                         PIC X(4).
   634      03 ACCTSIDI                       PIC X(11).
   635      03 CARDSIDL                       PIC S9(4) COMP.
   636      03 CARDSIDF                       PIC X.
   637      03 FILLER REDEFINES CARDSIDF.
   638         05 CARDSIDA                       PIC X.
   639      03 FILLER                         PIC X(4).
   640      03 CARDSIDI                       PIC X(16).
   641      03 CRDSEL1L                       PIC S9(4) COMP.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  17
* COCRDLIC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COCRDLI.cpy)
   642      03 CRDSEL1F                       PIC X.
   643      03 FILLER REDEFINES CRDSEL1F.
   644         05 CRDSEL1A                       PIC X.
   645      03 FILLER                         PIC X(4).
   646      03 CRDSEL1I                       PIC X(1).
   647      03 ACCTNO1L                       PIC S9(4) COMP.
   648      03 ACCTNO1F                       PIC X.
   649      03 FILLER REDEFINES ACCTNO1F.
   650         05 ACCTNO1A                       PIC X.
   651      03 FILLER                         PIC X(4).
   652      03 ACCTNO1I                       PIC X(11).
   653      03 CRDNUM1L                       PIC S9(4) COMP.
   654      03 CRDNUM1F                       PIC X.
   655      03 FILLER REDEFINES CRDNUM1F.
   656         05 CRDNUM1A                       PIC X.
   657      03 FILLER                         PIC X(4).
   658      03 CRDNUM1I                       PIC X(16).
   659      03 CRDSTS1L                       PIC S9(4) COMP.
   660      03 CRDSTS1F                       PIC X.
   661      03 FILLER REDEFINES CRDSTS1F.
   662         05 CRDSTS1A                       PIC X.
   663      03 FILLER                         PIC X(4).
   664      03 CRDSTS1I                       PIC X(1).
   665      03 CRDSEL2L                       PIC S9(4) COMP.
   666      03 CRDSEL2F                       PIC X.
   667      03 FILLER REDEFINES CRDSEL2F.
   668         05 CRDSEL2A                       PIC X.
   669      03 FILLER                         PIC X(4).
   670      03 CRDSEL2I                       PIC X(1).
   671      03 CRDSTP2L                       PIC S9(4) COMP.
   672      03 CRDSTP2F                       PIC X.
   673      03 FILLER REDEFINES CRDSTP2F.
   674         05 CRDSTP2A                       PIC X.
   675      03 FILLER                         PIC X(4).
   676      03 CRDSTP2I                       PIC X(1).
   677      03 ACCTNO2L                       PIC S9(4) COMP.
   678      03 ACCTNO2F                       PIC X.
   679      03 FILLER REDEFINES ACCTNO2F.
   680         05 ACCTNO2A                       PIC X.
   681      03 FILLER                         PIC X(4).
   682      03 ACCTNO2I                       PIC X(11).
   683      03 CRDNUM2L                       PIC S9(4) COMP.
   684      03 CRDNUM2F                       PIC X.
   685      03 FILLER REDEFINES CRDNUM2F.
   686         05 CRDNUM2A                       PIC X.
   687      03 FILLER                         PIC X(4).
   688      03 CRDNUM2I                       PIC X(16).
   689      03 CRDSTS2L                       PIC S9(4) COMP.
   690      03 CRDSTS2F                       PIC X.
   691      03 FILLER REDEFINES CRDSTS2F.
   692         05 CRDSTS2A                       PIC X.
   693      03 FILLER                         PIC X(4).
   694      03 CRDSTS2I                       PIC X(1).
   695      03 CRDSEL3L                       PIC S9(4) COMP.
   696      03 CRDSEL3F                       PIC X.
   697      03 FILLER REDEFINES CRDSEL3F.
   698         05 CRDSEL3A                       PIC X.
   699      03 FILLER                         PIC X(4).
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  18
* COCRDLIC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COCRDLI.cpy)
   700      03 CRDSEL3I                       PIC X(1).
   701      03 CRDSTP3L                       PIC S9(4) COMP.
   702      03 CRDSTP3F                       PIC X.
   703      03 FILLER REDEFINES CRDSTP3F.
   704         05 CRDSTP3A                       PIC X.
   705      03 FILLER                         PIC X(4).
   706      03 CRDSTP3I                       PIC X(1).
   707      03 ACCTNO3L                       PIC S9(4) COMP.
   708      03 ACCTNO3F                       PIC X.
   709      03 FILLER REDEFINES ACCTNO3F.
   710         05 ACCTNO3A                       PIC X.
   711      03 FILLER                         PIC X(4).
   712      03 ACCTNO3I                       PIC X(11).
   713      03 CRDNUM3L                       PIC S9(4) COMP.
   714      03 CRDNUM3F                       PIC X.
   715      03 FILLER REDEFINES CRDNUM3F.
   716         05 CRDNUM3A                       PIC X.
   717      03 FILLER                         PIC X(4).
   718      03 CRDNUM3I                       PIC X(16).
   719      03 CRDSTS3L                       PIC S9(4) COMP.
   720      03 CRDSTS3F                       PIC X.
   721      03 FILLER REDEFINES CRDSTS3F.
   722         05 CRDSTS3A                       PIC X.
   723      03 FILLER                         PIC X(4).
   724      03 CRDSTS3I                       PIC X(1).
   725      03 CRDSEL4L                       PIC S9(4) COMP.
   726      03 CRDSEL4F                       PIC X.
   727      03 FILLER REDEFINES CRDSEL4F.
   728         05 CRDSEL4A                       PIC X.
   729      03 FILLER                         PIC X(4).
   730      03 CRDSEL4I                       PIC X(1).
   731      03 CRDSTP4L                       PIC S9(4) COMP.
   732      03 CRDSTP4F                       PIC X.
   733      03 FILLER REDEFINES CRDSTP4F.
   734         05 CRDSTP4A                       PIC X.
   735      03 FILLER                         PIC X(4).
   736      03 CRDSTP4I                       PIC X(1).
   737      03 ACCTNO4L                       PIC S9(4) COMP.
   738      03 ACCTNO4F                       PIC X.
   739      03 FILLER REDEFINES ACCTNO4F.
   740         05 ACCTNO4A                       PIC X.
   741      03 FILLER                         PIC X(4).
   742      03 ACCTNO4I                       PIC X(11).
   743      03 CRDNUM4L                       PIC S9(4) COMP.
   744      03 CRDNUM4F                       PIC X.
   745      03 FILLER REDEFINES CRDNUM4F.
   746         05 CRDNUM4A                       PIC X.
   747      03 FILLER                         PIC X(4).
   748      03 CRDNUM4I                       PIC X(16).
   749      03 CRDSTS4L                       PIC S9(4) COMP.
   750      03 CRDSTS4F                       PIC X.
   751      03 FILLER REDEFINES CRDSTS4F.
   752         05 CRDSTS4A                       PIC X.
   753      03 FILLER                         PIC X(4).
   754      03 CRDSTS4I                       PIC X(1).
   755      03 CRDSEL5L                       PIC S9(4) COMP.
   756      03 CRDSEL5F                       PIC X.
   757      03 FILLER REDEFINES CRDSEL5F.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  19
* COCRDLIC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COCRDLI.cpy)
   758         05 CRDSEL5A                       PIC X.
   759      03 FILLER                         PIC X(4).
   760      03 CRDSEL5I                       PIC X(1).
   761      03 CRDSTP5L                       PIC S9(4) COMP.
   762      03 CRDSTP5F                       PIC X.
   763      03 FILLER REDEFINES CRDSTP5F.
   764         05 CRDSTP5A                       PIC X.
   765      03 FILLER                         PIC X(4).
   766      03 CRDSTP5I                       PIC X(1).
   767      03 ACCTNO5L                       PIC S9(4) COMP.
   768      03 ACCTNO5F                       PIC X.
   769      03 FILLER REDEFINES ACCTNO5F.
   770         05 ACCTNO5A                       PIC X.
   771      03 FILLER                         PIC X(4).
   772      03 ACCTNO5I                       PIC X(11).
   773      03 CRDNUM5L                       PIC S9(4) COMP.
   774      03 CRDNUM5F                       PIC X.
   775      03 FILLER REDEFINES CRDNUM5F.
   776         05 CRDNUM5A                       PIC X.
   777      03 FILLER                         PIC X(4).
   778      03 CRDNUM5I                       PIC X(16).
   779      03 CRDSTS5L                       PIC S9(4) COMP.
   780      03 CRDSTS5F                       PIC X.
   781      03 FILLER REDEFINES CRDSTS5F.
   782         05 CRDSTS5A                       PIC X.
   783      03 FILLER                         PIC X(4).
   784      03 CRDSTS5I                       PIC X(1).
   785      03 CRDSEL6L                       PIC S9(4) COMP.
   786      03 CRDSEL6F                       PIC X.
   787      03 FILLER REDEFINES CRDSEL6F.
   788         05 CRDSEL6A                       PIC X.
   789      03 FILLER                         PIC X(4).
   790      03 CRDSEL6I                       PIC X(1).
   791      03 CRDSTP6L                       PIC S9(4) COMP.
   792      03 CRDSTP6F                       PIC X.
   793      03 FILLER REDEFINES CRDSTP6F.
   794         05 CRDSTP6A                       PIC X.
   795      03 FILLER                         PIC X(4).
   796      03 CRDSTP6I                       PIC X(1).
   797      03 ACCTNO6L                       PIC S9(4) COMP.
   798      03 ACCTNO6F                       PIC X.
   799      03 FILLER REDEFINES ACCTNO6F.
   800         05 ACCTNO6A                       PIC X.
   801      03 FILLER                         PIC X(4).
   802      03 ACCTNO6I                       PIC X(11).
   803      03 CRDNUM6L                       PIC S9(4) COMP.
   804      03 CRDNUM6F                       PIC X.
   805      03 FILLER REDEFINES CRDNUM6F.
   806         05 CRDNUM6A                       PIC X.
   807      03 FILLER                         PIC X(4).
   808      03 CRDNUM6I                       PIC X(16).
   809      03 CRDSTS6L                       PIC S9(4) COMP.
   810      03 CRDSTS6F                       PIC X.
   811      03 FILLER REDEFINES CRDSTS6F.
   812         05 CRDSTS6A                       PIC X.
   813      03 FILLER                         PIC X(4).
   814      03 CRDSTS6I                       PIC X(1).
   815      03 CRDSEL7L                       PIC S9(4) COMP.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  20
* COCRDLIC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COCRDLI.cpy)
   816      03 CRDSEL7F                       PIC X.
   817      03 FILLER REDEFINES CRDSEL7F.
   818         05 CRDSEL7A                       PIC X.
   819      03 FILLER                         PIC X(4).
   820      03 CRDSEL7I                       PIC X(1).
   821      03 CRDSTP7L                       PIC S9(4) COMP.
   822      03 CRDSTP7F                       PIC X.
   823      03 FILLER REDEFINES CRDSTP7F.
   824         05 CRDSTP7A                       PIC X.
   825      03 FILLER                         PIC X(4).
   826      03 CRDSTP7I                       PIC X(1).
   827      03 ACCTNO7L                       PIC S9(4) COMP.
   828      03 ACCTNO7F                       PIC X.
   829      03 FILLER REDEFINES ACCTNO7F.
   830         05 ACCTNO7A                       PIC X.
   831      03 FILLER                         PIC X(4).
   832      03 ACCTNO7I                       PIC X(11).
   833      03 CRDNUM7L                       PIC S9(4) COMP.
   834      03 CRDNUM7F                       PIC X.
   835      03 FILLER REDEFINES CRDNUM7F.
   836         05 CRDNUM7A                       PIC X.
   837      03 FILLER                         PIC X(4).
   838      03 CRDNUM7I                       PIC X(16).
   839      03 CRDSTS7L                       PIC S9(4) COMP.
   840      03 CRDSTS7F                       PIC X.
   841      03 FILLER REDEFINES CRDSTS7F.
   842         05 CRDSTS7A                       PIC X.
   843      03 FILLER                         PIC X(4).
   844      03 CRDSTS7I                       PIC X(1).
   845      03 INFOMSGL                       PIC S9(4) COMP.
   846      03 INFOMSGF                       PIC X.
   847      03 FILLER REDEFINES INFOMSGF.
   848         05 INFOMSGA                       PIC X.
   849      03 FILLER                         PIC X(4).
   850      03 INFOMSGI                       PIC X(45).
   851      03 ERRMSGL                        PIC S9(4) COMP.
   852      03 ERRMSGF                        PIC X.
   853      03 FILLER REDEFINES ERRMSGF.
   854         05 ERRMSGA                        PIC X.
   855      03 FILLER                         PIC X(4).
   856      03 ERRMSGI                        PIC X(78).
   857
   858*  Output Data For Map CCRDLIA
   859   01 CCRDLIAO REDEFINES CCRDLIAI.
   860      03 FILLER                         PIC X(12).
   861      03 FILLER                         PIC X(3).
   862      03 TRNNAMEC                       PIC X.
   863      03 TRNNAMEP                       PIC X.
   864      03 TRNNAMEH                       PIC X.
   865      03 TRNNAMEV                       PIC X.
   866      03 TRNNAMEO                       PIC X(4).
   867      03 FILLER                         PIC X(3).
   868      03 TITLE01C                       PIC X.
   869      03 TITLE01P                       PIC X.
   870      03 TITLE01H                       PIC X.
   871      03 TITLE01V                       PIC X.
   872      03 TITLE01O                       PIC X(40).
   873      03 FILLER                         PIC X(3).
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  21
* COCRDLIC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COCRDLI.cpy)
   874      03 CURDATEC                       PIC X.
   875      03 CURDATEP                       PIC X.
   876      03 CURDATEH                       PIC X.
   877      03 CURDATEV                       PIC X.
   878      03 CURDATEO                       PIC X(8).
   879      03 FILLER                         PIC X(3).
   880      03 PGMNAMEC                       PIC X.
   881      03 PGMNAMEP                       PIC X.
   882      03 PGMNAMEH                       PIC X.
   883      03 PGMNAMEV                       PIC X.
   884      03 PGMNAMEO                       PIC X(8).
   885      03 FILLER                         PIC X(3).
   886      03 TITLE02C                       PIC X.
   887      03 TITLE02P                       PIC X.
   888      03 TITLE02H                       PIC X.
   889      03 TITLE02V                       PIC X.
   890      03 TITLE02O                       PIC X(40).
   891      03 FILLER                         PIC X(3).
   892      03 CURTIMEC                       PIC X.
   893      03 CURTIMEP                       PIC X.
   894      03 CURTIMEH                       PIC X.
   895      03 CURTIMEV                       PIC X.
   896      03 CURTIMEO                       PIC X(8).
   897      03 FILLER                         PIC X(3).
   898      03 PAGENOC                        PIC X.
   899      03 PAGENOP                        PIC X.
   900      03 PAGENOH                        PIC X.
   901      03 PAGENOV                        PIC X.
   902      03 PAGENOO                        PIC X(3).
   903      03 FILLER                         PIC X(3).
   904      03 ACCTSIDC                       PIC X.
   905      03 ACCTSIDP                       PIC X.
   906      03 ACCTSIDH                       PIC X.
   907      03 ACCTSIDV                       PIC X.
   908      03 ACCTSIDO                       PIC X(11).
   909      03 FILLER                         PIC X(3).
   910      03 CARDSIDC                       PIC X.
   911      03 CARDSIDP                       PIC X.
   912      03 CARDSIDH                       PIC X.
   913      03 CARDSIDV                       PIC X.
   914      03 CARDSIDO                       PIC X(16).
   915      03 FILLER                         PIC X(3).
   916      03 CRDSEL1C                       PIC X.
   917      03 CRDSEL1P                       PIC X.
   918      03 CRDSEL1H                       PIC X.
   919      03 CRDSEL1V                       PIC X.
   920      03 CRDSEL1O                       PIC X(1).
   921      03 FILLER                         PIC X(3).
   922      03 ACCTNO1C                       PIC X.
   923      03 ACCTNO1P                       PIC X.
   924      03 ACCTNO1H                       PIC X.
   925      03 ACCTNO1V                       PIC X.
   926      03 ACCTNO1O                       PIC X(11).
   927      03 FILLER                         PIC X(3).
   928      03 CRDNUM1C                       PIC X.
   929      03 CRDNUM1P                       PIC X.
   930      03 CRDNUM1H                       PIC X.
   931      03 CRDNUM1V                       PIC X.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  22
* COCRDLIC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COCRDLI.cpy)
   932      03 CRDNUM1O                       PIC X(16).
   933      03 FILLER                         PIC X(3).
   934      03 CRDSTS1C                       PIC X.
   935      03 CRDSTS1P                       PIC X.
   936      03 CRDSTS1H                       PIC X.
   937      03 CRDSTS1V                       PIC X.
   938      03 CRDSTS1O                       PIC X(1).
   939      03 FILLER                         PIC X(3).
   940      03 CRDSEL2C                       PIC X.
   941      03 CRDSEL2P                       PIC X.
   942      03 CRDSEL2H                       PIC X.
   943      03 CRDSEL2V                       PIC X.
   944      03 CRDSEL2O                       PIC X(1).
   945      03 FILLER                         PIC X(3).
   946      03 CRDSTP2C                       PIC X.
   947      03 CRDSTP2P                       PIC X.
   948      03 CRDSTP2H                       PIC X.
   949      03 CRDSTP2V                       PIC X.
   950      03 CRDSTP2O                       PIC X(1).
   951      03 FILLER                         PIC X(3).
   952      03 ACCTNO2C                       PIC X.
   953      03 ACCTNO2P                       PIC X.
   954      03 ACCTNO2H                       PIC X.
   955      03 ACCTNO2V                       PIC X.
   956      03 ACCTNO2O                       PIC X(11).
   957      03 FILLER                         PIC X(3).
   958      03 CRDNUM2C                       PIC X.
   959      03 CRDNUM2P                       PIC X.
   960      03 CRDNUM2H                       PIC X.
   961      03 CRDNUM2V                       PIC X.
   962      03 CRDNUM2O                       PIC X(16).
   963      03 FILLER                         PIC X(3).
   964      03 CRDSTS2C                       PIC X.
   965      03 CRDSTS2P                       PIC X.
   966      03 CRDSTS2H                       PIC X.
   967      03 CRDSTS2V                       PIC X.
   968      03 CRDSTS2O                       PIC X(1).
   969      03 FILLER                         PIC X(3).
   970      03 CRDSEL3C                       PIC X.
   971      03 CRDSEL3P                       PIC X.
   972      03 CRDSEL3H                       PIC X.
   973      03 CRDSEL3V                       PIC X.
   974      03 CRDSEL3O                       PIC X(1).
   975      03 FILLER                         PIC X(3).
   976      03 CRDSTP3C                       PIC X.
   977      03 CRDSTP3P                       PIC X.
   978      03 CRDSTP3H                       PIC X.
   979      03 CRDSTP3V                       PIC X.
   980      03 CRDSTP3O                       PIC X(1).
   981      03 FILLER                         PIC X(3).
   982      03 ACCTNO3C                       PIC X.
   983      03 ACCTNO3P                       PIC X.
   984      03 ACCTNO3H                       PIC X.
   985      03 ACCTNO3V                       PIC X.
   986      03 ACCTNO3O                       PIC X(11).
   987      03 FILLER                         PIC X(3).
   988      03 CRDNUM3C                       PIC X.
   989      03 CRDNUM3P                       PIC X.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  23
* COCRDLIC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COCRDLI.cpy)
   990      03 CRDNUM3H                       PIC X.
   991      03 CRDNUM3V                       PIC X.
   992      03 CRDNUM3O                       PIC X(16).
   993      03 FILLER                         PIC X(3).
   994      03 CRDSTS3C                       PIC X.
   995      03 CRDSTS3P                       PIC X.
   996      03 CRDSTS3H                       PIC X.
   997      03 CRDSTS3V                       PIC X.
   998      03 CRDSTS3O                       PIC X(1).
   999      03 FILLER                         PIC X(3).
  1000      03 CRDSEL4C                       PIC X.
  1001      03 CRDSEL4P                       PIC X.
  1002      03 CRDSEL4H                       PIC X.
  1003      03 CRDSEL4V                       PIC X.
  1004      03 CRDSEL4O                       PIC X(1).
  1005      03 FILLER                         PIC X(3).
  1006      03 CRDSTP4C                       PIC X.
  1007      03 CRDSTP4P                       PIC X.
  1008      03 CRDSTP4H                       PIC X.
  1009      03 CRDSTP4V                       PIC X.
  1010      03 CRDSTP4O                       PIC X(1).
  1011      03 FILLER                         PIC X(3).
  1012      03 ACCTNO4C                       PIC X.
  1013      03 ACCTNO4P                       PIC X.
  1014      03 ACCTNO4H                       PIC X.
  1015      03 ACCTNO4V                       PIC X.
  1016      03 ACCTNO4O                       PIC X(11).
  1017      03 FILLER                         PIC X(3).
  1018      03 CRDNUM4C                       PIC X.
  1019      03 CRDNUM4P                       PIC X.
  1020      03 CRDNUM4H                       PIC X.
  1021      03 CRDNUM4V                       PIC X.
  1022      03 CRDNUM4O                       PIC X(16).
  1023      03 FILLER                         PIC X(3).
  1024      03 CRDSTS4C                       PIC X.
  1025      03 CRDSTS4P                       PIC X.
  1026      03 CRDSTS4H                       PIC X.
  1027      03 CRDSTS4V                       PIC X.
  1028      03 CRDSTS4O                       PIC X(1).
  1029      03 FILLER                         PIC X(3).
  1030      03 CRDSEL5C                       PIC X.
  1031      03 CRDSEL5P                       PIC X.
  1032      03 CRDSEL5H                       PIC X.
  1033      03 CRDSEL5V                       PIC X.
  1034      03 CRDSEL5O                       PIC X(1).
  1035      03 FILLER                         PIC X(3).
  1036      03 CRDSTP5C                       PIC X.
  1037      03 CRDSTP5P                       PIC X.
  1038      03 CRDSTP5H                       PIC X.
  1039      03 CRDSTP5V                       PIC X.
  1040      03 CRDSTP5O                       PIC X(1).
  1041      03 FILLER                         PIC X(3).
  1042      03 ACCTNO5C                       PIC X.
  1043      03 ACCTNO5P                       PIC X.
  1044      03 ACCTNO5H                       PIC X.
  1045      03 ACCTNO5V                       PIC X.
  1046      03 ACCTNO5O                       PIC X(11).
  1047      03 FILLER                         PIC X(3).
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  24
* COCRDLIC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COCRDLI.cpy)
  1048      03 CRDNUM5C                       PIC X.
  1049      03 CRDNUM5P                       PIC X.
  1050      03 CRDNUM5H                       PIC X.
  1051      03 CRDNUM5V                       PIC X.
  1052      03 CRDNUM5O                       PIC X(16).
  1053      03 FILLER                         PIC X(3).
  1054      03 CRDSTS5C                       PIC X.
  1055      03 CRDSTS5P                       PIC X.
  1056      03 CRDSTS5H                       PIC X.
  1057      03 CRDSTS5V                       PIC X.
  1058      03 CRDSTS5O                       PIC X(1).
  1059      03 FILLER                         PIC X(3).
  1060      03 CRDSEL6C                       PIC X.
  1061      03 CRDSEL6P                       PIC X.
  1062      03 CRDSEL6H                       PIC X.
  1063      03 CRDSEL6V                       PIC X.
  1064      03 CRDSEL6O                       PIC X(1).
  1065      03 FILLER                         PIC X(3).
  1066      03 CRDSTP6C                       PIC X.
  1067      03 CRDSTP6P                       PIC X.
  1068      03 CRDSTP6H                       PIC X.
  1069      03 CRDSTP6V                       PIC X.
  1070      03 CRDSTP6O                       PIC X(1).
  1071      03 FILLER                         PIC X(3).
  1072      03 ACCTNO6C                       PIC X.
  1073      03 ACCTNO6P                       PIC X.
  1074      03 ACCTNO6H                       PIC X.
  1075      03 ACCTNO6V                       PIC X.
  1076      03 ACCTNO6O                       PIC X(11).
  1077      03 FILLER                         PIC X(3).
  1078      03 CRDNUM6C                       PIC X.
  1079      03 CRDNUM6P                       PIC X.
  1080      03 CRDNUM6H                       PIC X.
  1081      03 CRDNUM6V                       PIC X.
  1082      03 CRDNUM6O                       PIC X(16).
  1083      03 FILLER                         PIC X(3).
  1084      03 CRDSTS6C                       PIC X.
  1085      03 CRDSTS6P                       PIC X.
  1086      03 CRDSTS6H                       PIC X.
  1087      03 CRDSTS6V                       PIC X.
  1088      03 CRDSTS6O                       PIC X(1).
  1089      03 FILLER                         PIC X(3).
  1090      03 CRDSEL7C                       PIC X.
  1091      03 CRDSEL7P                       PIC X.
  1092      03 CRDSEL7H                       PIC X.
  1093      03 CRDSEL7V                       PIC X.
  1094      03 CRDSEL7O                       PIC X(1).
  1095      03 FILLER                         PIC X(3).
  1096      03 CRDSTP7C                       PIC X.
  1097      03 CRDSTP7P                       PIC X.
  1098      03 CRDSTP7H                       PIC X.
  1099      03 CRDSTP7V                       PIC X.
  1100      03 CRDSTP7O                       PIC X(1).
  1101      03 FILLER                         PIC X(3).
  1102      03 ACCTNO7C                       PIC X.
  1103      03 ACCTNO7P                       PIC X.
  1104      03 ACCTNO7H                       PIC X.
  1105      03 ACCTNO7V                       PIC X.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  25
* COCRDLIC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COCRDLI.cpy)
  1106      03 ACCTNO7O                       PIC X(11).
  1107      03 FILLER                         PIC X(3).
  1108      03 CRDNUM7C                       PIC X.
  1109      03 CRDNUM7P                       PIC X.
  1110      03 CRDNUM7H                       PIC X.
  1111      03 CRDNUM7V                       PIC X.
  1112      03 CRDNUM7O                       PIC X(16).
  1113      03 FILLER                         PIC X(3).
  1114      03 CRDSTS7C                       PIC X.
  1115      03 CRDSTS7P                       PIC X.
  1116      03 CRDSTS7H                       PIC X.
  1117      03 CRDSTS7V                       PIC X.
  1118      03 CRDSTS7O                       PIC X(1).
  1119      03 FILLER                         PIC X(3).
  1120      03 INFOMSGC                       PIC X.
  1121      03 INFOMSGP                       PIC X.
  1122      03 INFOMSGH                       PIC X.
  1123      03 INFOMSGV                       PIC X.
  1124      03 INFOMSGO                       PIC X(45).
  1125      03 FILLER                         PIC X(3).
  1126      03 ERRMSGC                        PIC X.
  1127      03 ERRMSGP                        PIC X.
  1128      03 ERRMSGH                        PIC X.
  1129      03 ERRMSGV                        PIC X.
  1130      03 ERRMSGO                        PIC X(78).
  1131
  1132
  1133*Current Date
  1134*COPY CSDAT01Y.
  1135 01 WS-DATE-TIME.
  1136   05 WS-CURDATE-DATA.
  1137     10  WS-CURDATE.
  1138       15  WS-CURDATE-YEAR         PIC 9(04).
  1139       15  WS-CURDATE-MONTH        PIC 9(02).
  1140       15  WS-CURDATE-DAY          PIC 9(02).
  1141     10 WS-CURDATE-N REDEFINES WS-CURDATE PIC 9(08).
  1142     10  WS-CURTIME.
  1143       15  WS-CURTIME-HOURS        PIC 9(02).
  1144       15  WS-CURTIME-MINUTE       PIC 9(02).
  1145       15  WS-CURTIME-SECOND       PIC 9(02).
  1146       15  WS-CURTIME-MILSEC       PIC 9(02).
  1147     10 WS-CURTIME-N REDEFINES WS-CURTIME PIC 9(08).
  1148   05 WS-CURDATE-MM-DD-YY.
  1149     10  WS-CURDATE-MM             PIC 9(02).
  1150     10  FILLER                    PIC X(01) VALUE '/'.
  1151     10  WS-CURDATE-DD             PIC 9(02).
  1152     10  FILLER                    PIC X(01) VALUE '/'.
  1153     10  WS-CURDATE-YY             PIC 9(02).
  1154   05 WS-CURTIME-HH-MM-SS.
  1155     10  WS-CURTIME-HH             PIC 9(02).
  1156     10  FILLER                    PIC X(01) VALUE ':'.
  1157     10  WS-CURTIME-MM             PIC 9(02).
  1158     10  FILLER                    PIC X(01) VALUE ':'.
  1159     10  WS-CURTIME-SS             PIC 9(02).
  1160   05 WS-TIMESTAMP.
  1161     10  WS-TIMESTAMP-DT-YYYY      PIC 9(04).
  1162     10  FILLER                    PIC X(01) VALUE '-'.
  1163     10  WS-TIMESTAMP-DT-MM        PIC 9(02).
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  26
* COCRDLIC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSDAT01Y.c)
  1164     10  FILLER                    PIC X(01) VALUE '-'.
  1165     10  WS-TIMESTAMP-DT-DD        PIC 9(02).
  1166     10  FILLER                    PIC X(01) VALUE ' '.
  1167     10  WS-TIMESTAMP-TM-HH        PIC 9(02).
  1168     10  FILLER                    PIC X(01) VALUE ':'.
  1169     10  WS-TIMESTAMP-TM-MM        PIC 9(02).
  1170     10  FILLER                    PIC X(01) VALUE ':'.
  1171     10  WS-TIMESTAMP-TM-SS        PIC 9(02).
  1172     10  FILLER                    PIC X(01) VALUE '.'.
  1173     10  WS-TIMESTAMP-TM-MS6       PIC 9(06).
  1174*
  1175* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT
  1176*
  1177*Common Messages
  1178*COPY CSMSG01Y.
  1179 01 CCDA-COMMON-MESSAGES.
  1180   05 CCDA-MSG-THANK-YOU         PIC X(50) VALUE
  1181        'Thank you for using CardDemo application...      '.
  1182   05 CCDA-MSG-INVALID-KEY       PIC X(50) VALUE
  1183        'Invalid key pressed. Please see below...         '.
  1184*
  1185* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT
  1186*
  1187*Abend Variables
  1188*COPY CSMSG02Y.
  1189*Signed on user data
  1190*COPY CSUSR01Y.
  1191 01 SEC-USER-DATA.
  1192   05 SEC-USR-ID                 PIC X(08).
  1193   05 SEC-USR-FNAME              PIC X(20).
  1194   05 SEC-USR-LNAME              PIC X(20).
  1195   05 SEC-USR-PWD                PIC X(08).
  1196   05 SEC-USR-TYPE               PIC X(01).
  1197   05 SEC-USR-FILLER             PIC X(23).
  1198*
  1199* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:59 CDT
  1200*
  1201
  1202*Dataset layouts
  1203
  1204*CARD RECORD LAYOUT
  1205*COPY CVACT02Y.
  1206*****************************************************************
  1207*    Data-structure for card entity (RECLN 150)
  1208*****************************************************************
  1209 01  CARD-RECORD.
  1210     05  CARD-NUM                          PIC X(16).
  1211     05  CARD-ACCT-ID                      PIC 9(11).
  1212     05  CARD-CVV-CD                       PIC 9(03).
  1213     05  CARD-EMBOSSED-NAME                PIC X(50).
  1214     05  CARD-EXPIRAION-DATE               PIC X(10).
  1215     05  CARD-ACTIVE-STATUS                PIC X(01).
  1216     05  FILLER                            PIC X(59).
  1217*
  1218* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:00 CDT
  1219*
  1220
  1221 LINKAGE SECTION.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  27
* COCRDLIC.cbl
  1222 01  DFHCOMMAREA.
  1223   05  FILLER                                PIC X(1)
  1224       OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.
  1225
  1226 PROCEDURE DIVISION.
  1227 0000-MAIN.
  1228
  1229     INITIALIZE CC-WORK-AREA
  1230                WS-MISC-STORAGE
  1231                WS-COMMAREA
  1232
  1233*****************************************************************
  1234* Store our context
  1235*****************************************************************
  1236     MOVE LIT-THISTRANID       TO WS-TRANID
  1237*****************************************************************
  1238* Ensure error message is cleared                               *
  1239*****************************************************************
  1240     SET WS-ERROR-MSG-OFF  TO TRUE
  1241*****************************************************************
  1242* Retrived passed data if  any. Initialize them if first run.
  1243*****************************************************************
  1244     IF EIBCALEN = 0
  1245        INITIALIZE CARDDEMO-COMMAREA
  1246                   WS-THIS-PROGCOMMAREA
  1247        MOVE LIT-THISTRANID        TO CDEMO-FROM-TRANID
  1248        MOVE LIT-THISPGM           TO CDEMO-FROM-PROGRAM
  1249        SET CDEMO-USRTYP-USER      TO TRUE
  1250        SET CDEMO-PGM-ENTER        TO TRUE
  1251        MOVE LIT-THISMAP           TO CDEMO-LAST-MAP
  1252        MOVE LIT-THISMAPSET        TO CDEMO-LAST-MAPSET
  1253        SET CA-FIRST-PAGE          TO TRUE
  1254        SET CA-LAST-PAGE-NOT-SHOWN TO TRUE
  1255     ELSE
  1256        MOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA) TO
  1257                          CARDDEMO-COMMAREA
  1258        MOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:
  1259                         LENGTH OF WS-THIS-PROGCOMMAREA )TO
  1260                          WS-THIS-PROGCOMMAREA
  1261     END-IF
  1262*****************************************************************
  1263* If coming in from menu. Lets forget the past and start afresh *
  1264*****************************************************************
  1265     IF (CDEMO-PGM-ENTER
  1266     AND CDEMO-FROM-PROGRAM NOT EQUAL LIT-THISPGM)
  1267         INITIALIZE WS-THIS-PROGCOMMAREA
  1268         SET CDEMO-PGM-ENTER      TO TRUE
  1269         MOVE LIT-THISMAP         TO CDEMO-LAST-MAP
  1270         SET CA-FIRST-PAGE        TO TRUE
  1271         SET CA-LAST-PAGE-NOT-SHOWN TO TRUE
  1272     END-IF
  1273
  1274******************************************************************
  1275* Remap PFkeys as needed.
  1276* Store the Mapped PF Key
  1277*****************************************************************
  1278     PERFORM YYYY-STORE-PFKEY
  1279        THRU YYYY-STORE-PFKEY-EXIT
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  28
* COCRDLIC.cbl
  1280
  1281******************************************************************
  1282* If something is present in commarea
  1283* and the from program is this program itself,
  1284* read and edit the inputs given
  1285*****************************************************************
  1286     IF  EIBCALEN > 0
  1287     AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM
  1288         PERFORM 2000-RECEIVE-MAP
  1289         THRU    2000-RECEIVE-MAP-EXIT
  1290
  1291     END-IF
  1292*****************************************************************
  1293* Check the mapped key  to see if its valid at this point       *
  1294* F3    - Exit
  1295* Enter - List of cards for current start key
  1296* F8    - Page down
  1297* F7    - Page up
  1298*****************************************************************
  1299     SET PFK-INVALID TO TRUE
  1300     IF CCARD-AID-ENTER OR
  1301        CCARD-AID-PFK03 OR
  1302        CCARD-AID-PFK07 OR
  1303        CCARD-AID-PFK08
  1304         SET PFK-VALID TO TRUE
  1305     END-IF
  1306
  1307     IF PFK-INVALID
  1308        SET CCARD-AID-ENTER TO TRUE
  1309     END-IF
  1310*****************************************************************
  1311* If the user pressed PF3 go back to main menu
  1312*****************************************************************
  1313     IF  (CCARD-AID-PFK03
  1314     AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM)
  1315        MOVE LIT-THISTRANID   TO CDEMO-FROM-TRANID
  1316        MOVE LIT-THISPGM      TO CDEMO-FROM-PROGRAM
  1317        SET  CDEMO-USRTYP-USER TO TRUE
  1318        SET  CDEMO-PGM-ENTER  TO TRUE
  1319        MOVE LIT-THISMAPSET   TO CDEMO-LAST-MAPSET
  1320        MOVE LIT-THISMAP      TO CDEMO-LAST-MAP
  1321        MOVE LIT-MENUPGM      TO CDEMO-TO-PROGRAM
  1322
  1323        MOVE LIT-MENUMAPSET   TO CCARD-NEXT-MAPSET
  1324        MOVE LIT-THISMAP      TO CCARD-NEXT-MAP
  1325        SET WS-EXIT-MESSAGE            TO TRUE
  1326
  1327*       CALL MENU PROGRAM
  1328*
  1329        SET CDEMO-PGM-ENTER   TO TRUE
  1330*
  1331        EXEC CICS XCTL
  1332                  PROGRAM (LIT-MENUPGM)
  1333                  COMMAREA(CARDDEMO-COMMAREA)
  1334        END-EXEC
  1335     END-IF
  1336*****************************************************************
  1337* If the user did not press PF8, lets reset the last page flag
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  29
* COCRDLIC.cbl
  1338*****************************************************************
  1339     IF CCARD-AID-PFK08
  1340        CONTINUE
  1341     ELSE
  1342        SET CA-LAST-PAGE-NOT-SHOWN   TO TRUE
  1343     END-IF
  1344*****************************************************************
  1345* Now we decide what to do
  1346*****************************************************************
  1347     EVALUATE TRUE
  1348         WHEN INPUT-ERROR
  1349*****************************************************************
  1350*        ASK FOR CORRECTIONS TO INPUTS
  1351*****************************************************************
  1352              MOVE WS-ERROR-MSG    TO CCARD-ERROR-MSG
  1353              MOVE LIT-THISPGM     TO CDEMO-FROM-PROGRAM
  1354              MOVE LIT-THISMAPSET  TO CDEMO-LAST-MAPSET
  1355              MOVE LIT-THISMAP     TO CDEMO-LAST-MAP
  1356
  1357              MOVE LIT-THISPGM     TO CCARD-NEXT-PROG
  1358              MOVE LIT-THISMAPSET  TO CCARD-NEXT-MAPSET
  1359              MOVE LIT-THISMAP     TO CCARD-NEXT-MAP
  1360              IF  NOT FLG-ACCTFILTER-NOT-OK
  1361              AND NOT FLG-CARDFILTER-NOT-OK
  1362                 PERFORM 9000-READ-FORWARD
  1363                    THRU 9000-READ-FORWARD-EXIT
  1364              END-IF
  1365              PERFORM 1000-SEND-MAP
  1366                 THRU 1000-SEND-MAP-EXIT
  1367              GO TO COMMON-RETURN
  1368         WHEN CCARD-AID-PFK07
  1369              AND CA-FIRST-PAGE
  1370*****************************************************************
  1371*        PAGE UP - PF7 - BUT ALREADY ON FIRST PAGE
  1372*****************************************************************
  1373         WHEN CCARD-AID-PFK07
  1374              AND CA-FIRST-PAGE
  1375              MOVE WS-CA-FIRST-CARD-NUM
  1376                            TO WS-CARD-RID-CARDNUM
  1377*             MOVE WS-CA-FIRST-CARD-ACCT-ID
  1378*                           TO WS-CARD-RID-ACCT-ID
  1379              PERFORM 9000-READ-FORWARD
  1380                 THRU 9000-READ-FORWARD-EXIT
  1381              PERFORM 1000-SEND-MAP
  1382                 THRU 1000-SEND-MAP-EXIT
  1383              GO TO COMMON-RETURN
  1384*****************************************************************
  1385*        BACK - PF3 IF WE CAME FROM SOME OTHER PROGRAM
  1386*****************************************************************
  1387         WHEN CCARD-AID-PFK03
  1388         WHEN CDEMO-PGM-REENTER AND
  1389              CDEMO-FROM-PROGRAM NOT EQUAL LIT-THISPGM
  1390
  1391              INITIALIZE CARDDEMO-COMMAREA
  1392                         WS-THIS-PROGCOMMAREA
  1393              MOVE LIT-THISTRANID      TO CDEMO-FROM-TRANID
  1394              MOVE LIT-THISPGM         TO CDEMO-FROM-PROGRAM
  1395              SET CDEMO-USRTYP-USER    TO TRUE
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  30
* COCRDLIC.cbl
  1396              SET CDEMO-PGM-ENTER      TO TRUE
  1397              MOVE LIT-THISMAP         TO CDEMO-LAST-MAP
  1398              MOVE LIT-THISMAPSET      TO CDEMO-LAST-MAPSET
  1399              SET CA-FIRST-PAGE        TO TRUE
  1400              SET CA-LAST-PAGE-NOT-SHOWN TO TRUE
  1401
  1402              MOVE WS-CA-FIRST-CARD-NUM
  1403                            TO WS-CARD-RID-CARDNUM
  1404*             MOVE WS-CA-FIRST-CARD-ACCT-ID
  1405*                           TO WS-CARD-RID-ACCT-ID
  1406
  1407              PERFORM 9000-READ-FORWARD
  1408                 THRU 9000-READ-FORWARD-EXIT
  1409              PERFORM 1000-SEND-MAP
  1410                 THRU 1000-SEND-MAP-EXIT
  1411              GO TO COMMON-RETURN
  1412*****************************************************************
  1413*        PAGE DOWN
  1414*****************************************************************
  1415         WHEN CCARD-AID-PFK08
  1416              AND CA-NEXT-PAGE-EXISTS
  1417              MOVE WS-CA-LAST-CARD-NUM
  1418                            TO WS-CARD-RID-CARDNUM
  1419*             MOVE WS-CA-LAST-CARD-ACCT-ID
  1420*                           TO WS-CARD-RID-ACCT-ID
  1421              ADD   +1       TO WS-CA-SCREEN-NUM
  1422              PERFORM 9000-READ-FORWARD
  1423                 THRU 9000-READ-FORWARD-EXIT
  1424              PERFORM 1000-SEND-MAP
  1425                 THRU 1000-SEND-MAP-EXIT
  1426              GO TO COMMON-RETURN
  1427*****************************************************************
  1428*        PAGE UP
  1429*****************************************************************
  1430         WHEN CCARD-AID-PFK07
  1431              AND NOT CA-FIRST-PAGE
  1432
  1433              MOVE WS-CA-FIRST-CARD-NUM
  1434                            TO WS-CARD-RID-CARDNUM
  1435*             MOVE WS-CA-FIRST-CARD-ACCT-ID
  1436*                           TO WS-CARD-RID-ACCT-ID
  1437              SUBTRACT 1    FROM WS-CA-SCREEN-NUM
  1438              PERFORM 9100-READ-BACKWARDS
  1439                 THRU 9100-READ-BACKWARDS-EXIT
  1440              PERFORM 1000-SEND-MAP
  1441                 THRU 1000-SEND-MAP-EXIT
  1442              GO TO COMMON-RETURN
  1443*****************************************************************
  1444*        TRANSFER TO CARD DETAIL VIEW
  1445*****************************************************************
  1446         WHEN CCARD-AID-ENTER
  1447          AND VIEW-REQUESTED-ON(I-SELECTED)
  1448          AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM
  1449             MOVE LIT-THISTRANID    TO CDEMO-FROM-TRANID
  1450             MOVE LIT-THISPGM       TO CDEMO-FROM-PROGRAM
  1451             SET  CDEMO-USRTYP-USER TO TRUE
  1452             SET  CDEMO-PGM-ENTER   TO TRUE
  1453             MOVE LIT-THISMAPSET    TO CDEMO-LAST-MAPSET
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  31
* COCRDLIC.cbl
  1454             MOVE LIT-THISMAP       TO CDEMO-LAST-MAP
  1455             MOVE LIT-CARDDTLPGM    TO CCARD-NEXT-PROG
  1456
  1457             MOVE LIT-CARDDTLMAPSET TO CCARD-NEXT-MAPSET
  1458             MOVE LIT-CARDDTLMAP    TO CCARD-NEXT-MAP
  1459
  1460             MOVE WS-ROW-ACCTNO (I-SELECTED)
  1461                                    TO CDEMO-ACCT-ID
  1462             MOVE WS-ROW-CARD-NUM (I-SELECTED)
  1463                                    TO CDEMO-CARD-NUM
  1464
  1465*            CALL CARD DETAIL PROGRAM
  1466*
  1467             EXEC CICS XCTL
  1468                  PROGRAM (CCARD-NEXT-PROG)
  1469                  COMMAREA(CARDDEMO-COMMAREA)
  1470             END-EXEC
  1471*****************************************************************
  1472*        TRANSFER TO CARD UPDATED PROGRAM
  1473*****************************************************************
  1474         WHEN CCARD-AID-ENTER
  1475          AND UPDATE-REQUESTED-ON(I-SELECTED)
  1476          AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM
  1477             MOVE LIT-THISTRANID    TO CDEMO-FROM-TRANID
  1478             MOVE LIT-THISPGM       TO CDEMO-FROM-PROGRAM
  1479             SET  CDEMO-USRTYP-USER TO TRUE
  1480             SET  CDEMO-PGM-ENTER   TO TRUE
  1481             MOVE LIT-THISMAPSET    TO CDEMO-LAST-MAPSET
  1482             MOVE LIT-THISMAP       TO CDEMO-LAST-MAP
  1483             MOVE LIT-CARDUPDPGM    TO CCARD-NEXT-PROG
  1484
  1485             MOVE LIT-CARDUPDMAPSET TO CCARD-NEXT-MAPSET
  1486             MOVE LIT-CARDUPDMAP    TO CCARD-NEXT-MAP
  1487
  1488             MOVE WS-ROW-ACCTNO (I-SELECTED)
  1489                                    TO CDEMO-ACCT-ID
  1490             MOVE WS-ROW-CARD-NUM (I-SELECTED)
  1491                                    TO CDEMO-CARD-NUM
  1492
  1493*            CALL CARD UPDATE PROGRAM
  1494*
  1495             EXEC CICS XCTL
  1496                  PROGRAM (CCARD-NEXT-PROG)
  1497                  COMMAREA(CARDDEMO-COMMAREA)
  1498             END-EXEC
  1499
  1500*****************************************************************
  1501         WHEN OTHER
  1502*****************************************************************
  1503              MOVE WS-CA-FIRST-CARD-NUM
  1504                            TO WS-CARD-RID-CARDNUM
  1505*             MOVE WS-CA-FIRST-CARD-ACCT-ID
  1506*                           TO WS-CARD-RID-ACCT-ID
  1507              PERFORM 9000-READ-FORWARD
  1508                 THRU 9000-READ-FORWARD-EXIT
  1509              PERFORM 1000-SEND-MAP
  1510                 THRU 1000-SEND-MAP-EXIT
  1511              GO TO COMMON-RETURN
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  32
* COCRDLIC.cbl
  1512     END-EVALUATE
  1513
  1514* If we had an error setup error message to display and return
  1515     IF INPUT-ERROR
  1516        MOVE WS-ERROR-MSG   TO CCARD-ERROR-MSG
  1517        MOVE LIT-THISPGM     TO CDEMO-FROM-PROGRAM
  1518        MOVE LIT-THISMAPSET  TO CDEMO-LAST-MAPSET
  1519        MOVE LIT-THISMAP     TO CDEMO-LAST-MAP
  1520
  1521        MOVE LIT-THISPGM     TO CCARD-NEXT-PROG
  1522        MOVE LIT-THISMAPSET  TO CCARD-NEXT-MAPSET
  1523        MOVE LIT-THISMAP     TO CCARD-NEXT-MAP
  1524*       PERFORM 1000-SEND-MAP
  1525*          THRU 1000-SEND-MAP
  1526        GO TO COMMON-RETURN
  1527     END-IF
  1528
  1529     MOVE LIT-THISPGM        TO CCARD-NEXT-PROG
  1530     GO TO COMMON-RETURN
  1531     .
  1532
  1533 COMMON-RETURN.
  1534     MOVE  LIT-THISTRANID TO CDEMO-FROM-TRANID
  1535     MOVE  LIT-THISPGM     TO CDEMO-FROM-PROGRAM
  1536     MOVE  LIT-THISMAPSET  TO CDEMO-LAST-MAPSET
  1537     MOVE  LIT-THISMAP     TO CDEMO-LAST-MAP
  1538     MOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA
  1539     MOVE  WS-THIS-PROGCOMMAREA TO
  1540            WS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:
  1541                         LENGTH OF WS-THIS-PROGCOMMAREA )
  1542
  1543
  1544     EXEC CICS RETURN
  1545          TRANSID (LIT-THISTRANID)
  1546          COMMAREA (WS-COMMAREA)
  1547          LENGTH(LENGTH OF WS-COMMAREA)
  1548     END-EXEC
  1549     .
  1550 0000-MAIN-EXIT.
  1551     EXIT
  1552     .
  1553 1000-SEND-MAP.
  1554     PERFORM 1100-SCREEN-INIT
  1555        THRU 1100-SCREEN-INIT-EXIT
  1556     PERFORM 1200-SCREEN-ARRAY-INIT
  1557        THRU 1200-SCREEN-ARRAY-INIT-EXIT
  1558     PERFORM 1250-SETUP-ARRAY-ATTRIBS
  1559        THRU 1250-SETUP-ARRAY-ATTRIBS-EXIT
  1560     PERFORM 1300-SETUP-SCREEN-ATTRS
  1561        THRU 1300-SETUP-SCREEN-ATTRS-EXIT
  1562     PERFORM 1400-SETUP-MESSAGE
  1563        THRU 1400-SETUP-MESSAGE-EXIT
  1564     PERFORM 1500-SEND-SCREEN
  1565        THRU 1500-SEND-SCREEN-EXIT
  1566     .
  1567
  1568 1000-SEND-MAP-EXIT.
  1569     EXIT
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  33
* COCRDLIC.cbl
  1570     .
  1571 1100-SCREEN-INIT.
  1572     MOVE LOW-VALUES             TO CCRDLIAO
  1573
  1574     MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA
  1575
  1576     MOVE CCDA-TITLE01           TO TITLE01O OF CCRDLIAO
  1577     MOVE CCDA-TITLE02           TO TITLE02O OF CCRDLIAO
  1578     MOVE LIT-THISTRANID         TO TRNNAMEO OF CCRDLIAO
  1579     MOVE LIT-THISPGM            TO PGMNAMEO OF CCRDLIAO
  1580
  1581     MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA
  1582
  1583     MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM
  1584     MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD
  1585     MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY
  1586
  1587     MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF CCRDLIAO
  1588
  1589     MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH
  1590     MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM
  1591     MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS
  1592
  1593     MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF CCRDLIAO
  1594*    PAGE NUMBER
  1595*
  1596     MOVE WS-CA-SCREEN-NUM       TO PAGENOO  OF CCRDLIAO
  1597
  1598     SET WS-NO-INFO-MESSAGE      TO TRUE
  1599     MOVE WS-INFO-MSG            TO INFOMSGO OF CCRDLIAO
  1600     MOVE DFHBMDAR               TO INFOMSGC OF CCRDLIAO
  1601     .
  1602
  1603 1100-SCREEN-INIT-EXIT.
  1604     EXIT
  1605     .
  1606
  1607 1200-SCREEN-ARRAY-INIT.
  1608*    USE REDEFINES AND CLEAN UP REPETITIVE CODE !!
  1609     IF   WS-EACH-CARD(1)            EQUAL LOW-VALUES
  1610        CONTINUE
  1611     ELSE
  1612        MOVE WS-EDIT-SELECT(1)       TO CRDSEL1O OF CCRDLIAO
  1613        MOVE WS-ROW-ACCTNO(1)        TO ACCTNO1O OF CCRDLIAO
  1614        MOVE WS-ROW-CARD-NUM(1)      TO CRDNUM1O OF CCRDLIAO
  1615        MOVE WS-ROW-CARD-STATUS(1)   TO CRDSTS1O OF CCRDLIAO
  1616     END-IF
  1617
  1618     IF   WS-EACH-CARD(2)        EQUAL LOW-VALUES
  1619        CONTINUE
  1620     ELSE
  1621        MOVE WS-EDIT-SELECT(2)       TO CRDSEL2O OF CCRDLIAO
  1622        MOVE WS-ROW-ACCTNO(2)        TO ACCTNO2O OF CCRDLIAO
  1623        MOVE WS-ROW-CARD-NUM(2)      TO CRDNUM2O OF CCRDLIAO
  1624        MOVE WS-ROW-CARD-STATUS(2)   TO CRDSTS2O OF CCRDLIAO
  1625     END-IF
  1626
  1627     IF   WS-EACH-CARD(3)        EQUAL LOW-VALUES
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  34
* COCRDLIC.cbl
  1628        CONTINUE
  1629     ELSE
  1630        MOVE WS-EDIT-SELECT(3)       TO CRDSEL3O OF CCRDLIAO
  1631        MOVE WS-ROW-ACCTNO(3)        TO ACCTNO3O OF CCRDLIAO
  1632        MOVE WS-ROW-CARD-NUM(3)      TO CRDNUM3O OF CCRDLIAO
  1633        MOVE WS-ROW-CARD-STATUS(3)   TO CRDSTS3O OF CCRDLIAO
  1634     END-IF
  1635
  1636     IF   WS-EACH-CARD(4)        EQUAL LOW-VALUES
  1637        CONTINUE
  1638     ELSE
  1639        MOVE WS-EDIT-SELECT(4)       TO CRDSEL4O OF CCRDLIAO
  1640        MOVE WS-ROW-ACCTNO(4)        TO ACCTNO4O OF CCRDLIAO
  1641        MOVE WS-ROW-CARD-NUM(4)      TO CRDNUM4O OF CCRDLIAO
  1642        MOVE WS-ROW-CARD-STATUS(4)   TO CRDSTS4O OF CCRDLIAO
  1643     END-IF
  1644
  1645     IF   WS-EACH-CARD(5)        EQUAL LOW-VALUES
  1646        CONTINUE
  1647     ELSE
  1648        MOVE WS-EDIT-SELECT(5)       TO CRDSEL5O OF CCRDLIAO
  1649        MOVE WS-ROW-ACCTNO(5)        TO ACCTNO5O OF CCRDLIAO
  1650        MOVE WS-ROW-CARD-NUM(5)      TO CRDNUM5O OF CCRDLIAO
  1651        MOVE WS-ROW-CARD-STATUS(5)   TO CRDSTS5O OF CCRDLIAO
  1652     END-IF
  1653
  1654
  1655     IF   WS-EACH-CARD(6)        EQUAL LOW-VALUES
  1656        CONTINUE
  1657     ELSE
  1658        MOVE WS-EDIT-SELECT(6)       TO CRDSEL6O OF CCRDLIAO
  1659        MOVE WS-ROW-ACCTNO(6)        TO ACCTNO6O OF CCRDLIAO
  1660        MOVE WS-ROW-CARD-NUM(6)      TO CRDNUM6O OF CCRDLIAO
  1661        MOVE WS-ROW-CARD-STATUS(6)   TO CRDSTS6O OF CCRDLIAO
  1662     END-IF
  1663
  1664     IF   WS-EACH-CARD(7)        EQUAL LOW-VALUES
  1665        CONTINUE
  1666     ELSE
  1667        MOVE WS-EDIT-SELECT(7)       TO CRDSEL7O OF CCRDLIAO
  1668        MOVE WS-ROW-ACCTNO(7)        TO ACCTNO7O OF CCRDLIAO
  1669        MOVE WS-ROW-CARD-NUM(7)      TO CRDNUM7O OF CCRDLIAO
  1670        MOVE WS-ROW-CARD-STATUS(7)   TO CRDSTS7O OF CCRDLIAO
  1671     END-IF
  1672     .
  1673
  1674 1200-SCREEN-ARRAY-INIT-EXIT.
  1675     EXIT
  1676     .
  1677 1250-SETUP-ARRAY-ATTRIBS.
  1678*    USE REDEFINES AND CLEAN UP REPETITIVE CODE !!
  1679
  1680     IF   WS-EACH-CARD(1)            EQUAL LOW-VALUES
  1681     OR   FLG-PROTECT-SELECT-ROWS-YES
  1682        MOVE DFHBMPRF                TO CRDSEL1A OF CCRDLIAI
  1683     ELSE
  1684        IF WS-ROW-CRDSELECT-ERROR(1) = '1'
  1685           MOVE DFHRED               TO CRDSEL1C OF CCRDLIAO
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  35
* COCRDLIC.cbl
  1686           IF WS-EDIT-SELECT(1) = SPACE OR LOW-VALUES
  1687              MOVE '*'               TO CRDSEL1O OF CCRDLIAO
  1688           END-IF
  1689        END-IF
  1690        MOVE DFHBMFSE                TO CRDSEL1A OF CCRDLIAI
  1691     END-IF
  1692
  1693     IF   WS-EACH-CARD(2)            EQUAL LOW-VALUES
  1694     OR   FLG-PROTECT-SELECT-ROWS-YES
  1695        MOVE DFHBMPRO                TO CRDSEL2A OF CCRDLIAI
  1696     ELSE
  1697        IF WS-ROW-CRDSELECT-ERROR(2) = '1'
  1698           MOVE DFHRED               TO CRDSEL2C OF CCRDLIAO
  1699           MOVE -1                   TO CRDSEL2L OF CCRDLIAI
  1700        END-IF
  1701        MOVE DFHBMFSE                TO CRDSEL2A OF CCRDLIAI
  1702     END-IF
  1703
  1704     IF   WS-EACH-CARD(3)            EQUAL LOW-VALUES
  1705     OR   FLG-PROTECT-SELECT-ROWS-YES
  1706        MOVE DFHBMPRO                TO CRDSEL3A OF CCRDLIAI
  1707
  1708     ELSE
  1709        IF WS-ROW-CRDSELECT-ERROR(3) = '1'
  1710           MOVE DFHRED               TO CRDSEL3C OF CCRDLIAO
  1711           MOVE -1                   TO CRDSEL3L OF CCRDLIAI
  1712        END-IF
  1713        MOVE DFHBMFSE                TO CRDSEL3A OF CCRDLIAI
  1714     END-IF
  1715
  1716     IF   WS-EACH-CARD(4)            EQUAL LOW-VALUES
  1717     OR   FLG-PROTECT-SELECT-ROWS-YES
  1718        MOVE DFHBMPRO                TO CRDSEL4A OF CCRDLIAI
  1719        I
  1720     ELSE
  1721        IF WS-ROW-CRDSELECT-ERROR(4) = '1'
  1722           MOVE DFHRED               TO CRDSEL4C OF CCRDLIAO
  1723           MOVE -1                   TO CRDSEL4L OF CCRDLIAI
  1724        END-IF
  1725        MOVE DFHBMFSE                TO CRDSEL4A OF CCRDLIAI
  1726     END-IF
  1727
  1728     IF   WS-EACH-CARD(5)            EQUAL LOW-VALUES
  1729     OR   FLG-PROTECT-SELECT-ROWS-YES
  1730        MOVE DFHBMPRO                TO CRDSEL5A OF CCRDLIAI
  1731     ELSE
  1732        IF WS-ROW-CRDSELECT-ERROR(5) = '1'
  1733           MOVE DFHRED               TO CRDSEL5C OF CCRDLIAO
  1734           MOVE -1                   TO CRDSEL5L OF CCRDLIAI
  1735        END-IF
  1736        MOVE DFHBMFSE                TO CRDSEL5A OF CCRDLIAI
  1737     END-IF
  1738
  1739     IF   WS-EACH-CARD(6)            EQUAL LOW-VALUES
  1740     OR   FLG-PROTECT-SELECT-ROWS-YES
  1741        MOVE DFHBMPRO                TO CRDSEL6A OF CCRDLIAI
  1742
  1743     ELSE
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  36
* COCRDLIC.cbl
  1744        IF WS-ROW-CRDSELECT-ERROR(6) = '1'
  1745           MOVE DFHRED               TO CRDSEL6C OF CCRDLIAO
  1746           MOVE -1                   TO CRDSEL6L OF CCRDLIAI
  1747        END-IF
  1748        MOVE DFHBMFSE                TO CRDSEL6A OF CCRDLIAI
  1749     END-IF
  1750
  1751     IF   WS-EACH-CARD(7)            EQUAL LOW-VALUES
  1752     OR   FLG-PROTECT-SELECT-ROWS-YES
  1753        MOVE DFHBMPRO                TO CRDSEL7A OF CCRDLIAI
  1754     ELSE
  1755        IF WS-ROW-CRDSELECT-ERROR(7) = '1'
  1756           MOVE DFHRED               TO CRDSEL7C OF CCRDLIAO
  1757           MOVE -1                   TO CRDSEL7L OF CCRDLIAI
  1758        END-IF
  1759        MOVE DFHBMFSE                TO CRDSEL7A OF CCRDLIAI
  1760     END-IF
  1761     .
  1762
  1763 1250-SETUP-ARRAY-ATTRIBS-EXIT.
  1764     EXIT
  1765     .
  1766 1300-SETUP-SCREEN-ATTRS.
  1767*    INITIALIZE SEARCH CRITERIA
  1768     IF EIBCALEN = 0
  1769     OR (CDEMO-PGM-ENTER
  1770     AND CDEMO-FROM-PROGRAM = LIT-MENUPGM)
  1771        CONTINUE
  1772     ELSE
  1773        EVALUATE TRUE
  1774            WHEN FLG-ACCTFILTER-ISVALID
  1775            WHEN FLG-ACCTFILTER-NOT-OK
  1776               MOVE CC-ACCT-ID   TO ACCTSIDO OF CCRDLIAO
  1777               MOVE DFHBMFSE     TO ACCTSIDA OF CCRDLIAI
  1778            WHEN CDEMO-ACCT-ID = 0
  1779               MOVE LOW-VALUES   TO ACCTSIDO OF CCRDLIAO
  1780            WHEN OTHER
  1781              MOVE CDEMO-ACCT-ID TO ACCTSIDO OF CCRDLIAO
  1782              MOVE DFHBMFSE      TO ACCTSIDA OF CCRDLIAI
  1783        END-EVALUATE
  1784
  1785        EVALUATE TRUE
  1786            WHEN FLG-CARDFILTER-ISVALID
  1787            WHEN FLG-CARDFILTER-NOT-OK
  1788               MOVE CC-CARD-NUM  TO CARDSIDO OF CCRDLIAO
  1789               MOVE DFHBMFSE     TO CARDSIDA OF CCRDLIAI
  1790            WHEN CDEMO-CARD-NUM = 0
  1791               MOVE LOW-VALUES   TO CARDSIDO OF CCRDLIAO
  1792            WHEN OTHER
  1793              MOVE CDEMO-CARD-NUM
  1794                                 TO CARDSIDO OF CCRDLIAO
  1795              MOVE DFHBMFSE      TO CARDSIDA OF CCRDLIAI
  1796        END-EVALUATE
  1797     END-IF
  1798
  1799*    POSITION CURSOR
  1800
  1801     IF FLG-ACCTFILTER-NOT-OK
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  37
* COCRDLIC.cbl
  1802        MOVE  DFHRED             TO ACCTSIDC OF CCRDLIAO
  1803        MOVE  -1                 TO ACCTSIDL OF CCRDLIAI
  1804     END-IF
  1805
  1806     IF FLG-CARDFILTER-NOT-OK
  1807        MOVE  DFHRED             TO CARDSIDC OF CCRDLIAO
  1808        MOVE  -1                 TO CARDSIDL OF CCRDLIAI
  1809     END-IF
  1810
  1811*    IF NO ERRORS POSITION CURSOR AT ACCTID
  1812
  1813     IF INPUT-OK
  1814       MOVE   -1                 TO ACCTSIDL OF CCRDLIAI
  1815     END-IF
  1816
  1817
  1818     .
  1819 1300-SETUP-SCREEN-ATTRS-EXIT.
  1820     EXIT
  1821     .
  1822
  1823
  1824 1400-SETUP-MESSAGE.
  1825*    SETUP MESSAGE
  1826     EVALUATE TRUE
  1827          WHEN FLG-ACCTFILTER-NOT-OK
  1828          WHEN FLG-CARDFILTER-NOT-OK
  1829            CONTINUE
  1830          WHEN CCARD-AID-PFK07
  1831              AND CA-FIRST-PAGE
  1832            MOVE 'NO PREVIOUS PAGES TO DISPLAY'
  1833            TO WS-ERROR-MSG
  1834          WHEN CCARD-AID-PFK08
  1835           AND CA-NEXT-PAGE-NOT-EXISTS
  1836           AND CA-LAST-PAGE-SHOWN
  1837            MOVE 'NO MORE PAGES TO DISPLAY'
  1838            TO WS-ERROR-MSG
  1839          WHEN CCARD-AID-PFK08
  1840           AND CA-NEXT-PAGE-NOT-EXISTS
  1841            SET WS-INFORM-REC-ACTIONS TO TRUE
  1842            IF  CA-LAST-PAGE-NOT-SHOWN
  1843            AND CA-NEXT-PAGE-NOT-EXISTS
  1844                SET CA-LAST-PAGE-SHOWN TO TRUE
  1845            END-IF
  1846          WHEN WS-NO-INFO-MESSAGE
  1847          WHEN CA-NEXT-PAGE-EXISTS
  1848            SET WS-INFORM-REC-ACTIONS TO TRUE
  1849          WHEN OTHER
  1850             SET WS-NO-INFO-MESSAGE TO TRUE
  1851     END-EVALUATE
  1852
  1853     MOVE WS-ERROR-MSG          TO ERRMSGO OF CCRDLIAO
  1854
  1855     IF  NOT WS-NO-INFO-MESSAGE
  1856     AND NOT WS-NO-RECORDS-FOUND
  1857        MOVE WS-INFO-MSG        TO INFOMSGO OF CCRDLIAO
  1858        MOVE DFHNEUTR           TO INFOMSGC OF CCRDLIAO
  1859     END-IF
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  38
* COCRDLIC.cbl
  1860
  1861     .
  1862 1400-SETUP-MESSAGE-EXIT.
  1863     EXIT
  1864     .
  1865
  1866
  1867 1500-SEND-SCREEN.
  1868     EXEC CICS SEND MAP(LIT-THISMAP)
  1869                    MAPSET(LIT-THISMAPSET)
  1870                    FROM(CCRDLIAO)
  1871                    CURSOR
  1872                    ERASE
  1873                    RESP(WS-RESP-CD)
  1874                    FREEKB
  1875     END-EXEC
  1876     .
  1877 1500-SEND-SCREEN-EXIT.
  1878     EXIT
  1879     .
  1880 2000-RECEIVE-MAP.
  1881     PERFORM 2100-RECEIVE-SCREEN
  1882        THRU 2100-RECEIVE-SCREEN-EXIT
  1883
  1884     PERFORM 2200-EDIT-INPUTS
  1885      THRU   2200-EDIT-INPUTS-EXIT
  1886     .
  1887
  1888 2000-RECEIVE-MAP-EXIT.
  1889     EXIT
  1890     .
  1891 2100-RECEIVE-SCREEN.
  1892     EXEC CICS RECEIVE MAP(LIT-THISMAP)
  1893                    MAPSET(LIT-THISMAPSET)
  1894                    INTO(CCRDLIAI)
  1895                    RESP(WS-RESP-CD)
  1896     END-EXEC
  1897
  1898     MOVE ACCTSIDI OF CCRDLIAI  TO CC-ACCT-ID
  1899     MOVE CARDSIDI OF CCRDLIAI  TO CC-CARD-NUM
  1900
  1901     MOVE CRDSEL1I OF CCRDLIAI  TO WS-EDIT-SELECT(1)
  1902     MOVE CRDSEL2I OF CCRDLIAI  TO WS-EDIT-SELECT(2)
  1903     MOVE CRDSEL3I OF CCRDLIAI  TO WS-EDIT-SELECT(3)
  1904     MOVE CRDSEL4I OF CCRDLIAI  TO WS-EDIT-SELECT(4)
  1905     MOVE CRDSEL5I OF CCRDLIAI  TO WS-EDIT-SELECT(5)
  1906     MOVE CRDSEL6I OF CCRDLIAI  TO WS-EDIT-SELECT(6)
  1907     MOVE CRDSEL7I OF CCRDLIAI  TO WS-EDIT-SELECT(7)
  1908     .
  1909
  1910 2100-RECEIVE-SCREEN-EXIT.
  1911     EXIT
  1912     .
  1913
  1914 2200-EDIT-INPUTS.
  1915     SET INPUT-OK                   TO TRUE
  1916     SET FLG-PROTECT-SELECT-ROWS-NO TO TRUE
  1917
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  39
* COCRDLIC.cbl
  1918     PERFORM 2210-EDIT-ACCOUNT
  1919        THRU 2210-EDIT-ACCOUNT-EXIT
  1920
  1921     PERFORM 2220-EDIT-CARD
  1922        THRU 2220-EDIT-CARD-EXIT
  1923
  1924     PERFORM 2250-EDIT-ARRAY
  1925        THRU 2250-EDIT-ARRAY-EXIT
  1926     .
  1927
  1928 2200-EDIT-INPUTS-EXIT.
  1929     EXIT
  1930     .
  1931
  1932 2210-EDIT-ACCOUNT.
  1933     SET FLG-ACCTFILTER-BLANK TO TRUE
  1934
  1935*    Not supplied
  1936     IF CC-ACCT-ID   EQUAL LOW-VALUES
  1937     OR CC-ACCT-ID   EQUAL SPACES
  1938     OR CC-ACCT-ID-N EQUAL ZEROS
  1939        SET FLG-ACCTFILTER-BLANK  TO TRUE
  1940        MOVE ZEROES       TO CDEMO-ACCT-ID
  1941        GO TO  2210-EDIT-ACCOUNT-EXIT
  1942     END-IF
  1943*
  1944*    Not numeric
  1945*    Not 11 characters
  1946     IF CC-ACCT-ID  IS NOT NUMERIC
  1947        SET INPUT-ERROR TO TRUE
  1948        SET FLG-ACCTFILTER-NOT-OK TO TRUE
  1949        SET FLG-PROTECT-SELECT-ROWS-YES TO TRUE
  1950        MOVE
  1951        'ACCOUNT FILTER,IF SUPPLIED MUST BE A 11 DIGIT NUMBER'
  1952                        TO WS-ERROR-MSG
  1953        MOVE ZERO       TO CDEMO-ACCT-ID
  1954        GO TO 2210-EDIT-ACCOUNT-EXIT
  1955     ELSE
  1956        MOVE CC-ACCT-ID TO CDEMO-ACCT-ID
  1957        SET FLG-ACCTFILTER-ISVALID TO TRUE
  1958     END-IF
  1959     .
  1960
  1961 2210-EDIT-ACCOUNT-EXIT.
  1962     EXIT
  1963     .
  1964
  1965 2220-EDIT-CARD.
  1966*    Not numeric
  1967*    Not 16 characters
  1968     SET FLG-CARDFILTER-BLANK TO TRUE
  1969
  1970*    Not supplied
  1971     IF CC-CARD-NUM   EQUAL LOW-VALUES
  1972     OR CC-CARD-NUM   EQUAL SPACES
  1973     OR CC-CARD-NUM-N EQUAL ZEROS
  1974        SET FLG-CARDFILTER-BLANK  TO TRUE
  1975        MOVE ZEROES       TO CDEMO-CARD-NUM
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  40
* COCRDLIC.cbl
  1976        GO TO  2220-EDIT-CARD-EXIT
  1977     END-IF
  1978*
  1979*    Not numeric
  1980*    Not 16 characters
  1981     IF CC-CARD-NUM  IS NOT NUMERIC
  1982        SET INPUT-ERROR TO TRUE
  1983        SET FLG-CARDFILTER-NOT-OK TO TRUE
  1984        SET FLG-PROTECT-SELECT-ROWS-YES TO TRUE
  1985        IF WS-ERROR-MSG-OFF
  1986           MOVE
  1987        'CARD ID FILTER,IF SUPPLIED MUST BE A 16 DIGIT NUMBER'
  1988                        TO WS-ERROR-MSG
  1989        END-IF
  1990        MOVE ZERO       TO CDEMO-CARD-NUM
  1991        GO TO 2220-EDIT-CARD-EXIT
  1992     ELSE
  1993        MOVE CC-CARD-NUM-N TO CDEMO-CARD-NUM
  1994        SET FLG-CARDFILTER-ISVALID TO TRUE
  1995     END-IF
  1996     .
  1997
  1998 2220-EDIT-CARD-EXIT.
  1999     EXIT
  2000     .
  2001
  2002 2250-EDIT-ARRAY.
  2003
  2004     IF INPUT-ERROR
  2005        GO TO 2250-EDIT-ARRAY-EXIT
  2006     END-IF
  2007
  2008     INSPECT  WS-EDIT-SELECT-FLAGS
  2009     TALLYING I
  2010     FOR ALL 'S'
  2011         ALL 'U'
  2012
  2013     IF I > +1
  2014         SET INPUT-ERROR      TO TRUE
  2015         SET WS-MORE-THAN-1-ACTION TO TRUE
  2016
  2017         MOVE WS-EDIT-SELECT-FLAGS
  2018                             TO WS-EDIT-SELECT-ERROR-FLAGS
  2019         INSPECT WS-EDIT-SELECT-ERROR-FLAGS
  2020           REPLACING ALL 'S' BY '1'
  2021                     ALL 'U' BY '1'
  2022           CHARACTERS        BY '0'
  2023
  2024     END-IF
  2025
  2026     MOVE ZERO TO I-SELECTED
  2027
  2028     PERFORM VARYING I FROM 1 BY 1 UNTIL I > 7
  2029         EVALUATE TRUE
  2030           WHEN SELECT-OK(I)
  2031             MOVE I TO I-SELECTED
  2032             IF WS-MORE-THAN-1-ACTION
  2033                MOVE '1' TO WS-ROW-CRDSELECT-ERROR(I)
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  41
* COCRDLIC.cbl
  2034             END-IF
  2035           WHEN SELECT-BLANK(I)
  2036             CONTINUE
  2037           WHEN OTHER
  2038             SET INPUT-ERROR TO TRUE
  2039             MOVE '1' TO WS-ROW-CRDSELECT-ERROR(I)
  2040             IF WS-ERROR-MSG-OFF
  2041                SET WS-INVALID-ACTION-CODE TO TRUE
  2042             END-IF
  2043        END-EVALUATE
  2044     END-PERFORM
  2045
  2046     .
  2047
  2048 2250-EDIT-ARRAY-EXIT.
  2049     EXIT
  2050     .
  2051
  2052 9000-READ-FORWARD.
  2053     MOVE LOW-VALUES           TO WS-ALL-ROWS
  2054
  2055*****************************************************************
  2056*    Start Browse
  2057*****************************************************************
  2058     EXEC CICS STARTBR
  2059          DATASET(LIT-CARD-FILE)
  2060          RIDFLD(WS-CARD-RID-CARDNUM)
  2061          KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)
  2062          GTEQ
  2063          RESP(WS-RESP-CD)
  2064          RESP2(WS-REAS-CD)
  2065     END-EXEC
  2066*****************************************************************
  2067*    Loop through records and fetch max screen records
  2068*****************************************************************
  2069     MOVE ZEROES TO WS-SCRN-COUNTER
  2070     SET CA-NEXT-PAGE-EXISTS    TO TRUE
  2071     SET MORE-RECORDS-TO-READ   TO TRUE
  2072
  2073     PERFORM UNTIL READ-LOOP-EXIT
  2074
  2075     EXEC CICS READNEXT
  2076          DATASET(LIT-CARD-FILE)
  2077          INTO (CARD-RECORD)
  2078          LENGTH(LENGTH OF CARD-RECORD)
  2079          RIDFLD(WS-CARD-RID-CARDNUM)
  2080          KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)
  2081          RESP(WS-RESP-CD)
  2082          RESP2(WS-REAS-CD)
  2083     END-EXEC
  2084
  2085     EVALUATE WS-RESP-CD
  2086         WHEN DFHRESP(NORMAL)
  2087         WHEN DFHRESP(DUPREC)
  2088             PERFORM 9500-FILTER-RECORDS
  2089                THRU 9500-FILTER-RECORDS-EXIT
  2090
  2091             IF WS-DONOT-EXCLUDE-THIS-RECORD
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  42
* COCRDLIC.cbl
  2092                ADD 1             TO WS-SCRN-COUNTER
  2093
  2094                MOVE CARD-NUM     TO WS-ROW-CARD-NUM(
  2095                WS-SCRN-COUNTER)
  2096                MOVE CARD-ACCT-ID TO
  2097                WS-ROW-ACCTNO(WS-SCRN-COUNTER)
  2098                MOVE CARD-ACTIVE-STATUS
  2099                                  TO WS-ROW-CARD-STATUS(
  2100                                  WS-SCRN-COUNTER)
  2101
  2102                IF WS-SCRN-COUNTER = 1
  2103                   MOVE CARD-ACCT-ID
  2104                                  TO WS-CA-FIRST-CARD-ACCT-ID
  2105                   MOVE CARD-NUM  TO WS-CA-FIRST-CARD-NUM
  2106                   IF   WS-CA-SCREEN-NUM = 0
  2107                     ADD   +1     TO WS-CA-SCREEN-NUM
  2108                   ELSE
  2109                     CONTINUE
  2110                   END-IF
  2111                ELSE
  2112                   CONTINUE
  2113                END-IF
  2114             ELSE
  2115                 CONTINUE
  2116             END-IF
  2117******************************************************************
  2118*            Max Screen size
  2119******************************************************************
  2120             IF WS-SCRN-COUNTER = WS-MAX-SCREEN-LINES
  2121                SET READ-LOOP-EXIT  TO TRUE
  2122
  2123                MOVE CARD-ACCT-ID     TO WS-CA-LAST-CARD-ACCT-ID
  2124                MOVE CARD-NUM         TO WS-CA-LAST-CARD-NUM
  2125
  2126                EXEC CICS READNEXT
  2127                  DATASET(LIT-CARD-FILE)
  2128                  INTO (CARD-RECORD)
  2129                  LENGTH(LENGTH OF CARD-RECORD)
  2130                  RIDFLD(WS-CARD-RID-CARDNUM)
  2131                  KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)
  2132                  RESP(WS-RESP-CD)
  2133                  RESP2(WS-REAS-CD)
  2134                END-EXEC
  2135
  2136                EVALUATE WS-RESP-CD
  2137                   WHEN DFHRESP(NORMAL)
  2138                   WHEN DFHRESP(DUPREC)
  2139                        SET CA-NEXT-PAGE-EXISTS
  2140                                          TO TRUE
  2141                        MOVE CARD-ACCT-ID TO
  2142                             WS-CA-LAST-CARD-ACCT-ID
  2143                        MOVE CARD-NUM     TO WS-CA-LAST-CARD-NUM
  2144                  WHEN DFHRESP(ENDFILE)
  2145                      SET CA-NEXT-PAGE-NOT-EXISTS     TO TRUE
  2146
  2147                      IF WS-ERROR-MSG-OFF
  2148                          MOVE 'NO MORE RECORDS TO SHOW'
  2149                                          TO WS-ERROR-MSG
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  43
* COCRDLIC.cbl
  2150                      END-IF
  2151                      WHEN OTHER
  2152*                     This is some kind of error. Change to END BR
  2153*                     And exit
  2154                      SET READ-LOOP-EXIT      TO TRUE
  2155                      MOVE 'READ'              TO ERROR-OPNAME
  2156                      MOVE LIT-CARD-FILE       TO ERROR-FILE
  2157                      MOVE WS-RESP-CD          TO ERROR-RESP
  2158                      MOVE WS-REAS-CD          TO ERROR-RESP2
  2159                    MOVE WS-FILE-ERROR-MESSAGE TO WS-ERROR-MSG
  2160                END-EVALUATE
  2161            END-IF
  2162         WHEN DFHRESP(ENDFILE)
  2163            SET READ-LOOP-EXIT              TO TRUE
  2164            SET CA-NEXT-PAGE-NOT-EXISTS     TO TRUE
  2165            MOVE CARD-ACCT-ID     TO WS-CA-LAST-CARD-ACCT-ID
  2166            MOVE CARD-NUM         TO WS-CA-LAST-CARD-NUM
  2167            IF WS-ERROR-MSG-OFF
  2168               MOVE 'NO MORE RECORDS TO SHOW'  TO WS-ERROR-MSG
  2169            END-IF
  2170            IF WS-CA-SCREEN-NUM = 1
  2171            AND WS-SCRN-COUNTER = 0
  2172*               MOVE 'NO RECORDS TO SHOW'  TO WS-ERROR-MSG
  2173                SET WS-NO-RECORDS-FOUND    TO TRUE
  2174            END-IF
  2175         WHEN OTHER
  2176*           This is some kind of error. Change to END BR
  2177*           And exit
  2178            SET READ-LOOP-EXIT             TO TRUE
  2179            MOVE 'READ'                     TO ERROR-OPNAME
  2180            MOVE LIT-CARD-FILE              TO ERROR-FILE
  2181            MOVE WS-RESP-CD                 TO ERROR-RESP
  2182            MOVE WS-REAS-CD                 TO ERROR-RESP2
  2183            MOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG
  2184     END-EVALUATE
  2185     END-PERFORM
  2186
  2187     EXEC CICS ENDBR FILE(LIT-CARD-FILE)
  2188     END-EXEC
  2189     .
  2190 9000-READ-FORWARD-EXIT.
  2191     EXIT
  2192     .
  2193 9100-READ-BACKWARDS.
  2194
  2195     MOVE LOW-VALUES           TO WS-ALL-ROWS
  2196
  2197     MOVE WS-CA-FIRST-CARDKEY  TO WS-CA-LAST-CARDKEY
  2198
  2199*****************************************************************
  2200*    Start Browse
  2201*****************************************************************
  2202     EXEC CICS STARTBR
  2203          DATASET(LIT-CARD-FILE)
  2204          RIDFLD(WS-CARD-RID-CARDNUM)
  2205          KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)
  2206          GTEQ
  2207          RESP(WS-RESP-CD)
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  44
* COCRDLIC.cbl
  2208          RESP2(WS-REAS-CD)
  2209     END-EXEC
  2210*****************************************************************
  2211*    Loop through records and fetch max screen records
  2212*****************************************************************
  2213     COMPUTE WS-SCRN-COUNTER =
  2214                             WS-MAX-SCREEN-LINES + 1
  2215     END-COMPUTE
  2216     SET CA-NEXT-PAGE-EXISTS    TO TRUE
  2217     SET MORE-RECORDS-TO-READ   TO TRUE
  2218
  2219*****************************************************************
  2220*    Now we show the records from previous set.
  2221*****************************************************************
  2222
  2223     EXEC CICS READPREV
  2224          DATASET(LIT-CARD-FILE)
  2225          INTO (CARD-RECORD)
  2226          LENGTH(LENGTH OF CARD-RECORD)
  2227          RIDFLD(WS-CARD-RID-CARDNUM)
  2228          KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)
  2229          RESP(WS-RESP-CD)
  2230          RESP2(WS-REAS-CD)
  2231     END-EXEC
  2232
  2233     EVALUATE WS-RESP-CD
  2234         WHEN DFHRESP(NORMAL)
  2235         WHEN DFHRESP(DUPREC)
  2236             SUBTRACT 1          FROM WS-SCRN-COUNTER
  2237         WHEN OTHER
  2238*           This is some kind of error. Change to END BR
  2239*           And exit
  2240            SET READ-LOOP-EXIT             TO TRUE
  2241            MOVE 'READ'                     TO ERROR-OPNAME
  2242            MOVE LIT-CARD-FILE              TO ERROR-FILE
  2243            MOVE WS-RESP-CD                 TO ERROR-RESP
  2244            MOVE WS-REAS-CD                 TO ERROR-RESP2
  2245            MOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG
  2246            GO TO 9100-READ-BACKWARDS-EXIT
  2247     END-EVALUATE
  2248
  2249     PERFORM UNTIL READ-LOOP-EXIT
  2250
  2251     EXEC CICS READPREV
  2252          DATASET(LIT-CARD-FILE)
  2253          INTO (CARD-RECORD)
  2254          LENGTH(LENGTH OF CARD-RECORD)
  2255          RIDFLD(WS-CARD-RID-CARDNUM)
  2256          KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)
  2257          RESP(WS-RESP-CD)
  2258          RESP2(WS-REAS-CD)
  2259     END-EXEC
  2260
  2261     EVALUATE WS-RESP-CD
  2262         WHEN DFHRESP(NORMAL)
  2263         WHEN DFHRESP(DUPREC)
  2264             PERFORM 9500-FILTER-RECORDS
  2265                THRU 9500-FILTER-RECORDS-EXIT
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  45
* COCRDLIC.cbl
  2266             IF WS-DONOT-EXCLUDE-THIS-RECORD
  2267                MOVE CARD-NUM
  2268                            TO WS-ROW-CARD-NUM(WS-SCRN-COUNTER)
  2269                MOVE CARD-ACCT-ID
  2270                            TO WS-ROW-ACCTNO(WS-SCRN-COUNTER)
  2271                MOVE CARD-ACTIVE-STATUS
  2272                            TO
  2273                            WS-ROW-CARD-STATUS(WS-SCRN-COUNTER)
  2274
  2275                SUBTRACT 1  FROM WS-SCRN-COUNTER
  2276                IF WS-SCRN-COUNTER = 0
  2277                   SET READ-LOOP-EXIT  TO TRUE
  2278
  2279                   MOVE CARD-ACCT-ID
  2280                            TO WS-CA-FIRST-CARD-ACCT-ID
  2281                   MOVE CARD-NUM
  2282                            TO WS-CA-FIRST-CARD-NUM
  2283                ELSE
  2284                   CONTINUE
  2285                END-IF
  2286             ELSE
  2287                 CONTINUE
  2288             END-IF
  2289
  2290         WHEN OTHER
  2291*           This is some kind of error. Change to END BR
  2292*           And exit
  2293            SET READ-LOOP-EXIT             TO TRUE
  2294            MOVE 'READ'                     TO ERROR-OPNAME
  2295            MOVE LIT-CARD-FILE              TO ERROR-FILE
  2296            MOVE WS-RESP-CD                 TO ERROR-RESP
  2297            MOVE WS-REAS-CD                 TO ERROR-RESP2
  2298            MOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG
  2299     END-EVALUATE
  2300     END-PERFORM
  2301     .
  2302
  2303 9100-READ-BACKWARDS-EXIT.
  2304     EXEC CICS
  2305          ENDBR FILE(LIT-CARD-FILE)
  2306     END-EXEC
  2307
  2308     EXIT
  2309     .
  2310
  2311 9500-FILTER-RECORDS.
  2312     SET WS-DONOT-EXCLUDE-THIS-RECORD TO TRUE
  2313
  2314     IF FLG-ACCTFILTER-ISVALID
  2315        IF  CARD-ACCT-ID = CC-ACCT-ID
  2316            CONTINUE
  2317        ELSE
  2318            SET WS-EXCLUDE-THIS-RECORD  TO TRUE
  2319            GO TO 9500-FILTER-RECORDS-EXIT
  2320        END-IF
  2321     ELSE
  2322       CONTINUE
  2323     END-IF
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  46
* COCRDLIC.cbl
  2324
  2325     IF FLG-CARDFILTER-ISVALID
  2326        IF  CARD-NUM = CC-CARD-NUM-N
  2327            CONTINUE
  2328        ELSE
  2329            SET WS-EXCLUDE-THIS-RECORD TO TRUE
  2330            GO TO 9500-FILTER-RECORDS-EXIT
  2331        END-IF
  2332     ELSE
  2333       CONTINUE
  2334     END-IF
  2335
  2336     .
  2337
  2338 9500-FILTER-RECORDS-EXIT.
  2339     EXIT
  2340     .
  2341
  2342*****************************************************************
  2343*Common code to store PFKey
  2344*****************************************************************
  2345*COPY 'CSSTRPFY'
  2346*    .
**    COBCH0008S Unknown copybook CSSTRPFY specified  : COCRDLIC.cbl(1402,11,11)
  2347
  2348*****************************************************************
  2349* Plain text exit - Dont use in production                      *
  2350*****************************************************************
  2351 SEND-PLAIN-TEXT.
**    COBCH0301S Unrecognized verb  : COCRDLIC.cbl(1407,22,8)
**    COBCH0010S Word starts or is continued in wrong area of source line  : COCRDLIC.cbl(1407,22,8)
  2352     EXEC CICS SEND TEXT
  2353               FROM(WS-ERROR-MSG)
  2354               LENGTH(LENGTH OF WS-ERROR-MSG)
  2355               ERASE
  2356               FREEKB
  2357     END-EXEC
  2358
  2359     EXEC CICS RETURN
  2360     END-EXEC
  2361     .
  2362 SEND-PLAIN-TEXT-EXIT.
  2363     EXIT
  2364     .
  2365*****************************************************************
  2366* Display Long text and exit                                    *
  2367* This is primarily for debugging and should not be used in     *
  2368* regular course                                                *
  2369*****************************************************************
  2370 SEND-LONG-TEXT.
  2371     EXEC CICS SEND TEXT
  2372               FROM(WS-LONG-MSG)
  2373               LENGTH(LENGTH OF WS-LONG-MSG)
  2374               ERASE
  2375               FREEKB
  2376     END-EXEC
  2377
  2378     EXEC CICS RETURN
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  47
* COCRDLIC.cbl
  2379     END-EXEC
  2380     .
  2381 SEND-LONG-TEXT-EXIT.
  2382     EXIT
  2383     .
  2384
  2385
  2386*
  2387* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT
  2388*
*      YYYY-STORE-PFKEY-EXIT
**    COBCH0498S Procedure name YYYY-STORE-PFKEY-EXIT undeclared, line 1279  : COCRDLIC.cbl(335,40,20)
*      YYYY-STORE-PFKEY
**    COBCH0498S Procedure name YYYY-STORE-PFKEY undeclared, line 1278  : COCRDLIC.cbl(334,35,20)
*
*
* Errors
* -Line- Col Code/severity Description
*   2346  12    8-S        Unknown copybook CSSTRPFY specified
*   2351  23  301-S        Unrecognized verb
*   2351  23   10-S        Word starts or is continued in wrong area of source
*                          line
*                          *      YYYY-STORE-PFKEY-EXIT
*   1279  41  498-S        Procedure name YYYY-STORE-PFKEY-EXIT undeclared,
*                          line 1279
*                          *      YYYY-STORE-PFKEY
*   1278  36  498-S        Procedure name YYYY-STORE-PFKEY undeclared, line 1278
* Micro Focus COBOL                  V9.0 revision 000 Compiler
* (C) Copyright 1984-2024 Micro Focus or one of its affiliates.
*                                                        REF GKR-081900000A0
* Last message on page:   47
* Total Messages:     5
* Unrecoverable :     0                    Severe  :     5
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:        7849     Code:           0
