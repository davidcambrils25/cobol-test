* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   1
* COACTUPC.cbl
* Options: int("COACTUPC.int") verbose
*          USE(/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/DIRECTIVES/DI
*          RFOLDER/COACTUPC.cbl.dir)
*          USE(/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/DIRECTIVES/DE
*          FAULTDIR/DUMMY.DIR)
*          USE(/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/DIRECTIVES/DE
*          FAULTDIR/DUMMY.DIR)
*          USE(/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/DIRECTIVES/DE
*          FAULTDIR/DUMMY.DIR)
* Setting: NOACCEPTREFRESH
*          NOACU
*          NOACUCOMMENT
*          NOACUSYNC
*          NOACU-UNDERSCORE
*            ADV
*            ALIGN"8 OPT"
*            ALPHALITCONT"MARGIN"
*            ALPHASTART"1"
*            ALTER
*          NOAMODE
*            ANIM
*            ANS85
*            APOST
*            AREACHECK
*            ARITH"EXTEND"
*            ARITHMETIC"ENTCOBOL"
*            ASSIGN"EXTERNAL"
*          NOASSIGN-PRINTER
*          NOAUTOLOCK
*          NOBELL
*            BINLIT"BOOLEAN"
*          NOBOUND
*          NOBRIEF
*          NOBS2000
*            BWZSTAR
*            BYTEMODEMOVE
*            CALLFH"EXTFH"
*          NOCALLRECOVERY
*            CALLSORT"EXTSM"
*            CANCEL
*            CANCELLBR
*          NOCHANGEMESSAGE
*            CHARSET"EBCDIC"
*            CHECKDIV"ENTCOBOL"
*          NOCHECKREFMOD
*          NOCICS
*            CICS-CPY
*          NOCICSOPTIMIZE
*          NOCMPR2
*            COBFSTATCONV
*          NOCOBIDY
*          NOCOBOL370
*          NOCOBOLDIR
*          NOCOMMANDLINELINKAGE
*            COLLECTION"CardDemo"
*          NOCOMP
*            COMP"BINARY"
*            COMP1"FLOAT"
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   2
* COACTUPC.cbl
*            COMP2"FLOAT"
*            COMP-5"2"
*            COMP-6"2"
*            CONFIRM
*          NOCONVERTRET
*            CONVSPACE
*            COPYEXT"cpy,cbl"
*            COPYLBR
*            COPYLIST
*            COPYLISTCOMMENT"7"
*            COPYSEARCH"MF"
*            CSI
*            CURRENCY-SIGN"36"
*            CURRENT-DATE"MMDDYY"
*          NODATA
*            DATACOMPRESS"0"
*          NODATA-CONTEXT
*          NODATAMAP
*            DATE
*            DBCHECK
*            DBCS"3"
*            DBCSSOSI"14""15"
*            DBSPACE
*            DE-EDIT"2"
*            DEFAULTBYTE"0"
*          NODEFAULTCALLS
*            DETECTLOCK
*          NODG
*            DIALECT"ENTCOBOL"
*          NODIRECTIVES-IN-COMMENTS
*            DISPLAY"CONSOLE"
*          NODISPLAYAT
*            DISPLAYPICU"ANSI"
*            DISPSIGN"COMPAT"
*          NODOSVS
*          NODOTNET
*            DPCINDATA"XML"
*            DPCINSUBSCRIPT
*          NODYNAM
*          NOEARLY-RELEASE
*            EBCCOLSEQ"1"
*            ECHO
*          NOECHOALL
*            ENTCOBOL
*          NOEOF1A
*            ERRFORMAT"2"
*            ERRLIST"VERBOSE"
*          NOERRQ
*          NOEXECSQLFLAG
*            EXITPROGRAM"ANSI"
*          NOFASTINIT
*            FASTSORT
*            FCD3
*          NOFCDALIGN
*          NOFCDREG
*            FDCLEAR"3"
*          NOFILESHARE
*            FILETYPE"0"
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   3
* COACTUPC.cbl
*            FLAG"ENTCOBOL"
*            FLAGAS"S"
*          NOFLAGEUC
*          NOFLAGMIG
*          NOFLAGQ
*            FLAGSINEDIT
*          NOFLAGSTD
*            FOLDCALLNAME"UPPER"
*            FOLDCOPYNAME"UPPER"
*            FORM"60"
*            FP-ROUNDING"ENTCOBOL"
*          NOHOSTARITHMETIC
*            HOSTCONTZERO
*            HOST-NUMCOMPARE
*            HOST-NUMMOVE
*            HOSTFD
*          NOHOSTRW
*          NOIBM-MS
*            IBMCOMP
*            IDENTIFIERLEN"30"
*            IDXFORMAT"0"
*          NOIGNOREEXEC
*          NOIL
*          NOILGEN
*          NOILEMIT
*            IMPLICITSCOPE
*            INCFORMAT"PC"
*            INDD"SYSIN 80 R"
*          NOIDYSRCPATH
*            INFORETURN"0"
*          NOINITCALL
*            INITIAL"1"
*          NOINITPTR
*          NOINITBYTYPE
*            INT"COACTUPC.int"
*            INTDATE"ANSI"
*            INTLEVEL"9"
*            IOCONV
*          NOISO2002
*          NOIXNLSKEY
*          NOIXNUMKEY
*          NOJAVACALLABLE
*          NOJAVAGENPROGS
*          NOJAVAGENSTRG
*            JAVAOUTPUTPATH""
*            JAVAPACKAGENAME"com.microfocus.COBOL"
*          NOJVMGEN
*            KEYCHECK
*            KEYCOMPRESS"0"
*          NOLIBRARIAN
*          NOLINE-COUNT
*            LIST"COACTUPC.lst"
*            LISTPATH...
*          ..."/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/LISTINGS/CO"
*            LISTWIDTH"80"
*            LITVAL-SIZE"4"
*          NOLOCALSOURCEFORMAT
*            LOCKTYPE"0"
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   4
* COACTUPC.cbl
*            MAPNAME
*          NOMAINFRAMEFLOATINGPOINT
*          NOMAXERROR
*            METHODDEFAULT"REFERENCE"
*          NOMF
*          NOMFCOMMENT
*          NOMFSYNC
*          NOMOVELENCHECK
*          NOMS
*          NOMVS
*            NATIONAL"1"
*            NATIVE"EBCDIC"
*          NONATIVEFLOATINGPOINT
*          NONCHAR
*          NONLS
*          NONLSCURRENCYLENGTH
*            NSYMBOL"NATIONAL"
*            NULLESCAPE
*          NOODOOSVS
*            ODOSLIDE
*          NOOLDBLANKLINE
*          NOOLDCOPY
*          NOOLDINDEX
*          NOOLDNEXTSENTENCE
*          NOOLDREADINTO
*          NOOLDSTRMIX
*            OOCTRL"-C-E-G+L-P+Q+R-S+W"
*          NOOPTIONAL-FILE
*          NOOS390
*            OSEXT""
*          NOOSVS
*            OUTDD"SYSOUT 121 R"
*            P64
*          NOPANVALET
*            PANVALET-INCLUDES-IN-COMMENTS
*            PERFORM-TYPE"ENTCOBOL"
*          NOPREPLIST
*          NOPREPROCESS
*            PRESERVECASE
*          NOPRINT-EXT
*          NOPROFILE
*          NOPROGID-COMMENT
*          NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE
*            PROTOTYPE"RELAXED"
*            QUAL
*            QUALPROC
*          NOQUERY
*          NOQUOTE
*          NORAWLIST
*            RDW
*            RECMODE"ENTCOBOL"
*          NOREENTRANT
*          NOREF
*          NOREFNO
*            REMAINDER"2"
*            REPLACE"NOKEEPSEQ"
*            REPORT-LINE"256"
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   5
* COACTUPC.cbl
*            RESEQ
*          NORETRYLOCK
*            REWRITE-LS
*          NORM
*          NORM-FILE-ERRORS
*            RTNCODE-SIZE"2"
*            RTNCODE-TYPE"COMP"
*          NORWHARDPAGE
*          NOSAA
*          NOSEG
*          NOSEQCHK
*            SEQUENTIAL"RECORD"
*          NOSERIAL
*            SETTING"COL"
*          NOSHAREOUTDD
*          NOSHOW-DIR
*            SIGN"EBCDIC"
*            SIGN"TRAILING"
*          NOSIGNDISCARD
*          NOSIGNFIXUP
*            SORTTYPE"DFSORT"
*          NOSOURCEENCODING
*            SOURCEFORMAT"FIXED"
*            SOURCETABSTOP"4"
*          NOSPZERO
*          NOSSRANGE
*            STDERR
*            STICKY-LINKAGE"1"
*          NOSTICKY-PERFORM
*            SUPFF
*            SWITCHTYPE"1"
*            SYMBSTART"1"
*            SYSPUNCH"80"
*            TERMPAGE
*          NOTESTCOVER
*            TIME
*          NOTRACE
*          NOTRUNC
*            TRUNCCALLNAME"8"
*            TRUNCCOPY"8"
*            TRUNCINC"10"
*            UNICODE"PORTABLE"
*            VERBOSE
*          NOVISUALSTUDIO
*          NOVSC2
*          NOWARNASERROR
*            WARNING"1"
*            WEBSERVER"CGI"
*          NOWRITELOCK
*          NOWRITETHRU
*          NOXMLGEN
*            XMLPARSE"XMLSS"
*          NOXOPEN
*          NOXREF
*            ZEROLENGTHFALSE
*          NOZEROSEQ
*            ZWB
     1**************************************** *************************
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   6
* COACTUPC.cbl
     2* Program:     COACTUPC.CBL                                     *
     3* Layer:       Business logic                                   *
     4* Function:    Accept and process ACCOUNT UPDATE                *
     5*****************************************************************
     6
     7 IDENTIFICATION DIVISION.
     8 PROGRAM-ID.
     9     COACTUPC.
    10 DATE-WRITTEN.
    11     July 2022.
    12 DATE-COMPILED. 12-Jul-24 07:58.
    15 ENVIRONMENT DIVISION.
    16 INPUT-OUTPUT SECTION.
    17
    18 DATA DIVISION.
    19
    20 WORKING-STORAGE SECTION.
    21 01  WS-MISC-STORAGE.
    22******************************************************************
    23* General CICS related
    24******************************************************************
    25   05 WS-CICS-PROCESSNG-VARS.
    26      07 WS-RESP-CD                          PIC S9(09) COMP
    27                                             VALUE ZEROS.
    28      07 WS-REAS-CD                          PIC S9(09) COMP
    29                                             VALUE ZEROS.
    30      07 WS-TRANID                           PIC X(4)
    31                                             VALUE SPACES.
    32      07 WS-UCTRANS                          PIC X(4)
    33                                             VALUE SPACES.
    34******************************************************************
    35*      Input edits
    36******************************************************************
    37*  Generic Input Edits
    38   05  WS-GENERIC-EDITS.
    39     10 WS-EDIT-VARIABLE-NAME                PIC X(25).
    40
    41     10 WS-EDIT-SIGNED-NUMBER-9V2-X          PIC X(15).
    42     10 WS-FLG-SIGNED-NUMBER-EDIT            PIC X(1).
    43        88  FLG-SIGNED-NUMBER-ISVALID        VALUE LOW-VALUES.
    44        88  FLG-SIGNED-NUMBER-NOT-OK         VALUE '0'.
    45        88  FLG-SIGNED-NUMBER-BLANK          VALUE 'B'.
    46
    47     10 WS-EDIT-ALPHANUM-ONLY                PIC X(256).
    48     10 WS-EDIT-ALPHANUM-LENGTH              PIC S9(4) COMP-3.
    49
    50     10 WS-EDIT-ALPHA-ONLY-FLAGS             PIC X(1).
    51        88  FLG-ALPHA-ISVALID                VALUE LOW-VALUES.
    52        88  FLG-ALPHA-NOT-OK                 VALUE '0'.
    53        88  FLG-ALPHA-BLANK                  VALUE 'B'.
    54     10 WS-EDIT-ALPHANUM-ONLY-FLAGS          PIC X(1).
    55        88  FLG-ALPHNANUM-ISVALID            VALUE LOW-VALUES.
    56        88  FLG-ALPHNANUM-NOT-OK             VALUE '0'.
    57        88  FLG-ALPHNANUM-BLANK              VALUE 'B'.
    58     10 WS-EDIT-MANDATORY-FLAGS              PIC X(1).
    59        88  FLG-MANDATORY-ISVALID            VALUE LOW-VALUES.
    60        88  FLG-MANDATORY-NOT-OK             VALUE '0'.
    61        88  FLG-MANDATORY-BLANK              VALUE 'B'.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   7
* COACTUPC.cbl
    62     10 WS-EDIT-YES-NO                       PIC X(1)
    63                                             VALUE 'N'.
    64        88 FLG-YES-NO-ISVALID                VALUES 'Y', 'N'.
    65        88 FLG-YES-NO-NOT-OK                 VALUE '0'.
    66        88 FLG-YES-NO-BLANK                  VALUE 'B'.
    67
    68     10 WS-EDIT-US-PHONE-NUM                 PIC X(15).
    69     10 WS-EDIT-US-PHONE-NUM-X REDEFINES
    70        WS-EDIT-US-PHONE-NUM.
    71        20 FILLER                            PIC X(1).
    72*                                            VALUE '('
    73        20 WS-EDIT-US-PHONE-NUMA             PIC X(3).
    74        20 WS-EDIT-US-PHONE-NUMA-N REDEFINES
    75           WS-EDIT-US-PHONE-NUMA             PIC 9(3).
    76        20 FILLER                            PIC X(1).
    77*                                            VALUE ')'
    78        20 WS-EDIT-US-PHONE-NUMB             PIC X(3).
    79        20 WS-EDIT-US-PHONE-NUMB-N REDEFINES
    80           WS-EDIT-US-PHONE-NUMB             PIC 9(3).
    81        20 FILLER                            PIC X(1).
    82*                                            VALUE '-'
    83        20 WS-EDIT-US-PHONE-NUMC             PIC X(4).
    84        20 WS-EDIT-US-PHONE-NUMC-N REDEFINES
    85           WS-EDIT-US-PHONE-NUMC             PIC 9(4).
    86        20 FILLER                            PIC X(2).
    87     10 WS-EDIT-US-PHONE-NUM-FLGS.
    88         88 WS-EDIT-US-PHONE-IS-INVALID      VALUE '000'.
    89         88 WS-EDIT-US-PHONE-IS-VALID        VALUE LOW-VALUES.
    90         20 WS-EDIT-US-PHONEA-FLG            PIC X(01).
    91            88 FLG-EDIT-US-PHONEA-ISVALID    VALUE LOW-VALUES.
    92            88 FLG-EDIT-US-PHONEA-NOT-OK     VALUE '0'.
    93            88 FLG-EDIT-US-PHONEA-BLANK      VALUE 'B'.
    94         20 WS-EDIT-EDIT-US-PHONEB           PIC X(01).
    95            88 FLG-EDIT-US-PHONEB-ISVALID    VALUE LOW-VALUES.
    96            88 FLG-EDIT-US-PHONEB-NOT-OK     VALUE '0'.
    97            88 FLG-EDIT-US-PHONEB-BLANK      VALUE 'B'.
    98         20 WS-EDIT-EDIT-PHONEC              PIC X(01).
    99            88 FLG-EDIT-US-PHONEC-ISVALID    VALUE LOW-VALUES.
   100            88 FLG-EDIT-US-PHONEC-NOT-OK     VALUE '0'.
   101            88 FLG-EDIT-US-PHONEC-BLANK      VALUE 'B'.
   102
   103     10 WS-EDIT-US-SSN.
   104         20 WS-EDIT-US-SSN-PART1              PIC X(3).
   105         20 WS-EDIT-US-SSN-PART1-N REDEFINES
   106            WS-EDIT-US-SSN-PART1              PIC 9(3).
   107            88 INVALID-SSN-PART1  VALUES      0,
   108                                              666,
   109                                              900 THRU 999.
   110         20 WS-EDIT-US-SSN-PART2              PIC X(2).
   111         20 WS-EDIT-US-SSN-PART2-N REDEFINES
   112            WS-EDIT-US-SSN-PART2              PIC 9(2).
   113         20 WS-EDIT-US-SSN-PART3              PIC X(4).
   114         20 WS-EDIT-US-SSN-PART3-N REDEFINES
   115            WS-EDIT-US-SSN-PART3              PIC 9(4).
   116     10 WS-EDIT-US-SSN-N REDEFINES
   117        WS-EDIT-US-SSN                        PIC 9(09).
   118     10 WS-EDIT-US-SSN-FLGS.
   119         88 WS-EDIT-US-SSN-IS-INVALID         VALUE '000'.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   8
* COACTUPC.cbl
   120         88 WS-EDIT-US-SSN-IS-VALID           VALUE LOW-VALUES.
   121         20 WS-EDIT-US-SSN-PART1-FLGS         PIC X(01).
   122            88 FLG-EDIT-US-SSN-PART1-ISVALID  VALUE LOW-VALUES.
   123            88 FLG-EDIT-US-SSN-PART1-NOT-OK   VALUE '0'.
   124            88 FLG-EDIT-US-SSN-PART1-BLANK    VALUE 'B'.
   125         20 WS-EDIT-US-SSN-PART2-FLGS         PIC X(01).
   126            88 FLG-EDIT-US-SSN-PART2-ISVALID  VALUE LOW-VALUES.
   127            88 FLG-EDIT-US-SSN-PART2-NOT-OK   VALUE '0'.
   128            88 FLG-EDIT-US-SSN-PART2-BLANK    VALUE 'B'.
   129         20 WS-EDIT-US-SSN-PART3-FLGS         PIC X(01).
   130            88 FLG-EDIT-US-SSN-PART3-ISVALID  VALUE LOW-VALUES.
   131            88 FLG-EDIT-US-SSN-PART3-NOT-OK   VALUE '0'.
   132            88 FLG-EDIT-US-SSN-PART3-BLANK    VALUE 'B'.
   133
   134******************************************************************
   135*    Work variables
   136******************************************************************
   137   05 WS-CALCULATION-VARS.
   138    10 WS-DIV-BY                             PIC S9(4) COMP-3
   139                                             VALUE 4.
   140    10 WS-DIVIDEND                           PIC S9(4) COMP-3
   141                                             VALUE 0.
   142
   143    10 WS-REMAINDER                          PIC S9(4) COMP-3
   144                                             VALUE 0.
   145    10 WS-CURR-DATE                          PIC X(21)
   146                                             VALUE SPACES.
   147
   148
   149******************************************************************
   150*    Generic date edit variables CCYYMMDD
   151******************************************************************
   152*    COPY 'CSUTLDWY'.
   153******************************************************************
   154*Working Storage Copybook for DATE related code
   155******************************************************************
   156     10 WS-EDIT-DATE-CCYYMMDD.
   157        20 WS-EDIT-DATE-CCYY.
   158           25 WS-EDIT-DATE-CC                PIC X(2).
   159           25 WS-EDIT-DATE-CC-N REDEFINES    WS-EDIT-DATE-CC
   160                                             PIC 9(2).
   161              88 THIS-CENTURY                VALUE 20.
   162              88 LAST-CENTURY                VALUE 19.
   163           25 WS-EDIT-DATE-YY                PIC X(2).
   164           25 WS-EDIT-DATE-YY-N REDEFINES    WS-EDIT-DATE-YY
   165                                             PIC 9(2).
   166        20 WS-EDIT-DATE-CCYY-N  REDEFINES
   167           WS-EDIT-DATE-CCYY                 PIC 9(4).
   168        20 WS-EDIT-DATE-MM                   PIC X(2).
   169        20 WS-EDIT-DATE-MM-N REDEFINES WS-EDIT-DATE-MM
   170                                             PIC 9(2).
   171           88 WS-VALID-MONTH                 VALUES
   172                                             1 THROUGH 12.
   173           88 WS-31-DAY-MONTH                VALUES
   174                                             1, 3, 5, 7,
   175                                             8, 10, 12.
   176           88 WS-FEBRUARY                    VALUE 2.
   177        20 WS-EDIT-DATE-DD                   PIC X(2).
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   9
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSUTLDWY.c)
   178        20 WS-EDIT-DATE-DD-N REDEFINES WS-EDIT-DATE-DD
   179                                             PIC 9(2).
   180           88 WS-VALID-DAY                   VALUES
   181                                             1 THROUGH 31.
   182           88 WS-DAY-31                      VALUE 31.
   183           88 WS-DAY-30                      VALUE 30.
   184           88 WS-DAY-29                      VALUE 29.
   185           88 WS-VALID-FEB-DAY               VALUES
   186                                             1 THROUGH 28.
   187     10 WS-EDIT-DATE-CCYYMMDD-N REDEFINES
   188        WS-EDIT-DATE-CCYYMMDD                PIC 9(8).
   189     10 WS-EDIT-DATE-BINARY                  PIC S9(9) BINARY.
   190     10 WS-CURRENT-DATE.
   191        20 WS-CURRENT-DATE-YYYYMMDD          PIC X(8).
   192        20 WS-CURRENT-DATE-YYYYMMDD-N REDEFINES
   193           WS-CURRENT-DATE-YYYYMMDD          PIC 9(8).
   194        20 WS-CURRENT-DATE-BINARY            PIC S9(9) BINARY.
   195     10 WS-EDIT-DATE-FLGS.
   196         88 WS-EDIT-DATE-IS-VALID            VALUE LOW-VALUES.
   197         88 WS-EDIT-DATE-IS-INVALID          VALUE '000'.
   198         20 WS-EDIT-YEAR-FLG                 PIC X(01).
   199            88 FLG-YEAR-ISVALID              VALUE LOW-VALUES.
   200            88 FLG-YEAR-NOT-OK               VALUE '0'.
   201            88 FLG-YEAR-BLANK                VALUE 'B'.
   202         20 WS-EDIT-MONTH                    PIC X(01).
   203            88 FLG-MONTH-ISVALID             VALUE LOW-VALUES.
   204            88 FLG-MONTH-NOT-OK              VALUE '0'.
   205            88 FLG-MONTH-BLANK               VALUE 'B'.
   206         20 WS-EDIT-DAY                      PIC X(01).
   207            88 FLG-DAY-ISVALID               VALUE LOW-VALUES.
   208            88 FLG-DAY-NOT-OK                VALUE '0'.
   209            88 FLG-DAY-BLANK                 VALUE 'B'.
   210    10 WS-DATE-FORMAT                        PIC X(08)
   211                                             VALUE 'YYYYMMDD'.
   212    10 WS-DATE-VALIDATION-RESULT .
   213         20 WS-SEVERITY                      PIC X(04).
   214         20 WS-SEVERITY-N                    REDEFINES
   215            WS-SEVERITY                      PIC 9(4).
   216         20 FILLER                           PIC X(11)
   217                                             VALUE 'Mesg Code:'.
   218         20 WS-MSG-NO                        PIC X(04).
   219         20 WS-MSG-NO-N                      REDEFINES
   220            WS-MSG-NO                        Pic 9(4).
   221         20 FILLER                           PIC X(01)
   222                                             VALUE SPACE.
   223         20 WS-RESULT                        PIC X(15).
   224         20 FILLER                           PIC X(01)
   225                                             VALUE SPACE.
   226         20 FILLER                           PIC X(09)
   227                                             VALUE 'TstDate:'.
   228         20 WS-DATE                          PIC X(10).
   229         20 FILLER                           PIC X(01)
   230                                             VALUE SPACE.
   231         20 FILLER                           PIC X(10)
   232                                             VALUE 'Mask used:' .
   233         20 WS-DATE-FMT                      PIC X(10).
   234         20 FILLER                           PIC X(01)
   235                                             VALUE SPACE.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  10
* COACTUPC.cbl
   236         20 FILLER                           PIC X(03)
   237                                             VALUE SPACES.
   238
   239*
   240* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:59 CDT
   241*
   242******************************************************************
   243   05  WS-DATACHANGED-FLAG                   PIC X(1).
   244     88  NO-CHANGES-FOUND                    VALUE '0'.
   245     88  CHANGE-HAS-OCCURRED                 VALUE '1'.
   246   05  WS-INPUT-FLAG                         PIC X(1).
   247     88  INPUT-OK                            VALUE '0'.
   248     88  INPUT-ERROR                         VALUE '1'.
   249     88  INPUT-PENDING                       VALUE LOW-VALUES.
   250   05  WS-RETURN-FLAG                        PIC X(1).
   251     88  WS-RETURN-FLAG-OFF                  VALUE LOW-VALUES.
   252     88  WS-RETURN-FLAG-ON                   VALUE '1'.
   253   05  WS-PFK-FLAG                           PIC X(1).
   254     88  PFK-VALID                           VALUE '0'.
   255     88  PFK-INVALID                         VALUE '1'.
   256
   257*  Program specific edits
   258   05  WS-EDIT-ACCT-FLAG                     PIC X(1).
   259     88  FLG-ACCTFILTER-ISVALID              VALUE '1'.
   260     88  FLG-ACCTFILTER-NOT-OK               VALUE '0'.
   261     88  FLG-ACCTFILTER-BLANK                VALUE ' '.
   262   05  WS-EDIT-CUST-FLAG                     PIC X(1).
   263     88  FLG-CUSTFILTER-ISVALID              VALUE '1'.
   264     88  FLG-CUSTFILTER-NOT-OK               VALUE '0'.
   265     88  FLG-CUSTFILTER-BLANK                VALUE ' '.
   266   05 WS-NON-KEY-FLAGS.
   267     10  WS-EDIT-ACCT-STATUS                 PIC  X(1).
   268         88  FLG-ACCT-STATUS-ISVALID         VALUES 'Y', 'N'.
   269         88  FLG-ACCT-STATUS-NOT-OK          VALUE '0'.
   270         88  FLG-ACCT-STATUS-BLANK           VALUE 'B'.
   271     10  WS-EDIT-CREDIT-LIMIT                PIC  X(1).
   272         88  FLG-CRED-LIMIT-ISVALID          VALUE LOW-VALUES.
   273         88  FLG-CRED-LIMIT-NOT-OK           VALUE '0'.
   274         88  FLG-CRED-LIMIT-BLANK            VALUE 'B'.
   275     10  WS-EDIT-CASH-CREDIT-LIMIT           PIC  X(1).
   276         88  FLG-CASH-CREDIT-LIMIT-ISVALID   VALUE LOW-VALUES.
   277         88  FLG-CASH-CREDIT-LIMIT-NOT-OK    VALUE '0'.
   278         88  FLG-CASH-CREDIT-LIMIT-BLANK     VALUE 'B'.
   279     10  WS-EDIT-CURR-BAL                    PIC  X(1).
   280         88  FLG-CURR-BAL-ISVALID            VALUE LOW-VALUES.
   281         88  FLG-CURR-BAL-NOT-OK             VALUE '0'.
   282         88  FLG-CURR-BAL-BLANK              VALUE 'B'.
   283     10  WS-EDIT-CURR-CYC-CREDIT             PIC  X(1).
   284         88  FLG-CURR-CYC-CREDIT-ISVALID     VALUE LOW-VALUES.
   285         88  FLG-CURR-CYC-CREDIT-NOT-OK      VALUE '0'.
   286         88  FLG-CURR-CYC-CREDIT-BLANK       VALUE 'B'.
   287     10  WS-EDIT-CURR-CYC-DEBIT              PIC  X(1).
   288         88  FLG-CURR-CYC-DEBIT-ISVALID      VALUE LOW-VALUES.
   289         88  FLG-CURR-CYC-DEBIT-NOT-OK       VALUE '0'.
   290         88  FLG-CURR-CYC-DEBIT-BLANK        VALUE 'B'.
   291     10 WS-EDIT-DT-OF-BIRTH-FLGS.
   292         88 WS-EDIT-DT-OF-BIRTH-INVALID      VALUE '000'.
   293         88 WS-EDIT-DT-OF-BIRTH-ISVALID      VALUE LOW-VALUES.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  11
* COACTUPC.cbl
   294         20 WS-EDIT-DT-OF-BIRTH-YEAR-FLG     PIC X(01).
   295            88 FLG-DT-OF-BIRTH-YEAR-ISVALID  VALUE LOW-VALUES.
   296            88 FLG-DT-OF-BIRTH-YEAR-NOT-OK   VALUE '0'.
   297            88 FLG-DT-OF-BIRTH-YEAR-BLANK    VALUE 'B'.
   298         20 WS-EDIT-DT-OF-BIRTH-MONTH        PIC X(01).
   299            88 FLG-DT-OF-BIRTH-MONTH-ISVALID VALUE LOW-VALUES.
   300            88 FLG-DT-OF-BIRTH-MONTH-NOT-OK  VALUE '0'.
   301            88 FLG-DT-OF-BIRTH-MONTH-BLANK   VALUE 'B'.
   302         20 WS-EDIT-DT-OF-BIRTH-DAY          PIC X(01).
   303            88 FLG-DT-OF-BIRTH-DAY-ISVALID   VALUE LOW-VALUES.
   304            88 FLG-DT-OF-BIRTH-DAY-NOT-OK    VALUE '0'.
   305            88 FLG-DT-OF-BIRTH-DAY-BLANK     VALUE 'B'.
   306     10  WS-EDIT-FICO-SCORE-FLGS             PIC  X(1).
   307         88  FLG-FICO-SCORE-ISVALID          VALUE LOW-VALUES.
   308         88  FLG-FICO-SCORE-NOT-OK           VALUE '0'.
   309         88  FLG-FICO-SCORE-BLANK            VALUE 'B'.
   310     10 WS-EDIT-OPEN-DATE-FLGS.
   311         88 WS-EDIT-OPEN-DATE-IS-INVALID     VALUE '000'.
   312         20 WS-EDIT-OPEN-YEAR-FLG            PIC X(01).
   313            88 FLG-OPEN-YEAR-ISVALID         VALUE LOW-VALUES.
   314            88 FLG-OPEN-YEAR-NOT-OK          VALUE '0'.
   315            88 FLG-OPEN-YEAR-BLANK           VALUE 'B'.
   316         20 WS-EDIT-OPEN-MONTH               PIC X(01).
   317            88 FLG-OPEN-MONTH-ISVALID        VALUE LOW-VALUES.
   318            88 FLG-OPEN-MONTH-NOT-OK         VALUE '0'.
   319            88 FLG-OPEN-MONTH-BLANK          VALUE 'B'.
   320         20 WS-EDIT-OPEN-DAY                 PIC X(01).
   321            88 FLG-OPEN-DAY-ISVALID          VALUE LOW-VALUES.
   322            88 FLG-OPEN-DAY-NOT-OK           VALUE '0'.
   323            88 FLG-OPEN-DAY-BLANK            VALUE 'B'.
   324     10 WS-EXPIRY-DATE-FLGS.
   325         88 WS-EDIT-EXPIRY-IS-INVALID        VALUE '000'.
   326         20 WS-EDIT-EXPIRY-YEAR-FLG          PIC X(01).
   327            88 FLG-EXPIRY-YEAR-ISVALID       VALUE LOW-VALUES.
   328            88 FLG-EXPIRY-YEAR-NOT-OK        VALUE '0'.
   329            88 FLG-EXPIRY-YEAR-BLANK         VALUE 'B'.
   330         20 WS-EDIT-EXPIRY-MONTH             PIC X(01).
   331            88 FLG-EXPIRY-MONTH-ISVALID      VALUE LOW-VALUES.
   332            88 FLG-EXPIRY-MONTH-NOT-OK       VALUE '0'.
   333            88 FLG-EXPIRY-MONTH-BLANK        VALUE 'B'.
   334         20 WS-EDIT-EXPIRY-DAY               PIC X(01).
   335            88 FLG-EXPIRY-DAY-ISVALID        VALUE LOW-VALUES.
   336            88 FLG-EXPIRY-DAY-NOT-OK         VALUE '0'.
   337            88 FLG-EXPIRY-DAY-BLANK          VALUE 'B'.
   338     10 WS-EDIT-REISSUE-DATE-FLGS.
   339         88 WS-EDIT-REISSUE-DATE-INVALID     VALUE '000'.
   340         20 WS-EDIT-REISSUE-YEAR-FLG         PIC X(01).
   341            88 FLG-REISSUE-YEAR-ISVALID      VALUE LOW-VALUES.
   342            88 FLG-REISSUE-YEAR-NOT-OK       VALUE '0'.
   343            88 FLG-REISSUE-YEAR-BLANK        VALUE 'B'.
   344         20 WS-EDIT-REISSUE-MONTH            PIC X(01).
   345            88 FLG-REISSUE-MONTH-ISVALID     VALUE LOW-VALUES.
   346            88 FLG-REISSUE-MONTH-NOT-OK      VALUE '0'.
   347            88 FLG-REISSUE-MONTH-BLANK       VALUE 'B'.
   348         20 WS-EDIT-REISSUE-DAY              PIC X(01).
   349            88 FLG-REISSUE-DAY-ISVALID       VALUE LOW-VALUES.
   350            88 FLG-REISSUE-DAY-NOT-OK        VALUE '0'.
   351            88 FLG-REISSUE-DAY-BLANK         VALUE 'B'.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  12
* COACTUPC.cbl
   352     10 WS-EDIT-NAME-FLAGS.
   353         20 WS-EDIT-FIRST-NAME-FLGS          PIC X(01).
   354            88 FLG-FIRST-NAME-ISVALID        VALUE LOW-VALUES.
   355            88 FLG-FIRST-NAME-NOT-OK         VALUE '0'.
   356            88 FLG-FIRST-NAME-BLANK          VALUE 'B'.
   357         20 WS-EDIT-MIDDLE-NAME-FLGS         PIC X(01).
   358            88 FLG-MIDDLE-NAME-ISVALID       VALUE LOW-VALUES.
   359            88 FLG-MIDDLE-NAME-NOT-OK        VALUE '0'.
   360            88 FLG-MIDDLE-NAME-BLANK         VALUE 'B'.
   361         20 WS-EDIT-LAST-NAME-FLGS           PIC X(01).
   362            88 FLG-LAST-NAME-ISVALID         VALUE LOW-VALUES.
   363            88 FLG-LAST-NAME-NOT-OK          VALUE '0'.
   364            88 FLG-LAST-NAME-BLANK           VALUE 'B'.
   365     10 WS-EDIT-ADDRESS-FLAGS.
   366         20 WS-EDIT-ADDRESS-LINE-1-FLGS      PIC X(01).
   367            88 FLG-ADDRESS-LINE-1-ISVALID    VALUE LOW-VALUES.
   368            88 FLG-ADDRESS-LINE-1-NOT-OK     VALUE '0'.
   369            88 FLG-ADDRESS-LINE-1-BLANK      VALUE 'B'.
   370         20 WS-EDIT-ADDRESS-LINE-2-FLGS      PIC X(01).
   371            88 FLG-ADDRESS-LINE-2-ISVALID    VALUE LOW-VALUES.
   372            88 FLG-ADDRESS-LINE-2-NOT-OK     VALUE '0'.
   373            88 FLG-ADDRESS-LINE-2-BLANK      VALUE 'B'.
   374         20 WS-EDIT-CITY-FLGS                PIC X(01).
   375            88 FLG-CITY-ISVALID              VALUE LOW-VALUES.
   376            88 FLG-CITY-NOT-OK               VALUE '0'.
   377            88 FLG-CITY-BLANK                VALUE 'B'.
   378         20 WS-EDIT-STATE-FLGS               PIC X(01).
   379            88 FLG-STATE-ISVALID             VALUE LOW-VALUES.
   380            88 FLG-STATE-NOT-OK              VALUE '0'.
   381            88 FLG-STATE-BLANK               VALUE 'B'.
   382         20 WS-EDIT-ZIPCODE-FLGS             PIC X(01).
   383            88 FLG-ZIPCODE-ISVALID           VALUE LOW-VALUES.
   384            88 FLG-ZIPCODE-NOT-OK            VALUE '0'.
   385            88 FLG-ZIPCODE-BLANK             VALUE 'B'.
   386         20 WS-EDIT-COUNTRY-FLGS             PIC X(01).
   387            88 FLG-COUNTRY-ISVALID           VALUE LOW-VALUES.
   388            88 FLG-COUNTRY-NOT-OK            VALUE '0'.
   389            88 FLG-COUNTRY-BLANK             VALUE 'B'.
   390         20 WS-EDIT-PHONE-NUM-1-FLGS.
   391            88 WS-EDIT-PHONE-NUM-1-IS-INVALID
   392                                             VALUE '000'.
   393            30 WS-EDIT-PHONE-NUM-1A-FLG      PIC X(01).
   394               88 FLG-PHONE-NUM-1A-ISVALID   VALUE LOW-VALUES.
   395               88 FLG-PHONE-NUM-1A-NOT-OK    VALUE '0'.
   396               88 FLG-PHONE-NUM-1A-BLANK     VALUE 'B'.
   397            30 WS-EDIT-PHONE-NUM-1B          PIC X(01).
   398               88 FLG-PHONE-NUM-1B-ISVALID   VALUE LOW-VALUES.
   399               88 FLG-PHONE-NUM-1B-NOT-OK    VALUE '0'.
   400               88 FLG-PHONE-NUM-1B-BLANK     VALUE 'B'.
   401            30 WS-EDIT-PHONE-NUM-1C          PIC X(01).
   402               88 FLG-PHONE-NUM-1C-ISVALID   VALUE LOW-VALUES.
   403               88 FLG-PHONE-NUM-1C-NOT-OK    VALUE '0'.
   404               88 FLG-PHONE-NUM-1C-BLANK     VALUE 'B'.
   405         20 WS-EDIT-PHONE-NUM-2-FLGS.
   406            88 WS-EDIT-PHONE-NUM-2-IS-INVALID
   407                                             VALUE '000'.
   408            30 WS-EDIT-PHONE-NUM-2A-FLG      PIC X(01).
   409               88 FLG-PHONE-NUM-2A-ISVALID   VALUE LOW-VALUES.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  13
* COACTUPC.cbl
   410               88 FLG-PHONE-NUM-2A-NOT-OK    VALUE '0'.
   411               88 FLG-PHONE-NUM-2A-BLANK     VALUE 'B'.
   412            30 WS-EDIT-PHONE-NUM-2B          PIC X(01).
   413               88 FLG-PHONE-NUM-2B-ISVALID   VALUE LOW-VALUES.
   414               88 FLG-PHONE-NUM-2B-NOT-OK    VALUE '0'.
   415               88 FLG-PHONE-NUM-2B-BLANK     VALUE 'B'.
   416            30 WS-EDIT-PHONE-NUM-2C          PIC X(01).
   417               88 FLG-PHONE-NUM-2C-ISVALID   VALUE LOW-VALUES.
   418               88 FLG-PHONE-NUM-2C-NOT-OK    VALUE '0'.
   419               88 FLG-PHONE-NUM-2C-BLANK     VALUE 'B'.
   420     10  WS-EFT-ACCOUNT-ID-FLGS              PIC X(01).
   421         88 FLG-EFT-ACCOUNT-ID-ISVALID       VALUE LOW-VALUES.
   422         88 FLG-EFT-ACCOUNT-ID-NOT-OK        VALUE '0'.
   423         88 FLG-EFT-ACCOUNT-ID-BLANK         VALUE 'B'.
   424     10  WS-EDIT-PRI-CARDHOLDER              PIC  X(1).
   425         88  FLG-PRI-CARDHOLDER-ISVALID      VALUES 'Y', 'N'.
   426         88  FLG-PRI-CARDHOLDER-NOT-OK       VALUE '0'.
   427         88  FLG-PRI-CARDHOLDER-BLANK        VALUE 'B'.
   428
   429******************************************************************
   430* Output edits
   431******************************************************************
   432   05 CICS-OUTPUT-EDIT-VARS.
   433     10  CUST-ACCT-ID-X                      PIC X(11).
   434     10  CUST-ACCT-ID-N REDEFINES CUST-ACCT-ID-X
   435                                             PIC 9(11).
   436     10  WS-EDIT-DATE-X                      PIC X(10).
   437     10  FILLER REDEFINES WS-EDIT-DATE-X.
   438         20 WS-EDIT-DATE-X-YEAR              PIC X(4).
   439         20 FILLER                           PIC X(1).
   440         20 WS-EDIT-DATE-MONTH               PIC X(2).
   441         20 FILLER                           PIC X(1).
   442         20 WS-EDIT-DATE-DAY                 PIC X(2).
   443     10  WS-EDIT-DATE-X REDEFINES
   444         WS-EDIT-DATE-X                      PIC 9(10).
   445     10  WS-EDIT-CURRENCY-9-2                PIC X(15).
   446     10  WS-EDIT-CURRENCY-9-2-F              PIC +ZZZ,ZZZ,ZZZ.99.
   447
   448******************************************************************
   449*      File and data Handling
   450******************************************************************
   451   05 WS-XREF-RID.
   452     10  WS-CARD-RID-CARDNUM                 PIC X(16).
   453     10  WS-CARD-RID-CUST-ID                 PIC 9(09).
   454     10  WS-CARD-RID-CUST-ID-X REDEFINES
   455            WS-CARD-RID-CUST-ID              PIC X(09).
   456     10  WS-CARD-RID-ACCT-ID                 PIC 9(11).
   457     10  WS-CARD-RID-ACCT-ID-X REDEFINES
   458            WS-CARD-RID-ACCT-ID              PIC X(11).
   459   05  WS-FILE-READ-FLAGS.
   460     10 WS-ACCOUNT-MASTER-READ-FLAG          PIC X(1).
   461        88 FOUND-ACCT-IN-MASTER              VALUE '1'.
   462     10 WS-CUST-MASTER-READ-FLAG             PIC X(1).
   463        88 FOUND-CUST-IN-MASTER              VALUE '1'.
   464   05  WS-FILE-ERROR-MESSAGE.
   465     10  FILLER                         PIC X(12)
   466                                             VALUE 'File Error: '.
   467     10  ERROR-OPNAME                        PIC X(8)
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  14
* COACTUPC.cbl
   468                                             VALUE SPACES.
   469     10  FILLER                              PIC X(4)
   470                                             VALUE ' on '.
   471     10  ERROR-FILE                          PIC X(9)
   472                                             VALUE SPACES.
   473     10  FILLER                              PIC X(15)
   474                                             VALUE
   475                                             ' returned RESP '.
   476     10  ERROR-RESP                          PIC X(10)
   477                                             VALUE SPACES.
   478     10  FILLER                              PIC X(7)
   479                                             VALUE ',RESP2 '.
   480     10  ERROR-RESP2                         PIC X(10)
   481                                             VALUE SPACES.
   482    10  FILLER                               PIC X(5)
   483                                             VALUE SPACES.
   484*  Alpha variables for editing numerics
   485*
   486    05 ALPHA-VARS-FOR-DATA-EDITING.
   487       15 ACUP-NEW-CREDIT-LIMIT-X            PIC X(15).
   488       15 ACUP-NEW-CASH-CREDIT-LIMIT-X       PIC X(15).
   489       15 ACUP-NEW-CURR-BAL-X                PIC X(15).
   490       15 ACUP-NEW-CURR-CYC-CREDIT-X         PIC X(15).
   491       15 ACUP-NEW-CURR-CYC-DEBIT-X          PIC X(15).
   492
   493    05 ACCT-UPDATE-RECORD.
   494*****************************************************************
   495*    Data-structure for  account entity (RECLN 300)
   496*****************************************************************
   497         15  ACCT-UPDATE-ID                      PIC 9(11).
   498         15  ACCT-UPDATE-ACTIVE-STATUS           PIC X(01).
   499         15  ACCT-UPDATE-CURR-BAL                PIC S9(10)V99.
   500         15  ACCT-UPDATE-CREDIT-LIMIT            PIC S9(10)V99.
   501         15  ACCT-UPDATE-CASH-CREDIT-LIMIT       PIC S9(10)V99.
   502         15  ACCT-UPDATE-OPEN-DATE               PIC X(10).
   503         15  ACCT-UPDATE-EXPIRAION-DATE          PIC X(10).
   504         15  ACCT-UPDATE-REISSUE-DATE            PIC X(10).
   505         15  ACCT-UPDATE-CURR-CYC-CREDIT         PIC S9(10)V99.
   506         15  ACCT-UPDATE-CURR-CYC-DEBIT          PIC S9(10)V99.
   507         15  ACCT-UPDATE-GROUP-ID                PIC X(10).
   508         15  FILLER                              PIC X(188).
   509    05 CUST-UPDATE-RECORD.
   510*****************************************************************
   511*    Data-structure for  CUSTOMER entity (RECLN 300)
   512*****************************************************************
   513         15  CUST-UPDATE-ID                      PIC 9(09).
   514         15  CUST-UPDATE-FIRST-NAME              PIC X(25).
   515         15  CUST-UPDATE-MIDDLE-NAME             PIC X(25).
   516         15  CUST-UPDATE-LAST-NAME               PIC X(25).
   517         15  CUST-UPDATE-ADDR-LINE-1             PIC X(50).
   518         15  CUST-UPDATE-ADDR-LINE-2             PIC X(50).
   519         15  CUST-UPDATE-ADDR-LINE-3             PIC X(50).
   520         15  CUST-UPDATE-ADDR-STATE-CD           PIC X(02).
   521         15  CUST-UPDATE-ADDR-COUNTRY-CD         PIC X(03).
   522         15  CUST-UPDATE-ADDR-ZIP                PIC X(10).
   523         15  CUST-UPDATE-PHONE-NUM-1             PIC X(15).
   524         15  CUST-UPDATE-PHONE-NUM-2             PIC X(15).
   525         15  CUST-UPDATE-SSN                     PIC 9(09).
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  15
* COACTUPC.cbl
   526         15  CUST-UPDATE-GOVT-ISSUED-ID          PIC X(20).
   527         15  CUST-UPDATE-DOB-YYYY-MM-DD          PIC X(10).
   528         15  CUST-UPDATE-EFT-ACCOUNT-ID          PIC X(10).
   529         15  CUST-UPDATE-PRI-CARD-IND            PIC X(01).
   530         15  CUST-UPDATE-FICO-CREDIT-SCORE       PIC 9(03).
   531         15  FILLER                              PIC X(168).
   532
   533
   534******************************************************************
   535*      Output Message Construction
   536******************************************************************
   537   05  WS-LONG-MSG                           PIC X(500).
   538   05  WS-INFO-MSG                           PIC X(40).
   539     88  WS-NO-INFO-MESSAGE                 VALUES
   540                                            SPACES LOW-VALUES.
   541     88  FOUND-ACCOUNT-DATA             VALUE
   542         'Details of selected account shown above'.
   543     88  PROMPT-FOR-SEARCH-KEYS              VALUE
   544         'Enter or update id of account to update'.
   545     88  PROMPT-FOR-CHANGES                  VALUE
   546         'Update account details presented above.'.
   547     88  PROMPT-FOR-CONFIRMATION             VALUE
   548         'Changes validated.Press F5 to save'.
   549     88  CONFIRM-UPDATE-SUCCESS              VALUE
   550         'Changes committed to database'.
   551     88  INFORM-FAILURE                      VALUE
   552         'Changes unsuccessful. Please try again'.
   553
   554   05  WS-RETURN-MSG                         PIC X(75).
   555     88  WS-RETURN-MSG-OFF                   VALUE SPACES.
   556     88  WS-EXIT-MESSAGE                     VALUE
   557         'PF03 pressed.Exiting              '.
   558     88  WS-PROMPT-FOR-ACCT                  VALUE
   559         'Account number not provided'.
   560     88  WS-PROMPT-FOR-LASTNAME              VALUE
   561         'Last name not provided'.
   562     88  WS-NAME-MUST-BE-ALPHA               VALUE
   563         'Name can only contain alphabets and spaces'.
   564     88  NO-SEARCH-CRITERIA-RECEIVED         VALUE
   565         'No input received'.
   566     88  NO-CHANGES-DETECTED                 VALUE
   567         'No change detected with respect to values fetched.'.
   568     88  SEARCHED-ACCT-ZEROES                VALUE
   569         'Account number must be a non zero 11 digit number'.
   570     88  SEARCHED-ACCT-NOT-NUMERIC           VALUE
   571         'Account number must be a non zero 11 digit number'.
   572     88  DID-NOT-FIND-ACCT-IN-CARDXREF       VALUE
   573         'Did not find this account in account card xref file'.
   574     88  DID-NOT-FIND-ACCT-IN-ACCTDAT        VALUE
   575         'Did not find this account in account master file'.
   576     88  DID-NOT-FIND-CUST-IN-CUSTDAT        VALUE
   577         'Did not find associated customer in master file'.
   578     88  ACCT-STATUS-MUST-BE-YES-NO          VALUE
   579         'Account Active Status must be Y or N'.
   580     88  CRED-LIMIT-IS-BLANK                 VALUE
   581         'Credit Limit must be supplied'.
   582     88  CRED-LIMIT-IS-NOT-VALID             VALUE
   583         'Credit Limit is not valid'.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  16
* COACTUPC.cbl
   584     88  THIS-MONTH-NOT-VALID                VALUE
   585         'Card expiry month must be between 1 and 12'.
   586     88  THIS-YEAR-NOT-VALID                 VALUE
   587         'Invalid card expiry year'.
   588     88  DID-NOT-FIND-ACCT-IN-CARDXREF       VALUE
   589         'Did not find this account in cards database'.
   590     88  DID-NOT-FIND-ACCTCARD-COMBO         VALUE
   591         'Did not find cards for this search condition'.
   592     88  COULD-NOT-LOCK-ACCT-FOR-UPDATE      VALUE
   593         'Could not lock account record for update'.
   594     88  COULD-NOT-LOCK-CUST-FOR-UPDATE      VALUE
   595         'Could not lock customer record for update'.
   596     88  DATA-WAS-CHANGED-BEFORE-UPDATE      VALUE
   597         'Record changed by some one else. Please review'.
   598     88  LOCKED-BUT-UPDATE-FAILED            VALUE
   599         'Update of record failed'.
   600     88  XREF-READ-ERROR                     VALUE
   601         'Error reading Card Data File'.
   602     88  CODING-TO-BE-DONE                   VALUE
   603         'Looks Good.... so far'.
   604******************************************************************
   605*      Literals and Constants
   606******************************************************************
   607 01 WS-LITERALS.
   608    05 LIT-THISPGM                           PIC X(8)
   609                                             VALUE 'COACTUPC'.
   610    05 LIT-THISTRANID                        PIC X(4)
   611                                             VALUE 'CAUP'.
   612    05 LIT-THISMAPSET                        PIC X(8)
   613                                             VALUE 'COACTUP '.
   614    05 LIT-THISMAP                           PIC X(7)
   615                                             VALUE 'CACTUPA'.
   616    05 LIT-CARDUPDATE-PGM                    PIC X(8)
   617                                             VALUE 'COCRDUPC'.
   618    05 LIT-CARDUPDATE-TRANID                 PIC X(4)
   619                                             VALUE 'CCUP'.
   620    05 LIT-CARDUPDATE-MAPSET                 PIC X(8)
   621                                             VALUE 'COCRDUP '.
   622    05 LIT-CARDUPDATE-MAP                    PIC X(7)
   623                                             VALUE 'CCRDUPA'.
   624    05 LIT-CCLISTPGM                         PIC X(8)
   625                                             VALUE 'COCRDLIC'.
   626    05 LIT-CCLISTTRANID                      PIC X(4)
   627                                             VALUE 'CCLI'.
   628    05 LIT-CCLISTMAPSET                      PIC X(7)
   629                                             VALUE 'COCRDLI'.
   630    05 LIT-CCLISTMAP                         PIC X(7)
   631                                             VALUE 'CCRDSLA'.
   632    05 LIT-MENUPGM                           PIC X(8)
   633                                             VALUE 'COMEN01C'.
   634    05 LIT-MENUTRANID                        PIC X(4)
   635                                             VALUE 'CM00'.
   636    05 LIT-MENUMAPSET                        PIC X(7)
   637                                             VALUE 'COMEN01'.
   638    05 LIT-MENUMAP                           PIC X(7)
   639                                             VALUE 'COMEN1A'.
   640    05 LIT-CARDDTLPGM                        PIC X(8)
   641                                             VALUE 'COCRDSLC'.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  17
* COACTUPC.cbl
   642    05 LIT-CARDDTLTRANID                     PIC X(4)
   643                                             VALUE 'CCDL'.
   644    05 LIT-CARDDTLMAPSET                     PIC X(7)
   645                                             VALUE 'COCRDSL'.
   646    05 LIT-CARDDTLMAP                        PIC X(7)
   647                                             VALUE 'CCRDSLA'.
   648    05 LIT-ACCTFILENAME                      PIC X(8)
   649                                             VALUE 'ACCTDAT '.
   650    05 LIT-CUSTFILENAME                      PIC X(8)
   651                                             VALUE 'CUSTDAT '.
   652    05 LIT-CARDFILENAME                      PIC X(8)
   653                                             VALUE 'CARDDAT '.
   654    05 LIT-CARDFILENAME-ACCT-PATH            PIC X(8)
   655                                             VALUE 'CARDAIX '.
   656    05 LIT-CARDXREFNAME-ACCT-PATH            PIC X(8)
   657                                             VALUE 'CXACAIX '.
   658******************************************************************
   659* Literals for use in INSPECT statements
   660******************************************************************
   661    05 FILLER.
   662       10 FILLER.
   663          15 LIT-UPPER                       PIC X(26)
   664                           VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
   665          15 LIT-LOWER                       PIC X(26)
   666                           VALUE 'abcdefghijklmnopqrstuvwxyz'.
   667       10 LIT-NUMBERS                        PIC X(10)
   668                           VALUE '0123456789'.
   669******************************************************************
   670*Level 66 variables to add some variety
   671******************************************************************
   672    66 LIT-ALL-ALPHA-FROM-X       RENAMES  LIT-UPPER
   673                                  THRU     LIT-LOWER.
   674    66 LIT-ALL-ALPHANUM-FROM-X    RENAMES  LIT-UPPER
   675                                  THRU     LIT-NUMBERS.
   676
   677******************************************************************
   678*Other common working storage Variables
   679******************************************************************
   680*COPY CVCRD01Y.
   681 01  CC-WORK-AREAS.                                               00010004
   682    05 CC-WORK-AREA.                                              00020001
   683       10 CCARD-AID                         PIC X(5).             00090001
   684          88  CCARD-AID-ENTER                VALUE 'ENTER'.       00100001
   685          88  CCARD-AID-CLEAR                VALUE 'CLEAR'.       00110001
   686          88  CCARD-AID-PA1                  VALUE 'PA1  '.       00120001
   687          88  CCARD-AID-PA2                  VALUE 'PA2  '.       00130001
   688          88  CCARD-AID-PFK01                VALUE 'PFK01'.       00140001
   689          88  CCARD-AID-PFK02                VALUE 'PFK02'.       00150001
   690          88  CCARD-AID-PFK03                VALUE 'PFK03'.       00160001
   691          88  CCARD-AID-PFK04                VALUE 'PFK04'.       00170001
   692          88  CCARD-AID-PFK05                VALUE 'PFK05'.       00180001
   693          88  CCARD-AID-PFK06                VALUE 'PFK06'.       00190001
   694          88  CCARD-AID-PFK07                VALUE 'PFK07'.       00200001
   695          88  CCARD-AID-PFK08                VALUE 'PFK08'.       00210001
   696          88  CCARD-AID-PFK09                VALUE 'PFK09'.       00220001
   697          88  CCARD-AID-PFK10                VALUE 'PFK10'.       00230001
   698          88  CCARD-AID-PFK11                VALUE 'PFK11'.       00240001
   699          88  CCARD-AID-PFK12                VALUE 'PFK12'.       00250001
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  18
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CVCRD01Y.c)
   700*      10  CCARD-LAST-PROG                  PIC X(8).             00260001
   701       10  CCARD-NEXT-PROG                  PIC X(8).             00270001
   702*      10  CCARD-RETURN-TO-PROG             PIC X(8).             00280001
   703       10  CCARD-NEXT-MAPSET                PIC X(7).             00330001
   704       10  CCARD-NEXT-MAP                   PIC X(7).             00340001
   705*      10  CCARD-RETURN-FLAG                PIC X(1).             00350001
   706*        88  CCARD-RETURN-FLAG-OFF          VALUE LOW-VALUES.     00360001
   707*        88  CCARD-RETURN-FLAG-ON           VALUE '1'.            00370001
   708       10  CCARD-ERROR-MSG                  PIC X(75).            00380001
   709       10  CCARD-RETURN-MSG                 PIC X(75).            00390001
   710         88  CCARD-RETURN-MSG-OFF           VALUE LOW-VALUES.     00400001
   711*      10  CCARD-FUNCTION                   PIC X(1).             00410001
   712*        88  CCARD-NO-VALUE                  VALUE LOW-VALUES.    00420001
   713*        88  CCARD-GET-DATA                  VALUE '1'.           00430001
   714       10 CC-ACCT-ID                        PIC X(11)             00440005
   715                                            VALUE SPACES.
   716       10 CC-ACCT-ID-N REDEFINES CC-ACCT-ID PIC 9(11).
   717       10 CC-CARD-NUM                       PIC X(16)             00460005
   718                                            VALUE SPACES.         00470005
   719       10 CC-CARD-NUM-N REDEFINES CC-CARD-NUM PIC 9(16).
   720       10 CC-CUST-ID                        PIC X(09)             00480005
   721                                            VALUE SPACES.         00490005
   722       10 CC-CUST-ID-N REDEFINES CC-CUST-ID PIC 9(9).             00480005
   723
   724*
   725* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:00 CDT
   726*
   727******************************************************************
   728*Lookups
   729******************************************************************
   730*North America Phone Area codes
   731*COPY CSLKPCDY.
   732******************************************************************
   733*Lookup code repository
   734*       1) North america phone area codes
   735*       2) United States - state codes
   736*       3) United States - state + first 2 of zip
   737*
   738******************************************************************
   739
   740 01 WS-US-PHONE-AREA-CODE-TO-EDIT PIC XXX.
   741******************************************************************
   742*North America Phone area codes List obtained from North America
   743*Numbering Plan Administrator *nanpa
   744*https://nationalnanpa.com/nanp1/npa_report.csv
   745******************************************************************
   746    88 VALID-PHONE-AREA-CODE VALUES '201',
   747                              '202',
   748                              '203',
   749                              '204',
   750                              '205',
   751                              '206',
   752                              '207',
   753                              '208',
   754                              '209',
   755                              '210',
   756                              '212',
   757                              '213',
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  19
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSLKPCDY.c)
   758                              '214',
   759                              '215',
   760                              '216',
   761                              '217',
   762                              '218',
   763                              '219',
   764                              '220',
   765                              '223',
   766                              '224',
   767                              '225',
   768                              '226',
   769                              '228',
   770                              '229',
   771                              '231',
   772                              '234',
   773                              '236',
   774                              '239',
   775                              '240',
   776                              '242',
   777                              '246',
   778                              '248',
   779                              '249',
   780                              '250',
   781                              '251',
   782                              '252',
   783                              '253',
   784                              '254',
   785                              '256',
   786                              '260',
   787                              '262',
   788                              '264',
   789                              '267',
   790                              '268',
   791                              '269',
   792                              '270',
   793                              '272',
   794                              '276',
   795                              '279',
   796                              '281',
   797                              '284',
   798                              '289',
   799                              '301',
   800                              '302',
   801                              '303',
   802                              '304',
   803                              '305',
   804                              '306',
   805                              '307',
   806                              '308',
   807                              '309',
   808                              '310',
   809                              '312',
   810                              '313',
   811                              '314',
   812                              '315',
   813                              '316',
   814                              '317',
   815                              '318',
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  20
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSLKPCDY.c)
   816                              '319',
   817                              '320',
   818                              '321',
   819                              '323',
   820                              '325',
   821                              '326',
   822                              '330',
   823                              '331',
   824                              '332',
   825                              '334',
   826                              '336',
   827                              '337',
   828                              '339',
   829                              '340',
   830                              '341',
   831                              '343',
   832                              '345',
   833                              '346',
   834                              '347',
   835                              '351',
   836                              '352',
   837                              '360',
   838                              '361',
   839                              '364',
   840                              '365',
   841                              '367',
   842                              '368',
   843                              '380',
   844                              '385',
   845                              '386',
   846                              '401',
   847                              '402',
   848                              '403',
   849                              '404',
   850                              '405',
   851                              '406',
   852                              '407',
   853                              '408',
   854                              '409',
   855                              '410',
   856                              '412',
   857                              '413',
   858                              '414',
   859                              '415',
   860                              '416',
   861                              '417',
   862                              '418',
   863                              '419',
   864                              '423',
   865                              '424',
   866                              '425',
   867                              '430',
   868                              '431',
   869                              '432',
   870                              '434',
   871                              '435',
   872                              '437',
   873                              '438',
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  21
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSLKPCDY.c)
   874                              '440',
   875                              '441',
   876                              '442',
   877                              '443',
   878                              '445',
   879                              '447',
   880                              '448',
   881                              '450',
   882                              '458',
   883                              '463',
   884                              '464',
   885                              '469',
   886                              '470',
   887                              '473',
   888                              '474',
   889                              '475',
   890                              '478',
   891                              '479',
   892                              '480',
   893                              '484',
   894                              '501',
   895                              '502',
   896                              '503',
   897                              '504',
   898                              '505',
   899                              '506',
   900                              '507',
   901                              '508',
   902                              '509',
   903                              '510',
   904                              '512',
   905                              '513',
   906                              '514',
   907                              '515',
   908                              '516',
   909                              '517',
   910                              '518',
   911                              '519',
   912                              '520',
   913                              '530',
   914                              '531',
   915                              '534',
   916                              '539',
   917                              '540',
   918                              '541',
   919                              '548',
   920                              '551',
   921                              '559',
   922                              '561',
   923                              '562',
   924                              '563',
   925                              '564',
   926                              '567',
   927                              '570',
   928                              '571',
   929                              '572',
   930                              '573',
   931                              '574',
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  22
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSLKPCDY.c)
   932                              '575',
   933                              '579',
   934                              '580',
   935                              '581',
   936                              '582',
   937                              '585',
   938                              '586',
   939                              '587',
   940                              '601',
   941                              '602',
   942                              '603',
   943                              '604',
   944                              '605',
   945                              '606',
   946                              '607',
   947                              '608',
   948                              '609',
   949                              '610',
   950                              '612',
   951                              '613',
   952                              '614',
   953                              '615',
   954                              '616',
   955                              '617',
   956                              '618',
   957                              '619',
   958                              '620',
   959                              '623',
   960                              '626',
   961                              '628',
   962                              '629',
   963                              '630',
   964                              '631',
   965                              '636',
   966                              '639',
   967                              '640',
   968                              '641',
   969                              '646',
   970                              '647',
   971                              '649',
   972                              '650',
   973                              '651',
   974                              '656',
   975                              '657',
   976                              '658',
   977                              '659',
   978                              '660',
   979                              '661',
   980                              '662',
   981                              '664',
   982                              '667',
   983                              '669',
   984                              '670',
   985                              '671',
   986                              '672',
   987                              '678',
   988                              '680',
   989                              '681',
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  23
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSLKPCDY.c)
   990                              '682',
   991                              '683',
   992                              '684',
   993                              '689',
   994                              '701',
   995                              '702',
   996                              '703',
   997                              '704',
   998                              '705',
   999                              '706',
  1000                              '707',
  1001                              '708',
  1002                              '709',
  1003                              '712',
  1004                              '713',
  1005                              '714',
  1006                              '715',
  1007                              '716',
  1008                              '717',
  1009                              '718',
  1010                              '719',
  1011                              '720',
  1012                              '721',
  1013                              '724',
  1014                              '725',
  1015                              '726',
  1016                              '727',
  1017                              '731',
  1018                              '732',
  1019                              '734',
  1020                              '737',
  1021                              '740',
  1022                              '742',
  1023                              '743',
  1024                              '747',
  1025                              '753',
  1026                              '754',
  1027                              '757',
  1028                              '758',
  1029                              '760',
  1030                              '762',
  1031                              '763',
  1032                              '765',
  1033                              '767',
  1034                              '769',
  1035                              '770',
  1036                              '771',
  1037                              '772',
  1038                              '773',
  1039                              '774',
  1040                              '775',
  1041                              '778',
  1042                              '779',
  1043                              '780',
  1044                              '781',
  1045                              '782',
  1046                              '784',
  1047                              '785',
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  24
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSLKPCDY.c)
  1048                              '786',
  1049                              '787',
  1050                              '801',
  1051                              '802',
  1052                              '803',
  1053                              '804',
  1054                              '805',
  1055                              '806',
  1056                              '807',
  1057                              '808',
  1058                              '809',
  1059                              '810',
  1060                              '812',
  1061                              '813',
  1062                              '814',
  1063                              '815',
  1064                              '816',
  1065                              '817',
  1066                              '818',
  1067                              '819',
  1068                              '820',
  1069                              '825',
  1070                              '826',
  1071                              '828',
  1072                              '829',
  1073                              '830',
  1074                              '831',
  1075                              '832',
  1076                              '838',
  1077                              '839',
  1078                              '840',
  1079                              '843',
  1080                              '845',
  1081                              '847',
  1082                              '848',
  1083                              '849',
  1084                              '850',
  1085                              '854',
  1086                              '856',
  1087                              '857',
  1088                              '858',
  1089                              '859',
  1090                              '860',
  1091                              '862',
  1092                              '863',
  1093                              '864',
  1094                              '865',
  1095                              '867',
  1096                              '868',
  1097                              '869',
  1098                              '870',
  1099                              '872',
  1100                              '873',
  1101                              '876',
  1102                              '878',
  1103                              '901',
  1104                              '902',
  1105                              '903',
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  25
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSLKPCDY.c)
  1106                              '904',
  1107                              '905',
  1108                              '906',
  1109                              '907',
  1110                              '908',
  1111                              '909',
  1112                              '910',
  1113                              '912',
  1114                              '913',
  1115                              '914',
  1116                              '915',
  1117                              '916',
  1118                              '917',
  1119                              '918',
  1120                              '919',
  1121                              '920',
  1122                              '925',
  1123                              '928',
  1124                              '929',
  1125                              '930',
  1126                              '931',
  1127                              '934',
  1128                              '936',
  1129                              '937',
  1130                              '938',
  1131                              '939',
  1132                              '940',
  1133                              '941',
  1134                              '943',
  1135                              '945',
  1136                              '947',
  1137                              '948',
  1138                              '949',
  1139                              '951',
  1140                              '952',
  1141                              '954',
  1142                              '956',
  1143                              '959',
  1144                              '970',
  1145                              '971',
  1146                              '972',
  1147                              '973',
  1148                              '978',
  1149                              '979',
  1150                              '980',
  1151                              '983',
  1152                              '984',
  1153                              '985',
  1154                              '986',
  1155                              '989',
  1156*Easily recognizable codes begin here.
  1157                               '200',
  1158                               '211',
  1159                               '222',
  1160                               '233',
  1161                               '244',
  1162                               '255',
  1163                               '266',
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  26
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSLKPCDY.c)
  1164                               '277',
  1165                               '288',
  1166                               '299',
  1167                               '300',
  1168                               '311',
  1169                               '322',
  1170                               '333',
  1171                               '344',
  1172                               '355',
  1173                               '366',
  1174                               '377',
  1175                               '388',
  1176                               '399',
  1177                               '400',
  1178                               '411',
  1179                               '422',
  1180                               '433',
  1181                               '444',
  1182                               '455',
  1183                               '466',
  1184                               '477',
  1185                               '488',
  1186                               '499',
  1187                               '500',
  1188                               '511',
  1189                               '522',
  1190                               '533',
  1191                               '544',
  1192                               '555',
  1193                               '566',
  1194                               '577',
  1195                               '588',
  1196                               '599',
  1197                               '600',
  1198                               '611',
  1199                               '622',
  1200                               '633',
  1201                               '644',
  1202                               '655',
  1203                               '666',
  1204                               '677',
  1205                               '688',
  1206                               '699',
  1207                               '700',
  1208                               '711',
  1209                               '722',
  1210                               '733',
  1211                               '744',
  1212                               '755',
  1213                               '766',
  1214                               '777',
  1215                               '788',
  1216                               '799',
  1217                               '800',
  1218                               '811',
  1219                               '822',
  1220                               '833',
  1221                               '844',
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  27
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSLKPCDY.c)
  1222                               '855',
  1223                               '866',
  1224                               '877',
  1225                               '888',
  1226                               '899',
  1227                               '900',
  1228                               '911',
  1229                               '922',
  1230                               '933',
  1231                               '944',
  1232                               '955',
  1233                               '966',
  1234                               '977',
  1235                               '988',
  1236                               '999'.
  1237    88 VALID-GENERAL-PURP-CODE VALUES '201',
  1238                              '202',
  1239                              '203',
  1240                              '204',
  1241                              '205',
  1242                              '206',
  1243                              '207',
  1244                              '208',
  1245                              '209',
  1246                              '210',
  1247                              '212',
  1248                              '213',
  1249                              '214',
  1250                              '215',
  1251                              '216',
  1252                              '217',
  1253                              '218',
  1254                              '219',
  1255                              '220',
  1256                              '223',
  1257                              '224',
  1258                              '225',
  1259                              '226',
  1260                              '228',
  1261                              '229',
  1262                              '231',
  1263                              '234',
  1264                              '236',
  1265                              '239',
  1266                              '240',
  1267                              '242',
  1268                              '246',
  1269                              '248',
  1270                              '249',
  1271                              '250',
  1272                              '251',
  1273                              '252',
  1274                              '253',
  1275                              '254',
  1276                              '256',
  1277                              '260',
  1278                              '262',
  1279                              '264',
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  28
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSLKPCDY.c)
  1280                              '267',
  1281                              '268',
  1282                              '269',
  1283                              '270',
  1284                              '272',
  1285                              '276',
  1286                              '279',
  1287                              '281',
  1288                              '284',
  1289                              '289',
  1290                              '301',
  1291                              '302',
  1292                              '303',
  1293                              '304',
  1294                              '305',
  1295                              '306',
  1296                              '307',
  1297                              '308',
  1298                              '309',
  1299                              '310',
  1300                              '312',
  1301                              '313',
  1302                              '314',
  1303                              '315',
  1304                              '316',
  1305                              '317',
  1306                              '318',
  1307                              '319',
  1308                              '320',
  1309                              '321',
  1310                              '323',
  1311                              '325',
  1312                              '326',
  1313                              '330',
  1314                              '331',
  1315                              '332',
  1316                              '334',
  1317                              '336',
  1318                              '337',
  1319                              '339',
  1320                              '340',
  1321                              '341',
  1322                              '343',
  1323                              '345',
  1324                              '346',
  1325                              '347',
  1326                              '351',
  1327                              '352',
  1328                              '360',
  1329                              '361',
  1330                              '364',
  1331                              '365',
  1332                              '367',
  1333                              '368',
  1334                              '380',
  1335                              '385',
  1336                              '386',
  1337                              '401',
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  29
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSLKPCDY.c)
  1338                              '402',
  1339                              '403',
  1340                              '404',
  1341                              '405',
  1342                              '406',
  1343                              '407',
  1344                              '408',
  1345                              '409',
  1346                              '410',
  1347                              '412',
  1348                              '413',
  1349                              '414',
  1350                              '415',
  1351                              '416',
  1352                              '417',
  1353                              '418',
  1354                              '419',
  1355                              '423',
  1356                              '424',
  1357                              '425',
  1358                              '430',
  1359                              '431',
  1360                              '432',
  1361                              '434',
  1362                              '435',
  1363                              '437',
  1364                              '438',
  1365                              '440',
  1366                              '441',
  1367                              '442',
  1368                              '443',
  1369                              '445',
  1370                              '447',
  1371                              '448',
  1372                              '450',
  1373                              '458',
  1374                              '463',
  1375                              '464',
  1376                              '469',
  1377                              '470',
  1378                              '473',
  1379                              '474',
  1380                              '475',
  1381                              '478',
  1382                              '479',
  1383                              '480',
  1384                              '484',
  1385                              '501',
  1386                              '502',
  1387                              '503',
  1388                              '504',
  1389                              '505',
  1390                              '506',
  1391                              '507',
  1392                              '508',
  1393                              '509',
  1394                              '510',
  1395                              '512',
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  30
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSLKPCDY.c)
  1396                              '513',
  1397                              '514',
  1398                              '515',
  1399                              '516',
  1400                              '517',
  1401                              '518',
  1402                              '519',
  1403                              '520',
  1404                              '530',
  1405                              '531',
  1406                              '534',
  1407                              '539',
  1408                              '540',
  1409                              '541',
  1410                              '548',
  1411                              '551',
  1412                              '559',
  1413                              '561',
  1414                              '562',
  1415                              '563',
  1416                              '564',
  1417                              '567',
  1418                              '570',
  1419                              '571',
  1420                              '572',
  1421                              '573',
  1422                              '574',
  1423                              '575',
  1424                              '579',
  1425                              '580',
  1426                              '581',
  1427                              '582',
  1428                              '585',
  1429                              '586',
  1430                              '587',
  1431                              '601',
  1432                              '602',
  1433                              '603',
  1434                              '604',
  1435                              '605',
  1436                              '606',
  1437                              '607',
  1438                              '608',
  1439                              '609',
  1440                              '610',
  1441                              '612',
  1442                              '613',
  1443                              '614',
  1444                              '615',
  1445                              '616',
  1446                              '617',
  1447                              '618',
  1448                              '619',
  1449                              '620',
  1450                              '623',
  1451                              '626',
  1452                              '628',
  1453                              '629',
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  31
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSLKPCDY.c)
  1454                              '630',
  1455                              '631',
  1456                              '636',
  1457                              '639',
  1458                              '640',
  1459                              '641',
  1460                              '646',
  1461                              '647',
  1462                              '649',
  1463                              '650',
  1464                              '651',
  1465                              '656',
  1466                              '657',
  1467                              '658',
  1468                              '659',
  1469                              '660',
  1470                              '661',
  1471                              '662',
  1472                              '664',
  1473                              '667',
  1474                              '669',
  1475                              '670',
  1476                              '671',
  1477                              '672',
  1478                              '678',
  1479                              '680',
  1480                              '681',
  1481                              '682',
  1482                              '683',
  1483                              '684',
  1484                              '689',
  1485                              '701',
  1486                              '702',
  1487                              '703',
  1488                              '704',
  1489                              '705',
  1490                              '706',
  1491                              '707',
  1492                              '708',
  1493                              '709',
  1494                              '712',
  1495                              '713',
  1496                              '714',
  1497                              '715',
  1498                              '716',
  1499                              '717',
  1500                              '718',
  1501                              '719',
  1502                              '720',
  1503                              '721',
  1504                              '724',
  1505                              '725',
  1506                              '726',
  1507                              '727',
  1508                              '731',
  1509                              '732',
  1510                              '734',
  1511                              '737',
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  32
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSLKPCDY.c)
  1512                              '740',
  1513                              '742',
  1514                              '743',
  1515                              '747',
  1516                              '753',
  1517                              '754',
  1518                              '757',
  1519                              '758',
  1520                              '760',
  1521                              '762',
  1522                              '763',
  1523                              '765',
  1524                              '767',
  1525                              '769',
  1526                              '770',
  1527                              '771',
  1528                              '772',
  1529                              '773',
  1530                              '774',
  1531                              '775',
  1532                              '778',
  1533                              '779',
  1534                              '780',
  1535                              '781',
  1536                              '782',
  1537                              '784',
  1538                              '785',
  1539                              '786',
  1540                              '787',
  1541                              '801',
  1542                              '802',
  1543                              '803',
  1544                              '804',
  1545                              '805',
  1546                              '806',
  1547                              '807',
  1548                              '808',
  1549                              '809',
  1550                              '810',
  1551                              '812',
  1552                              '813',
  1553                              '814',
  1554                              '815',
  1555                              '816',
  1556                              '817',
  1557                              '818',
  1558                              '819',
  1559                              '820',
  1560                              '825',
  1561                              '826',
  1562                              '828',
  1563                              '829',
  1564                              '830',
  1565                              '831',
  1566                              '832',
  1567                              '838',
  1568                              '839',
  1569                              '840',
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  33
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSLKPCDY.c)
  1570                              '843',
  1571                              '845',
  1572                              '847',
  1573                              '848',
  1574                              '849',
  1575                              '850',
  1576                              '854',
  1577                              '856',
  1578                              '857',
  1579                              '858',
  1580                              '859',
  1581                              '860',
  1582                              '862',
  1583                              '863',
  1584                              '864',
  1585                              '865',
  1586                              '867',
  1587                              '868',
  1588                              '869',
  1589                              '870',
  1590                              '872',
  1591                              '873',
  1592                              '876',
  1593                              '878',
  1594                              '901',
  1595                              '902',
  1596                              '903',
  1597                              '904',
  1598                              '905',
  1599                              '906',
  1600                              '907',
  1601                              '908',
  1602                              '909',
  1603                              '910',
  1604                              '912',
  1605                              '913',
  1606                              '914',
  1607                              '915',
  1608                              '916',
  1609                              '917',
  1610                              '918',
  1611                              '919',
  1612                              '920',
  1613                              '925',
  1614                              '928',
  1615                              '929',
  1616                              '930',
  1617                              '931',
  1618                              '934',
  1619                              '936',
  1620                              '937',
  1621                              '938',
  1622                              '939',
  1623                              '940',
  1624                              '941',
  1625                              '943',
  1626                              '945',
  1627                              '947',
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  34
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSLKPCDY.c)
  1628                              '948',
  1629                              '949',
  1630                              '951',
  1631                              '952',
  1632                              '954',
  1633                              '956',
  1634                              '959',
  1635                              '970',
  1636                              '971',
  1637                              '972',
  1638                              '973',
  1639                              '978',
  1640                              '979',
  1641                              '980',
  1642                              '983',
  1643                              '984',
  1644                              '985',
  1645                              '986',
  1646                              '989'.
  1647    88 VALID-EASY-RECOG-AREA-CODE VALUES  '200',
  1648                               '211',
  1649                               '222',
  1650                               '233',
  1651                               '244',
  1652                               '255',
  1653                               '266',
  1654                               '277',
  1655                               '288',
  1656                               '299',
  1657                               '300',
  1658                               '311',
  1659                               '322',
  1660                               '333',
  1661                               '344',
  1662                               '355',
  1663                               '366',
  1664                               '377',
  1665                               '388',
  1666                               '399',
  1667                               '400',
  1668                               '411',
  1669                               '422',
  1670                               '433',
  1671                               '444',
  1672                               '455',
  1673                               '466',
  1674                               '477',
  1675                               '488',
  1676                               '499',
  1677                               '500',
  1678                               '511',
  1679                               '522',
  1680                               '533',
  1681                               '544',
  1682                               '555',
  1683                               '566',
  1684                               '577',
  1685                               '588',
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  35
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSLKPCDY.c)
  1686                               '599',
  1687                               '600',
  1688                               '611',
  1689                               '622',
  1690                               '633',
  1691                               '644',
  1692                               '655',
  1693                               '666',
  1694                               '677',
  1695                               '688',
  1696                               '699',
  1697                               '700',
  1698                               '711',
  1699                               '722',
  1700                               '733',
  1701                               '744',
  1702                               '755',
  1703                               '766',
  1704                               '777',
  1705                               '788',
  1706                               '799',
  1707                               '800',
  1708                               '811',
  1709                               '822',
  1710                               '833',
  1711                               '844',
  1712                               '855',
  1713                               '866',
  1714                               '877',
  1715                               '888',
  1716                               '899',
  1717                               '900',
  1718                               '911',
  1719                               '922',
  1720                               '933',
  1721                               '944',
  1722                               '955',
  1723                               '966',
  1724                               '977',
  1725                               '988',
  1726                               '999'.
  1727*Search list of valid Phone area codes
  1728 01 US-STATE-CODE-TO-EDIT  PIC X(2).
  1729    88 VALID-US-STATE-CODE VALUES
  1730                              'AL',
  1731                              'AK',
  1732                              'AZ',
  1733                              'AR',
  1734                              'CA',
  1735                              'CO',
  1736                              'CT',
  1737                              'DE',
  1738                              'FL',
  1739                              'GA',
  1740                              'HI',
  1741                              'ID',
  1742                              'IL',
  1743                              'IN',
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  36
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSLKPCDY.c)
  1744                              'IA',
  1745                              'KS',
  1746                              'KY',
  1747                              'LA',
  1748                              'ME',
  1749                              'MD',
  1750                              'MA',
  1751                              'MI',
  1752                              'MN',
  1753                              'MS',
  1754                              'MO',
  1755                              'MT',
  1756                              'NE',
  1757                              'NV',
  1758                              'NH',
  1759                              'NJ',
  1760                              'NM',
  1761                              'NY',
  1762                              'NC',
  1763                              'ND',
  1764                              'OH',
  1765                              'OK',
  1766                              'OR',
  1767                              'PA',
  1768                              'RI',
  1769                              'SC',
  1770                              'SD',
  1771                              'TN',
  1772                              'TX',
  1773                              'UT',
  1774                              'VT',
  1775                              'VA',
  1776                              'WA',
  1777                              'WV',
  1778                              'WI',
  1779                              'WY',
  1780                              'DC',
  1781                              'AS',
  1782                              'GU',
  1783                              'MP',
  1784                              'PR',
  1785                              'VI'.
  1786*State Zip Code Combinations
  1787 01 US-STATE-ZIPCODE-TO-EDIT.
  1788    02 US-STATE-AND-FIRST-ZIP2 PIC X(4).
  1789       88 VALID-US-STATE-ZIP-CD2-COMBO VALUES
  1790                              'AA34',
  1791                              'AE90',
  1792                              'AE91',
  1793                              'AE92',
  1794                              'AE93',
  1795                              'AE94',
  1796                              'AE95',
  1797                              'AE96',
  1798                              'AE97',
  1799                              'AE98',
  1800                              'AK99',
  1801                              'AL35',
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  37
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSLKPCDY.c)
  1802                              'AL36',
  1803                              'AP96',
  1804                              'AR71',
  1805                              'AR72',
  1806                              'AS96',
  1807                              'AZ85',
  1808                              'AZ86',
  1809                              'CA90',
  1810                              'CA91',
  1811                              'CA92',
  1812                              'CA93',
  1813                              'CA94',
  1814                              'CA95',
  1815                              'CA96',
  1816                              'CO80',
  1817                              'CO81',
  1818                              'CT60',
  1819                              'CT61',
  1820                              'CT62',
  1821                              'CT63',
  1822                              'CT64',
  1823                              'CT65',
  1824                              'CT66',
  1825                              'CT67',
  1826                              'CT68',
  1827                              'CT69',
  1828                              'DC20',
  1829                              'DC56',
  1830                              'DC88',
  1831                              'DE19',
  1832                              'FL32',
  1833                              'FL33',
  1834                              'FL34',
  1835                              'FM96',
  1836                              'GA30',
  1837                              'GA31',
  1838                              'GA39',
  1839                              'GU96',
  1840                              'HI96',
  1841                              'IA50',
  1842                              'IA51',
  1843                              'IA52',
  1844                              'ID83',
  1845                              'IL60',
  1846                              'IL61',
  1847                              'IL62',
  1848                              'IN46',
  1849                              'IN47',
  1850                              'KS66',
  1851                              'KS67',
  1852                              'KY40',
  1853                              'KY41',
  1854                              'KY42',
  1855                              'LA70',
  1856                              'LA71',
  1857                              'MA10',
  1858                              'MA11',
  1859                              'MA12',
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  38
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSLKPCDY.c)
  1860                              'MA13',
  1861                              'MA14',
  1862                              'MA15',
  1863                              'MA16',
  1864                              'MA17',
  1865                              'MA18',
  1866                              'MA19',
  1867                              'MA20',
  1868                              'MA21',
  1869                              'MA22',
  1870                              'MA23',
  1871                              'MA24',
  1872                              'MA25',
  1873                              'MA26',
  1874                              'MA27',
  1875                              'MA55',
  1876                              'MD20',
  1877                              'MD21',
  1878                              'ME39',
  1879                              'ME40',
  1880                              'ME41',
  1881                              'ME42',
  1882                              'ME43',
  1883                              'ME44',
  1884                              'ME45',
  1885                              'ME46',
  1886                              'ME47',
  1887                              'ME48',
  1888                              'ME49',
  1889                              'MH96',
  1890                              'MI48',
  1891                              'MI49',
  1892                              'MN55',
  1893                              'MN56',
  1894                              'MO63',
  1895                              'MO64',
  1896                              'MO65',
  1897                              'MO72',
  1898                              'MP96',
  1899                              'MS38',
  1900                              'MS39',
  1901                              'MT59',
  1902                              'NC27',
  1903                              'NC28',
  1904                              'ND58',
  1905                              'NE68',
  1906                              'NE69',
  1907                              'NH30',
  1908                              'NH31',
  1909                              'NH32',
  1910                              'NH33',
  1911                              'NH34',
  1912                              'NH35',
  1913                              'NH36',
  1914                              'NH37',
  1915                              'NH38',
  1916                              'NJ70',
  1917                              'NJ71',
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  39
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSLKPCDY.c)
  1918                              'NJ72',
  1919                              'NJ73',
  1920                              'NJ74',
  1921                              'NJ75',
  1922                              'NJ76',
  1923                              'NJ77',
  1924                              'NJ78',
  1925                              'NJ79',
  1926                              'NJ80',
  1927                              'NJ81',
  1928                              'NJ82',
  1929                              'NJ83',
  1930                              'NJ84',
  1931                              'NJ85',
  1932                              'NJ86',
  1933                              'NJ87',
  1934                              'NJ88',
  1935                              'NJ89',
  1936                              'NM87',
  1937                              'NM88',
  1938                              'NV88',
  1939                              'NV89',
  1940                              'NY50',
  1941                              'NY54',
  1942                              'NY63',
  1943                              'NY10',
  1944                              'NY11',
  1945                              'NY12',
  1946                              'NY13',
  1947                              'NY14',
  1948                              'OH43',
  1949                              'OH44',
  1950                              'OH45',
  1951                              'OK73',
  1952                              'OK74',
  1953                              'OR97',
  1954                              'PA15',
  1955                              'PA16',
  1956                              'PA17',
  1957                              'PA18',
  1958                              'PA19',
  1959                              'PR60',
  1960                              'PR61',
  1961                              'PR62',
  1962                              'PR63',
  1963                              'PR64',
  1964                              'PR65',
  1965                              'PR66',
  1966                              'PR67',
  1967                              'PR68',
  1968                              'PR69',
  1969                              'PR70',
  1970                              'PR71',
  1971                              'PR72',
  1972                              'PR73',
  1973                              'PR74',
  1974                              'PR75',
  1975                              'PR76',
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  40
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSLKPCDY.c)
  1976                              'PR77',
  1977                              'PR78',
  1978                              'PR79',
  1979                              'PR90',
  1980                              'PR91',
  1981                              'PR92',
  1982                              'PR93',
  1983                              'PR94',
  1984                              'PR95',
  1985                              'PR96',
  1986                              'PR97',
  1987                              'PR98',
  1988                              'PW96',
  1989                              'RI28',
  1990                              'RI29',
  1991                              'SC29',
  1992                              'SD57',
  1993                              'TN37',
  1994                              'TN38',
  1995                              'TX73',
  1996                              'TX75',
  1997                              'TX76',
  1998                              'TX77',
  1999                              'TX78',
  2000                              'TX79',
  2001                              'TX88',
  2002                              'UT84',
  2003                              'VA20',
  2004                              'VA22',
  2005                              'VA23',
  2006                              'VA24',
  2007                              'VI80',
  2008                              'VI82',
  2009                              'VI83',
  2010                              'VI84',
  2011                              'VI85',
  2012                              'VT50',
  2013                              'VT51',
  2014                              'VT52',
  2015                              'VT53',
  2016                              'VT54',
  2017                              'VT56',
  2018                              'VT57',
  2019                              'VT58',
  2020                              'VT59',
  2021                              'WA98',
  2022                              'WA99',
  2023                              'WI53',
  2024                              'WI54',
  2025                              'WV24',
  2026                              'WV25',
  2027                              'WV26',
  2028                              'WY82',
  2029                              'WY83'.
  2030    02 LAST-3-OF-ZIP           PIC X(3).
  2031*
  2032* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:57 CDT
  2033*
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  41
* COACTUPC.cbl
  2034
  2035
  2036******************************************************************
  2037* Variables for use in INSPECT statements
  2038******************************************************************
  2039 01  LIT-ALL-ALPHA-FROM     PIC X(52) VALUE SPACES.
  2040 01  LIT-ALL-ALPHANUM-FROM  PIC X(62) VALUE SPACES.
  2041 01  LIT-ALL-NUM-FROM       PIC X(10) VALUE SPACES.
  2042 77  LIT-ALPHA-SPACES-TO    PIC X(52) VALUE SPACES.
  2043 77  LIT-ALPHANUM-SPACES-TO PIC X(62) VALUE SPACES.
  2044 77  LIT-NUM-SPACES-TO      PIC X(10) VALUE SPACES.
  2045
  2046*IBM SUPPLIED COPYBOOKS
  2047*COPY DFHBMSCA.
  2048*----------------------------------------------------------------*
  2049* dfhbmsca.cpy
  2050*<CR_TAG_DEMO_BEGIN>
  2051*
  2052*  Copyright (C) 2024 Micro Focus or one of its affiliates.
  2053*  All rights reserved.
  2054*
  2055*  This sample code is supplied for demonstration purposes only
  2056*  on an "as is" basis and "is for use at your own risk".
  2057*
  2058*<CR_TAG_DEMO_END>
  2059***---------------------------------------------------------*
  2060***CONTROL BLOCK NAME= DFHBMSCA                             *
  2061***                                                         *
  2062***NAME OF MATCHING ASSEMBLER CONTROL BLOCK = NONE          *
  2063***                                                         *
  2064***DESCRIPTIVE NAME = 3270 ATTRIBUTE VALUES                 *
  2065***                                                         *
  2066***FUNCTION =  Provides the values for 3270 attribute bytes *
  2067***            used by the BMS support.                     *
  2068***                                                         *
  2069***---------------------------------------------------------*
  2070 01      DFHBMSCA.
  2071*                                               X'1915'.
  2072   02    DFHBMPEM-BIN  PICTURE 9(4) COMP VALUE IS 6421.
  2073   02    FILLER REDEFINES DFHBMPEM-BIN.
  2074     03  DFHBMPEM  PICTURE X.
  2075     03  DFHBMPNL  PICTURE X.
  2076*                                               X'0C0D'.
  2077   02    DFHBMPFF-BIN  PICTURE 9(4) COMP VALUE IS 3085.
  2078   02    FILLER REDEFINES DFHBMPFF-BIN.
  2079     03  DFHBMPFF  PICTURE X.
  2080     03  DFHBMPCR  PICTURE X.
  2081   02    DFHBMASK  PICTURE X   VALUE  IS  '0'.
  2082   02    DFHBMUNP  PICTURE X   VALUE  IS  ' '.
  2083   02    DFHBMUNN  PICTURE X   VALUE  IS  '&'.
  2084   02    DFHBMPRO  PICTURE X   VALUE  IS  '-'.
  2085   02    DFHBMBRY  PICTURE X   VALUE  IS  'H'.
  2086   02    DFHBMDAR  PICTURE X   VALUE  IS  '<'.
  2087   02    DFHBMFSE  PICTURE X   VALUE  IS  'A'.
  2088   02    DFHBMPRF  PICTURE X   VALUE  IS  '/'.
  2089   02    DFHBMASF  PICTURE X   VALUE  IS  '1'.
  2090   02    DFHBMASB  PICTURE X   VALUE  IS  '8'.
  2091*                                               X'0E0F'.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  42
* COACTUPC.cbl (/opt/microfocus/EnterpriseBuildTools/cpylib/DFHBMSCA.cpy)
  2092   02    DFHBMPSO-BIN  PICTURE 9(4) COMP VALUE IS 3599.
  2093   02    FILLER REDEFINES DFHBMPSO-BIN.
  2094     03  DFHBMPSO  PICTURE X.
  2095     03  DFHBMPSI  PICTURE X.
  2096*                                               X'0080'.
  2097   02    DFHBMEOF-BIN  PICTURE 9(4) COMP VALUE IS 128.
  2098   02    FILLER REDEFINES DFHBMEOF-BIN.
  2099     03  FILLER    PICTURE X.
  2100     03  DFHBMEOF  PICTURE X.
  2101*                                               X'0282'.
  2102   02    DFHBMCUR-BIN  PICTURE 9(4) COMP VALUE IS 642.
  2103   02    FILLER REDEFINES DFHBMCUR-BIN.
  2104     03  DFHBMCUR  PICTURE X.
  2105     03  DFHBMEC   PICTURE X.
  2106*                                               X'0082'.
  2107   02    DFHBMFLG-BIN  PICTURE 9(4) COMP VALUE IS 130.
  2108       88    DFHERASE VALUES ARE 128, 130.
  2109       88    DFHCURSR VALUES ARE   2, 130.
  2110   02    FILLER REDEFINES DFHBMFLG-BIN.
  2111     03  FILLER    PICTURE X.
  2112     03  DFHBMFLG  PICTURE X.
  2113   02    DFHBMDET  PICTURE X   VALUE  IS  HIGH-VALUES.
  2114   02    FILLER    PICTURE X.
  2115*                                               X'0028'.
  2116   02    DFHSA-BIN  PICTURE 9(4) COMP VALUE IS 40.
  2117   02    FILLER REDEFINES DFHSA-BIN.
  2118     03  FILLER    PICTURE X.
  2119     03  DFHSA     PICTURE X.
  2120*                                               X'003F'.
  2121   02    DFHERROR-BIN  PICTURE 9(4) COMP VALUE IS 63.
  2122   02    FILLER REDEFINES DFHERROR-BIN.
  2123     03  FILLER    PICTURE X.
  2124     03  DFHERROR  PICTURE X.
  2125*                                               X'0042'.
  2126   02    DFHCOLOR-BIN  PICTURE 9(4) COMP VALUE IS 66.
  2127   02    FILLER REDEFINES DFHCOLOR-BIN.
  2128     03  FILLER    PICTURE X.
  2129     03  DFHCOLOR  PICTURE X.
  2130*                                               X'0043'.
  2131   02    DFHPS-BIN  PICTURE 9(4) COMP VALUE IS 67.
  2132   02    FILLER REDEFINES DFHPS-BIN.
  2133     03  FILLER    PICTURE X.
  2134     03  DFHPS     PICTURE X.
  2135*                                               X'0041'.
  2136   02    DFHHLT-BIN  PICTURE 9(4) COMP VALUE IS 65.
  2137   02    FILLER REDEFINES DFHHLT-BIN.
  2138     03  FILLER    PICTURE X.
  2139     03  DFHHLT    PICTURE X.
  2140*                                               X'00C0'.
  2141   02    DFH3270-BIN   PICTURE 9(4) COMP VALUE IS 192.
  2142   02    FILLER REDEFINES DFH3270-BIN.
  2143     03  FILLER    PICTURE X.
  2144     03  DFH3270   PICTURE X.
  2145   02    DFHVAL    PICTURE X   VALUE  IS  'A'.
  2146   02    DFHOUTLN  PICTURE X   VALUE  IS  'B'.
  2147*                                               X'0046'.
  2148   02    DFHBKTRN-BIN  PICTURE 9(4) COMP VALUE IS 70.
  2149   02    FILLER REDEFINES DFHBKTRN-BIN.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  43
* COACTUPC.cbl (/opt/microfocus/EnterpriseBuildTools/cpylib/DFHBMSCA.cpy)
  2150     03  FILLER    PICTURE X.
  2151     03  DFHBKTRN  PICTURE X.
  2152   02    DFHALL    PICTURE X   VALUE  IS  LOW-VALUES.
  2153   02    DFHDFT    PICTURE X   VALUE  IS  HIGH-VALUES.
  2154   02    DFHDFCOL  PICTURE X   VALUE  IS  LOW-VALUES.
  2155   02    DFHBLUE   PICTURE X   VALUE  IS  '1'.
  2156   02    DFHRED    PICTURE X   VALUE  IS  '2'.
  2157   02    DFHPINK   PICTURE X   VALUE  IS  '3'.
  2158   02    DFHGREEN  PICTURE X   VALUE  IS  '4'.
  2159   02    DFHTURQ   PICTURE X   VALUE  IS  '5'.
  2160   02    DFHYELLO  PICTURE X   VALUE  IS  '6'.
  2161   02    DFHNEUTR  PICTURE X   VALUE  IS  '7'.
  2162   02    DFHBASE   PICTURE X   VALUE  IS  LOW-VALUES.
  2163   02    DFHDFHI   PICTURE X   VALUE  IS  LOW-VALUES.
  2164   02    DFHBLINK  PICTURE X   VALUE  IS  '1'.
  2165   02    DFHREVRS  PICTURE X   VALUE  IS  '2'.
  2166   02    DFHUNDLN  PICTURE X   VALUE  IS  '4'.
  2167*                                               X'0402'.
  2168   02    DFHMFIL-BIN  PICTURE 9(4) COMP VALUE IS 1026.
  2169   02    FILLER REDEFINES DFHMFIL-BIN.
  2170     03  DFHMFIL   PICTURE X.
  2171     03  DFHMENT   PICTURE X.
  2172*                                               X'0601'.
  2173   02    DFHMFE-BIN  PICTURE 9(4) COMP VALUE IS 1537.
  2174   02    FILLER REDEFINES DFHMFE-BIN.
  2175     03  DFHMFE    PICTURE X.
  2176     03  DFHMT     PICTURE X.
  2177*                                               X'0503'.
  2178   02    DFHMFT-BIN  PICTURE 9(4) COMP VALUE IS 1283.
  2179   02    FILLER REDEFINES DFHMFT-BIN.
  2180     03  DFHMFT    PICTURE X.
  2181     03  DFHMET    PICTURE X.
  2182*                                               X'0007'.
  2183   02    DFHMFET-BIN  PICTURE 9(4) COMP VALUE IS 7.
  2184   02    FILLER REDEFINES DFHMFET-BIN.
  2185     03  FILLER    PICTURE X.
  2186     03  DFHMFET   PICTURE X.
  2187   02    DFHUNNOD  PICTURE X   VALUE  IS  '('.
  2188   02    DFHUNIMD  PICTURE X   VALUE  IS  'I'.
  2189   02    DFHUNNUM  PICTURE X   VALUE  IS  'J'.
  2190   02    DFHUNNUB  PICTURE X   VALUE  IS  'Q'.
  2191   02    DFHUNINT  PICTURE X   VALUE  IS  'R'.
  2192   02    DFHUNNON  PICTURE X   VALUE  IS  ')'.
  2193   02    DFHPROTI  PICTURE X   VALUE  IS  'Y'.
  2194   02    DFHPROTN  PICTURE X   VALUE  IS  '%'.
  2195   02    DFHDFFR   PICTURE X   VALUE  IS  LOW-VALUES.
  2196*                                               X'0102'.
  2197   02    DFHUNDER-BIN  PICTURE 9(4) COMP VALUE IS 258.
  2198   02    FILLER REDEFINES DFHUNDER-BIN.
  2199     03  DFHUNDER  PICTURE X.
  2200     03  DFHRIGHT  PICTURE X.
  2201*                                               X'0408'.
  2202   02    DFHOVER-BIN  PICTURE 9(4) COMP VALUE IS 1032.
  2203   02    FILLER REDEFINES DFHOVER-BIN.
  2204     03  DFHOVER   PICTURE X.
  2205     03  DFHLEFT   PICTURE X.
  2206*                                               X'000F'.
  2207   02    DFHBOX-BIN   PICTURE 9(4) COMP VALUE IS 15.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  44
* COACTUPC.cbl (/opt/microfocus/EnterpriseBuildTools/cpylib/DFHBMSCA.cpy)
  2208   02    FILLER REDEFINES DFHBOX-BIN.
  2209     03  FILLER    PICTURE X.
  2210     03  DFHBOX    PICTURE X.
  2211*                                               X'0001'.
  2212   02    DFHSOSI-BIN  PICTURE 9(4) COMP VALUE IS 1.
  2213   02    FILLER REDEFINES DFHSOSI-BIN.
  2214     03  FILLER    PICTURE X.
  2215     03  DFHSOSI   PICTURE X.
  2216   02    DFHTRANS  PICTURE X   VALUE  IS  '0'.
  2217   02    DFHOPAQ   PICTURE X   VALUE  IS  HIGH-VALUES.
  2218*----------------------------------------------------------------*
  2219* dfhbmsca.cpy end
  2220*----------------------------------------------------------------*
  2221*COPY DFHAID.
  2222*<CR_TAG_DEMO_BEGIN>
  2223*
  2224*  Copyright (C) 2024 Micro Focus or one of its affiliates.
  2225*  All rights reserved.
  2226*
  2227*  This sample code is supplied for demonstration purposes only
  2228*  on an "as is" basis and "is for use at your own risk".
  2229*
  2230*<CR_TAG_DEMO_END>
  2231*----------------------------------------------------------------*
  2232* dfhaid.cpy
  2233*----------------------------------------------------------------*
  2234 01  DFHAID.
  2235     02  DFHNULL         PIC X   VALUE IS LOW-VALUE.
  2236     02  DFHENTER        PIC X   VALUE IS ''''.
  2237     02  DFHCLEAR        PIC X   VALUE IS '_'.
  2238     02  DFHPEN          PIC X   VALUE IS '='.
  2239     02  DFHOPID         PIC X   VALUE IS 'W'.
  2240     02  DFHMSRE         PIC X   VALUE IS 'X'.
  2241     02  DFHSTRF         PIC X   VALUE IS ' '.
  2242     02  DFHTRIG         PIC X   VALUE IS '"'.
  2243     02  DFHPA1          PIC X   VALUE IS '%'.
  2244     02  DFHPA2          PIC X   VALUE IS '>'.
  2245     02  DFHPA3          PIC X   VALUE IS ','.
  2246     02  DFHPF1          PIC X   VALUE IS '1'.
  2247     02  DFHPF2          PIC X   VALUE IS '2'.
  2248     02  DFHPF3          PIC X   VALUE IS '3'.
  2249     02  DFHPF4          PIC X   VALUE IS '4'.
  2250     02  DFHPF5          PIC X   VALUE IS '5'.
  2251     02  DFHPF6          PIC X   VALUE IS '6'.
  2252     02  DFHPF7          PIC X   VALUE IS '7'.
  2253     02  DFHPF8          PIC X   VALUE IS '8'.
  2254     02  DFHPF9          PIC X   VALUE IS '9'.
  2255     02  DFHPF10         PIC X   VALUE IS ':'.
  2256     02  DFHPF11         PIC X   VALUE IS '#'.
  2257     02  DFHPF12         PIC X   VALUE IS '@'.
  2258     02  DFHPF13         PIC X   VALUE IS 'A'.
  2259     02  DFHPF14         PIC X   VALUE IS 'B'.
  2260     02  DFHPF15         PIC X   VALUE IS 'C'.
  2261     02  DFHPF16         PIC X   VALUE IS 'D'.
  2262     02  DFHPF17         PIC X   VALUE IS 'E'.
  2263     02  DFHPF18         PIC X   VALUE IS 'F'.
  2264     02  DFHPF19         PIC X   VALUE IS 'G'.
  2265     02  DFHPF20         PIC X   VALUE IS 'H'.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  45
* COACTUPC.cbl (/opt/microfocus/EnterpriseBuildTools/cpylib/DFHAID.cpy)
  2266     02  DFHPF21         PIC X   VALUE IS 'I'.
  2267     02  DFHPF22         PIC X   VALUE IS ' '.
  2268*    Note: CICS ECM alters the line above to...
  2269*          Value for ASCII  is X'5B'
  2270*          Value for EBCDIC is X'4A'
  2271     02  DFHPF23         PIC X   VALUE IS '.'.
  2272     02  DFHPF24         PIC X   VALUE IS '<'.
  2273*----------------------------------------------------------------*
  2274* dfhaid.cpy end
  2275*----------------------------------------------------------------*
  2276
  2277*COMMON COPYBOOKS
  2278*Screen Titles
  2279*COPY COTTL01Y.
  2280 01 CCDA-SCREEN-TITLE.
  2281   05 CCDA-TITLE01    PIC X(40) VALUE
  2282      '      AWS Mainframe Modernization       '.
  2283   05 CCDA-TITLE02    PIC X(40) VALUE
  2284*     '  Credit Card Demo Application (CCDA)   '.
  2285      '              CardDemo                  '.
  2286   05 CCDA-THANK-YOU  PIC X(40) VALUE
  2287      'Thank you for using CCDA application... '.
  2288*
  2289* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT
  2290*
  2291
  2292*Account Update Screen Layout
  2293*COPY COACTUP.
  2294*   Micro Focus COBOL 2017  7.0.00247
  2295*   Micro Focus BMS Screen Painter
  2296*   MapSet Name   COACTUP
  2297*   Date Created  08/05/2022
  2298*   Time Created  16:44:44
  2299
  2300*  Input Data For Map CACTUPA
  2301   01 CACTUPAI.
  2302      03 FILLER                         PIC X(12).
  2303      03 TRNNAMEL                       PIC S9(4) COMP.
  2304      03 TRNNAMEF                       PIC X.
  2305      03 FILLER REDEFINES TRNNAMEF.
  2306         05 TRNNAMEA                       PIC X.
  2307      03 FILLER                         PIC X(4).
  2308      03 TRNNAMEI                       PIC X(4).
  2309      03 TITLE01L                       PIC S9(4) COMP.
  2310      03 TITLE01F                       PIC X.
  2311      03 FILLER REDEFINES TITLE01F.
  2312         05 TITLE01A                       PIC X.
  2313      03 FILLER                         PIC X(4).
  2314      03 TITLE01I                       PIC X(40).
  2315      03 CURDATEL                       PIC S9(4) COMP.
  2316      03 CURDATEF                       PIC X.
  2317      03 FILLER REDEFINES CURDATEF.
  2318         05 CURDATEA                       PIC X.
  2319      03 FILLER                         PIC X(4).
  2320      03 CURDATEI                       PIC X(8).
  2321      03 PGMNAMEL                       PIC S9(4) COMP.
  2322      03 PGMNAMEF                       PIC X.
  2323      03 FILLER REDEFINES PGMNAMEF.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  46
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COACTUP.cpy)
  2324         05 PGMNAMEA                       PIC X.
  2325      03 FILLER                         PIC X(4).
  2326      03 PGMNAMEI                       PIC X(8).
  2327      03 TITLE02L                       PIC S9(4) COMP.
  2328      03 TITLE02F                       PIC X.
  2329      03 FILLER REDEFINES TITLE02F.
  2330         05 TITLE02A                       PIC X.
  2331      03 FILLER                         PIC X(4).
  2332      03 TITLE02I                       PIC X(40).
  2333      03 CURTIMEL                       PIC S9(4) COMP.
  2334      03 CURTIMEF                       PIC X.
  2335      03 FILLER REDEFINES CURTIMEF.
  2336         05 CURTIMEA                       PIC X.
  2337      03 FILLER                         PIC X(4).
  2338      03 CURTIMEI                       PIC X(8).
  2339      03 ACCTSIDL                       PIC S9(4) COMP.
  2340      03 ACCTSIDF                       PIC X.
  2341      03 FILLER REDEFINES ACCTSIDF.
  2342         05 ACCTSIDA                       PIC X.
  2343      03 FILLER                         PIC X(4).
  2344      03 ACCTSIDI                       PIC X(11).
  2345      03 ACSTTUSL                       PIC S9(4) COMP.
  2346      03 ACSTTUSF                       PIC X.
  2347      03 FILLER REDEFINES ACSTTUSF.
  2348         05 ACSTTUSA                       PIC X.
  2349      03 FILLER                         PIC X(4).
  2350      03 ACSTTUSI                       PIC X(1).
  2351      03 OPNYEARL                       PIC S9(4) COMP.
  2352      03 OPNYEARF                       PIC X.
  2353      03 FILLER REDEFINES OPNYEARF.
  2354         05 OPNYEARA                       PIC X.
  2355      03 FILLER                         PIC X(4).
  2356      03 OPNYEARI                       PIC X(4).
  2357      03 OPNMONL                        PIC S9(4) COMP.
  2358      03 OPNMONF                        PIC X.
  2359      03 FILLER REDEFINES OPNMONF.
  2360         05 OPNMONA                        PIC X.
  2361      03 FILLER                         PIC X(4).
  2362      03 OPNMONI                        PIC X(2).
  2363      03 OPNDAYL                        PIC S9(4) COMP.
  2364      03 OPNDAYF                        PIC X.
  2365      03 FILLER REDEFINES OPNDAYF.
  2366         05 OPNDAYA                        PIC X.
  2367      03 FILLER                         PIC X(4).
  2368      03 OPNDAYI                        PIC X(2).
  2369      03 ACRDLIML                       PIC S9(4) COMP.
  2370      03 ACRDLIMF                       PIC X.
  2371      03 FILLER REDEFINES ACRDLIMF.
  2372         05 ACRDLIMA                       PIC X.
  2373      03 FILLER                         PIC X(4).
  2374      03 ACRDLIMI                       PIC X(15).
  2375      03 EXPYEARL                       PIC S9(4) COMP.
  2376      03 EXPYEARF                       PIC X.
  2377      03 FILLER REDEFINES EXPYEARF.
  2378         05 EXPYEARA                       PIC X.
  2379      03 FILLER                         PIC X(4).
  2380      03 EXPYEARI                       PIC X(4).
  2381      03 EXPMONL                        PIC S9(4) COMP.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  47
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COACTUP.cpy)
  2382      03 EXPMONF                        PIC X.
  2383      03 FILLER REDEFINES EXPMONF.
  2384         05 EXPMONA                        PIC X.
  2385      03 FILLER                         PIC X(4).
  2386      03 EXPMONI                        PIC X(2).
  2387      03 EXPDAYL                        PIC S9(4) COMP.
  2388      03 EXPDAYF                        PIC X.
  2389      03 FILLER REDEFINES EXPDAYF.
  2390         05 EXPDAYA                        PIC X.
  2391      03 FILLER                         PIC X(4).
  2392      03 EXPDAYI                        PIC X(2).
  2393      03 ACSHLIML                       PIC S9(4) COMP.
  2394      03 ACSHLIMF                       PIC X.
  2395      03 FILLER REDEFINES ACSHLIMF.
  2396         05 ACSHLIMA                       PIC X.
  2397      03 FILLER                         PIC X(4).
  2398      03 ACSHLIMI                       PIC X(15).
  2399      03 RISYEARL                       PIC S9(4) COMP.
  2400      03 RISYEARF                       PIC X.
  2401      03 FILLER REDEFINES RISYEARF.
  2402         05 RISYEARA                       PIC X.
  2403      03 FILLER                         PIC X(4).
  2404      03 RISYEARI                       PIC X(4).
  2405      03 RISMONL                        PIC S9(4) COMP.
  2406      03 RISMONF                        PIC X.
  2407      03 FILLER REDEFINES RISMONF.
  2408         05 RISMONA                        PIC X.
  2409      03 FILLER                         PIC X(4).
  2410      03 RISMONI                        PIC X(2).
  2411      03 RISDAYL                        PIC S9(4) COMP.
  2412      03 RISDAYF                        PIC X.
  2413      03 FILLER REDEFINES RISDAYF.
  2414         05 RISDAYA                        PIC X.
  2415      03 FILLER                         PIC X(4).
  2416      03 RISDAYI                        PIC X(2).
  2417      03 ACURBALL                       PIC S9(4) COMP.
  2418      03 ACURBALF                       PIC X.
  2419      03 FILLER REDEFINES ACURBALF.
  2420         05 ACURBALA                       PIC X.
  2421      03 FILLER                         PIC X(4).
  2422      03 ACURBALI                       PIC X(15).
  2423      03 ACRCYCRL                       PIC S9(4) COMP.
  2424      03 ACRCYCRF                       PIC X.
  2425      03 FILLER REDEFINES ACRCYCRF.
  2426         05 ACRCYCRA                       PIC X.
  2427      03 FILLER                         PIC X(4).
  2428      03 ACRCYCRI                       PIC X(15).
  2429      03 AADDGRPL                       PIC S9(4) COMP.
  2430      03 AADDGRPF                       PIC X.
  2431      03 FILLER REDEFINES AADDGRPF.
  2432         05 AADDGRPA                       PIC X.
  2433      03 FILLER                         PIC X(4).
  2434      03 AADDGRPI                       PIC X(10).
  2435      03 ACRCYDBL                       PIC S9(4) COMP.
  2436      03 ACRCYDBF                       PIC X.
  2437      03 FILLER REDEFINES ACRCYDBF.
  2438         05 ACRCYDBA                       PIC X.
  2439      03 FILLER                         PIC X(4).
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  48
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COACTUP.cpy)
  2440      03 ACRCYDBI                       PIC X(15).
  2441      03 ACSTNUML                       PIC S9(4) COMP.
  2442      03 ACSTNUMF                       PIC X.
  2443      03 FILLER REDEFINES ACSTNUMF.
  2444         05 ACSTNUMA                       PIC X.
  2445      03 FILLER                         PIC X(4).
  2446      03 ACSTNUMI                       PIC X(9).
  2447      03 ACTSSN1L                       PIC S9(4) COMP.
  2448      03 ACTSSN1F                       PIC X.
  2449      03 FILLER REDEFINES ACTSSN1F.
  2450         05 ACTSSN1A                       PIC X.
  2451      03 FILLER                         PIC X(4).
  2452      03 ACTSSN1I                       PIC X(3).
  2453      03 ACTSSN2L                       PIC S9(4) COMP.
  2454      03 ACTSSN2F                       PIC X.
  2455      03 FILLER REDEFINES ACTSSN2F.
  2456         05 ACTSSN2A                       PIC X.
  2457      03 FILLER                         PIC X(4).
  2458      03 ACTSSN2I                       PIC X(2).
  2459      03 ACTSSN3L                       PIC S9(4) COMP.
  2460      03 ACTSSN3F                       PIC X.
  2461      03 FILLER REDEFINES ACTSSN3F.
  2462         05 ACTSSN3A                       PIC X.
  2463      03 FILLER                         PIC X(4).
  2464      03 ACTSSN3I                       PIC X(4).
  2465      03 DOBYEARL                       PIC S9(4) COMP.
  2466      03 DOBYEARF                       PIC X.
  2467      03 FILLER REDEFINES DOBYEARF.
  2468         05 DOBYEARA                       PIC X.
  2469      03 FILLER                         PIC X(4).
  2470      03 DOBYEARI                       PIC X(4).
  2471      03 DOBMONL                        PIC S9(4) COMP.
  2472      03 DOBMONF                        PIC X.
  2473      03 FILLER REDEFINES DOBMONF.
  2474         05 DOBMONA                        PIC X.
  2475      03 FILLER                         PIC X(4).
  2476      03 DOBMONI                        PIC X(2).
  2477      03 DOBDAYL                        PIC S9(4) COMP.
  2478      03 DOBDAYF                        PIC X.
  2479      03 FILLER REDEFINES DOBDAYF.
  2480         05 DOBDAYA                        PIC X.
  2481      03 FILLER                         PIC X(4).
  2482      03 DOBDAYI                        PIC X(2).
  2483      03 ACSTFCOL                       PIC S9(4) COMP.
  2484      03 ACSTFCOF                       PIC X.
  2485      03 FILLER REDEFINES ACSTFCOF.
  2486         05 ACSTFCOA                       PIC X.
  2487      03 FILLER                         PIC X(4).
  2488      03 ACSTFCOI                       PIC X(3).
  2489      03 ACSFNAML                       PIC S9(4) COMP.
  2490      03 ACSFNAMF                       PIC X.
  2491      03 FILLER REDEFINES ACSFNAMF.
  2492         05 ACSFNAMA                       PIC X.
  2493      03 FILLER                         PIC X(4).
  2494      03 ACSFNAMI                       PIC X(25).
  2495      03 ACSMNAML                       PIC S9(4) COMP.
  2496      03 ACSMNAMF                       PIC X.
  2497      03 FILLER REDEFINES ACSMNAMF.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  49
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COACTUP.cpy)
  2498         05 ACSMNAMA                       PIC X.
  2499      03 FILLER                         PIC X(4).
  2500      03 ACSMNAMI                       PIC X(25).
  2501      03 ACSLNAML                       PIC S9(4) COMP.
  2502      03 ACSLNAMF                       PIC X.
  2503      03 FILLER REDEFINES ACSLNAMF.
  2504         05 ACSLNAMA                       PIC X.
  2505      03 FILLER                         PIC X(4).
  2506      03 ACSLNAMI                       PIC X(25).
  2507      03 ACSADL1L                       PIC S9(4) COMP.
  2508      03 ACSADL1F                       PIC X.
  2509      03 FILLER REDEFINES ACSADL1F.
  2510         05 ACSADL1A                       PIC X.
  2511      03 FILLER                         PIC X(4).
  2512      03 ACSADL1I                       PIC X(50).
  2513      03 ACSSTTEL                       PIC S9(4) COMP.
  2514      03 ACSSTTEF                       PIC X.
  2515      03 FILLER REDEFINES ACSSTTEF.
  2516         05 ACSSTTEA                       PIC X.
  2517      03 FILLER                         PIC X(4).
  2518      03 ACSSTTEI                       PIC X(2).
  2519      03 ACSADL2L                       PIC S9(4) COMP.
  2520      03 ACSADL2F                       PIC X.
  2521      03 FILLER REDEFINES ACSADL2F.
  2522         05 ACSADL2A                       PIC X.
  2523      03 FILLER                         PIC X(4).
  2524      03 ACSADL2I                       PIC X(50).
  2525      03 ACSZIPCL                       PIC S9(4) COMP.
  2526      03 ACSZIPCF                       PIC X.
  2527      03 FILLER REDEFINES ACSZIPCF.
  2528         05 ACSZIPCA                       PIC X.
  2529      03 FILLER                         PIC X(4).
  2530      03 ACSZIPCI                       PIC X(5).
  2531      03 ACSCITYL                       PIC S9(4) COMP.
  2532      03 ACSCITYF                       PIC X.
  2533      03 FILLER REDEFINES ACSCITYF.
  2534         05 ACSCITYA                       PIC X.
  2535      03 FILLER                         PIC X(4).
  2536      03 ACSCITYI                       PIC X(50).
  2537      03 ACSCTRYL                       PIC S9(4) COMP.
  2538      03 ACSCTRYF                       PIC X.
  2539      03 FILLER REDEFINES ACSCTRYF.
  2540         05 ACSCTRYA                       PIC X.
  2541      03 FILLER                         PIC X(4).
  2542      03 ACSCTRYI                       PIC X(3).
  2543      03 ACSPH1AL                       PIC S9(4) COMP.
  2544      03 ACSPH1AF                       PIC X.
  2545      03 FILLER REDEFINES ACSPH1AF.
  2546         05 ACSPH1AA                       PIC X.
  2547      03 FILLER                         PIC X(4).
  2548      03 ACSPH1AI                       PIC X(3).
  2549      03 ACSPH1BL                       PIC S9(4) COMP.
  2550      03 ACSPH1BF                       PIC X.
  2551      03 FILLER REDEFINES ACSPH1BF.
  2552         05 ACSPH1BA                       PIC X.
  2553      03 FILLER                         PIC X(4).
  2554      03 ACSPH1BI                       PIC X(3).
  2555      03 ACSPH1CL                       PIC S9(4) COMP.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  50
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COACTUP.cpy)
  2556      03 ACSPH1CF                       PIC X.
  2557      03 FILLER REDEFINES ACSPH1CF.
  2558         05 ACSPH1CA                       PIC X.
  2559      03 FILLER                         PIC X(4).
  2560      03 ACSPH1CI                       PIC X(4).
  2561      03 ACSGOVTL                       PIC S9(4) COMP.
  2562      03 ACSGOVTF                       PIC X.
  2563      03 FILLER REDEFINES ACSGOVTF.
  2564         05 ACSGOVTA                       PIC X.
  2565      03 FILLER                         PIC X(4).
  2566      03 ACSGOVTI                       PIC X(20).
  2567      03 ACSPH2AL                       PIC S9(4) COMP.
  2568      03 ACSPH2AF                       PIC X.
  2569      03 FILLER REDEFINES ACSPH2AF.
  2570         05 ACSPH2AA                       PIC X.
  2571      03 FILLER                         PIC X(4).
  2572      03 ACSPH2AI                       PIC X(3).
  2573      03 ACSPH2BL                       PIC S9(4) COMP.
  2574      03 ACSPH2BF                       PIC X.
  2575      03 FILLER REDEFINES ACSPH2BF.
  2576         05 ACSPH2BA                       PIC X.
  2577      03 FILLER                         PIC X(4).
  2578      03 ACSPH2BI                       PIC X(3).
  2579      03 ACSPH2CL                       PIC S9(4) COMP.
  2580      03 ACSPH2CF                       PIC X.
  2581      03 FILLER REDEFINES ACSPH2CF.
  2582         05 ACSPH2CA                       PIC X.
  2583      03 FILLER                         PIC X(4).
  2584      03 ACSPH2CI                       PIC X(4).
  2585      03 ACSEFTCL                       PIC S9(4) COMP.
  2586      03 ACSEFTCF                       PIC X.
  2587      03 FILLER REDEFINES ACSEFTCF.
  2588         05 ACSEFTCA                       PIC X.
  2589      03 FILLER                         PIC X(4).
  2590      03 ACSEFTCI                       PIC X(10).
  2591      03 ACSPFLGL                       PIC S9(4) COMP.
  2592      03 ACSPFLGF                       PIC X.
  2593      03 FILLER REDEFINES ACSPFLGF.
  2594         05 ACSPFLGA                       PIC X.
  2595      03 FILLER                         PIC X(4).
  2596      03 ACSPFLGI                       PIC X(1).
  2597      03 INFOMSGL                       PIC S9(4) COMP.
  2598      03 INFOMSGF                       PIC X.
  2599      03 FILLER REDEFINES INFOMSGF.
  2600         05 INFOMSGA                       PIC X.
  2601      03 FILLER                         PIC X(4).
  2602      03 INFOMSGI                       PIC X(45).
  2603      03 ERRMSGL                        PIC S9(4) COMP.
  2604      03 ERRMSGF                        PIC X.
  2605      03 FILLER REDEFINES ERRMSGF.
  2606         05 ERRMSGA                        PIC X.
  2607      03 FILLER                         PIC X(4).
  2608      03 ERRMSGI                        PIC X(78).
  2609      03 FKEYSL                         PIC S9(4) COMP.
  2610      03 FKEYSF                         PIC X.
  2611      03 FILLER REDEFINES FKEYSF.
  2612         05 FKEYSA                         PIC X.
  2613      03 FILLER                         PIC X(4).
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  51
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COACTUP.cpy)
  2614      03 FKEYSI                         PIC X(21).
  2615      03 FKEY05L                        PIC S9(4) COMP.
  2616      03 FKEY05F                        PIC X.
  2617      03 FILLER REDEFINES FKEY05F.
  2618         05 FKEY05A                        PIC X.
  2619      03 FILLER                         PIC X(4).
  2620      03 FKEY05I                        PIC X(7).
  2621      03 FKEY12L                        PIC S9(4) COMP.
  2622      03 FKEY12F                        PIC X.
  2623      03 FILLER REDEFINES FKEY12F.
  2624         05 FKEY12A                        PIC X.
  2625      03 FILLER                         PIC X(4).
  2626      03 FKEY12I                        PIC X(10).
  2627
  2628*  Output Data For Map CACTUPA
  2629   01 CACTUPAO REDEFINES CACTUPAI.
  2630      03 FILLER                         PIC X(12).
  2631      03 FILLER                         PIC X(3).
  2632      03 TRNNAMEC                       PIC X.
  2633      03 TRNNAMEP                       PIC X.
  2634      03 TRNNAMEH                       PIC X.
  2635      03 TRNNAMEV                       PIC X.
  2636      03 TRNNAMEO                       PIC X(4).
  2637      03 FILLER                         PIC X(3).
  2638      03 TITLE01C                       PIC X.
  2639      03 TITLE01P                       PIC X.
  2640      03 TITLE01H                       PIC X.
  2641      03 TITLE01V                       PIC X.
  2642      03 TITLE01O                       PIC X(40).
  2643      03 FILLER                         PIC X(3).
  2644      03 CURDATEC                       PIC X.
  2645      03 CURDATEP                       PIC X.
  2646      03 CURDATEH                       PIC X.
  2647      03 CURDATEV                       PIC X.
  2648      03 CURDATEO                       PIC X(8).
  2649      03 FILLER                         PIC X(3).
  2650      03 PGMNAMEC                       PIC X.
  2651      03 PGMNAMEP                       PIC X.
  2652      03 PGMNAMEH                       PIC X.
  2653      03 PGMNAMEV                       PIC X.
  2654      03 PGMNAMEO                       PIC X(8).
  2655      03 FILLER                         PIC X(3).
  2656      03 TITLE02C                       PIC X.
  2657      03 TITLE02P                       PIC X.
  2658      03 TITLE02H                       PIC X.
  2659      03 TITLE02V                       PIC X.
  2660      03 TITLE02O                       PIC X(40).
  2661      03 FILLER                         PIC X(3).
  2662      03 CURTIMEC                       PIC X.
  2663      03 CURTIMEP                       PIC X.
  2664      03 CURTIMEH                       PIC X.
  2665      03 CURTIMEV                       PIC X.
  2666      03 CURTIMEO                       PIC X(8).
  2667      03 FILLER                         PIC X(3).
  2668      03 ACCTSIDC                       PIC X.
  2669      03 ACCTSIDP                       PIC X.
  2670      03 ACCTSIDH                       PIC X.
  2671      03 ACCTSIDV                       PIC X.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  52
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COACTUP.cpy)
  2672      03 ACCTSIDO                       PIC X(11).
  2673      03 FILLER                         PIC X(3).
  2674      03 ACSTTUSC                       PIC X.
  2675      03 ACSTTUSP                       PIC X.
  2676      03 ACSTTUSH                       PIC X.
  2677      03 ACSTTUSV                       PIC X.
  2678      03 ACSTTUSO                       PIC X(1).
  2679      03 FILLER                         PIC X(3).
  2680      03 OPNYEARC                       PIC X.
  2681      03 OPNYEARP                       PIC X.
  2682      03 OPNYEARH                       PIC X.
  2683      03 OPNYEARV                       PIC X.
  2684      03 OPNYEARO                       PIC X(4).
  2685      03 FILLER                         PIC X(3).
  2686      03 OPNMONC                        PIC X.
  2687      03 OPNMONP                        PIC X.
  2688      03 OPNMONH                        PIC X.
  2689      03 OPNMONV                        PIC X.
  2690      03 OPNMONO                        PIC X(2).
  2691      03 FILLER                         PIC X(3).
  2692      03 OPNDAYC                        PIC X.
  2693      03 OPNDAYP                        PIC X.
  2694      03 OPNDAYH                        PIC X.
  2695      03 OPNDAYV                        PIC X.
  2696      03 OPNDAYO                        PIC X(2).
  2697      03 FILLER                         PIC X(3).
  2698      03 ACRDLIMC                       PIC X.
  2699      03 ACRDLIMP                       PIC X.
  2700      03 ACRDLIMH                       PIC X.
  2701      03 ACRDLIMV                       PIC X.
  2702      03 ACRDLIMO                       PIC X(15).
  2703      03 FILLER                         PIC X(3).
  2704      03 EXPYEARC                       PIC X.
  2705      03 EXPYEARP                       PIC X.
  2706      03 EXPYEARH                       PIC X.
  2707      03 EXPYEARV                       PIC X.
  2708      03 EXPYEARO                       PIC X(4).
  2709      03 FILLER                         PIC X(3).
  2710      03 EXPMONC                        PIC X.
  2711      03 EXPMONP                        PIC X.
  2712      03 EXPMONH                        PIC X.
  2713      03 EXPMONV                        PIC X.
  2714      03 EXPMONO                        PIC X(2).
  2715      03 FILLER                         PIC X(3).
  2716      03 EXPDAYC                        PIC X.
  2717      03 EXPDAYP                        PIC X.
  2718      03 EXPDAYH                        PIC X.
  2719      03 EXPDAYV                        PIC X.
  2720      03 EXPDAYO                        PIC X(2).
  2721      03 FILLER                         PIC X(3).
  2722      03 ACSHLIMC                       PIC X.
  2723      03 ACSHLIMP                       PIC X.
  2724      03 ACSHLIMH                       PIC X.
  2725      03 ACSHLIMV                       PIC X.
  2726      03 ACSHLIMO                       PIC X(15).
  2727      03 FILLER                         PIC X(3).
  2728      03 RISYEARC                       PIC X.
  2729      03 RISYEARP                       PIC X.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  53
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COACTUP.cpy)
  2730      03 RISYEARH                       PIC X.
  2731      03 RISYEARV                       PIC X.
  2732      03 RISYEARO                       PIC X(4).
  2733      03 FILLER                         PIC X(3).
  2734      03 RISMONC                        PIC X.
  2735      03 RISMONP                        PIC X.
  2736      03 RISMONH                        PIC X.
  2737      03 RISMONV                        PIC X.
  2738      03 RISMONO                        PIC X(2).
  2739      03 FILLER                         PIC X(3).
  2740      03 RISDAYC                        PIC X.
  2741      03 RISDAYP                        PIC X.
  2742      03 RISDAYH                        PIC X.
  2743      03 RISDAYV                        PIC X.
  2744      03 RISDAYO                        PIC X(2).
  2745      03 FILLER                         PIC X(3).
  2746      03 ACURBALC                       PIC X.
  2747      03 ACURBALP                       PIC X.
  2748      03 ACURBALH                       PIC X.
  2749      03 ACURBALV                       PIC X.
  2750      03 ACURBALO                       PIC X(15).
  2751      03 FILLER                         PIC X(3).
  2752      03 ACRCYCRC                       PIC X.
  2753      03 ACRCYCRP                       PIC X.
  2754      03 ACRCYCRH                       PIC X.
  2755      03 ACRCYCRV                       PIC X.
  2756      03 ACRCYCRO                       PIC X(15).
  2757      03 FILLER                         PIC X(3).
  2758      03 AADDGRPC                       PIC X.
  2759      03 AADDGRPP                       PIC X.
  2760      03 AADDGRPH                       PIC X.
  2761      03 AADDGRPV                       PIC X.
  2762      03 AADDGRPO                       PIC X(10).
  2763      03 FILLER                         PIC X(3).
  2764      03 ACRCYDBC                       PIC X.
  2765      03 ACRCYDBP                       PIC X.
  2766      03 ACRCYDBH                       PIC X.
  2767      03 ACRCYDBV                       PIC X.
  2768      03 ACRCYDBO                       PIC X(15).
  2769      03 FILLER                         PIC X(3).
  2770      03 ACSTNUMC                       PIC X.
  2771      03 ACSTNUMP                       PIC X.
  2772      03 ACSTNUMH                       PIC X.
  2773      03 ACSTNUMV                       PIC X.
  2774      03 ACSTNUMO                       PIC X(9).
  2775      03 FILLER                         PIC X(3).
  2776      03 ACTSSN1C                       PIC X.
  2777      03 ACTSSN1P                       PIC X.
  2778      03 ACTSSN1H                       PIC X.
  2779      03 ACTSSN1V                       PIC X.
  2780      03 ACTSSN1O                       PIC X(3).
  2781      03 FILLER                         PIC X(3).
  2782      03 ACTSSN2C                       PIC X.
  2783      03 ACTSSN2P                       PIC X.
  2784      03 ACTSSN2H                       PIC X.
  2785      03 ACTSSN2V                       PIC X.
  2786      03 ACTSSN2O                       PIC X(2).
  2787      03 FILLER                         PIC X(3).
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  54
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COACTUP.cpy)
  2788      03 ACTSSN3C                       PIC X.
  2789      03 ACTSSN3P                       PIC X.
  2790      03 ACTSSN3H                       PIC X.
  2791      03 ACTSSN3V                       PIC X.
  2792      03 ACTSSN3O                       PIC X(4).
  2793      03 FILLER                         PIC X(3).
  2794      03 DOBYEARC                       PIC X.
  2795      03 DOBYEARP                       PIC X.
  2796      03 DOBYEARH                       PIC X.
  2797      03 DOBYEARV                       PIC X.
  2798      03 DOBYEARO                       PIC X(4).
  2799      03 FILLER                         PIC X(3).
  2800      03 DOBMONC                        PIC X.
  2801      03 DOBMONP                        PIC X.
  2802      03 DOBMONH                        PIC X.
  2803      03 DOBMONV                        PIC X.
  2804      03 DOBMONO                        PIC X(2).
  2805      03 FILLER                         PIC X(3).
  2806      03 DOBDAYC                        PIC X.
  2807      03 DOBDAYP                        PIC X.
  2808      03 DOBDAYH                        PIC X.
  2809      03 DOBDAYV                        PIC X.
  2810      03 DOBDAYO                        PIC X(2).
  2811      03 FILLER                         PIC X(3).
  2812      03 ACSTFCOC                       PIC X.
  2813      03 ACSTFCOP                       PIC X.
  2814      03 ACSTFCOH                       PIC X.
  2815      03 ACSTFCOV                       PIC X.
  2816      03 ACSTFCOO                       PIC X(3).
  2817      03 FILLER                         PIC X(3).
  2818      03 ACSFNAMC                       PIC X.
  2819      03 ACSFNAMP                       PIC X.
  2820      03 ACSFNAMH                       PIC X.
  2821      03 ACSFNAMV                       PIC X.
  2822      03 ACSFNAMO                       PIC X(25).
  2823      03 FILLER                         PIC X(3).
  2824      03 ACSMNAMC                       PIC X.
  2825      03 ACSMNAMP                       PIC X.
  2826      03 ACSMNAMH                       PIC X.
  2827      03 ACSMNAMV                       PIC X.
  2828      03 ACSMNAMO                       PIC X(25).
  2829      03 FILLER                         PIC X(3).
  2830      03 ACSLNAMC                       PIC X.
  2831      03 ACSLNAMP                       PIC X.
  2832      03 ACSLNAMH                       PIC X.
  2833      03 ACSLNAMV                       PIC X.
  2834      03 ACSLNAMO                       PIC X(25).
  2835      03 FILLER                         PIC X(3).
  2836      03 ACSADL1C                       PIC X.
  2837      03 ACSADL1P                       PIC X.
  2838      03 ACSADL1H                       PIC X.
  2839      03 ACSADL1V                       PIC X.
  2840      03 ACSADL1O                       PIC X(50).
  2841      03 FILLER                         PIC X(3).
  2842      03 ACSSTTEC                       PIC X.
  2843      03 ACSSTTEP                       PIC X.
  2844      03 ACSSTTEH                       PIC X.
  2845      03 ACSSTTEV                       PIC X.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  55
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COACTUP.cpy)
  2846      03 ACSSTTEO                       PIC X(2).
  2847      03 FILLER                         PIC X(3).
  2848      03 ACSADL2C                       PIC X.
  2849      03 ACSADL2P                       PIC X.
  2850      03 ACSADL2H                       PIC X.
  2851      03 ACSADL2V                       PIC X.
  2852      03 ACSADL2O                       PIC X(50).
  2853      03 FILLER                         PIC X(3).
  2854      03 ACSZIPCC                       PIC X.
  2855      03 ACSZIPCP                       PIC X.
  2856      03 ACSZIPCH                       PIC X.
  2857      03 ACSZIPCV                       PIC X.
  2858      03 ACSZIPCO                       PIC X(5).
  2859      03 FILLER                         PIC X(3).
  2860      03 ACSCITYC                       PIC X.
  2861      03 ACSCITYP                       PIC X.
  2862      03 ACSCITYH                       PIC X.
  2863      03 ACSCITYV                       PIC X.
  2864      03 ACSCITYO                       PIC X(50).
  2865      03 FILLER                         PIC X(3).
  2866      03 ACSCTRYC                       PIC X.
  2867      03 ACSCTRYP                       PIC X.
  2868      03 ACSCTRYH                       PIC X.
  2869      03 ACSCTRYV                       PIC X.
  2870      03 ACSCTRYO                       PIC X(3).
  2871      03 FILLER                         PIC X(3).
  2872      03 ACSPH1AC                       PIC X.
  2873      03 ACSPH1AP                       PIC X.
  2874      03 ACSPH1AH                       PIC X.
  2875      03 ACSPH1AV                       PIC X.
  2876      03 ACSPH1AO                       PIC X(3).
  2877      03 FILLER                         PIC X(3).
  2878      03 ACSPH1BC                       PIC X.
  2879      03 ACSPH1BP                       PIC X.
  2880      03 ACSPH1BH                       PIC X.
  2881      03 ACSPH1BV                       PIC X.
  2882      03 ACSPH1BO                       PIC X(3).
  2883      03 FILLER                         PIC X(3).
  2884      03 ACSPH1CC                       PIC X.
  2885      03 ACSPH1CP                       PIC X.
  2886      03 ACSPH1CH                       PIC X.
  2887      03 ACSPH1CV                       PIC X.
  2888      03 ACSPH1CO                       PIC X(4).
  2889      03 FILLER                         PIC X(3).
  2890      03 ACSGOVTC                       PIC X.
  2891      03 ACSGOVTP                       PIC X.
  2892      03 ACSGOVTH                       PIC X.
  2893      03 ACSGOVTV                       PIC X.
  2894      03 ACSGOVTO                       PIC X(20).
  2895      03 FILLER                         PIC X(3).
  2896      03 ACSPH2AC                       PIC X.
  2897      03 ACSPH2AP                       PIC X.
  2898      03 ACSPH2AH                       PIC X.
  2899      03 ACSPH2AV                       PIC X.
  2900      03 ACSPH2AO                       PIC X(3).
  2901      03 FILLER                         PIC X(3).
  2902      03 ACSPH2BC                       PIC X.
  2903      03 ACSPH2BP                       PIC X.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  56
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COACTUP.cpy)
  2904      03 ACSPH2BH                       PIC X.
  2905      03 ACSPH2BV                       PIC X.
  2906      03 ACSPH2BO                       PIC X(3).
  2907      03 FILLER                         PIC X(3).
  2908      03 ACSPH2CC                       PIC X.
  2909      03 ACSPH2CP                       PIC X.
  2910      03 ACSPH2CH                       PIC X.
  2911      03 ACSPH2CV                       PIC X.
  2912      03 ACSPH2CO                       PIC X(4).
  2913      03 FILLER                         PIC X(3).
  2914      03 ACSEFTCC                       PIC X.
  2915      03 ACSEFTCP                       PIC X.
  2916      03 ACSEFTCH                       PIC X.
  2917      03 ACSEFTCV                       PIC X.
  2918      03 ACSEFTCO                       PIC X(10).
  2919      03 FILLER                         PIC X(3).
  2920      03 ACSPFLGC                       PIC X.
  2921      03 ACSPFLGP                       PIC X.
  2922      03 ACSPFLGH                       PIC X.
  2923      03 ACSPFLGV                       PIC X.
  2924      03 ACSPFLGO                       PIC X(1).
  2925      03 FILLER                         PIC X(3).
  2926      03 INFOMSGC                       PIC X.
  2927      03 INFOMSGP                       PIC X.
  2928      03 INFOMSGH                       PIC X.
  2929      03 INFOMSGV                       PIC X.
  2930      03 INFOMSGO                       PIC X(45).
  2931      03 FILLER                         PIC X(3).
  2932      03 ERRMSGC                        PIC X.
  2933      03 ERRMSGP                        PIC X.
  2934      03 ERRMSGH                        PIC X.
  2935      03 ERRMSGV                        PIC X.
  2936      03 ERRMSGO                        PIC X(78).
  2937      03 FILLER                         PIC X(3).
  2938      03 FKEYSC                         PIC X.
  2939      03 FKEYSP                         PIC X.
  2940      03 FKEYSH                         PIC X.
  2941      03 FKEYSV                         PIC X.
  2942      03 FKEYSO                         PIC X(21).
  2943      03 FILLER                         PIC X(3).
  2944      03 FKEY05C                        PIC X.
  2945      03 FKEY05P                        PIC X.
  2946      03 FKEY05H                        PIC X.
  2947      03 FKEY05V                        PIC X.
  2948      03 FKEY05O                        PIC X(7).
  2949      03 FILLER                         PIC X(3).
  2950      03 FKEY12C                        PIC X.
  2951      03 FKEY12P                        PIC X.
  2952      03 FKEY12H                        PIC X.
  2953      03 FKEY12V                        PIC X.
  2954      03 FKEY12O                        PIC X(10).
  2955
  2956
  2957*Current Date
  2958*COPY CSDAT01Y.
  2959 01 WS-DATE-TIME.
  2960   05 WS-CURDATE-DATA.
  2961     10  WS-CURDATE.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  57
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSDAT01Y.c)
  2962       15  WS-CURDATE-YEAR         PIC 9(04).
  2963       15  WS-CURDATE-MONTH        PIC 9(02).
  2964       15  WS-CURDATE-DAY          PIC 9(02).
  2965     10 WS-CURDATE-N REDEFINES WS-CURDATE PIC 9(08).
  2966     10  WS-CURTIME.
  2967       15  WS-CURTIME-HOURS        PIC 9(02).
  2968       15  WS-CURTIME-MINUTE       PIC 9(02).
  2969       15  WS-CURTIME-SECOND       PIC 9(02).
  2970       15  WS-CURTIME-MILSEC       PIC 9(02).
  2971     10 WS-CURTIME-N REDEFINES WS-CURTIME PIC 9(08).
  2972   05 WS-CURDATE-MM-DD-YY.
  2973     10  WS-CURDATE-MM             PIC 9(02).
  2974     10  FILLER                    PIC X(01) VALUE '/'.
  2975     10  WS-CURDATE-DD             PIC 9(02).
  2976     10  FILLER                    PIC X(01) VALUE '/'.
  2977     10  WS-CURDATE-YY             PIC 9(02).
  2978   05 WS-CURTIME-HH-MM-SS.
  2979     10  WS-CURTIME-HH             PIC 9(02).
  2980     10  FILLER                    PIC X(01) VALUE ':'.
  2981     10  WS-CURTIME-MM             PIC 9(02).
  2982     10  FILLER                    PIC X(01) VALUE ':'.
  2983     10  WS-CURTIME-SS             PIC 9(02).
  2984   05 WS-TIMESTAMP.
  2985     10  WS-TIMESTAMP-DT-YYYY      PIC 9(04).
  2986     10  FILLER                    PIC X(01) VALUE '-'.
  2987     10  WS-TIMESTAMP-DT-MM        PIC 9(02).
  2988     10  FILLER                    PIC X(01) VALUE '-'.
  2989     10  WS-TIMESTAMP-DT-DD        PIC 9(02).
  2990     10  FILLER                    PIC X(01) VALUE ' '.
  2991     10  WS-TIMESTAMP-TM-HH        PIC 9(02).
  2992     10  FILLER                    PIC X(01) VALUE ':'.
  2993     10  WS-TIMESTAMP-TM-MM        PIC 9(02).
  2994     10  FILLER                    PIC X(01) VALUE ':'.
  2995     10  WS-TIMESTAMP-TM-SS        PIC 9(02).
  2996     10  FILLER                    PIC X(01) VALUE '.'.
  2997     10  WS-TIMESTAMP-TM-MS6       PIC 9(06).
  2998*
  2999* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT
  3000*
  3001
  3002*Common Messages
  3003*COPY CSMSG01Y.
  3004 01 CCDA-COMMON-MESSAGES.
  3005   05 CCDA-MSG-THANK-YOU         PIC X(50) VALUE
  3006        'Thank you for using CardDemo application...      '.
  3007   05 CCDA-MSG-INVALID-KEY       PIC X(50) VALUE
  3008        'Invalid key pressed. Please see below...         '.
  3009*
  3010* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT
  3011*
  3012
  3013*Abend Variables
  3014*COPY CSMSG02Y.
  3015*Skeleton COBOL Copybook
  3016*****************************************************************
  3017* CABENDD.CPY                                                   *
  3018*---------------------------------------------------------------*
  3019* Work areas for abend routine                                  *
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  58
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSMSG02Y.c)
  3020*****************************************************************
  3021 01  ABEND-DATA.
  3022   05  ABEND-CODE                            PIC X(4)
  3023       VALUE SPACES.
  3024   05  ABEND-CULPRIT                         PIC X(8)
  3025       VALUE SPACES.
  3026   05  ABEND-REASON                          PIC X(50)
  3027       VALUE SPACES.
  3028   05  ABEND-MSG                             PIC X(72)
  3029       VALUE SPACES.
  3030
  3031
  3032
  3033*
  3034* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT
  3035*
  3036
  3037*Signed on user data
  3038*COPY CSUSR01Y.
  3039 01 SEC-USER-DATA.
  3040   05 SEC-USR-ID                 PIC X(08).
  3041   05 SEC-USR-FNAME              PIC X(20).
  3042   05 SEC-USR-LNAME              PIC X(20).
  3043   05 SEC-USR-PWD                PIC X(08).
  3044   05 SEC-USR-TYPE               PIC X(01).
  3045   05 SEC-USR-FILLER             PIC X(23).
  3046*
  3047* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:59 CDT
  3048*
  3049
  3050*Dataset layouts
  3051
  3052*ACCT RECORD LAYOUT
  3053*COPY CVACT01Y.
  3054*****************************************************************
  3055*    Data-structure for  account entity (RECLN 300)
  3056*****************************************************************
  3057 01  ACCOUNT-RECORD.
  3058     05  ACCT-ID                           PIC 9(11).
  3059     05  ACCT-ACTIVE-STATUS                PIC X(01).
  3060     05  ACCT-CURR-BAL                     PIC S9(10)V99.
  3061     05  ACCT-CREDIT-LIMIT                 PIC S9(10)V99.
  3062     05  ACCT-CASH-CREDIT-LIMIT            PIC S9(10)V99.
  3063     05  ACCT-OPEN-DATE                    PIC X(10).
  3064     05  ACCT-EXPIRAION-DATE               PIC X(10).
  3065     05  ACCT-REISSUE-DATE                 PIC X(10).
  3066     05  ACCT-CURR-CYC-CREDIT              PIC S9(10)V99.
  3067     05  ACCT-CURR-CYC-DEBIT               PIC S9(10)V99.
  3068     05  ACCT-ADDR-ZIP                     PIC X(10).
  3069     05  ACCT-GROUP-ID                     PIC X(10).
  3070     05  FILLER                            PIC X(178).
  3071*
  3072* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:59 CDT
  3073*
  3074
  3075*CARD XREF LAYOUT
  3076*COPY CVACT03Y.
  3077*****************************************************************
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  59
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CVACT03Y.c)
  3078*    Data-structure for card xref (RECLN 50)
  3079*****************************************************************
  3080 01 CARD-XREF-RECORD.
  3081     05  XREF-CARD-NUM                     PIC X(16).
  3082     05  XREF-CUST-ID                      PIC 9(09).
  3083     05  XREF-ACCT-ID                      PIC 9(11).
  3084     05  FILLER                            PIC X(14).
  3085*
  3086* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:00 CDT
  3087*
  3088
  3089*CUSTOMER LAYOUT
  3090*COPY CVCUS01Y.
  3091*****************************************************************
  3092*    Data-structure for Customer entity (RECLN 500)
  3093*****************************************************************
  3094 01  CUSTOMER-RECORD.
  3095     05  CUST-ID                                 PIC 9(09).
  3096     05  CUST-FIRST-NAME                         PIC X(25).
  3097     05  CUST-MIDDLE-NAME                        PIC X(25).
  3098     05  CUST-LAST-NAME                          PIC X(25).
  3099     05  CUST-ADDR-LINE-1                        PIC X(50).
  3100     05  CUST-ADDR-LINE-2                        PIC X(50).
  3101     05  CUST-ADDR-LINE-3                        PIC X(50).
  3102     05  CUST-ADDR-STATE-CD                      PIC X(02).
  3103     05  CUST-ADDR-COUNTRY-CD                    PIC X(03).
  3104     05  CUST-ADDR-ZIP                           PIC X(10).
  3105     05  CUST-PHONE-NUM-1                        PIC X(15).
  3106     05  CUST-PHONE-NUM-2                        PIC X(15).
  3107     05  CUST-SSN                                PIC 9(09).
  3108     05  CUST-GOVT-ISSUED-ID                     PIC X(20).
  3109     05  CUST-DOB-YYYY-MM-DD                     PIC X(10).
  3110     05  CUST-EFT-ACCOUNT-ID                     PIC X(10).
  3111     05  CUST-PRI-CARD-HOLDER-IND                PIC X(01).
  3112     05  CUST-FICO-CREDIT-SCORE                  PIC 9(03).
  3113     05  FILLER                                  PIC X(168).
  3114*
  3115* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:00 CDT
  3116*
  3117
  3118******************************************************************
  3119*Application Commmarea Copybook
  3120*COPY COCOM01Y.
  3121******************************************************************
  3122* Communication area for CardDemo application programs
  3123******************************************************************
  3124 01 CARDDEMO-COMMAREA.
  3125    05 CDEMO-GENERAL-INFO.
  3126       10 CDEMO-FROM-TRANID             PIC X(04).
  3127       10 CDEMO-FROM-PROGRAM            PIC X(08).
  3128       10 CDEMO-TO-TRANID               PIC X(04).
  3129       10 CDEMO-TO-PROGRAM              PIC X(08).
  3130       10 CDEMO-USER-ID                 PIC X(08).
  3131       10 CDEMO-USER-TYPE               PIC X(01).
  3132          88 CDEMO-USRTYP-ADMIN         VALUE 'A'.
  3133          88 CDEMO-USRTYP-USER          VALUE 'U'.
  3134       10 CDEMO-PGM-CONTEXT             PIC 9(01).
  3135          88 CDEMO-PGM-ENTER            VALUE 0.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  60
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/COCOM01Y.c)
  3136          88 CDEMO-PGM-REENTER          VALUE 1.
  3137    05 CDEMO-CUSTOMER-INFO.
  3138       10 CDEMO-CUST-ID                 PIC 9(09).
  3139       10 CDEMO-CUST-FNAME              PIC X(25).
  3140       10 CDEMO-CUST-MNAME              PIC X(25).
  3141       10 CDEMO-CUST-LNAME              PIC X(25).
  3142    05 CDEMO-ACCOUNT-INFO.
  3143       10 CDEMO-ACCT-ID                 PIC 9(11).
  3144       10 CDEMO-ACCT-STATUS             PIC X(01).
  3145    05 CDEMO-CARD-INFO.
  3146       10 CDEMO-CARD-NUM                PIC 9(16).
  3147    05 CDEMO-MORE-INFO.
  3148       10  CDEMO-LAST-MAP               PIC X(7).
  3149       10  CDEMO-LAST-MAPSET            PIC X(7).
  3150*
  3151* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:57 CDT
  3152*
  3153
  3154 01 WS-THIS-PROGCOMMAREA.
  3155    05 ACCT-UPDATE-SCREEN-DATA.
  3156       10 ACUP-CHANGE-ACTION                     PIC X(1)
  3157                                                 VALUE LOW-VALUES.
  3158          88 ACUP-DETAILS-NOT-FETCHED            VALUES
  3159                                                 LOW-VALUES,
  3160                                                 SPACES.
  3161          88 ACUP-SHOW-DETAILS                   VALUE 'S'.
  3162          88 ACUP-CHANGES-MADE                   VALUES 'E', 'N'
  3163                                                      , 'C', 'L'
  3164                                                      , 'F'.
  3165          88 ACUP-CHANGES-NOT-OK                 VALUE 'E'.
  3166          88 ACUP-CHANGES-OK-NOT-CONFIRMED       VALUE 'N'.
  3167          88 ACUP-CHANGES-OKAYED-AND-DONE        VALUE 'C'.
  3168          88 ACUP-CHANGES-FAILED                 VALUES 'L', 'F'.
  3169          88 ACUP-CHANGES-OKAYED-LOCK-ERROR      VALUE 'L'.
  3170          88 ACUP-CHANGES-OKAYED-BUT-FAILED      VALUE 'F'.
  3171    05 ACUP-OLD-DETAILS.
  3172       10 ACUP-OLD-ACCT-DATA.
  3173          15  ACUP-OLD-ACCT-ID-X                 PIC X(11).
  3174          15  ACUP-OLD-ACCT-ID                   REDEFINES
  3175              ACUP-OLD-ACCT-ID-X                 PIC 9(11).
  3176          15  ACUP-OLD-ACTIVE-STATUS             PIC X(01).
  3177          15  ACUP-OLD-CURR-BAL                  PIC X(12).
  3178          15  ACUP-OLD-CURR-BAL-N REDEFINES
  3179              ACUP-OLD-CURR-BAL                  PIC S9(10)V99.
  3180          15  ACUP-OLD-CREDIT-LIMIT              PIC X(12).
  3181          15  ACUP-OLD-CREDIT-LIMIT-N            REDEFINES
  3182              ACUP-OLD-CREDIT-LIMIT              PIC S9(10)V99.
  3183          15  ACUP-OLD-CASH-CREDIT-LIMIT         PIC X(12).
  3184          15  ACUP-OLD-CASH-CREDIT-LIMIT-N       REDEFINES
  3185              ACUP-OLD-CASH-CREDIT-LIMIT         PIC S9(10)V99.
  3186          15  ACUP-OLD-OPEN-DATE                 PIC X(08).
  3187          15  ACUP-OLD-OPEN-DATE-PARTS           REDEFINES
  3188              ACUP-OLD-OPEN-DATE.
  3189              20 ACUP-OLD-OPEN-YEAR              PIC X(4).
  3190              20 ACUP-OLD-OPEN-MON               PIC X(2).
  3191              20 ACUP-OLD-OPEN-DAY               PIC X(2).
  3192          15  ACUP-OLD-EXPIRAION-DATE            PIC X(08).
  3193          15  ACUP-OLD-EXPIRAION-DATE-PARTS      REDEFINES
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  61
* COACTUPC.cbl
  3194              ACUP-OLD-EXPIRAION-DATE.
  3195              20 ACUP-OLD-EXP-YEAR                PIC X(4).
  3196              20 ACUP-OLD-EXP-MON                 PIC X(2).
  3197              20 ACUP-OLD-EXP-DAY                 PIC X(2).
  3198          15  ACUP-OLD-REISSUE-DATE              PIC X(08).
  3199          15  ACUP-OLD-REISSUE-DATE-PARTS        REDEFINES
  3200              ACUP-OLD-REISSUE-DATE.
  3201              20 ACUP-OLD-REISSUE-YEAR           PIC X(4).
  3202              20 ACUP-OLD-REISSUE-MON            PIC X(2).
  3203              20 ACUP-OLD-REISSUE-DAY            PIC X(2).
  3204          15  ACUP-OLD-CURR-CYC-CREDIT           PIC X(12).
  3205          15  ACUP-OLD-CURR-CYC-CREDIT-N         REDEFINES
  3206              ACUP-OLD-CURR-CYC-CREDIT           PIC S9(10)V99.
  3207          15  ACUP-OLD-CURR-CYC-DEBIT            PIC X(12).
  3208          15  ACUP-OLD-CURR-CYC-DEBIT-N          REDEFINES
  3209              ACUP-OLD-CURR-CYC-DEBIT            PIC S9(10)V99.
  3210          15  ACUP-OLD-GROUP-ID                  PIC X(10).
  3211       10 ACUP-OLD-CUST-DATA.
  3212          15  ACUP-OLD-CUST-ID-X                 PIC X(09).
  3213          15  ACUP-OLD-CUST-ID                   REDEFINES
  3214              ACUP-OLD-CUST-ID-X                 PIC 9(09).
  3215          15  ACUP-OLD-CUST-FIRST-NAME           PIC X(25).
  3216          15  ACUP-OLD-CUST-MIDDLE-NAME          PIC X(25).
  3217          15  ACUP-OLD-CUST-LAST-NAME            PIC X(25).
  3218          15  ACUP-OLD-CUST-ADDR-LINE-1          PIC X(50).
  3219          15  ACUP-OLD-CUST-ADDR-LINE-2          PIC X(50).
  3220          15  ACUP-OLD-CUST-ADDR-LINE-3          PIC X(50).
  3221          15  ACUP-OLD-CUST-ADDR-STATE-CD        PIC X(02).
  3222          15  ACUP-OLD-CUST-ADDR-COUNTRY-CD      PIC X(03).
  3223          15  ACUP-OLD-CUST-ADDR-ZIP             PIC X(10).
  3224          15  ACUP-OLD-CUST-PHONE-NUM-1          PIC X(15).
  3225          15  ACUP-OLD-CUST-PHONE-NUM-1-X REDEFINES
  3226              ACUP-OLD-CUST-PHONE-NUM-1.
  3227              20 FILLER                          PIC X(1).
  3228              20 ACUP-OLD-CUST-PHONE-NUM-1A      PIC X(3).
  3229              20 FILLER                          PIC X(1).
  3230              20 ACUP-OLD-CUST-PHONE-NUM-1B      PIC X(3).
  3231              20 FILLER                          PIC X(1).
  3232              20 ACUP-OLD-CUST-PHONE-NUM-1C      PIC X(4).
  3233              20 FILLER                          PIC X(2).
  3234          15  ACUP-OLD-CUST-PHONE-NUM-2          PIC X(15).
  3235          15  ACUP-OLD-CUST-PHONE-NUM-2-X REDEFINES
  3236              ACUP-OLD-CUST-PHONE-NUM-2.
  3237              20 FILLER                          PIC X(1).
  3238              20 ACUP-OLD-CUST-PHONE-NUM-2A      PIC X(3).
  3239              20 FILLER                          PIC X(1).
  3240              20 ACUP-OLD-CUST-PHONE-NUM-2B      PIC X(3).
  3241              20 FILLER                          PIC X(1).
  3242              20 ACUP-OLD-CUST-PHONE-NUM-2C      PIC X(4).
  3243              20 FILLER                          PIC X(2).
  3244          15  ACUP-OLD-CUST-SSN-X                PIC X(09).
  3245          15  ACUP-OLD-CUST-SSN                  REDEFINES
  3246              ACUP-OLD-CUST-SSN-X                PIC 9(09).
  3247          15  ACUP-OLD-CUST-GOVT-ISSUED-ID       PIC X(20).
  3248          15  ACUP-OLD-CUST-DOB-YYYY-MM-DD       PIC X(08).
  3249          15  ACUP-OLD-CUST-DOB-PARTS            REDEFINES
  3250              ACUP-OLD-CUST-DOB-YYYY-MM-DD.
  3251              20 ACUP-OLD-CUST-DOB-YEAR          PIC X(4).
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  62
* COACTUPC.cbl
  3252              20 ACUP-OLD-CUST-DOB-MON           PIC X(2).
  3253              20 ACUP-OLD-CUST-DOB-DAY           PIC X(2).
  3254          15  ACUP-OLD-CUST-EFT-ACCOUNT-ID       PIC X(10).
  3255          15  ACUP-OLD-CUST-PRI-HOLDER-IND       PIC X(01).
  3256          15  ACUP-OLD-CUST-FICO-SCORE-X         PIC X(03).
  3257          15  ACUP-OLD-CUST-FICO-SCORE           REDEFINES
  3258              ACUP-OLD-CUST-FICO-SCORE-X         PIC 9(03).
  3259    05 ACUP-NEW-DETAILS.
  3260       10 ACUP-NEW-ACCT-DATA.
  3261          15  ACUP-NEW-ACCT-ID-X                 PIC X(11).
  3262          15  ACUP-NEW-ACCT-ID                   REDEFINES
  3263              ACUP-NEW-ACCT-ID-X                 PIC 9(11).
  3264          15  ACUP-NEW-ACTIVE-STATUS             PIC X(01).
  3265          15  ACUP-NEW-CURR-BAL                  PIC X(12).
  3266          15  ACUP-NEW-CURR-BAL-N                REDEFINES
  3267              ACUP-NEW-CURR-BAL                  PIC S9(10)V99.
  3268          15  ACUP-NEW-CREDIT-LIMIT              PIC X(12).
  3269          15  ACUP-NEW-CREDIT-LIMIT-N            REDEFINES
  3270              ACUP-NEW-CREDIT-LIMIT              PIC S9(10)V99.
  3271          15  ACUP-NEW-CASH-CREDIT-LIMIT         PIC X(12).
  3272          15  ACUP-NEW-CASH-CREDIT-LIMIT-N       REDEFINES
  3273              ACUP-NEW-CASH-CREDIT-LIMIT         PIC S9(10)V99.
  3274          15  ACUP-NEW-OPEN-DATE                 PIC X(08).
  3275          15  ACUP-NEW-OPEN-DATE-PARTS           REDEFINES
  3276              ACUP-NEW-OPEN-DATE.
  3277              20 ACUP-NEW-OPEN-YEAR              PIC X(4).
  3278              20 ACUP-NEW-OPEN-MON               PIC X(2).
  3279              20 ACUP-NEW-OPEN-DAY               PIC X(2).
  3280          15  ACUP-NEW-EXPIRAION-DATE            PIC X(08).
  3281          15  ACUP-NEW-EXPIRAION-DATE-PARTS      REDEFINES
  3282              ACUP-NEW-EXPIRAION-DATE.
  3283              20 ACUP-NEW-EXP-YEAR                PIC X(4).
  3284              20 ACUP-NEW-EXP-MON                 PIC X(2).
  3285              20 ACUP-NEW-EXP-DAY                 PIC X(2).
  3286          15  ACUP-NEW-REISSUE-DATE              PIC X(08).
  3287          15  ACUP-NEW-REISSUE-DATE-PARTS        REDEFINES
  3288              ACUP-NEW-REISSUE-DATE.
  3289              20 ACUP-NEW-REISSUE-YEAR           PIC X(4).
  3290              20 ACUP-NEW-REISSUE-MON            PIC X(2).
  3291              20 ACUP-NEW-REISSUE-DAY            PIC X(2).
  3292          15  ACUP-NEW-CURR-CYC-CREDIT           PIC X(12).
  3293          15  ACUP-NEW-CURR-CYC-CREDIT-N         REDEFINES
  3294              ACUP-NEW-CURR-CYC-CREDIT           PIC S9(10)V99.
  3295          15  ACUP-NEW-CURR-CYC-DEBIT            PIC X(12).
  3296          15  ACUP-NEW-CURR-CYC-DEBIT-N          REDEFINES
  3297              ACUP-NEW-CURR-CYC-DEBIT            PIC S9(10)V99.
  3298          15  ACUP-NEW-GROUP-ID                  PIC X(10).
  3299       10 ACUP-NEW-CUST-DATA.
  3300          15  ACUP-NEW-CUST-ID-X                 PIC X(09).
  3301          15  ACUP-NEW-CUST-ID                   REDEFINES
  3302              ACUP-NEW-CUST-ID-X                 PIC 9(09).
  3303          15  ACUP-NEW-CUST-FIRST-NAME           PIC X(25).
  3304          15  ACUP-NEW-CUST-MIDDLE-NAME          PIC X(25).
  3305          15  ACUP-NEW-CUST-LAST-NAME            PIC X(25).
  3306          15  ACUP-NEW-CUST-ADDR-LINE-1          PIC X(50).
  3307          15  ACUP-NEW-CUST-ADDR-LINE-2          PIC X(50).
  3308          15  ACUP-NEW-CUST-ADDR-LINE-3          PIC X(50).
  3309          15  ACUP-NEW-CUST-ADDR-STATE-CD        PIC X(02).
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  63
* COACTUPC.cbl
  3310          15  ACUP-NEW-CUST-ADDR-COUNTRY-CD      PIC X(03).
  3311          15  ACUP-NEW-CUST-ADDR-ZIP             PIC X(10).
  3312          15  ACUP-NEW-CUST-PHONE-NUM-1          PIC X(15).
  3313          15  ACUP-NEW-CUST-PHONE-NUM-1-X REDEFINES
  3314              ACUP-NEW-CUST-PHONE-NUM-1.
  3315              20 FILLER                          PIC X(1).
  3316              20 ACUP-NEW-CUST-PHONE-NUM-1A      PIC X(3).
  3317              20 FILLER                          PIC X(1).
  3318              20 ACUP-NEW-CUST-PHONE-NUM-1B      PIC X(3).
  3319              20 FILLER                          PIC X(1).
  3320              20 ACUP-NEW-CUST-PHONE-NUM-1C      PIC X(4).
  3321              20 FILLER                          PIC X(2).
  3322          15  ACUP-NEW-CUST-PHONE-NUM-2          PIC X(15).
  3323          15  ACUP-NEW-CUST-PHONE-NUM-2-X REDEFINES
  3324              ACUP-NEW-CUST-PHONE-NUM-2.
  3325              20 FILLER                          PIC X(1).
  3326              20 ACUP-NEW-CUST-PHONE-NUM-2A      PIC X(3).
  3327              20 FILLER                          PIC X(1).
  3328              20 ACUP-NEW-CUST-PHONE-NUM-2B      PIC X(3).
  3329              20 FILLER                          PIC X(1).
  3330              20 ACUP-NEW-CUST-PHONE-NUM-2C      PIC X(4).
  3331              20 FILLER                          PIC X(2).
  3332          15  ACUP-NEW-CUST-SSN-X.
  3333              20 ACUP-NEW-CUST-SSN-1             PIC X(03).
  3334              20 ACUP-NEW-CUST-SSN-2             PIC X(02).
  3335              20 ACUP-NEW-CUST-SSN-3             PIC X(04).
  3336          15  ACUP-NEW-CUST-SSN                  REDEFINES
  3337              ACUP-NEW-CUST-SSN-X                PIC 9(09).
  3338          15  ACUP-NEW-CUST-GOVT-ISSUED-ID       PIC X(20).
  3339          15  ACUP-NEW-CUST-DOB-YYYY-MM-DD       PIC X(08).
  3340          15  ACUP-NEW-CUST-DOB-PARTS            REDEFINES
  3341              ACUP-NEW-CUST-DOB-YYYY-MM-DD.
  3342              20 ACUP-NEW-CUST-DOB-YEAR          PIC X(4).
  3343              20 ACUP-NEW-CUST-DOB-MON           PIC X(2).
  3344              20 ACUP-NEW-CUST-DOB-DAY           PIC X(2).
  3345          15  ACUP-NEW-CUST-EFT-ACCOUNT-ID       PIC X(10).
  3346          15  ACUP-NEW-CUST-PRI-HOLDER-IND       PIC X(01).
  3347          15  ACUP-NEW-CUST-FICO-SCORE-X         PIC X(03).
  3348          15  ACUP-NEW-CUST-FICO-SCORE           REDEFINES
  3349              ACUP-NEW-CUST-FICO-SCORE-X         PIC 9(03).
  3350              88 FICO-RANGE-IS-VALID             VALUES 300
  3351                                                 THROUGH 850.
  3352 01  WS-COMMAREA                                 PIC X(2000).
  3353
  3354
  3355 LINKAGE SECTION.
  3356 01  DFHCOMMAREA.
  3357   05  FILLER                                PIC X(1)
  3358       OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.
  3359
*      EIBCALEN
**    COBCH0245S DEPENDING ON item EIBCALEN missing or illegal  : COACTUPC.cbl(850,58,51)
  3360 PROCEDURE DIVISION.
  3361 0000-MAIN.
  3362
  3363
  3364     EXEC CICS HANDLE ABEND
**    COBCH0301S Unrecognized verb  : COACTUPC.cbl(856,15,12)
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  64
* COACTUPC.cbl
  3365               LABEL(ABEND-ROUTINE)
  3366     END-EXEC
  3367
  3368     INITIALIZE CC-WORK-AREA
  3369                WS-MISC-STORAGE
  3370                WS-COMMAREA
  3371*****************************************************************
  3372* Store our context
  3373*****************************************************************
  3374     MOVE LIT-THISTRANID       TO WS-TRANID
  3375*****************************************************************
  3376* Ensure error message is cleared                               *
  3377*****************************************************************
  3378     SET WS-RETURN-MSG-OFF  TO TRUE
  3379*****************************************************************
  3380* Store passed data if  any                *
  3381*****************************************************************
  3382     IF EIBCALEN IS EQUAL TO 0
**    COBCH0012S Operand EIBCALEN is not declared  : COACTUPC.cbl(874,22,15)
  3383         OR (CDEMO-FROM-PROGRAM = LIT-MENUPGM
  3384         AND NOT CDEMO-PGM-REENTER)
  3385        INITIALIZE CARDDEMO-COMMAREA
  3386                   WS-THIS-PROGCOMMAREA
  3387        SET CDEMO-PGM-ENTER TO TRUE
  3388        SET ACUP-DETAILS-NOT-FETCHED TO TRUE
  3389     ELSE
  3390        MOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA)  TO
  3391                          CARDDEMO-COMMAREA
  3392        MOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:
  3393                         LENGTH OF WS-THIS-PROGCOMMAREA ) TO
  3394                          WS-THIS-PROGCOMMAREA
  3395     END-IF
  3396*****************************************************************
  3397* Remap PFkeys as needed.
  3398* Store the Mapped PF Key
  3399*****************************************************************
  3400     PERFORM YYYY-STORE-PFKEY
  3401        THRU YYYY-STORE-PFKEY-EXIT
  3402*****************************************************************
  3403* Check the AID to see if its valid at this point               *
  3404* F3 - Exit
  3405* Enter show screen again
  3406*****************************************************************
  3407     SET PFK-INVALID TO TRUE
  3408     IF CCARD-AID-ENTER OR
  3409        CCARD-AID-PFK03 OR
  3410        (CCARD-AID-PFK05 AND ACUP-CHANGES-OK-NOT-CONFIRMED)
  3411                        OR
  3412        (CCARD-AID-PFK12 AND NOT ACUP-DETAILS-NOT-FETCHED)
  3413        SET PFK-VALID TO TRUE
  3414     END-IF
  3415
  3416     IF PFK-INVALID
  3417        SET CCARD-AID-ENTER TO TRUE
  3418     END-IF
  3419
  3420*****************************************************************
  3421* Decide what to do based on inputs received
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  65
* COACTUPC.cbl
  3422*****************************************************************
  3423     EVALUATE TRUE
  3424******************************************************************
  3425*       USER PRESSES PF03 TO EXIT
  3426*  OR   USER IS DONE WITH UPDATE
  3427*            XCTL TO CALLING PROGRAM OR MAIN MENU
  3428******************************************************************
  3429        WHEN CCARD-AID-PFK03
  3430             SET CCARD-AID-PFK03     TO TRUE
  3431
  3432             IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES
  3433             OR CDEMO-FROM-TRANID    EQUAL SPACES
  3434                MOVE LIT-MENUTRANID  TO CDEMO-TO-TRANID
  3435             ELSE
  3436                MOVE CDEMO-FROM-TRANID  TO CDEMO-TO-TRANID
  3437             END-IF
  3438
  3439             IF CDEMO-FROM-PROGRAM   EQUAL LOW-VALUES
  3440             OR CDEMO-FROM-PROGRAM   EQUAL SPACES
  3441                MOVE LIT-MENUPGM     TO CDEMO-TO-PROGRAM
  3442             ELSE
  3443                MOVE CDEMO-FROM-PROGRAM TO CDEMO-TO-PROGRAM
  3444             END-IF
  3445
  3446             MOVE LIT-THISTRANID     TO CDEMO-FROM-TRANID
  3447             MOVE LIT-THISPGM        TO CDEMO-FROM-PROGRAM
  3448
  3449             SET  CDEMO-USRTYP-USER  TO TRUE
  3450             SET  CDEMO-PGM-ENTER    TO TRUE
  3451             MOVE LIT-THISMAPSET     TO CDEMO-LAST-MAPSET
  3452             MOVE LIT-THISMAP        TO CDEMO-LAST-MAP
  3453
  3454             EXEC CICS
**    COBCH0012S Operand EXEC is not declared  : COACTUPC.cbl(946,23,20)
**    COBCH0012S Operand CICS is not declared  : COACTUPC.cbl(946,28,25)
  3455                  SYNCPOINT
**    COBCH0012S Operand SYNCPOINT is not declared  : COACTUPC.cbl(947,33,25)
  3456             END-EXEC
**    COBCH0012S Operand END-EXEC is not declared  : COACTUPC.cbl(948,27,20)
  3457*
  3458             EXEC CICS XCTL
**    COBCH0012S Operand XCTL is not declared  : COACTUPC.cbl(950,33,30)
  3459                  PROGRAM (CDEMO-TO-PROGRAM)
  3460                  COMMAREA(CARDDEMO-COMMAREA)
  3461             END-EXEC
  3462******************************************************************
  3463*       FRESH ENTRY INTO PROGRAM
  3464*            ASK THE USER FOR THE KEYS TO FETCH CARD TO BE UPDATED
  3465******************************************************************
  3466        WHEN ACUP-DETAILS-NOT-FETCHED
  3467         AND CDEMO-PGM-ENTER
  3468        WHEN CDEMO-FROM-PROGRAM   EQUAL LIT-MENUPGM
  3469         AND NOT CDEMO-PGM-REENTER
  3470             INITIALIZE WS-THIS-PROGCOMMAREA
  3471             PERFORM 3000-SEND-MAP THRU
  3472                     3000-SEND-MAP-EXIT
  3473             SET CDEMO-PGM-REENTER        TO TRUE
  3474             SET ACUP-DETAILS-NOT-FETCHED TO TRUE
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  66
* COACTUPC.cbl
  3475             GO TO COMMON-RETURN
  3476******************************************************************
  3477*       ACCT DATA CHANGES REVIEWED, OKAYED AND DONE SUCESSFULLY
  3478*            RESET THE SEARCH KEYS
  3479*            ASK THE USER FOR FRESH SEARCH CRITERIA
  3480******************************************************************
  3481        WHEN ACUP-CHANGES-OKAYED-AND-DONE
  3482        WHEN ACUP-CHANGES-FAILED
  3483             INITIALIZE WS-THIS-PROGCOMMAREA
  3484                        WS-MISC-STORAGE
  3485                        CDEMO-ACCT-ID
  3486             SET CDEMO-PGM-ENTER            TO TRUE
  3487             PERFORM 3000-SEND-MAP THRU
  3488                     3000-SEND-MAP-EXIT
  3489             SET CDEMO-PGM-REENTER          TO TRUE
  3490             SET ACUP-DETAILS-NOT-FETCHED   TO TRUE
  3491             GO TO COMMON-RETURN
  3492******************************************************************
  3493*      ACCT DATA HAS BEEN PRESENTED TO USER
  3494*            CHECK THE USER INPUTS
  3495*            DECIDE WHAT TO DO
  3496*            PRESENT NEXT STEPS TO USER
  3497******************************************************************
  3498        WHEN OTHER
  3499             PERFORM 1000-PROCESS-INPUTS
  3500                THRU 1000-PROCESS-INPUTS-EXIT
  3501             PERFORM 2000-DECIDE-ACTION
  3502                THRU 2000-DECIDE-ACTION-EXIT
  3503             PERFORM 3000-SEND-MAP
  3504                THRU 3000-SEND-MAP-EXIT
  3505             GO TO COMMON-RETURN
  3506     END-EVALUATE
  3507     .
  3508
  3509 COMMON-RETURN.
  3510     MOVE WS-RETURN-MSG     TO CCARD-ERROR-MSG
  3511
  3512     MOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA
  3513     MOVE  WS-THIS-PROGCOMMAREA TO
  3514            WS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:
  3515                         LENGTH OF WS-THIS-PROGCOMMAREA )
  3516
  3517     EXEC CICS RETURN
  3518          TRANSID (LIT-THISTRANID)
**    COBCH0012S Operand TRANSID is not declared  : COACTUPC.cbl(1010,23,17)
  3519          COMMAREA (WS-COMMAREA)
  3520          LENGTH(LENGTH OF WS-COMMAREA)
  3521     END-EXEC
  3522     .
  3523 0000-MAIN-EXIT.
  3524     EXIT
  3525     .
  3526
  3527 1000-PROCESS-INPUTS.
  3528     PERFORM 1100-RECEIVE-MAP
  3529        THRU 1100-RECEIVE-MAP-EXIT
  3530     PERFORM 1200-EDIT-MAP-INPUTS
  3531        THRU 1200-EDIT-MAP-INPUTS-EXIT
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  67
* COACTUPC.cbl
  3532     MOVE WS-RETURN-MSG  TO CCARD-ERROR-MSG
  3533     MOVE LIT-THISPGM    TO CCARD-NEXT-PROG
  3534     MOVE LIT-THISMAPSET TO CCARD-NEXT-MAPSET
  3535     MOVE LIT-THISMAP    TO CCARD-NEXT-MAP
  3536     .
  3537*
  3538 1000-PROCESS-INPUTS-EXIT.
  3539     EXIT
  3540     .
  3541 1100-RECEIVE-MAP.
  3542     EXEC CICS RECEIVE MAP(LIT-THISMAP)
**    COBCH0305S Procedure name EXEC same as data-name  : COACTUPC.cbl(1034,15,12)
**    COBCH0301S Unrecognized verb  : COACTUPC.cbl(1034,15,12)
**    COBCH1895S Communication Facility not supported  : COACTUPC.cbl(1034,28,22)
**    COBCH0012S Operand MAP is not declared  : COACTUPC.cbl(1034,32,30)
  3543               MAPSET(LIT-THISMAPSET)
  3544               INTO(CACTUPAI)
  3545               RESP(WS-RESP-CD)
  3546               RESP2(WS-REAS-CD)
  3547     END-EXEC
  3548*
  3549     INITIALIZE ACUP-NEW-DETAILS
  3550******************************************************************
  3551*    Account Master data
  3552******************************************************************
  3553     IF  ACCTSIDI OF CACTUPAI = '*'
  3554     OR  ACCTSIDI OF CACTUPAI = SPACES
  3555         MOVE LOW-VALUES           TO CC-ACCT-ID
  3556                                      ACUP-NEW-ACCT-ID-X
  3557     ELSE
  3558         MOVE ACCTSIDI OF CACTUPAI TO CC-ACCT-ID
  3559                                      ACUP-NEW-ACCT-ID-X
  3560     END-IF
  3561
  3562     IF ACUP-DETAILS-NOT-FETCHED
  3563        GO TO 1100-RECEIVE-MAP-EXIT
  3564     END-IF
  3565
  3566* Active Status
  3567     IF  ACSTTUSI OF CACTUPAI = '*'
  3568     OR  ACSTTUSI OF CACTUPAI = SPACES
  3569         MOVE LOW-VALUES           TO ACUP-NEW-ACTIVE-STATUS
  3570     ELSE
  3571         MOVE ACSTTUSI OF CACTUPAI TO ACUP-NEW-ACTIVE-STATUS
  3572     END-IF
  3573
  3574* Credit Limit
  3575     IF  ACRDLIMI OF CACTUPAI = '*'
  3576     OR  ACRDLIMI OF CACTUPAI = SPACES
  3577         MOVE LOW-VALUES           TO ACUP-NEW-CREDIT-LIMIT-X
  3578     ELSE
  3579         MOVE ACRDLIMI OF CACTUPAI TO ACUP-NEW-CREDIT-LIMIT-X
  3580         IF FUNCTION TEST-NUMVAL-C(ACUP-NEW-CREDIT-LIMIT-X) = 0
  3581            COMPUTE ACUP-NEW-CREDIT-LIMIT-N =
  3582               FUNCTION NUMVAL-C(ACRDLIMI OF CACTUPAI)
  3583         ELSE
  3584            CONTINUE
  3585         END-IF
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  68
* COACTUPC.cbl
  3586     END-IF
  3587
  3588* Cash Limit
  3589     IF  ACSHLIMI OF CACTUPAI = '*'
  3590     OR  ACSHLIMI OF CACTUPAI = SPACES
  3591       MOVE LOW-VALUES           TO ACUP-NEW-CASH-CREDIT-LIMIT-X
  3592     ELSE
  3593       MOVE ACSHLIMI OF CACTUPAI TO ACUP-NEW-CASH-CREDIT-LIMIT-X
  3594       IF FUNCTION TEST-NUMVAL-C(ACUP-NEW-CASH-CREDIT-LIMIT-X) = 0
  3595          COMPUTE ACUP-NEW-CASH-CREDIT-LIMIT-N =
  3596               FUNCTION NUMVAL-C(ACSHLIMI OF CACTUPAI)
  3597       ELSE
  3598          CONTINUE
  3599       END-IF
  3600     END-IF
  3601
  3602* Current Balance
  3603     IF  ACURBALI OF CACTUPAI = '*'
  3604     OR  ACURBALI OF CACTUPAI = SPACES
  3605         MOVE LOW-VALUES           TO ACUP-NEW-CURR-BAL-X
  3606     ELSE
  3607         MOVE ACURBALI OF CACTUPAI TO ACUP-NEW-CURR-BAL-X
  3608         IF  FUNCTION TEST-NUMVAL-C(ACUP-NEW-CURR-BAL-X) = 0
  3609             COMPUTE ACUP-NEW-CURR-BAL-N =
  3610               FUNCTION NUMVAL-C(ACUP-NEW-CURR-BAL-X)
  3611         ELSE
  3612             CONTINUE
  3613         END-IF
  3614     END-IF
  3615
  3616*Current Cycle Credit
  3617     IF  ACRCYCRI OF CACTUPAI = '*'
  3618     OR  ACRCYCRI OF CACTUPAI = SPACES
  3619         MOVE LOW-VALUES           TO ACUP-NEW-CURR-CYC-CREDIT-X
  3620     ELSE
  3621         MOVE ACRCYCRI OF CACTUPAI TO ACUP-NEW-CURR-CYC-CREDIT-X
  3622         IF FUNCTION TEST-NUMVAL-C(ACUP-NEW-CURR-CYC-CREDIT-X) = 0
  3623             COMPUTE ACUP-NEW-CURR-CYC-CREDIT-N =
  3624               FUNCTION NUMVAL-C(ACRCYCRI OF CACTUPAI)
  3625         ELSE
  3626             CONTINUE
  3627         END-IF
  3628     END-IF
  3629
  3630*Current Cycle Debit
  3631     IF  ACRCYDBI OF CACTUPAI = '*'
  3632     OR  ACRCYDBI OF CACTUPAI = SPACES
  3633         MOVE LOW-VALUES           TO ACUP-NEW-CURR-CYC-DEBIT-X
  3634     ELSE
  3635         MOVE ACRCYDBI OF CACTUPAI TO ACUP-NEW-CURR-CYC-DEBIT-X
  3636         IF  FUNCTION TEST-NUMVAL-C(ACUP-NEW-CURR-CYC-DEBIT-X) = 0
  3637             COMPUTE ACUP-NEW-CURR-CYC-DEBIT-N =
  3638               FUNCTION NUMVAL-C(ACRCYDBI OF CACTUPAI)
  3639         ELSE
  3640             CONTINUE
  3641         END-IF
  3642     END-IF
  3643
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  69
* COACTUPC.cbl
  3644*Open date
  3645*
  3646     IF  OPNYEARI OF CACTUPAI = '*'
  3647     OR  OPNYEARI OF CACTUPAI = SPACES
  3648         MOVE LOW-VALUES           TO ACUP-NEW-OPEN-YEAR
  3649     ELSE
  3650         MOVE OPNYEARI OF CACTUPAI TO ACUP-NEW-OPEN-YEAR
  3651     END-IF
  3652
  3653     IF  OPNMONI OF CACTUPAI = '*'
  3654     OR  OPNMONI OF CACTUPAI = SPACES
  3655         MOVE LOW-VALUES           TO ACUP-NEW-OPEN-MON
  3656     ELSE
  3657         MOVE OPNMONI OF CACTUPAI TO  ACUP-NEW-OPEN-MON
  3658     END-IF
  3659
  3660     IF  OPNDAYI OF CACTUPAI = '*'
  3661     OR  OPNDAYI OF CACTUPAI = SPACES
  3662         MOVE LOW-VALUES           TO ACUP-NEW-OPEN-DAY
  3663     ELSE
  3664         MOVE OPNDAYI OF CACTUPAI TO  ACUP-NEW-OPEN-DAY
  3665     END-IF
  3666
  3667*Expiry date
  3668*
  3669     IF  EXPYEARI OF CACTUPAI = '*'
  3670     OR  EXPYEARI OF CACTUPAI = SPACES
  3671         MOVE LOW-VALUES           TO ACUP-NEW-EXP-YEAR
  3672     ELSE
  3673         MOVE EXPYEARI OF CACTUPAI TO ACUP-NEW-EXP-YEAR
  3674     END-IF
  3675
  3676     IF  EXPMONI OF CACTUPAI = '*'
  3677     OR  EXPMONI OF CACTUPAI = SPACES
  3678         MOVE LOW-VALUES           TO ACUP-NEW-EXP-MON
  3679     ELSE
  3680         MOVE EXPMONI OF CACTUPAI TO  ACUP-NEW-EXP-MON
  3681     END-IF
  3682
  3683     IF  EXPDAYI OF CACTUPAI = '*'
  3684     OR  EXPDAYI OF CACTUPAI = SPACES
  3685         MOVE LOW-VALUES           TO ACUP-NEW-EXP-DAY
  3686     ELSE
  3687         MOVE EXPDAYI OF CACTUPAI TO  ACUP-NEW-EXP-DAY
  3688     END-IF
  3689
  3690*Reissue date
  3691*
  3692     IF  RISYEARI OF CACTUPAI = '*'
  3693     OR  RISYEARI OF CACTUPAI = SPACES
  3694         MOVE LOW-VALUES           TO ACUP-NEW-REISSUE-YEAR
  3695     ELSE
  3696         MOVE RISYEARI OF CACTUPAI TO ACUP-NEW-REISSUE-YEAR
  3697     END-IF
  3698
  3699     IF  RISMONI OF CACTUPAI = '*'
  3700     OR  RISMONI OF CACTUPAI = SPACES
  3701         MOVE LOW-VALUES           TO ACUP-NEW-REISSUE-MON
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  70
* COACTUPC.cbl
  3702     ELSE
  3703         MOVE RISMONI OF CACTUPAI TO  ACUP-NEW-REISSUE-MON
  3704     END-IF
  3705
  3706     IF  RISDAYI OF CACTUPAI = '*'
  3707     OR  RISDAYI OF CACTUPAI = SPACES
  3708         MOVE LOW-VALUES           TO ACUP-NEW-REISSUE-DAY
  3709     ELSE
  3710         MOVE RISDAYI OF CACTUPAI TO  ACUP-NEW-REISSUE-DAY
  3711     END-IF
  3712
  3713*Account Group
  3714*
  3715     IF  AADDGRPI OF CACTUPAI = '*'
  3716     OR  AADDGRPI OF CACTUPAI = SPACES
  3717         MOVE LOW-VALUES           TO ACUP-NEW-GROUP-ID
  3718     ELSE
  3719         MOVE AADDGRPI OF CACTUPAI TO ACUP-NEW-GROUP-ID
  3720     END-IF
  3721******************************************************************
  3722*    Customer Master data
  3723******************************************************************
  3724*Customer Id (actually not editable)
  3725*
  3726     IF  ACSTNUMI OF CACTUPAI = '*'
  3727     OR  ACSTNUMI OF CACTUPAI = SPACES
  3728         MOVE LOW-VALUES           TO ACUP-NEW-CUST-ID-X
  3729     ELSE
  3730         MOVE ACSTNUMI OF CACTUPAI TO ACUP-NEW-CUST-ID-X
  3731     END-IF
  3732
  3733*Social Security Number
  3734*
  3735     IF  ACTSSN1I OF CACTUPAI = '*'
  3736     OR  ACTSSN1I OF CACTUPAI = SPACES
  3737         MOVE LOW-VALUES           TO ACUP-NEW-CUST-SSN-1
  3738     ELSE
  3739         MOVE ACTSSN1I OF CACTUPAI TO ACUP-NEW-CUST-SSN-1
  3740     END-IF
  3741
  3742     IF  ACTSSN2I OF CACTUPAI = '*'
  3743     OR  ACTSSN2I OF CACTUPAI = SPACES
  3744         MOVE LOW-VALUES           TO ACUP-NEW-CUST-SSN-2
  3745     ELSE
  3746         MOVE ACTSSN2I OF CACTUPAI TO ACUP-NEW-CUST-SSN-2
  3747     END-IF
  3748
  3749     IF  ACTSSN3I OF CACTUPAI = '*'
  3750     OR  ACTSSN3I OF CACTUPAI = SPACES
  3751         MOVE LOW-VALUES           TO ACUP-NEW-CUST-SSN-3
  3752     ELSE
  3753         MOVE ACTSSN3I OF CACTUPAI TO ACUP-NEW-CUST-SSN-3
  3754     END-IF
  3755*
  3756*Date of birth
  3757*
  3758     IF  DOBYEARI OF CACTUPAI = '*'
  3759     OR  DOBYEARI OF CACTUPAI = SPACES
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  71
* COACTUPC.cbl
  3760         MOVE LOW-VALUES           TO ACUP-NEW-CUST-DOB-YEAR
  3761     ELSE
  3762         MOVE DOBYEARI OF CACTUPAI TO ACUP-NEW-CUST-DOB-YEAR
  3763     END-IF
  3764
  3765     IF  DOBMONI OF CACTUPAI = '*'
  3766     OR  DOBMONI OF CACTUPAI = SPACES
  3767         MOVE LOW-VALUES           TO ACUP-NEW-CUST-DOB-MON
  3768     ELSE
  3769         MOVE DOBMONI OF CACTUPAI  TO ACUP-NEW-CUST-DOB-MON
  3770     END-IF
  3771
  3772     IF  DOBDAYI OF CACTUPAI = '*'
  3773     OR  DOBDAYI OF CACTUPAI = SPACES
  3774         MOVE LOW-VALUES           TO ACUP-NEW-CUST-DOB-DAY
  3775     ELSE
  3776         MOVE DOBDAYI OF CACTUPAI  TO ACUP-NEW-CUST-DOB-DAY
  3777     END-IF
  3778*
  3779*FICO
  3780*
  3781     IF  ACSTFCOI OF CACTUPAI = '*'
  3782     OR  ACSTFCOI OF CACTUPAI = SPACES
  3783         MOVE LOW-VALUES           TO ACUP-NEW-CUST-FICO-SCORE-X
  3784     ELSE
  3785         MOVE ACSTFCOI OF CACTUPAI TO ACUP-NEW-CUST-FICO-SCORE-X
  3786     END-IF
  3787*
  3788*First Name
  3789*
  3790     IF  ACSFNAMI OF CACTUPAI = '*'
  3791     OR  ACSFNAMI OF CACTUPAI = SPACES
  3792         MOVE LOW-VALUES           TO ACUP-NEW-CUST-FIRST-NAME
  3793     ELSE
  3794         MOVE ACSFNAMI OF CACTUPAI TO ACUP-NEW-CUST-FIRST-NAME
  3795     END-IF
  3796*
  3797*Middle Name
  3798*
  3799     IF  ACSMNAMI OF CACTUPAI = '*'
  3800     OR  ACSMNAMI OF CACTUPAI = SPACES
  3801         MOVE LOW-VALUES           TO ACUP-NEW-CUST-MIDDLE-NAME
  3802     ELSE
  3803         MOVE ACSMNAMI OF CACTUPAI TO ACUP-NEW-CUST-MIDDLE-NAME
  3804     END-IF
  3805*
  3806*Last Name
  3807*
  3808     IF  ACSLNAMI OF CACTUPAI = '*'
  3809     OR  ACSLNAMI OF CACTUPAI = SPACES
  3810         MOVE LOW-VALUES           TO ACUP-NEW-CUST-LAST-NAME
  3811     ELSE
  3812         MOVE ACSLNAMI OF CACTUPAI TO ACUP-NEW-CUST-LAST-NAME
  3813     END-IF
  3814*
  3815*Address
  3816*
  3817     IF  ACSADL1I OF CACTUPAI = '*'
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  72
* COACTUPC.cbl
  3818     OR  ACSADL1I OF CACTUPAI = SPACES
  3819         MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-LINE-1
  3820     ELSE
  3821         MOVE ACSADL1I OF CACTUPAI TO ACUP-NEW-CUST-ADDR-LINE-1
  3822     END-IF
  3823
  3824     IF  ACSADL2I OF CACTUPAI = '*'
  3825     OR  ACSADL2I OF CACTUPAI = SPACES
  3826         MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-LINE-2
  3827     ELSE
  3828         MOVE ACSADL2I OF CACTUPAI TO ACUP-NEW-CUST-ADDR-LINE-2
  3829     END-IF
  3830
  3831     IF  ACSCITYI OF CACTUPAI = '*'
  3832     OR  ACSCITYI OF CACTUPAI = SPACES
  3833         MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-LINE-3
  3834     ELSE
  3835         MOVE ACSCITYI OF CACTUPAI TO ACUP-NEW-CUST-ADDR-LINE-3
  3836     END-IF
  3837
  3838     IF  ACSSTTEI OF CACTUPAI = '*'
  3839     OR  ACSSTTEI OF CACTUPAI = SPACES
  3840         MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-STATE-CD
  3841     ELSE
  3842         MOVE ACSSTTEI OF CACTUPAI TO ACUP-NEW-CUST-ADDR-STATE-CD
  3843     END-IF
  3844
  3845     IF  ACSCTRYI OF CACTUPAI = '*'
  3846     OR  ACSCTRYI OF CACTUPAI = SPACES
  3847        MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-COUNTRY-CD
  3848     ELSE
  3849        MOVE ACSCTRYI OF CACTUPAI TO ACUP-NEW-CUST-ADDR-COUNTRY-CD
  3850     END-IF
  3851
  3852     IF  ACSZIPCI OF CACTUPAI = '*'
  3853     OR  ACSZIPCI OF CACTUPAI = SPACES
  3854         MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-ZIP
  3855     ELSE
  3856         MOVE ACSZIPCI OF CACTUPAI TO ACUP-NEW-CUST-ADDR-ZIP
  3857     END-IF
  3858
  3859     IF  ACSPH1AI OF CACTUPAI = '*'
  3860     OR  ACSPH1AI OF CACTUPAI = SPACES
  3861         MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-1A
  3862     ELSE
  3863         MOVE ACSPH1AI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-1A
  3864     END-IF
  3865
  3866     IF  ACSPH1BI OF CACTUPAI = '*'
  3867     OR  ACSPH1BI OF CACTUPAI = SPACES
  3868         MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-1B
  3869     ELSE
  3870         MOVE ACSPH1BI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-1B
  3871     END-IF
  3872
  3873     IF  ACSPH1CI OF CACTUPAI = '*'
  3874     OR  ACSPH1CI OF CACTUPAI = SPACES
  3875         MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-1C
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  73
* COACTUPC.cbl
  3876     ELSE
  3877         MOVE ACSPH1CI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-1C
  3878     END-IF
  3879
  3880     IF  ACSPH2AI OF CACTUPAI = '*'
  3881     OR  ACSPH2AI OF CACTUPAI = SPACES
  3882         MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-2A
  3883     ELSE
  3884         MOVE ACSPH2AI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-2A
  3885     END-IF
  3886
  3887     IF  ACSPH2BI OF CACTUPAI = '*'
  3888     OR  ACSPH2BI OF CACTUPAI = SPACES
  3889         MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-2B
  3890     ELSE
  3891         MOVE ACSPH2BI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-2B
  3892     END-IF
  3893
  3894     IF  ACSPH2CI OF CACTUPAI = '*'
  3895     OR  ACSPH2CI OF CACTUPAI = SPACES
  3896         MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-2C
  3897     ELSE
  3898         MOVE ACSPH2CI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-2C
  3899     END-IF
  3900*
  3901*Government Id
  3902*
  3903     IF  ACSGOVTI OF CACTUPAI = '*'
  3904     OR  ACSGOVTI OF CACTUPAI = SPACES
  3905         MOVE LOW-VALUES           TO ACUP-NEW-CUST-GOVT-ISSUED-ID
  3906     ELSE
  3907         MOVE ACSGOVTI OF CACTUPAI TO ACUP-NEW-CUST-GOVT-ISSUED-ID
  3908     END-IF
  3909*
  3910*EFT Code
  3911*
  3912     IF  ACSEFTCI OF CACTUPAI = '*'
  3913     OR  ACSEFTCI OF CACTUPAI = SPACES
  3914         MOVE LOW-VALUES           TO ACUP-NEW-CUST-EFT-ACCOUNT-ID
  3915     ELSE
  3916         MOVE ACSEFTCI OF CACTUPAI TO ACUP-NEW-CUST-EFT-ACCOUNT-ID
  3917     END-IF
  3918*
  3919*Primary Holder Indicator
  3920*
  3921     IF  ACSPFLGI OF CACTUPAI = '*'
  3922     OR  ACSPFLGI OF CACTUPAI = SPACES
  3923        MOVE LOW-VALUES            TO ACUP-NEW-CUST-PRI-HOLDER-IND
  3924     ELSE
  3925        MOVE ACSPFLGI OF CACTUPAI  TO ACUP-NEW-CUST-PRI-HOLDER-IND
  3926     END-IF
  3927     .
  3928 1100-RECEIVE-MAP-EXIT.
  3929     EXIT
  3930     .
  3931 1200-EDIT-MAP-INPUTS.
  3932
  3933     SET INPUT-OK                  TO TRUE
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  74
* COACTUPC.cbl
  3934
  3935     IF  ACUP-DETAILS-NOT-FETCHED
  3936*        VALIDATE THE SEARCH KEYS
  3937         PERFORM 1210-EDIT-ACCOUNT
  3938            THRU 1210-EDIT-ACCOUNT-EXIT
  3939
  3940         MOVE LOW-VALUES           TO ACUP-OLD-ACCT-DATA
  3941
  3942*       IF THE SEARCH CONDITIONS HAVE PROBLEMS FLAG THEM
  3943        IF  FLG-ACCTFILTER-BLANK
  3944            SET NO-SEARCH-CRITERIA-RECEIVED TO TRUE
  3945        END-IF
  3946
  3947*       AT THIS STAGE. NO DETAILS FETCHED. NOTHING MORE TO EDIT.
  3948        GO TO 1200-EDIT-MAP-INPUTS-EXIT
  3949     ELSE
  3950         CONTINUE
  3951     END-IF
  3952*
  3953*    SEARCH KEYS ALREADY VALIDATED AND DATA FETCHED
  3954     SET FOUND-ACCOUNT-DATA        TO TRUE
  3955     SET FOUND-ACCT-IN-MASTER      TO TRUE
  3956     SET FLG-ACCTFILTER-ISVALID    TO TRUE
  3957
  3958     SET FOUND-CUST-IN-MASTER      TO TRUE
  3959     SET FLG-CUSTFILTER-ISVALID    TO TRUE
  3960
  3961*
  3962     PERFORM 1205-COMPARE-OLD-NEW
  3963        THRU 1205-COMPARE-OLD-NEW-EXIT
  3964
  3965     IF  NO-CHANGES-FOUND
  3966     OR  ACUP-CHANGES-OK-NOT-CONFIRMED
  3967     OR  ACUP-CHANGES-OKAYED-AND-DONE
  3968         MOVE LOW-VALUES           TO WS-NON-KEY-FLAGS
  3969         GO TO 1200-EDIT-MAP-INPUTS-EXIT
  3970     END-IF
  3971
  3972     SET ACUP-CHANGES-NOT-OK       TO TRUE
  3973
  3974     MOVE 'Account Status'          TO WS-EDIT-VARIABLE-NAME
  3975     MOVE ACUP-NEW-ACTIVE-STATUS    TO WS-EDIT-YES-NO
  3976     PERFORM 1220-EDIT-YESNO
  3977        THRU 1220-EDIT-YESNO-EXIT
  3978     MOVE WS-EDIT-YES-NO            TO WS-EDIT-ACCT-STATUS
  3979
  3980     MOVE 'Open Date'              TO WS-EDIT-VARIABLE-NAME
  3981     MOVE ACUP-NEW-OPEN-DATE       TO WS-EDIT-DATE-CCYYMMDD
  3982     PERFORM EDIT-DATE-CCYYMMDD
  3983        THRU EDIT-DATE-CCYYMMDD-EXIT
  3984     MOVE WS-EDIT-DATE-FLGS        TO WS-EDIT-OPEN-DATE-FLGS
  3985
  3986     MOVE 'Credit Limit'           TO WS-EDIT-VARIABLE-NAME
  3987     MOVE ACUP-NEW-CREDIT-LIMIT-X  TO WS-EDIT-SIGNED-NUMBER-9V2-X
  3988     PERFORM 1250-EDIT-SIGNED-9V2
  3989        THRU 1250-EDIT-SIGNED-9V2-EXIT
  3990     MOVE WS-FLG-SIGNED-NUMBER-EDIT  TO WS-EDIT-CREDIT-LIMIT
  3991
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  75
* COACTUPC.cbl
  3992     MOVE 'Expiry Date'            TO WS-EDIT-VARIABLE-NAME
  3993     MOVE ACUP-NEW-EXPIRAION-DATE  TO WS-EDIT-DATE-CCYYMMDD
  3994     PERFORM EDIT-DATE-CCYYMMDD
  3995        THRU EDIT-DATE-CCYYMMDD-EXIT
  3996     MOVE WS-EDIT-DATE-FLGS        TO WS-EXPIRY-DATE-FLGS
  3997
  3998     MOVE 'Cash Credit Limit'      TO WS-EDIT-VARIABLE-NAME
  3999     MOVE ACUP-NEW-CASH-CREDIT-LIMIT-X
  4000                                   TO WS-EDIT-SIGNED-NUMBER-9V2-X
  4001     PERFORM 1250-EDIT-SIGNED-9V2
  4002        THRU 1250-EDIT-SIGNED-9V2-EXIT
  4003     MOVE WS-FLG-SIGNED-NUMBER-EDIT TO WS-EDIT-CASH-CREDIT-LIMIT
  4004
  4005     MOVE 'Reissue Date'           TO WS-EDIT-VARIABLE-NAME
  4006     MOVE ACUP-NEW-REISSUE-DATE    TO WS-EDIT-DATE-CCYYMMDD
  4007     PERFORM EDIT-DATE-CCYYMMDD
  4008        THRU EDIT-DATE-CCYYMMDD-EXIT
  4009     MOVE WS-EDIT-DATE-FLGS        TO WS-EDIT-REISSUE-DATE-FLGS
  4010
  4011     MOVE 'Current Balance'        TO WS-EDIT-VARIABLE-NAME
  4012     MOVE ACUP-NEW-CURR-BAL-X      TO WS-EDIT-SIGNED-NUMBER-9V2-X
  4013     PERFORM 1250-EDIT-SIGNED-9V2
  4014        THRU 1250-EDIT-SIGNED-9V2-EXIT
  4015     MOVE WS-FLG-SIGNED-NUMBER-EDIT   TO WS-EDIT-CURR-BAL
  4016
  4017     MOVE 'Current Cycle Credit Limit' TO WS-EDIT-VARIABLE-NAME
  4018     MOVE ACUP-NEW-CURR-CYC-CREDIT-X
  4019                                   TO WS-EDIT-SIGNED-NUMBER-9V2-X
  4020     PERFORM 1250-EDIT-SIGNED-9V2
  4021        THRU 1250-EDIT-SIGNED-9V2-EXIT
  4022     MOVE WS-FLG-SIGNED-NUMBER-EDIT   TO WS-EDIT-CURR-CYC-CREDIT
  4023
  4024     MOVE 'Current Cycle Debit Limit' TO WS-EDIT-VARIABLE-NAME
  4025     MOVE ACUP-NEW-CURR-CYC-DEBIT-X
  4026                                   TO WS-EDIT-SIGNED-NUMBER-9V2-X
  4027     PERFORM 1250-EDIT-SIGNED-9V2
  4028        THRU 1250-EDIT-SIGNED-9V2-EXIT
  4029     MOVE WS-FLG-SIGNED-NUMBER-EDIT   TO WS-EDIT-CURR-CYC-DEBIT
  4030
  4031     MOVE 'SSN'                    TO WS-EDIT-VARIABLE-NAME
  4032     PERFORM 1265-EDIT-US-SSN
  4033        THRU 1265-EDIT-US-SSN-EXIT
  4034
  4035     MOVE 'Date of Birth'          TO WS-EDIT-VARIABLE-NAME
  4036     MOVE   ACUP-NEW-CUST-DOB-YYYY-MM-DD
  4037                                   TO WS-EDIT-DATE-CCYYMMDD
  4038     PERFORM EDIT-DATE-CCYYMMDD
  4039        THRU EDIT-DATE-CCYYMMDD-EXIT
  4040     MOVE WS-EDIT-DATE-FLGS        TO WS-EDIT-DT-OF-BIRTH-FLGS
  4041     IF WS-EDIT-DT-OF-BIRTH-ISVALID
  4042        PERFORM  EDIT-DATE-OF-BIRTH
  4043           THRU  EDIT-DATE-OF-BIRTH-EXIT
  4044        MOVE WS-EDIT-DATE-FLGS    TO WS-EDIT-DT-OF-BIRTH-FLGS
  4045     END-IF
  4046
  4047     MOVE 'FICO Score'             TO WS-EDIT-VARIABLE-NAME
  4048     MOVE ACUP-NEW-CUST-FICO-SCORE-X
  4049                                   TO WS-EDIT-ALPHANUM-ONLY
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  76
* COACTUPC.cbl
  4050     MOVE 3                        TO WS-EDIT-ALPHANUM-LENGTH
  4051     PERFORM 1245-EDIT-NUM-REQD
  4052        THRU 1245-EDIT-NUM-REQD-EXIT
  4053     MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS
  4054                                   TO WS-EDIT-FICO-SCORE-FLGS
  4055     IF FLG-FICO-SCORE-ISVALID
  4056        PERFORM  1275-EDIT-FICO-SCORE
  4057           THRU  1275-EDIT-FICO-SCORE-EXIT
  4058     END-IF
  4059******************************************************************
  4060*    Edit names
  4061******************************************************************
  4062     MOVE 'First Name'             TO WS-EDIT-VARIABLE-NAME
  4063     MOVE ACUP-NEW-CUST-FIRST-NAME TO WS-EDIT-ALPHANUM-ONLY
  4064     MOVE 25                       TO WS-EDIT-ALPHANUM-LENGTH
  4065     PERFORM 1225-EDIT-ALPHA-REQD
  4066        THRU 1225-EDIT-ALPHA-REQD-EXIT
  4067     MOVE WS-EDIT-ALPHA-ONLY-FLAGS
  4068                                   TO WS-EDIT-FIRST-NAME-FLGS
  4069
  4070     MOVE 'Middle Name'            TO WS-EDIT-VARIABLE-NAME
  4071     MOVE ACUP-NEW-CUST-MIDDLE-NAME TO WS-EDIT-ALPHANUM-ONLY
  4072     MOVE 25                       TO WS-EDIT-ALPHANUM-LENGTH
  4073     PERFORM 1235-EDIT-ALPHA-OPT
  4074        THRU 1235-EDIT-ALPHA-OPT-EXIT
  4075     MOVE WS-EDIT-ALPHA-ONLY-FLAGS
  4076                                   TO WS-EDIT-MIDDLE-NAME-FLGS
  4077
  4078     MOVE 'Last Name'              TO WS-EDIT-VARIABLE-NAME
  4079     MOVE ACUP-NEW-CUST-LAST-NAME  TO WS-EDIT-ALPHANUM-ONLY
  4080     MOVE 25                       TO WS-EDIT-ALPHANUM-LENGTH
  4081     PERFORM 1225-EDIT-ALPHA-REQD
  4082        THRU 1225-EDIT-ALPHA-REQD-EXIT
  4083     MOVE WS-EDIT-ALPHA-ONLY-FLAGS
  4084                                  TO WS-EDIT-LAST-NAME-FLGS
  4085
  4086     MOVE 'Address Line 1'         TO WS-EDIT-VARIABLE-NAME
  4087     MOVE ACUP-NEW-CUST-ADDR-LINE-1 TO WS-EDIT-ALPHANUM-ONLY
  4088     MOVE 50                       TO WS-EDIT-ALPHANUM-LENGTH
  4089     PERFORM 1215-EDIT-MANDATORY
  4090        THRU 1215-EDIT-MANDATORY-EXIT
  4091     MOVE WS-EDIT-MANDATORY-FLAGS
  4092                                   TO WS-EDIT-ADDRESS-LINE-1-FLGS
  4093
  4094     MOVE 'State'                  TO WS-EDIT-VARIABLE-NAME
  4095     MOVE ACUP-NEW-CUST-ADDR-STATE-CD TO WS-EDIT-ALPHANUM-ONLY
  4096     MOVE 2                       TO WS-EDIT-ALPHANUM-LENGTH
  4097     PERFORM 1225-EDIT-ALPHA-REQD
  4098        THRU 1225-EDIT-ALPHA-REQD-EXIT
  4099     MOVE WS-EDIT-ALPHA-ONLY-FLAGS
  4100                                   TO WS-EDIT-STATE-FLGS
  4101     IF FLG-ALPHA-ISVALID
  4102     PERFORM 1270-EDIT-US-STATE-CD
  4103        THRU 1270-EDIT-US-STATE-CD-EXIT
  4104     END-IF
  4105
  4106
  4107     MOVE 'Zip'                    TO WS-EDIT-VARIABLE-NAME
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  77
* COACTUPC.cbl
  4108     MOVE ACUP-NEW-CUST-ADDR-ZIP   TO WS-EDIT-ALPHANUM-ONLY
  4109     MOVE 5                        TO WS-EDIT-ALPHANUM-LENGTH
  4110     PERFORM 1245-EDIT-NUM-REQD
  4111        THRU 1245-EDIT-NUM-REQD-EXIT
  4112     MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS
  4113                                   TO WS-EDIT-ZIPCODE-FLGS
  4114
  4115*    Address Line 2 is optional
  4116*    MOVE 'Address Line 2'         TO WS-EDIT-VARIABLE-NAME
  4117     MOVE 'City'                   TO WS-EDIT-VARIABLE-NAME
  4118     MOVE ACUP-NEW-CUST-ADDR-LINE-3 TO WS-EDIT-ALPHANUM-ONLY
  4119     MOVE 50                       TO WS-EDIT-ALPHANUM-LENGTH
  4120     PERFORM 1225-EDIT-ALPHA-REQD
  4121        THRU 1225-EDIT-ALPHA-REQD-EXIT
  4122     MOVE WS-EDIT-ALPHA-ONLY-FLAGS
  4123                                   TO WS-EDIT-CITY-FLGS
  4124
  4125     MOVE 'Country'                TO WS-EDIT-VARIABLE-NAME
  4126     MOVE ACUP-NEW-CUST-ADDR-COUNTRY-CD
  4127                                  TO WS-EDIT-ALPHANUM-ONLY
  4128     MOVE 3                       TO WS-EDIT-ALPHANUM-LENGTH
  4129     PERFORM 1225-EDIT-ALPHA-REQD
  4130        THRU 1225-EDIT-ALPHA-REQD-EXIT
  4131     MOVE WS-EDIT-ALPHA-ONLY-FLAGS
  4132                                   TO WS-EDIT-COUNTRY-FLGS
  4133
  4134     MOVE 'Phone Number 1'         TO WS-EDIT-VARIABLE-NAME
  4135     MOVE ACUP-NEW-CUST-PHONE-NUM-1
  4136                                   TO WS-EDIT-US-PHONE-NUM
  4137     PERFORM 1260-EDIT-US-PHONE-NUM
  4138        THRU 1260-EDIT-US-PHONE-NUM-EXIT
  4139     MOVE WS-EDIT-US-PHONE-NUM-FLGS
  4140                                   TO  WS-EDIT-PHONE-NUM-1-FLGS
  4141
  4142     MOVE 'Phone Number 2'         TO WS-EDIT-VARIABLE-NAME
  4143     MOVE ACUP-NEW-CUST-PHONE-NUM-2
  4144                                   TO WS-EDIT-US-PHONE-NUM
  4145     PERFORM 1260-EDIT-US-PHONE-NUM
  4146        THRU 1260-EDIT-US-PHONE-NUM-EXIT
  4147     MOVE WS-EDIT-US-PHONE-NUM-FLGS
  4148                                   TO WS-EDIT-PHONE-NUM-2-FLGS
  4149
  4150     MOVE 'EFT Account Id'         TO WS-EDIT-VARIABLE-NAME
  4151     MOVE ACUP-NEW-CUST-EFT-ACCOUNT-ID
  4152                                   TO WS-EDIT-ALPHANUM-ONLY
  4153     MOVE 10                       TO WS-EDIT-ALPHANUM-LENGTH
  4154     PERFORM 1245-EDIT-NUM-REQD
  4155        THRU 1245-EDIT-NUM-REQD-EXIT
  4156     MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS
  4157                                   TO WS-EFT-ACCOUNT-ID-FLGS
  4158
  4159     MOVE 'Primary Card Holder'    TO WS-EDIT-VARIABLE-NAME
  4160     MOVE ACUP-NEW-CUST-PRI-HOLDER-IND
  4161                                   TO WS-EDIT-YES-NO
  4162     PERFORM 1220-EDIT-YESNO
  4163        THRU 1220-EDIT-YESNO-EXIT
  4164     MOVE WS-EDIT-YES-NO           TO WS-EDIT-PRI-CARDHOLDER
  4165
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  78
* COACTUPC.cbl
  4166*    Cross field edits begin here
  4167     IF  FLG-STATE-ISVALID
  4168     AND FLG-ZIPCODE-ISVALID
  4169         PERFORM 1280-EDIT-US-STATE-ZIP-CD
  4170            THRU 1280-EDIT-US-STATE-ZIP-CD-EXIT
  4171     END-IF
  4172
  4173     IF INPUT-ERROR
  4174        CONTINUE
  4175     ELSE
  4176        SET ACUP-CHANGES-OK-NOT-CONFIRMED TO TRUE
  4177     END-IF
  4178     .
  4179
  4180 1200-EDIT-MAP-INPUTS-EXIT.
  4181     EXIT
  4182     .
  4183 1205-COMPARE-OLD-NEW.
  4184     SET NO-CHANGES-FOUND           TO TRUE
  4185
  4186     IF  ACUP-NEW-ACCT-ID-X         = ACUP-OLD-ACCT-ID-X
  4187     AND FUNCTION UPPER-CASE (
  4188         ACUP-NEW-ACTIVE-STATUS)    =
  4189         FUNCTION UPPER-CASE (
  4190         ACUP-OLD-ACTIVE-STATUS)
  4191     AND ACUP-NEW-CURR-BAL          = ACUP-OLD-CURR-BAL
  4192     AND ACUP-NEW-CREDIT-LIMIT      = ACUP-OLD-CREDIT-LIMIT
  4193     AND ACUP-NEW-CASH-CREDIT-LIMIT = ACUP-OLD-CASH-CREDIT-LIMIT
  4194     AND ACUP-NEW-OPEN-DATE         = ACUP-OLD-OPEN-DATE
  4195     AND ACUP-NEW-EXPIRAION-DATE    = ACUP-OLD-EXPIRAION-DATE
  4196     AND ACUP-NEW-REISSUE-DATE      = ACUP-OLD-REISSUE-DATE
  4197     AND ACUP-NEW-CURR-CYC-CREDIT   = ACUP-OLD-CURR-CYC-CREDIT
  4198     AND ACUP-NEW-CURR-CYC-DEBIT    = ACUP-OLD-CURR-CYC-DEBIT
  4199     AND FUNCTION UPPER-CASE (
  4200         FUNCTION TRIM (ACUP-NEW-GROUP-ID)) =
  4201         FUNCTION UPPER-CASE (
  4202         FUNCTION TRIM (ACUP-OLD-GROUP-ID))
  4203         CONTINUE
  4204     ELSE
  4205         SET CHANGE-HAS-OCCURRED   TO TRUE
  4206         GO TO 1205-COMPARE-OLD-NEW-EXIT
  4207     END-IF
  4208
  4209
  4210     IF  FUNCTION UPPER-CASE (
  4211         FUNCTION TRIM (ACUP-NEW-CUST-ID-X)) =
  4212         FUNCTION UPPER-CASE (
  4213         FUNCTION TRIM (ACUP-OLD-CUST-ID-X))
  4214     AND FUNCTION UPPER-CASE (
  4215         FUNCTION TRIM (ACUP-NEW-CUST-FIRST-NAME)) =
  4216         FUNCTION UPPER-CASE (
  4217         FUNCTION TRIM (ACUP-OLD-CUST-FIRST-NAME))
  4218     AND FUNCTION UPPER-CASE (
  4219         FUNCTION TRIM (ACUP-NEW-CUST-MIDDLE-NAME)) =
  4220         FUNCTION UPPER-CASE (
  4221         FUNCTION TRIM (ACUP-OLD-CUST-MIDDLE-NAME))
  4222     AND FUNCTION UPPER-CASE (
  4223         FUNCTION TRIM (ACUP-NEW-CUST-LAST-NAME)) =
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  79
* COACTUPC.cbl
  4224         FUNCTION UPPER-CASE (
  4225         FUNCTION TRIM (ACUP-OLD-CUST-LAST-NAME))
  4226     AND FUNCTION UPPER-CASE (
  4227         FUNCTION TRIM (ACUP-NEW-CUST-ADDR-LINE-1)) =
  4228         FUNCTION UPPER-CASE (
  4229         FUNCTION TRIM (ACUP-OLD-CUST-ADDR-LINE-1))
  4230     AND FUNCTION UPPER-CASE (
  4231         FUNCTION TRIM (ACUP-NEW-CUST-ADDR-LINE-2)) =
  4232         FUNCTION UPPER-CASE (
  4233         FUNCTION TRIM (ACUP-OLD-CUST-ADDR-LINE-2))
  4234     AND FUNCTION UPPER-CASE (
  4235         FUNCTION TRIM (ACUP-NEW-CUST-ADDR-LINE-3)) =
  4236         FUNCTION UPPER-CASE (
  4237         FUNCTION TRIM (ACUP-OLD-CUST-ADDR-LINE-3))
  4238     AND FUNCTION UPPER-CASE (
  4239         FUNCTION TRIM (ACUP-NEW-CUST-ADDR-STATE-CD)) =
  4240         FUNCTION UPPER-CASE (
  4241         FUNCTION TRIM (ACUP-OLD-CUST-ADDR-STATE-CD))
  4242     AND FUNCTION UPPER-CASE (
  4243         FUNCTION TRIM (ACUP-NEW-CUST-ADDR-COUNTRY-CD)) =
  4244         FUNCTION UPPER-CASE (
  4245         FUNCTION TRIM (ACUP-OLD-CUST-ADDR-COUNTRY-CD))
  4246     AND FUNCTION UPPER-CASE (
  4247         FUNCTION TRIM (ACUP-NEW-CUST-ADDR-ZIP)) =
  4248         FUNCTION UPPER-CASE (
  4249         FUNCTION TRIM (ACUP-OLD-CUST-ADDR-ZIP))
  4250     AND ACUP-NEW-CUST-PHONE-NUM-1A = ACUP-OLD-CUST-PHONE-NUM-1A
  4251     AND ACUP-NEW-CUST-PHONE-NUM-1B = ACUP-OLD-CUST-PHONE-NUM-1B
  4252     AND ACUP-NEW-CUST-PHONE-NUM-1C = ACUP-OLD-CUST-PHONE-NUM-1C
  4253     AND ACUP-NEW-CUST-PHONE-NUM-2A = ACUP-OLD-CUST-PHONE-NUM-2A
  4254     AND ACUP-NEW-CUST-PHONE-NUM-2B = ACUP-OLD-CUST-PHONE-NUM-2B
  4255     AND ACUP-NEW-CUST-PHONE-NUM-2C = ACUP-OLD-CUST-PHONE-NUM-2C
  4256     AND ACUP-NEW-CUST-SSN-X       = ACUP-OLD-CUST-SSN-X
  4257     AND FUNCTION UPPER-CASE (
  4258         FUNCTION TRIM (ACUP-NEW-CUST-GOVT-ISSUED-ID )) =
  4259         FUNCTION UPPER-CASE (
  4260         FUNCTION TRIM (ACUP-OLD-CUST-GOVT-ISSUED-ID))
  4261     AND ACUP-NEW-CUST-DOB-YYYY-MM-DD
  4262                               = ACUP-OLD-CUST-DOB-YYYY-MM-DD
  4263     AND ACUP-NEW-CUST-EFT-ACCOUNT-ID
  4264                               = ACUP-OLD-CUST-EFT-ACCOUNT-ID
  4265     AND FUNCTION UPPER-CASE (
  4266         FUNCTION TRIM (ACUP-NEW-CUST-PRI-HOLDER-IND)) =
  4267         FUNCTION UPPER-CASE (
  4268         FUNCTION TRIM (ACUP-OLD-CUST-PRI-HOLDER-IND))
  4269     AND ACUP-NEW-CUST-FICO-SCORE-X
  4270                               = ACUP-OLD-CUST-FICO-SCORE-X
  4271         SET NO-CHANGES-DETECTED   TO TRUE
  4272     ELSE
  4273         SET CHANGE-HAS-OCCURRED   TO TRUE
  4274         GO TO 1205-COMPARE-OLD-NEW-EXIT
  4275     END-IF
  4276
  4277     .
  4278
  4279 1205-COMPARE-OLD-NEW-EXIT.
  4280     EXIT
  4281     .
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  80
* COACTUPC.cbl
  4282
  4283
  4284*
  4285 1210-EDIT-ACCOUNT.
  4286     SET FLG-ACCTFILTER-NOT-OK    TO TRUE
  4287
  4288*    Not supplied
  4289     IF CC-ACCT-ID   EQUAL LOW-VALUES
  4290     OR CC-ACCT-ID   EQUAL SPACES
  4291        SET INPUT-ERROR           TO TRUE
  4292        SET FLG-ACCTFILTER-BLANK  TO TRUE
  4293        IF WS-RETURN-MSG-OFF
  4294           SET WS-PROMPT-FOR-ACCT TO TRUE
  4295        END-IF
  4296        MOVE ZEROES               TO CDEMO-ACCT-ID
  4297                                     ACUP-NEW-ACCT-ID
  4298        GO TO  1210-EDIT-ACCOUNT-EXIT
  4299     END-IF
  4300
  4301*    Not numeric
  4302*    Not 11 characters
  4303     MOVE CC-ACCT-ID              TO ACUP-NEW-ACCT-ID
  4304     IF CC-ACCT-ID   IS NOT NUMERIC
  4305     OR CC-ACCT-ID-N EQUAL ZEROS
  4306        SET INPUT-ERROR TO TRUE
  4307        IF WS-RETURN-MSG-OFF
  4308          STRING
  4309           'Account Number if supplied must be a 11 digit'
  4310           ' Non-Zero Number'
  4311          DELIMITED BY SIZE
  4312          INTO WS-RETURN-MSG
  4313        END-IF
  4314        MOVE ZEROES               TO CDEMO-ACCT-ID
  4315        GO TO 1210-EDIT-ACCOUNT-EXIT
  4316     ELSE
  4317        MOVE CC-ACCT-ID TO CDEMO-ACCT-ID
  4318        SET FLG-ACCTFILTER-ISVALID TO TRUE
  4319     END-IF
  4320     .
  4321
  4322 1210-EDIT-ACCOUNT-EXIT.
  4323     EXIT
  4324     .
  4325
  4326 1215-EDIT-MANDATORY.
  4327*    Initialize
  4328     SET FLG-MANDATORY-NOT-OK    TO TRUE
  4329
  4330*    Not supplied
  4331     IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)
  4332                                 EQUAL LOW-VALUES
  4333     OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)
  4334                                 EQUAL SPACES
  4335     OR FUNCTION LENGTH(FUNCTION TRIM(
  4336        WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0
  4337
  4338        SET INPUT-ERROR          TO TRUE
  4339        SET FLG-MANDATORY-BLANK  TO TRUE
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  81
* COACTUPC.cbl
  4340        IF WS-RETURN-MSG-OFF
  4341           STRING
  4342             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4343             ' must be supplied.'
  4344             DELIMITED BY SIZE
  4345             INTO WS-RETURN-MSG
  4346           END-STRING
  4347        END-IF
  4348
  4349        GO TO  1215-EDIT-MANDATORY-EXIT
  4350     END-IF
  4351
  4352     SET FLG-MANDATORY-ISVALID   TO TRUE
  4353     .
  4354 1215-EDIT-MANDATORY-EXIT.
  4355     EXIT
  4356     .
  4357
  4358 1220-EDIT-YESNO.
  4359*    Must be Y or N
  4360*    SET FLG-YES-NO-NOT-OK         TO TRUE
  4361*
  4362*    Not supplied
  4363     IF WS-EDIT-YES-NO             EQUAL LOW-VALUES
  4364     OR WS-EDIT-YES-NO             EQUAL SPACES
  4365     OR WS-EDIT-YES-NO             EQUAL ZEROS
  4366        SET INPUT-ERROR            TO TRUE
  4367        SET FLG-YES-NO-BLANK       TO TRUE
  4368        IF WS-RETURN-MSG-OFF
  4369           STRING
  4370             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4371             ' must be supplied.'
  4372             DELIMITED BY SIZE
  4373             INTO WS-RETURN-MSG
  4374           END-STRING
  4375        END-IF
  4376        GO TO  1220-EDIT-YESNO-EXIT
  4377     END-IF
  4378
  4379
  4380     IF FLG-YES-NO-ISVALID
  4381        CONTINUE
  4382     ELSE
  4383        SET INPUT-ERROR             TO TRUE
  4384        SET FLG-YES-NO-NOT-OK       TO TRUE
  4385        IF WS-RETURN-MSG-OFF
  4386           STRING
  4387             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4388             ' must be Y or N.'
  4389             DELIMITED BY SIZE
  4390             INTO WS-RETURN-MSG
  4391           END-STRING
  4392        END-IF
  4393        GO TO  1220-EDIT-YESNO-EXIT
  4394     END-IF
  4395     .
  4396 1220-EDIT-YESNO-EXIT.
  4397     EXIT
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  82
* COACTUPC.cbl
  4398     .
  4399
  4400 1225-EDIT-ALPHA-REQD.
  4401*    Initialize
  4402     SET FLG-ALPHA-NOT-OK              TO TRUE
  4403
  4404*    Not supplied
  4405     IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)
  4406                                       EQUAL LOW-VALUES
  4407     OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)
  4408         EQUAL SPACES
  4409     OR FUNCTION LENGTH(FUNCTION TRIM(
  4410        WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0
  4411
  4412        SET INPUT-ERROR                TO TRUE
  4413        SET FLG-ALPHA-BLANK            TO TRUE
  4414        IF WS-RETURN-MSG-OFF
  4415           STRING
  4416             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4417             ' must be supplied.'
  4418             DELIMITED BY SIZE
  4419             INTO WS-RETURN-MSG
  4420           END-STRING
  4421        END-IF
  4422
  4423        GO TO  1225-EDIT-ALPHA-REQD-EXIT
  4424     END-IF
  4425
  4426*    Only Alphabets and space allowed
  4427     MOVE LIT-ALL-ALPHA-FROM-X   TO LIT-ALL-ALPHA-FROM
  4428     INSPECT WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)
  4429       CONVERTING LIT-ALL-ALPHA-FROM
  4430               TO LIT-ALPHA-SPACES-TO
  4431
  4432     IF FUNCTION LENGTH(
  4433             FUNCTION TRIM(
  4434             WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)
  4435                            )) = 0
  4436        CONTINUE
  4437     ELSE
  4438        SET INPUT-ERROR           TO TRUE
  4439        SET FLG-ALPHA-NOT-OK      TO TRUE
  4440        IF WS-RETURN-MSG-OFF
  4441           STRING
  4442             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4443             ' can have alphabets only.'
  4444             DELIMITED BY SIZE
  4445             INTO WS-RETURN-MSG
  4446           END-STRING
  4447        END-IF
  4448        GO TO  1225-EDIT-ALPHA-REQD-EXIT
  4449     END-IF
  4450
  4451     SET FLG-ALPHA-ISVALID        TO TRUE
  4452     .
  4453 1225-EDIT-ALPHA-REQD-EXIT.
  4454     EXIT
  4455     .
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  83
* COACTUPC.cbl
  4456
  4457 1230-EDIT-ALPHANUM-REQD.
  4458*    Initialize
  4459     SET FLG-ALPHNANUM-NOT-OK          TO TRUE
  4460
  4461*    Not supplied
  4462     IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)
  4463                                       EQUAL LOW-VALUES
  4464     OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)
  4465         EQUAL SPACES
  4466     OR FUNCTION LENGTH(FUNCTION TRIM(
  4467        WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0
  4468
  4469        SET INPUT-ERROR                TO TRUE
  4470        SET FLG-ALPHNANUM-BLANK        TO TRUE
  4471        IF WS-RETURN-MSG-OFF
  4472           STRING
  4473             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4474             ' must be supplied.'
  4475             DELIMITED BY SIZE
  4476             INTO WS-RETURN-MSG
  4477           END-STRING
  4478        END-IF
  4479
  4480        GO TO  1230-EDIT-ALPHANUM-REQD-EXIT
  4481     END-IF
  4482
  4483*    Only Alphabets,numbers and space allowed
  4484     MOVE LIT-ALL-ALPHANUM-FROM-X TO LIT-ALL-ALPHANUM-FROM
  4485
  4486     INSPECT WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)
  4487       CONVERTING LIT-ALL-ALPHANUM-FROM
  4488               TO LIT-ALPHANUM-SPACES-TO
  4489
  4490     IF FUNCTION LENGTH(
  4491             FUNCTION TRIM(
  4492             WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)
  4493                            )) = 0
  4494        CONTINUE
  4495     ELSE
  4496        SET INPUT-ERROR           TO TRUE
  4497        SET FLG-ALPHNANUM-NOT-OK  TO TRUE
  4498        IF WS-RETURN-MSG-OFF
  4499           STRING
  4500             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4501             ' can have numbers or alphabets only.'
  4502             DELIMITED BY SIZE
  4503             INTO WS-RETURN-MSG
  4504           END-STRING
  4505        END-IF
  4506        GO TO  1230-EDIT-ALPHANUM-REQD-EXIT
  4507     END-IF
  4508
  4509     SET FLG-ALPHNANUM-ISVALID    TO TRUE
  4510     .
  4511 1230-EDIT-ALPHANUM-REQD-EXIT.
  4512     EXIT
  4513     .
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  84
* COACTUPC.cbl
  4514 1235-EDIT-ALPHA-OPT.
  4515*    Initialize
  4516     SET FLG-ALPHA-NOT-OK              TO TRUE
  4517
  4518*    Not supplied
  4519     IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)
  4520                                       EQUAL LOW-VALUES
  4521     OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)
  4522         EQUAL SPACES
  4523     OR FUNCTION LENGTH(FUNCTION TRIM(
  4524        WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0
  4525
  4526        SET FLG-ALPHA-ISVALID          TO TRUE
  4527        GO TO  1235-EDIT-ALPHA-OPT-EXIT
  4528     ELSE
  4529        CONTINUE
  4530     END-IF
  4531
  4532*    Only Alphabets and space allowed
  4533     MOVE LIT-ALL-ALPHA-FROM-X    TO LIT-ALL-ALPHA-FROM
  4534     INSPECT WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)
  4535       CONVERTING LIT-ALL-ALPHA-FROM
  4536               TO LIT-ALPHA-SPACES-TO
  4537
  4538     IF FUNCTION LENGTH(
  4539             FUNCTION TRIM(
  4540             WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)
  4541                            )) = 0
  4542        CONTINUE
  4543     ELSE
  4544        SET INPUT-ERROR           TO TRUE
  4545        SET FLG-ALPHA-NOT-OK      TO TRUE
  4546        IF WS-RETURN-MSG-OFF
  4547           STRING
  4548             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4549             ' can have alphabets only.'
  4550             DELIMITED BY SIZE
  4551             INTO WS-RETURN-MSG
  4552           END-STRING
  4553        END-IF
  4554        GO TO  1235-EDIT-ALPHA-OPT-EXIT
  4555     END-IF
  4556
  4557     SET FLG-ALPHA-ISVALID        TO TRUE
  4558     .
  4559 1235-EDIT-ALPHA-OPT-EXIT.
  4560     EXIT
  4561     .
  4562
  4563 1240-EDIT-ALPHANUM-OPT.
  4564*    Initialize
  4565     SET FLG-ALPHNANUM-NOT-OK          TO TRUE
  4566
  4567*    Not supplied, but ok as optional
  4568     IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)
  4569                                       EQUAL LOW-VALUES
  4570     OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)
  4571         EQUAL SPACES
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  85
* COACTUPC.cbl
  4572     OR FUNCTION LENGTH(FUNCTION TRIM(
  4573        WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0
  4574        SET FLG-ALPHNANUM-ISVALID     TO TRUE
  4575        GO TO  1240-EDIT-ALPHANUM-OPT-EXIT
  4576     ELSE
  4577        CONTINUE
  4578     END-IF
  4579
  4580*    Only Alphabets and space allowed
  4581     MOVE LIT-ALL-ALPHANUM-FROM-X TO LIT-ALL-ALPHANUM-FROM
  4582     INSPECT WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)
  4583       CONVERTING LIT-ALL-ALPHANUM-FROM
  4584               TO LIT-ALPHANUM-SPACES-TO
  4585
  4586     IF FUNCTION LENGTH(
  4587             FUNCTION TRIM(
  4588             WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)
  4589                            )) = 0
  4590        CONTINUE
  4591     ELSE
  4592        SET INPUT-ERROR           TO TRUE
  4593        SET FLG-ALPHNANUM-NOT-OK  TO TRUE
  4594        IF WS-RETURN-MSG-OFF
  4595           STRING
  4596             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4597             ' can have numbers or alphabets only.'
  4598             DELIMITED BY SIZE
  4599             INTO WS-RETURN-MSG
  4600           END-STRING
  4601        END-IF
  4602        GO TO  1240-EDIT-ALPHANUM-OPT-EXIT
  4603     END-IF
  4604
  4605     SET FLG-ALPHNANUM-ISVALID    TO TRUE
  4606     .
  4607 1240-EDIT-ALPHANUM-OPT-EXIT.
  4608     EXIT
  4609     .
  4610
  4611 1245-EDIT-NUM-REQD.
  4612*    Initialize
  4613     SET FLG-ALPHNANUM-NOT-OK          TO TRUE
  4614
  4615*    Not supplied
  4616     IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)
  4617                                       EQUAL LOW-VALUES
  4618     OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)
  4619         EQUAL SPACES
  4620     OR FUNCTION LENGTH(FUNCTION TRIM(
  4621        WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH))) = 0
  4622
  4623        SET INPUT-ERROR                TO TRUE
  4624        SET FLG-ALPHNANUM-BLANK        TO TRUE
  4625        IF WS-RETURN-MSG-OFF
  4626           STRING
  4627             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4628             ' must be supplied.'
  4629             DELIMITED BY SIZE
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  86
* COACTUPC.cbl
  4630             INTO WS-RETURN-MSG
  4631           END-STRING
  4632        END-IF
  4633
  4634        GO TO  1245-EDIT-NUM-REQD-EXIT
  4635     END-IF
  4636
  4637*    Only all numeric allowed
  4638
  4639     IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)
  4640            IS NUMERIC
  4641        CONTINUE
  4642     ELSE
  4643        SET INPUT-ERROR           TO TRUE
  4644        SET FLG-ALPHNANUM-NOT-OK  TO TRUE
  4645        IF WS-RETURN-MSG-OFF
  4646           STRING
  4647             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4648             ' must be all numeric.'
  4649             DELIMITED BY SIZE
  4650             INTO WS-RETURN-MSG
  4651           END-STRING
  4652        END-IF
  4653        GO TO  1245-EDIT-NUM-REQD-EXIT
  4654     END-IF
  4655
  4656*    Must not be zero
  4657
  4658     IF FUNCTION NUMVAL(WS-EDIT-ALPHANUM-ONLY(1:
  4659                        WS-EDIT-ALPHANUM-LENGTH)) = 0
  4660        SET INPUT-ERROR           TO TRUE
  4661        SET FLG-ALPHNANUM-NOT-OK  TO TRUE
  4662        IF WS-RETURN-MSG-OFF
  4663           STRING
  4664             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4665             ' must not be zero.'
  4666             DELIMITED BY SIZE
  4667             INTO WS-RETURN-MSG
  4668           END-STRING
  4669        END-IF
  4670        GO TO  1245-EDIT-NUM-REQD-EXIT
  4671     ELSE
  4672        CONTINUE
  4673     END-IF
  4674
  4675
  4676     SET FLG-ALPHNANUM-ISVALID    TO TRUE
  4677     .
  4678 1245-EDIT-NUM-REQD-EXIT.
  4679     EXIT
  4680     .
  4681
  4682 1250-EDIT-SIGNED-9V2.
  4683     SET FLG-SIGNED-NUMBER-NOT-OK    TO TRUE
  4684
  4685*    Not supplied
  4686     IF WS-EDIT-SIGNED-NUMBER-9V2-X  EQUAL LOW-VALUES
  4687     OR WS-EDIT-SIGNED-NUMBER-9V2-X  EQUAL SPACES
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  87
* COACTUPC.cbl
  4688        SET INPUT-ERROR              TO TRUE
  4689        SET FLG-SIGNED-NUMBER-BLANK  TO TRUE
  4690        IF WS-RETURN-MSG-OFF
  4691           STRING
  4692             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4693             ' must be supplied.'
  4694             DELIMITED BY SIZE
  4695             INTO WS-RETURN-MSG
  4696           END-STRING
  4697        END-IF
  4698        GO TO  1250-EDIT-SIGNED-9V2-EXIT
  4699     ELSE
  4700        CONTINUE
  4701     END-IF
  4702
  4703     IF FUNCTION TEST-NUMVAL-C(WS-EDIT-SIGNED-NUMBER-9V2-X) = 0
  4704        CONTINUE
  4705     ELSE
  4706        SET INPUT-ERROR             TO TRUE
  4707        SET FLG-SIGNED-NUMBER-NOT-OK   TO TRUE
  4708        IF WS-RETURN-MSG-OFF
  4709           STRING
  4710             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4711             ' is not valid'
  4712             DELIMITED BY SIZE
  4713             INTO WS-RETURN-MSG
  4714        END-IF
  4715        GO TO  1250-EDIT-SIGNED-9V2-EXIT
  4716
  4717     END-IF
  4718
  4719*    If we got here all edits were cleared
  4720     SET FLG-SIGNED-NUMBER-ISVALID  TO TRUE
  4721     .
  4722
  4723 1250-EDIT-SIGNED-9V2-EXIT.
  4724     EXIT
  4725     .
  4726
  4727 1260-EDIT-US-PHONE-NUM.
  4728
  4729*    The database stores date in X(15) format (999)999-9999
  4730*                                             1234567890123
  4731*    So we take the X(15) input into WS-EDIT-US-PHONE-NUM
  4732*    and edit it
  4733
  4734     SET WS-EDIT-US-PHONE-IS-INVALID TO TRUE
  4735*    Not mandatory to enter a phone number
  4736     IF  (WS-EDIT-US-PHONE-NUMA EQUAL SPACES
  4737     OR   WS-EDIT-US-PHONE-NUMA EQUAL LOW-VALUES)
  4738     AND (WS-EDIT-US-PHONE-NUMB EQUAL SPACES
  4739     OR   WS-EDIT-US-PHONE-NUMB EQUAL LOW-VALUES)
  4740     AND (WS-EDIT-US-PHONE-NUMA EQUAL SPACES
  4741     OR   WS-EDIT-US-PHONE-NUMC EQUAL LOW-VALUES)
  4742          SET WS-EDIT-US-PHONE-IS-VALID TO TRUE
  4743          GO TO EDIT-US-PHONE-EXIT
  4744     ELSE
  4745          CONTINUE
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  88
* COACTUPC.cbl
  4746     END-IF
  4747     .
  4748 EDIT-AREA-CODE.
  4749     IF WS-EDIT-US-PHONE-NUMA EQUAL SPACES
  4750     OR WS-EDIT-US-PHONE-NUMA EQUAL LOW-VALUES
  4751        SET INPUT-ERROR              TO TRUE
  4752        SET FLG-EDIT-US-PHONEA-BLANK    TO TRUE
  4753        IF WS-RETURN-MSG-OFF
  4754           STRING
  4755             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4756             ': Area code must be supplied.'
  4757             DELIMITED BY SIZE
  4758             INTO WS-RETURN-MSG
  4759           END-STRING
  4760        END-IF
  4761        GO TO  EDIT-US-PHONE-PREFIX
  4762     ELSE
  4763        CONTINUE
  4764     END-IF
  4765
  4766     IF  WS-EDIT-US-PHONE-NUMA       IS NUMERIC
  4767        CONTINUE
  4768     ELSE
  4769        SET INPUT-ERROR                 TO TRUE
  4770        SET  FLG-EDIT-US-PHONEA-NOT-OK  TO TRUE
  4771        IF WS-RETURN-MSG-OFF
  4772           STRING
  4773             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4774             ': Area code must be A 3 digit number.'
  4775             DELIMITED BY SIZE
  4776             INTO WS-RETURN-MSG
  4777           END-STRING
  4778        END-IF
  4779        GO TO  EDIT-US-PHONE-PREFIX
  4780     END-IF
  4781
  4782     IF  WS-EDIT-US-PHONE-NUMA-N = 0
  4783        SET INPUT-ERROR              TO TRUE
  4784        SET  FLG-EDIT-US-PHONEA-NOT-OK  TO TRUE
  4785        IF WS-RETURN-MSG-OFF
  4786           STRING
  4787             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4788             ': Area code cannot be zero'
  4789             DELIMITED BY SIZE
  4790             INTO WS-RETURN-MSG
  4791           END-STRING
  4792        END-IF
  4793        GO TO  EDIT-US-PHONE-PREFIX
  4794     ELSE
  4795        CONTINUE
  4796     END-IF
  4797
  4798     MOVE FUNCTION TRIM (WS-EDIT-US-PHONE-NUMA)
  4799       TO WS-US-PHONE-AREA-CODE-TO-EDIT
  4800     IF VALID-GENERAL-PURP-CODE
  4801         CONTINUE
  4802     ELSE
  4803        SET INPUT-ERROR              TO TRUE
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  89
* COACTUPC.cbl
  4804        SET  FLG-EDIT-US-PHONEA-NOT-OK  TO TRUE
  4805        IF WS-RETURN-MSG-OFF
  4806           STRING
  4807             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4808             ': Not valid North America general purpose area code'
  4809             DELIMITED BY SIZE
  4810             INTO WS-RETURN-MSG
  4811           END-STRING
  4812        END-IF
  4813        GO TO  EDIT-US-PHONE-PREFIX
  4814     END-IF
  4815
  4816     SET FLG-EDIT-US-PHONEA-ISVALID    TO TRUE
  4817     .
  4818 EDIT-US-PHONE-PREFIX.
  4819
  4820     IF WS-EDIT-US-PHONE-NUMB EQUAL SPACES
  4821     OR WS-EDIT-US-PHONE-NUMB EQUAL LOW-VALUES
  4822        SET INPUT-ERROR              TO TRUE
  4823        SET FLG-EDIT-US-PHONEB-BLANK    TO TRUE
  4824        IF WS-RETURN-MSG-OFF
  4825           STRING
  4826             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4827             ': Prefix code must be supplied.'
  4828             DELIMITED BY SIZE
  4829             INTO WS-RETURN-MSG
  4830           END-STRING
  4831        END-IF
  4832        GO TO  EDIT-US-PHONE-LINENUM
  4833     ELSE
  4834        CONTINUE
  4835     END-IF
  4836
  4837     IF  WS-EDIT-US-PHONE-NUMB          IS NUMERIC
  4838        CONTINUE
  4839     ELSE
  4840        SET INPUT-ERROR                 TO TRUE
  4841        SET  FLG-EDIT-US-PHONEB-NOT-OK  TO TRUE
  4842        IF WS-RETURN-MSG-OFF
  4843           STRING
  4844             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4845             ': Prefix code must be A 3 digit number.'
  4846             DELIMITED BY SIZE
  4847             INTO WS-RETURN-MSG
  4848           END-STRING
  4849        END-IF
  4850        GO TO  EDIT-US-PHONE-LINENUM
  4851     END-IF
  4852
  4853     IF  WS-EDIT-US-PHONE-NUMB-N = 0
  4854        SET INPUT-ERROR              TO TRUE
  4855        SET  FLG-EDIT-US-PHONEB-NOT-OK  TO TRUE
  4856        IF WS-RETURN-MSG-OFF
  4857           STRING
  4858             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4859             ': Prefix code cannot be zero'
  4860             DELIMITED BY SIZE
  4861             INTO WS-RETURN-MSG
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  90
* COACTUPC.cbl
  4862           END-STRING
  4863        END-IF
  4864        GO TO  EDIT-US-PHONE-LINENUM
  4865     ELSE
  4866        CONTINUE
  4867     END-IF
  4868
  4869     SET FLG-EDIT-US-PHONEB-ISVALID    TO TRUE
  4870     .
  4871
  4872 EDIT-US-PHONE-LINENUM.
  4873     IF WS-EDIT-US-PHONE-NUMC EQUAL SPACES
  4874     OR WS-EDIT-US-PHONE-NUMC EQUAL LOW-VALUES
  4875        SET INPUT-ERROR              TO TRUE
  4876        SET FLG-EDIT-US-PHONEC-BLANK    TO TRUE
  4877        IF WS-RETURN-MSG-OFF
  4878           STRING
  4879             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4880             ': Line number code must be supplied.'
  4881             DELIMITED BY SIZE
  4882             INTO WS-RETURN-MSG
  4883           END-STRING
  4884        END-IF
  4885        GO TO EDIT-US-PHONE-EXIT
  4886     ELSE
  4887        CONTINUE
  4888     END-IF
  4889
  4890     IF  WS-EDIT-US-PHONE-NUMC          IS NUMERIC
  4891        CONTINUE
  4892     ELSE
  4893        SET INPUT-ERROR                 TO TRUE
  4894        SET  FLG-EDIT-US-PHONEC-NOT-OK  TO TRUE
  4895        IF WS-RETURN-MSG-OFF
  4896           STRING
  4897             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4898             ': Line number code must be A 4 digit number.'
  4899             DELIMITED BY SIZE
  4900             INTO WS-RETURN-MSG
  4901           END-STRING
  4902        END-IF
  4903        GO TO  EDIT-US-PHONE-EXIT
  4904     END-IF
  4905
  4906     IF  WS-EDIT-US-PHONE-NUMC-N = 0
  4907        SET INPUT-ERROR              TO TRUE
  4908        SET  FLG-EDIT-US-PHONEC-NOT-OK  TO TRUE
  4909        IF WS-RETURN-MSG-OFF
  4910           STRING
  4911             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4912             ': Line number code cannot be zero'
  4913             DELIMITED BY SIZE
  4914             INTO WS-RETURN-MSG
  4915           END-STRING
  4916        END-IF
  4917        GO TO  EDIT-US-PHONE-EXIT
  4918     ELSE
  4919         CONTINUE
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  91
* COACTUPC.cbl
  4920     END-IF
  4921
  4922
  4923     SET FLG-EDIT-US-PHONEC-ISVALID    TO TRUE
  4924     .
  4925
  4926 EDIT-US-PHONE-EXIT.
  4927     EXIT
  4928     .
  4929 1260-EDIT-US-PHONE-NUM-EXIT.
  4930     EXIT
  4931     .
  4932
  4933 1265-EDIT-US-SSN.
  4934*Format xxx-xx-xxxx
  4935*Part1 :should have 3 digits
  4936*Part2 :should have 2 digits and it should be from 01 to 99
  4937*Part3 should have 4 digits from 0001 to 9999.
  4938******************************************************************
  4939*    Edit SSN Part 1
  4940******************************************************************
  4941     MOVE 'SSN: First 3 chars'     TO WS-EDIT-VARIABLE-NAME
  4942     MOVE ACUP-NEW-CUST-SSN-1      TO WS-EDIT-ALPHANUM-ONLY
  4943     MOVE 3                        TO WS-EDIT-ALPHANUM-LENGTH
  4944     PERFORM 1245-EDIT-NUM-REQD
  4945        THRU 1245-EDIT-NUM-REQD-EXIT
  4946     MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS
  4947                                   TO WS-EDIT-US-SSN-PART1-FLGS
  4948
  4949*Part1 :should not be 000, 666, or between 900 and 999
  4950     IF FLG-EDIT-US-SSN-PART1-ISVALID
  4951        MOVE ACUP-NEW-CUST-SSN-1   TO WS-EDIT-US-SSN-PART1
  4952        IF INVALID-SSN-PART1
  4953        SET INPUT-ERROR            TO TRUE
  4954        SET FLG-EDIT-US-SSN-PART1-NOT-OK
  4955                           TO TRUE
  4956        IF WS-RETURN-MSG-OFF
  4957           STRING
  4958             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  4959             ': should not be 000, 666, or between 900 and 999'
  4960             DELIMITED BY SIZE
  4961             INTO WS-RETURN-MSG
  4962           END-STRING
  4963        ELSE
  4964          CONTINUE
  4965        END-IF
  4966     END-IF
  4967
  4968******************************************************************
  4969*    Edit SSN Part 2
  4970******************************************************************
  4971     MOVE 'SSN 4th & 5th chars'    TO WS-EDIT-VARIABLE-NAME
  4972     MOVE ACUP-NEW-CUST-SSN-2      TO WS-EDIT-ALPHANUM-ONLY
  4973     MOVE 2                        TO WS-EDIT-ALPHANUM-LENGTH
  4974     PERFORM 1245-EDIT-NUM-REQD
  4975        THRU 1245-EDIT-NUM-REQD-EXIT
  4976     MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS
  4977                                   TO WS-EDIT-US-SSN-PART2-FLGS
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  92
* COACTUPC.cbl
  4978
  4979
  4980******************************************************************
  4981*    Edit SSN Part 3
  4982******************************************************************
  4983     MOVE 'SSN Last 4 chars'       TO WS-EDIT-VARIABLE-NAME
  4984     MOVE ACUP-NEW-CUST-SSN-3      TO WS-EDIT-ALPHANUM-ONLY
  4985     MOVE 4                        TO WS-EDIT-ALPHANUM-LENGTH
  4986     PERFORM 1245-EDIT-NUM-REQD
  4987        THRU 1245-EDIT-NUM-REQD-EXIT
  4988     MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS
  4989                                   TO WS-EDIT-US-SSN-PART3-FLGS
  4990     .
  4991 1265-EDIT-US-SSN-EXIT.
  4992     EXIT
  4993     .
  4994
  4995 1270-EDIT-US-STATE-CD.
  4996     MOVE ACUP-NEW-CUST-ADDR-STATE-CD TO US-STATE-CODE-TO-EDIT
  4997     IF VALID-US-STATE-CODE
  4998         CONTINUE
  4999     ELSE
  5000        SET INPUT-ERROR              TO TRUE
  5001        SET FLG-STATE-NOT-OK         TO TRUE
  5002        IF WS-RETURN-MSG-OFF
  5003           STRING
  5004             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  5005             ': is not a valid state code'
  5006             DELIMITED BY SIZE
  5007             INTO WS-RETURN-MSG
  5008           END-STRING
  5009        END-IF
  5010        GO TO  1270-EDIT-US-STATE-CD-EXIT
  5011     END-IF
  5012     .
  5013 1270-EDIT-US-STATE-CD-EXIT.
  5014     EXIT
  5015     .
  5016 1275-EDIT-FICO-SCORE.
  5017     IF FICO-RANGE-IS-VALID
  5018         CONTINUE
  5019     ELSE
  5020        SET INPUT-ERROR              TO TRUE
  5021        SET FLG-FICO-SCORE-NOT-OK    TO TRUE
  5022        IF WS-RETURN-MSG-OFF
  5023           STRING
  5024             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  5025             ': should be between 300 and 850'
  5026             DELIMITED BY SIZE
  5027             INTO WS-RETURN-MSG
  5028           END-STRING
  5029        END-IF
  5030        GO TO  1275-EDIT-FICO-SCORE-EXIT
  5031     END-IF
  5032     .
  5033 1275-EDIT-FICO-SCORE-EXIT.
  5034     EXIT
  5035     .
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  93
* COACTUPC.cbl
  5036
  5037*A crude zip code edit based on data from USPS web site
  5038 1280-EDIT-US-STATE-ZIP-CD.
  5039     STRING ACUP-NEW-CUST-ADDR-STATE-CD
  5040            ACUP-NEW-CUST-ADDR-ZIP(1:2)
  5041       DELIMITED BY SIZE
  5042       INTO US-STATE-AND-FIRST-ZIP2
  5043
  5044     IF VALID-US-STATE-ZIP-CD2-COMBO
  5045         CONTINUE
  5046     ELSE
  5047        SET INPUT-ERROR              TO TRUE
  5048        SET FLG-STATE-NOT-OK         TO TRUE
  5049        SET FLG-ZIPCODE-NOT-OK       TO TRUE
  5050        IF WS-RETURN-MSG-OFF
  5051           STRING
  5052             'Invalid zip code for state'
  5053             DELIMITED BY SIZE
  5054             INTO WS-RETURN-MSG
  5055           END-STRING
  5056        END-IF
  5057        GO TO  1280-EDIT-US-STATE-ZIP-CD-EXIT
  5058     END-IF
  5059     .
  5060 1280-EDIT-US-STATE-ZIP-CD-EXIT.
  5061     EXIT
  5062     .
  5063
  5064 2000-DECIDE-ACTION.
  5065     EVALUATE TRUE
  5066******************************************************************
  5067*       NO DETAILS SHOWN.
  5068*       SO GET THEM AND SETUP DETAIL EDIT SCREEN
  5069******************************************************************
  5070        WHEN ACUP-DETAILS-NOT-FETCHED
  5071******************************************************************
  5072*       CHANGES MADE. BUT USER CANCELS
  5073******************************************************************
  5074        WHEN CCARD-AID-PFK12
  5075           IF  FLG-ACCTFILTER-ISVALID
  5076               SET WS-RETURN-MSG-OFF       TO TRUE
  5077               PERFORM 9000-READ-ACCT
  5078                  THRU 9000-READ-ACCT-EXIT
  5079               IF FOUND-CUST-IN-MASTER
  5080                  SET ACUP-SHOW-DETAILS    TO TRUE
  5081               END-IF
  5082           END-IF
  5083******************************************************************
  5084*       DETAILS SHOWN
  5085*       CHECK CHANGES AND ASK CONFIRMATION IF GOOD
  5086******************************************************************
  5087        WHEN ACUP-SHOW-DETAILS
  5088           IF INPUT-ERROR
  5089           OR NO-CHANGES-DETECTED
  5090              CONTINUE
  5091           ELSE
  5092              SET ACUP-CHANGES-OK-NOT-CONFIRMED TO TRUE
  5093           END-IF
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  94
* COACTUPC.cbl
  5094******************************************************************
  5095*       DETAILS SHOWN
  5096*       BUT INPUT EDIT ERRORS FOUND
  5097******************************************************************
  5098        WHEN ACUP-CHANGES-NOT-OK
  5099            CONTINUE
  5100******************************************************************
  5101*       DETAILS EDITED , FOUND OK, CONFIRM SAVE REQUESTED
  5102*       CONFIRMATION GIVEN.SO SAVE THE CHANGES
  5103******************************************************************
  5104        WHEN ACUP-CHANGES-OK-NOT-CONFIRMED
  5105         AND CCARD-AID-PFK05
  5106           PERFORM 9600-WRITE-PROCESSING
  5107              THRU 9600-WRITE-PROCESSING-EXIT
  5108           EVALUATE TRUE
  5109              WHEN COULD-NOT-LOCK-ACCT-FOR-UPDATE
  5110                   SET ACUP-CHANGES-OKAYED-LOCK-ERROR TO TRUE
  5111              WHEN LOCKED-BUT-UPDATE-FAILED
  5112                 SET ACUP-CHANGES-OKAYED-BUT-FAILED TO TRUE
  5113              WHEN DATA-WAS-CHANGED-BEFORE-UPDATE
  5114                  SET ACUP-SHOW-DETAILS            TO TRUE
  5115              WHEN OTHER
  5116                 SET ACUP-CHANGES-OKAYED-AND-DONE   TO TRUE
  5117           END-EVALUATE
  5118******************************************************************
  5119*       DETAILS EDITED , FOUND OK, CONFIRM SAVE REQUESTED
  5120*       CONFIRMATION NOT GIVEN. SO SHOW DETAILS AGAIN
  5121******************************************************************
  5122        WHEN ACUP-CHANGES-OK-NOT-CONFIRMED
  5123            CONTINUE
  5124******************************************************************
  5125*       SHOW CONFIRMATION. GO BACK TO SQUARE 1
  5126******************************************************************
  5127        WHEN ACUP-CHANGES-OKAYED-AND-DONE
  5128            SET ACUP-SHOW-DETAILS TO TRUE
  5129            IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES
  5130            OR CDEMO-FROM-TRANID    EQUAL SPACES
  5131               MOVE ZEROES       TO CDEMO-ACCT-ID
  5132                                    CDEMO-CARD-NUM
  5133               MOVE LOW-VALUES   TO CDEMO-ACCT-STATUS
  5134            END-IF
  5135        WHEN OTHER
  5136             MOVE LIT-THISPGM    TO ABEND-CULPRIT
  5137             MOVE '0001'         TO ABEND-CODE
  5138             MOVE SPACES         TO ABEND-REASON
  5139             MOVE 'UNEXPECTED DATA SCENARIO'
  5140                                 TO ABEND-MSG
  5141             PERFORM ABEND-ROUTINE
  5142                THRU ABEND-ROUTINE-EXIT
  5143     END-EVALUATE
  5144     .
  5145 2000-DECIDE-ACTION-EXIT.
  5146     EXIT
  5147     .
  5148
  5149
  5150
  5151 3000-SEND-MAP.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  95
* COACTUPC.cbl
  5152     PERFORM 3100-SCREEN-INIT
  5153        THRU 3100-SCREEN-INIT-EXIT
  5154     PERFORM 3200-SETUP-SCREEN-VARS
  5155        THRU 3200-SETUP-SCREEN-VARS-EXIT
  5156     PERFORM 3250-SETUP-INFOMSG
  5157        THRU 3250-SETUP-INFOMSG-EXIT
  5158     PERFORM 3300-SETUP-SCREEN-ATTRS
  5159        THRU 3300-SETUP-SCREEN-ATTRS-EXIT
  5160     PERFORM 3390-SETUP-INFOMSG-ATTRS
  5161        THRU 3390-SETUP-INFOMSG-ATTRS-EXIT
  5162     PERFORM 3400-SEND-SCREEN
  5163        THRU 3400-SEND-SCREEN-EXIT
  5164     .
  5165
  5166 3000-SEND-MAP-EXIT.
  5167     EXIT
  5168     .
  5169
  5170 3100-SCREEN-INIT.
  5171     MOVE LOW-VALUES TO CACTUPAO
  5172
  5173     MOVE FUNCTION CURRENT-DATE     TO WS-CURDATE-DATA
  5174
  5175     MOVE CCDA-TITLE01              TO TITLE01O OF CACTUPAO
  5176     MOVE CCDA-TITLE02              TO TITLE02O OF CACTUPAO
  5177     MOVE LIT-THISTRANID            TO TRNNAMEO OF CACTUPAO
  5178     MOVE LIT-THISPGM               TO PGMNAMEO OF CACTUPAO
  5179
  5180     MOVE FUNCTION CURRENT-DATE     TO WS-CURDATE-DATA
  5181
  5182     MOVE WS-CURDATE-MONTH          TO WS-CURDATE-MM
  5183     MOVE WS-CURDATE-DAY            TO WS-CURDATE-DD
  5184     MOVE WS-CURDATE-YEAR(3:2)      TO WS-CURDATE-YY
  5185
  5186     MOVE WS-CURDATE-MM-DD-YY       TO CURDATEO OF CACTUPAO
  5187
  5188     MOVE WS-CURTIME-HOURS          TO WS-CURTIME-HH
  5189     MOVE WS-CURTIME-MINUTE         TO WS-CURTIME-MM
  5190     MOVE WS-CURTIME-SECOND         TO WS-CURTIME-SS
  5191
  5192     MOVE WS-CURTIME-HH-MM-SS       TO CURTIMEO OF CACTUPAO
  5193
  5194     .
  5195
  5196 3100-SCREEN-INIT-EXIT.
  5197     EXIT
  5198     .
  5199
  5200 3200-SETUP-SCREEN-VARS.
  5201*    INITIALIZE SEARCH CRITERIA
  5202     IF CDEMO-PGM-ENTER
  5203        CONTINUE
  5204     ELSE
  5205        IF CC-ACCT-ID-N = 0
  5206        AND FLG-ACCTFILTER-ISVALID
  5207           MOVE LOW-VALUES                TO ACCTSIDO OF CACTUPAO
  5208        ELSE
  5209           MOVE CC-ACCT-ID                TO ACCTSIDO OF CACTUPAO
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  96
* COACTUPC.cbl
  5210        END-IF
  5211
  5212        EVALUATE TRUE
  5213          WHEN ACUP-DETAILS-NOT-FETCHED
  5214          WHEN CC-ACCT-ID-N =  0
  5215            PERFORM 3201-SHOW-INITIAL-VALUES
  5216               THRU 3201-SHOW-INITIAL-VALUES-EXIT
  5217         WHEN ACUP-SHOW-DETAILS
  5218            PERFORM 3202-SHOW-ORIGINAL-VALUES
  5219               THRU 3202-SHOW-ORIGINAL-VALUES-EXIT
  5220         WHEN ACUP-CHANGES-MADE
  5221            PERFORM 3203-SHOW-UPDATED-VALUES
  5222               THRU 3203-SHOW-UPDATED-VALUES-EXIT
  5223         WHEN OTHER
  5224            PERFORM 3202-SHOW-ORIGINAL-VALUES
  5225               THRU 3202-SHOW-ORIGINAL-VALUES-EXIT
  5226        END-EVALUATE
  5227      END-IF
  5228     .
  5229 3200-SETUP-SCREEN-VARS-EXIT.
  5230     EXIT
  5231     .
  5232
  5233 3201-SHOW-INITIAL-VALUES.
  5234     MOVE LOW-VALUES                     TO  ACSTTUSO OF CACTUPAO
  5235                                             ACRDLIMO OF CACTUPAO
  5236*Account Limits
  5237                                             ACURBALO OF CACTUPAO
  5238                                             ACSHLIMO OF CACTUPAO
  5239                                             ACRCYCRO OF CACTUPAO
  5240                                             ACRCYDBO OF CACTUPAO
  5241*Account Dates
  5242                                             OPNYEARO OF CACTUPAO
  5243                                             OPNMONO  OF CACTUPAO
  5244                                             OPNDAYO  OF CACTUPAO
  5245                                             EXPYEARO OF CACTUPAO
  5246                                             EXPMONO  OF CACTUPAO
  5247                                             EXPDAYO  OF CACTUPAO
  5248                                             RISYEARO OF CACTUPAO
  5249                                             RISMONO  OF CACTUPAO
  5250                                             RISDAYO  OF CACTUPAO
  5251                                             AADDGRPO OF CACTUPAO
  5252*Customer data
  5253                                             ACSTNUMO OF CACTUPAO
  5254                                             ACTSSN1O OF CACTUPAO
  5255                                             ACTSSN2O OF CACTUPAO
  5256                                             ACTSSN3O OF CACTUPAO
  5257                                             ACSTFCOO OF CACTUPAO
  5258                                             DOBYEARO OF CACTUPAO
  5259                                             DOBMONO  OF CACTUPAO
  5260                                             DOBDAYO  OF CACTUPAO
  5261                                             ACSFNAMO OF CACTUPAO
  5262                                             ACSMNAMO OF CACTUPAO
  5263                                             ACSLNAMO OF CACTUPAO
  5264*Customer address and contact info
  5265                                             ACSADL1O OF CACTUPAO
  5266                                             ACSADL2O OF CACTUPAO
  5267                                             ACSCITYO OF CACTUPAO
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  97
* COACTUPC.cbl
  5268                                             ACSSTTEO OF CACTUPAO
  5269                                             ACSZIPCO OF CACTUPAO
  5270                                             ACSCTRYO OF CACTUPAO
  5271
  5272                                             ACSPH1AO OF CACTUPAO
  5273                                             ACSPH1BO OF CACTUPAO
  5274                                             ACSPH1CO OF CACTUPAO
  5275                                             ACSPH2AO OF CACTUPAO
  5276                                             ACSPH2BO OF CACTUPAO
  5277                                             ACSPH2CO OF CACTUPAO
  5278
  5279*Customer other good stuff
  5280                                             ACSGOVTO OF CACTUPAO
  5281                                             ACSEFTCO OF CACTUPAO
  5282                                             ACSPFLGO OF CACTUPAO
  5283     .
  5284
  5285 3201-SHOW-INITIAL-VALUES-EXIT.
  5286     EXIT
  5287     .
  5288
  5289 3202-SHOW-ORIGINAL-VALUES.
  5290
  5291     MOVE LOW-VALUES                     TO WS-NON-KEY-FLAGS
  5292
  5293     SET PROMPT-FOR-CHANGES              TO TRUE
  5294
  5295     IF FOUND-ACCT-IN-MASTER
  5296     OR FOUND-CUST-IN-MASTER
  5297        MOVE ACUP-OLD-ACTIVE-STATUS      TO ACSTTUSO OF CACTUPAO
  5298
  5299        MOVE ACUP-OLD-CURR-BAL-N         TO WS-EDIT-CURRENCY-9-2-F
  5300        MOVE WS-EDIT-CURRENCY-9-2-F      TO ACURBALO OF CACTUPAO
  5301
  5302        MOVE ACUP-OLD-CREDIT-LIMIT-N     TO WS-EDIT-CURRENCY-9-2-F
  5303        MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRDLIMO OF CACTUPAO
  5304
  5305        MOVE ACUP-OLD-CASH-CREDIT-LIMIT-N
  5306                                         TO WS-EDIT-CURRENCY-9-2-F
  5307        MOVE WS-EDIT-CURRENCY-9-2-F      TO ACSHLIMO OF CACTUPAO
  5308
  5309        MOVE ACUP-OLD-CURR-CYC-CREDIT-N  TO WS-EDIT-CURRENCY-9-2-F
  5310        MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRCYCRO OF CACTUPAO
  5311
  5312        MOVE ACUP-OLD-CURR-CYC-DEBIT-N   TO WS-EDIT-CURRENCY-9-2-F
  5313        MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRCYDBO OF CACTUPAO
  5314
  5315        MOVE ACUP-OLD-OPEN-YEAR          TO OPNYEARO OF CACTUPAO
  5316        MOVE ACUP-OLD-OPEN-MON           TO OPNMONO  OF CACTUPAO
  5317        MOVE ACUP-OLD-OPEN-DAY           TO OPNDAYO  OF CACTUPAO
  5318
  5319        MOVE ACUP-OLD-EXP-YEAR           TO EXPYEARO OF CACTUPAO
  5320        MOVE ACUP-OLD-EXP-MON            TO EXPMONO  OF CACTUPAO
  5321        MOVE ACUP-OLD-EXP-DAY            TO EXPDAYO  OF CACTUPAO
  5322
  5323        MOVE ACUP-OLD-REISSUE-YEAR       TO RISYEARO OF CACTUPAO
  5324        MOVE ACUP-OLD-REISSUE-MON        TO RISMONO  OF CACTUPAO
  5325        MOVE ACUP-OLD-REISSUE-DAY        TO RISDAYO  OF CACTUPAO
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  98
* COACTUPC.cbl
  5326        MOVE ACUP-OLD-GROUP-ID           TO AADDGRPO OF CACTUPAO
  5327     END-IF
  5328
  5329     IF FOUND-CUST-IN-MASTER
  5330        MOVE ACUP-OLD-CUST-ID-X          TO ACSTNUMO OF CACTUPAO
  5331        MOVE ACUP-OLD-CUST-SSN-X(1:3)    TO ACTSSN1O OF CACTUPAO
  5332        MOVE ACUP-OLD-CUST-SSN-X(4:2)    TO ACTSSN2O OF CACTUPAO
  5333        MOVE ACUP-OLD-CUST-SSN-X(6:4)    TO ACTSSN3O OF CACTUPAO
  5334        MOVE ACUP-OLD-CUST-FICO-SCORE-X  TO ACSTFCOO OF CACTUPAO
  5335        MOVE ACUP-OLD-CUST-DOB-YEAR      TO DOBYEARO OF CACTUPAO
  5336        MOVE ACUP-OLD-CUST-DOB-MON       TO DOBMONO  OF CACTUPAO
  5337        MOVE ACUP-OLD-CUST-DOB-DAY       TO DOBDAYO  OF CACTUPAO
  5338        MOVE ACUP-OLD-CUST-FIRST-NAME    TO ACSFNAMO OF CACTUPAO
  5339        MOVE ACUP-OLD-CUST-MIDDLE-NAME   TO ACSMNAMO OF CACTUPAO
  5340        MOVE ACUP-OLD-CUST-LAST-NAME     TO ACSLNAMO OF CACTUPAO
  5341        MOVE ACUP-OLD-CUST-ADDR-LINE-1   TO ACSADL1O OF CACTUPAO
  5342        MOVE ACUP-OLD-CUST-ADDR-LINE-2   TO ACSADL2O OF CACTUPAO
  5343        MOVE ACUP-OLD-CUST-ADDR-LINE-3   TO ACSCITYO OF CACTUPAO
  5344        MOVE ACUP-OLD-CUST-ADDR-STATE-CD TO ACSSTTEO OF CACTUPAO
  5345        MOVE ACUP-OLD-CUST-ADDR-ZIP      TO ACSZIPCO OF CACTUPAO
  5346        MOVE ACUP-OLD-CUST-ADDR-COUNTRY-CD
  5347                                         TO ACSCTRYO OF CACTUPAO
  5348        MOVE ACUP-OLD-CUST-PHONE-NUM-1(2:3)
  5349                                         TO ACSPH1AO OF CACTUPAO
  5350        MOVE ACUP-OLD-CUST-PHONE-NUM-1(6:3)
  5351                                         TO ACSPH1BO OF CACTUPAO
  5352        MOVE ACUP-OLD-CUST-PHONE-NUM-1(10:4)
  5353                                         TO ACSPH1CO OF CACTUPAO
  5354        MOVE ACUP-OLD-CUST-PHONE-NUM-2(2:3)
  5355                                         TO ACSPH2AO OF CACTUPAO
  5356        MOVE ACUP-OLD-CUST-PHONE-NUM-2(6:3)
  5357                                         TO ACSPH2BO OF CACTUPAO
  5358        MOVE ACUP-OLD-CUST-PHONE-NUM-2(10:4)
  5359                                         TO ACSPH2CO OF CACTUPAO
  5360        MOVE ACUP-OLD-CUST-GOVT-ISSUED-ID
  5361                                         TO ACSGOVTO OF CACTUPAO
  5362        MOVE ACUP-OLD-CUST-EFT-ACCOUNT-ID
  5363                                         TO ACSEFTCO OF CACTUPAO
  5364        MOVE ACUP-OLD-CUST-PRI-HOLDER-IND
  5365                                         TO ACSPFLGO OF CACTUPAO
  5366     END-IF
  5367     .
  5368
  5369 3202-SHOW-ORIGINAL-VALUES-EXIT.
  5370     EXIT
  5371     .
  5372 3203-SHOW-UPDATED-VALUES.
  5373
  5374     MOVE ACUP-NEW-ACTIVE-STATUS         TO ACSTTUSO OF CACTUPAO
  5375
  5376     IF FLG-CRED-LIMIT-ISVALID
  5377        MOVE ACUP-NEW-CREDIT-LIMIT-N     TO WS-EDIT-CURRENCY-9-2-F
  5378        MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRDLIMO OF CACTUPAO
  5379     ELSE
  5380        MOVE ACUP-NEW-CREDIT-LIMIT-X     TO ACRDLIMO OF CACTUPAO
  5381     END-IF
  5382
  5383     IF FLG-CASH-CREDIT-LIMIT-ISVALID
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  99
* COACTUPC.cbl
  5384        MOVE ACUP-NEW-CASH-CREDIT-LIMIT-N
  5385                                         TO WS-EDIT-CURRENCY-9-2-F
  5386        MOVE WS-EDIT-CURRENCY-9-2-F      TO ACSHLIMO OF CACTUPAO
  5387     ELSE
  5388        MOVE ACUP-NEW-CASH-CREDIT-LIMIT-X
  5389                                         TO ACSHLIMO OF CACTUPAO
  5390     END-IF
  5391
  5392     IF FLG-CURR-BAL-ISVALID
  5393        MOVE ACUP-NEW-CURR-BAL-N         TO WS-EDIT-CURRENCY-9-2-F
  5394        MOVE WS-EDIT-CURRENCY-9-2-F      TO ACURBALO OF CACTUPAO
  5395     ELSE
  5396        MOVE ACUP-NEW-CURR-BAL-X         TO ACURBALO OF CACTUPAO
  5397     END-IF
  5398
  5399     IF FLG-CURR-CYC-CREDIT-ISVALID
  5400        MOVE ACUP-NEW-CURR-CYC-CREDIT-N  TO WS-EDIT-CURRENCY-9-2-F
  5401        MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRCYCRO OF CACTUPAO
  5402     ELSE
  5403        MOVE ACUP-NEW-CURR-CYC-CREDIT-X  TO ACRCYCRO OF CACTUPAO
  5404     END-IF
  5405
  5406     IF FLG-CURR-CYC-DEBIT-ISVALID
  5407        MOVE ACUP-NEW-CURR-CYC-DEBIT-N   TO WS-EDIT-CURRENCY-9-2-F
  5408        MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRCYDBO OF CACTUPAO
  5409     ELSE
  5410        MOVE ACUP-NEW-CURR-CYC-DEBIT-X   TO ACRCYDBO OF CACTUPAO
  5411     END-IF
  5412
  5413     MOVE ACUP-NEW-OPEN-YEAR             TO OPNYEARO OF CACTUPAO
  5414     MOVE ACUP-NEW-OPEN-MON              TO OPNMONO  OF CACTUPAO
  5415     MOVE ACUP-NEW-OPEN-DAY              TO OPNDAYO  OF CACTUPAO
  5416
  5417     MOVE ACUP-NEW-EXP-YEAR              TO EXPYEARO OF CACTUPAO
  5418     MOVE ACUP-NEW-EXP-MON               TO EXPMONO  OF CACTUPAO
  5419     MOVE ACUP-NEW-EXP-DAY               TO EXPDAYO  OF CACTUPAO
  5420     MOVE ACUP-NEW-REISSUE-YEAR          TO RISYEARO OF CACTUPAO
  5421     MOVE ACUP-NEW-REISSUE-MON           TO RISMONO  OF CACTUPAO
  5422     MOVE ACUP-NEW-REISSUE-DAY           TO RISDAYO  OF CACTUPAO
  5423     MOVE ACUP-NEW-GROUP-ID              TO AADDGRPO OF CACTUPAO
  5424     MOVE ACUP-NEW-CUST-ID-X             TO ACSTNUMO OF CACTUPAO
  5425     MOVE ACUP-NEW-CUST-SSN-1            TO ACTSSN1O OF CACTUPAO
  5426     MOVE ACUP-NEW-CUST-SSN-2            TO ACTSSN2O OF CACTUPAO
  5427     MOVE ACUP-NEW-CUST-SSN-3            TO ACTSSN3O OF CACTUPAO
  5428     MOVE ACUP-NEW-CUST-FICO-SCORE-X     TO ACSTFCOO OF CACTUPAO
  5429     MOVE ACUP-NEW-CUST-DOB-YEAR         TO DOBYEARO OF CACTUPAO
  5430     MOVE ACUP-NEW-CUST-DOB-MON          TO DOBMONO  OF CACTUPAO
  5431     MOVE ACUP-NEW-CUST-DOB-DAY          TO DOBDAYO  OF CACTUPAO
  5432     MOVE ACUP-NEW-CUST-FIRST-NAME       TO ACSFNAMO OF CACTUPAO
  5433     MOVE ACUP-NEW-CUST-MIDDLE-NAME      TO ACSMNAMO OF CACTUPAO
  5434     MOVE ACUP-NEW-CUST-LAST-NAME        TO ACSLNAMO OF CACTUPAO
  5435     MOVE ACUP-NEW-CUST-ADDR-LINE-1      TO ACSADL1O OF CACTUPAO
  5436     MOVE ACUP-NEW-CUST-ADDR-LINE-2      TO ACSADL2O OF CACTUPAO
  5437     MOVE ACUP-NEW-CUST-ADDR-LINE-3      TO ACSCITYO OF CACTUPAO
  5438     MOVE ACUP-NEW-CUST-ADDR-STATE-CD    TO ACSSTTEO OF CACTUPAO
  5439     MOVE ACUP-NEW-CUST-ADDR-ZIP         TO ACSZIPCO OF CACTUPAO
  5440     MOVE ACUP-NEW-CUST-ADDR-COUNTRY-CD  TO ACSCTRYO OF CACTUPAO
  5441     MOVE ACUP-NEW-CUST-PHONE-NUM-1A     TO ACSPH1AO OF CACTUPAO
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 100
* COACTUPC.cbl
  5442     MOVE ACUP-NEW-CUST-PHONE-NUM-1B     TO ACSPH1BO OF CACTUPAO
  5443     MOVE ACUP-NEW-CUST-PHONE-NUM-1C     TO ACSPH1CO OF CACTUPAO
  5444     MOVE ACUP-NEW-CUST-PHONE-NUM-2A     TO ACSPH2AO OF CACTUPAO
  5445     MOVE ACUP-NEW-CUST-PHONE-NUM-2B     TO ACSPH2BO OF CACTUPAO
  5446     MOVE ACUP-NEW-CUST-PHONE-NUM-2C     TO ACSPH2CO OF CACTUPAO
  5447     MOVE ACUP-NEW-CUST-GOVT-ISSUED-ID   TO ACSGOVTO OF CACTUPAO
  5448     MOVE ACUP-NEW-CUST-EFT-ACCOUNT-ID   TO ACSEFTCO OF CACTUPAO
  5449     MOVE ACUP-NEW-CUST-PRI-HOLDER-IND   TO ACSPFLGO OF CACTUPAO
  5450
  5451     .
  5452
  5453 3203-SHOW-UPDATED-VALUES-EXIT.
  5454     EXIT
  5455     .
  5456
  5457 3250-SETUP-INFOMSG.
  5458*    SETUP INFORMATION MESSAGE
  5459     EVALUATE TRUE
  5460         WHEN CDEMO-PGM-ENTER
  5461              SET  PROMPT-FOR-SEARCH-KEYS TO TRUE
  5462         WHEN ACUP-DETAILS-NOT-FETCHED
  5463             SET PROMPT-FOR-SEARCH-KEYS      TO TRUE
  5464         WHEN ACUP-SHOW-DETAILS
  5465              SET PROMPT-FOR-CHANGES         TO TRUE
  5466         WHEN ACUP-CHANGES-NOT-OK
  5467              SET PROMPT-FOR-CHANGES         TO TRUE
  5468         WHEN ACUP-CHANGES-OK-NOT-CONFIRMED
  5469              SET PROMPT-FOR-CONFIRMATION    TO TRUE
  5470         WHEN ACUP-CHANGES-OKAYED-AND-DONE
  5471              SET CONFIRM-UPDATE-SUCCESS     TO TRUE
  5472
  5473         WHEN ACUP-CHANGES-OKAYED-LOCK-ERROR
  5474              SET INFORM-FAILURE             TO TRUE
  5475         WHEN ACUP-CHANGES-OKAYED-BUT-FAILED
  5476              SET INFORM-FAILURE             TO TRUE
  5477         WHEN WS-NO-INFO-MESSAGE
  5478             SET PROMPT-FOR-SEARCH-KEYS      TO TRUE
  5479     END-EVALUATE
  5480
  5481     MOVE WS-INFO-MSG                    TO INFOMSGO OF CACTUPAO
  5482
  5483     MOVE WS-RETURN-MSG                  TO ERRMSGO OF CACTUPAO
  5484     .
  5485 3250-SETUP-INFOMSG-EXIT.
  5486     EXIT
  5487     .
  5488 3300-SETUP-SCREEN-ATTRS.
  5489
  5490*    PROTECT ALL FIELDS
  5491     PERFORM 3310-PROTECT-ALL-ATTRS
  5492        THRU 3310-PROTECT-ALL-ATTRS-EXIT
  5493
  5494*    UNPROTECT BASED ON CONTEXT
  5495     EVALUATE TRUE
  5496        WHEN ACUP-DETAILS-NOT-FETCHED
  5497*            Make Account Id editable
  5498             MOVE DFHBMFSE      TO ACCTSIDA OF CACTUPAI
  5499        WHEN  ACUP-SHOW-DETAILS
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 101
* COACTUPC.cbl
  5500        WHEN  ACUP-CHANGES-NOT-OK
  5501             PERFORM 3320-UNPROTECT-FEW-ATTRS
  5502                THRU 3320-UNPROTECT-FEW-ATTRS-EXIT
  5503        WHEN ACUP-CHANGES-OK-NOT-CONFIRMED
  5504        WHEN ACUP-CHANGES-OKAYED-AND-DONE
  5505             CONTINUE
  5506        WHEN OTHER
  5507             MOVE DFHBMFSE      TO ACCTSIDA OF CACTUPAI
  5508     END-EVALUATE
  5509
  5510*    POSITION CURSOR - ORDER BASED ON SCREEN LOCATION
  5511     EVALUATE TRUE
  5512        WHEN FOUND-ACCOUNT-DATA
  5513        WHEN NO-CHANGES-DETECTED
  5514            MOVE -1              TO ACSTTUSL OF CACTUPAI
  5515        WHEN FLG-ACCTFILTER-NOT-OK
  5516        WHEN FLG-ACCTFILTER-BLANK
  5517             MOVE -1             TO ACCTSIDL OF CACTUPAI
  5518*    Account Status
  5519        WHEN FLG-ACCT-STATUS-NOT-OK
  5520        WHEN FLG-ACCT-STATUS-BLANK
  5521            MOVE -1              TO ACSTTUSL OF CACTUPAI
  5522*    Open Year
  5523        WHEN FLG-OPEN-YEAR-NOT-OK
  5524        WHEN FLG-OPEN-YEAR-BLANK
  5525            MOVE -1              TO OPNYEARL OF CACTUPAI
  5526*    Open Month
  5527        WHEN FLG-OPEN-MONTH-NOT-OK
  5528        WHEN FLG-OPEN-MONTH-BLANK
  5529            MOVE -1              TO OPNMONL  OF CACTUPAI
  5530*    Open Day
  5531        WHEN FLG-OPEN-DAY-NOT-OK
  5532        WHEN FLG-OPEN-DAY-BLANK
  5533            MOVE -1              TO OPNDAYL  OF CACTUPAI
  5534*    Credit Limit
  5535        WHEN FLG-CRED-LIMIT-NOT-OK
  5536        WHEN FLG-CRED-LIMIT-BLANK
  5537            MOVE -1              TO ACRDLIML OF CACTUPAI
  5538*    Expiry Year
  5539        WHEN FLG-EXPIRY-YEAR-NOT-OK
  5540        WHEN FLG-EXPIRY-YEAR-BLANK
  5541            MOVE -1              TO EXPYEARL OF CACTUPAI
  5542*    Expiry Month
  5543        WHEN FLG-EXPIRY-MONTH-NOT-OK
  5544        WHEN FLG-EXPIRY-MONTH-BLANK
  5545            MOVE -1              TO EXPMONL  OF CACTUPAI
  5546*    Expiry Day
  5547        WHEN FLG-EXPIRY-DAY-NOT-OK
  5548        WHEN FLG-EXPIRY-DAY-BLANK
  5549            MOVE -1              TO EXPDAYL  OF CACTUPAI
  5550*    Cash credit limit
  5551        WHEN FLG-CASH-CREDIT-LIMIT-NOT-OK
  5552        WHEN FLG-CASH-CREDIT-LIMIT-BLANK
  5553            MOVE -1              TO ACSHLIML OF CACTUPAI
  5554*    Reissue Year
  5555        WHEN FLG-REISSUE-YEAR-NOT-OK
  5556        WHEN FLG-REISSUE-YEAR-BLANK
  5557            MOVE -1              TO RISYEARL OF CACTUPAI
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 102
* COACTUPC.cbl
  5558*    Expiry Month
  5559        WHEN FLG-REISSUE-MONTH-NOT-OK
  5560        WHEN FLG-REISSUE-MONTH-BLANK
  5561            MOVE -1              TO RISMONL  OF CACTUPAI
  5562*    Expiry Day
  5563        WHEN FLG-REISSUE-DAY-NOT-OK
  5564        WHEN FLG-REISSUE-DAY-BLANK
  5565            MOVE -1              TO RISDAYL  OF CACTUPAI
  5566
  5567*    Current Balance
  5568        WHEN FLG-CURR-BAL-NOT-OK
  5569        WHEN FLG-CURR-BAL-BLANK
  5570            MOVE -1              TO ACURBALL OF CACTUPAI
  5571*    Current Cycle Credit
  5572        WHEN FLG-CURR-CYC-CREDIT-NOT-OK
  5573        WHEN FLG-CURR-CYC-CREDIT-BLANK
  5574            MOVE -1              TO ACRCYCRL OF CACTUPAI
  5575*    Current Cycle Debit
  5576        WHEN FLG-CURR-CYC-DEBIT-NOT-OK
  5577        WHEN FLG-CURR-CYC-DEBIT-BLANK
  5578            MOVE -1              TO ACRCYDBL OF CACTUPAI
  5579*    SSN Part 1
  5580        WHEN FLG-EDIT-US-SSN-PART1-NOT-OK
  5581        WHEN FLG-EDIT-US-SSN-PART1-BLANK
  5582            MOVE -1              TO ACTSSN1L OF CACTUPAI
  5583*    SSN Part 2
  5584        WHEN FLG-EDIT-US-SSN-PART2-NOT-OK
  5585        WHEN FLG-EDIT-US-SSN-PART2-BLANK
  5586            MOVE -1              TO ACTSSN2L  OF CACTUPAI
  5587*    SSN Part 3
  5588        WHEN FLG-EDIT-US-SSN-PART3-NOT-OK
  5589        WHEN FLG-EDIT-US-SSN-PART3-BLANK
  5590            MOVE -1              TO ACTSSN3L  OF CACTUPAI
  5591*    Date of Birth Year
  5592        WHEN FLG-DT-OF-BIRTH-YEAR-NOT-OK
  5593        WHEN FLG-DT-OF-BIRTH-YEAR-BLANK
  5594            MOVE -1              TO DOBYEARL OF CACTUPAI
  5595*    Date of Birth Month
  5596        WHEN FLG-DT-OF-BIRTH-MONTH-NOT-OK
  5597        WHEN FLG-DT-OF-BIRTH-MONTH-BLANK
  5598            MOVE -1              TO DOBMONL  OF CACTUPAI
  5599*    Date of Birth Day
  5600        WHEN FLG-DT-OF-BIRTH-DAY-NOT-OK
  5601        WHEN FLG-DT-OF-BIRTH-DAY-BLANK
  5602            MOVE -1              TO DOBDAYL  OF CACTUPAI
  5603*    FICO Score
  5604        WHEN FLG-FICO-SCORE-NOT-OK
  5605        WHEN FLG-FICO-SCORE-BLANK
  5606            MOVE -1              TO ACSTFCOL OF CACTUPAI
  5607*    First Name
  5608        WHEN FLG-FIRST-NAME-NOT-OK
  5609        WHEN FLG-FIRST-NAME-BLANK
  5610            MOVE -1              TO ACSFNAML OF CACTUPAI
  5611*    Middle Name
  5612        WHEN FLG-MIDDLE-NAME-NOT-OK
  5613            MOVE -1              TO ACSMNAML OF CACTUPAI
  5614*    Last Name
  5615        WHEN FLG-LAST-NAME-NOT-OK
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 103
* COACTUPC.cbl
  5616        WHEN FLG-LAST-NAME-BLANK
  5617            MOVE -1              TO ACSLNAML OF CACTUPAI
  5618*    Address Line 1
  5619        WHEN FLG-FICO-SCORE-NOT-OK
  5620        WHEN FLG-FICO-SCORE-BLANK
  5621            MOVE -1              TO ACSADL1L OF CACTUPAI
  5622*    State (appears next to Line 2 on screen before city)
  5623        WHEN FLG-STATE-NOT-OK
  5624        WHEN FLG-STATE-BLANK
  5625            MOVE -1              TO ACSSTTEL OF CACTUPAI
  5626*    Address Line 2 has no edits
  5627*    Zip code
  5628        WHEN FLG-ZIPCODE-NOT-OK
  5629        WHEN FLG-ZIPCODE-BLANK
  5630            MOVE -1              TO ACSZIPCL OF CACTUPAI
  5631*    Address Line 3 (City)
  5632        WHEN FLG-CITY-NOT-OK
  5633        WHEN FLG-CITY-BLANK
  5634            MOVE -1              TO ACSCITYL OF CACTUPAI
  5635*    Country edits.
  5636        WHEN FLG-COUNTRY-NOT-OK
  5637        WHEN FLG-COUNTRY-BLANK
  5638            MOVE -1              TO ACSCTRYL OF CACTUPAI
  5639*    Phone 1
  5640        WHEN FLG-PHONE-NUM-1A-NOT-OK
  5641        WHEN FLG-PHONE-NUM-1A-BLANK
  5642            MOVE -1              TO ACSPH1AL OF CACTUPAI
  5643        WHEN FLG-PHONE-NUM-1B-NOT-OK
  5644        WHEN FLG-PHONE-NUM-1B-BLANK
  5645            MOVE -1              TO ACSPH1BL OF CACTUPAI
  5646        WHEN FLG-PHONE-NUM-1C-NOT-OK
  5647        WHEN FLG-PHONE-NUM-1C-BLANK
  5648            MOVE -1              TO ACSPH1CL OF CACTUPAI
  5649*    Phone 2
  5650        WHEN FLG-PHONE-NUM-2A-NOT-OK
  5651        WHEN FLG-PHONE-NUM-2A-BLANK
  5652            MOVE -1              TO ACSPH2AL OF CACTUPAI
  5653        WHEN FLG-PHONE-NUM-2B-NOT-OK
  5654        WHEN FLG-PHONE-NUM-2B-BLANK
  5655            MOVE -1              TO ACSPH2BL OF CACTUPAI
  5656        WHEN FLG-PHONE-NUM-2C-NOT-OK
  5657        WHEN FLG-PHONE-NUM-2C-BLANK
  5658            MOVE -1              TO ACSPH2CL OF CACTUPAI
  5659*    EFT Account Id
  5660        WHEN FLG-EFT-ACCOUNT-ID-NOT-OK
  5661        WHEN FLG-EFT-ACCOUNT-ID-BLANK
  5662            MOVE -1              TO ACSEFTCL OF CACTUPAI
  5663*    Primary Card Holder
  5664        WHEN FLG-PRI-CARDHOLDER-NOT-OK
  5665        WHEN FLG-PRI-CARDHOLDER-BLANK
  5666            MOVE -1              TO ACSPFLGL OF CACTUPAI
  5667        WHEN OTHER
  5668            MOVE -1              TO ACCTSIDL OF CACTUPAI
  5669      END-EVALUATE
  5670
  5671
  5672*    SETUP COLOR
  5673     IF CDEMO-LAST-MAPSET   EQUAL LIT-CCLISTMAPSET
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 104
* COACTUPC.cbl
  5674        MOVE DFHDFCOL            TO ACCTSIDC OF CACTUPAO
  5675     END-IF
  5676
  5677*    Account Filter
  5678     IF FLG-ACCTFILTER-NOT-OK
  5679        MOVE DFHRED              TO ACCTSIDC OF CACTUPAO
  5680     END-IF
  5681
  5682     IF  FLG-ACCTFILTER-BLANK
  5683     AND CDEMO-PGM-REENTER
  5684         MOVE '*'                TO ACCTSIDO OF CACTUPAO
  5685         MOVE DFHRED             TO ACCTSIDC OF CACTUPAO
  5686     END-IF
  5687
  5688     IF ACUP-DETAILS-NOT-FETCHED
  5689     OR FLG-ACCTFILTER-BLANK
  5690     OR FLG-ACCTFILTER-NOT-OK
  5691        GO TO 3300-SETUP-SCREEN-ATTRS-EXIT
  5692     ELSE
  5693        CONTINUE
  5694     END-IF
  5695
  5696******************************************************************
  5697*    Using Copy replacing to set attribs for remaining vars
  5698*    Write specific code only if rules differ
  5699******************************************************************
  5700*    IF (FLG-ACCT-STATUS-NOT-OK
  5701*    OR  FLG-ACCT-STATUS-BLANK)
  5702*    AND CDEMO-PGM-REENTER
  5703*        MOVE DFHRED             TO ACSTTUSC OF CACTUPAO
  5704*        IF  FLG-ACCT-STATUS-BLANK
  5705*            MOVE '*'            TO ACSTTUSO OF CACTUPAO
  5706*        END-IF
  5707*    END-IF
  5708
  5709*    Account Status
  5710*    COPY CSSETATY REPLACING
  5711*      ==(TESTVAR1)== BY ==ACCT-STATUS==
  5712*      ==(SCRNVAR2)== BY ==ACSTTUS==
  5713*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3205,43,43)
  5714
  5715*    Open Year
  5716*    COPY CSSETATY REPLACING
  5717*      ==(TESTVAR1)== BY ==OPEN-YEAR==
  5718*      ==(SCRNVAR2)== BY ==OPNYEAR==
  5719*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3211,43,43)
  5720
  5721*    Open Month
  5722*    COPY CSSETATY REPLACING
  5723*      ==(TESTVAR1)== BY ==OPEN-MONTH==
  5724*      ==(SCRNVAR2)== BY ==OPNMON==
  5725*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3217,43,43)
  5726
  5727*    Open Day
  5728*    COPY CSSETATY REPLACING
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 105
* COACTUPC.cbl
  5729*      ==(TESTVAR1)== BY ==OPEN-DAY==
  5730*      ==(SCRNVAR2)== BY ==OPNDAY==
  5731*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3223,43,43)
  5732
  5733*    Credit Limit
  5734*    COPY CSSETATY REPLACING
  5735*      ==(TESTVAR1)== BY ==CRED-LIMIT==
  5736*      ==(SCRNVAR2)== BY ==ACRDLIM==
  5737*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3229,43,43)
  5738
  5739*    Expiry Year
  5740*    COPY CSSETATY REPLACING
  5741*      ==(TESTVAR1)== BY ==EXPIRY-YEAR==
  5742*      ==(SCRNVAR2)== BY ==EXPYEAR==
  5743*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3235,43,43)
  5744
  5745*    Expiry Month
  5746*    COPY CSSETATY REPLACING
  5747*      ==(TESTVAR1)== BY ==EXPIRY-MONTH==
  5748*      ==(SCRNVAR2)== BY ==EXPMON==
  5749*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3241,43,43)
  5750
  5751*    Expiry Day
  5752*    COPY CSSETATY REPLACING
  5753*      ==(TESTVAR1)== BY ==EXPIRY-DAY==
  5754*      ==(SCRNVAR2)== BY ==EXPDAY==
  5755*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3247,43,43)
  5756
  5757*    Cash Credit Limit
  5758*    COPY CSSETATY REPLACING
  5759*      ==(TESTVAR1)== BY ==CASH-CREDIT-LIMIT==
  5760*      ==(SCRNVAR2)== BY ==ACSHLIM==
  5761*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3253,43,43)
  5762
  5763*    Reissue Year
  5764*    COPY CSSETATY REPLACING
  5765*      ==(TESTVAR1)== BY ==REISSUE-YEAR==
  5766*      ==(SCRNVAR2)== BY ==RISYEAR==
  5767*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3259,43,43)
  5768
  5769*    Reissue Month
  5770*    COPY CSSETATY REPLACING
  5771*      ==(TESTVAR1)== BY ==REISSUE-MONTH==
  5772*      ==(SCRNVAR2)== BY ==RISMON==
  5773*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3265,43,43)
  5774
  5775*    Reissue Day
  5776*    COPY CSSETATY REPLACING
  5777*      ==(TESTVAR1)== BY ==REISSUE-DAY==
  5778*      ==(SCRNVAR2)== BY ==RISDAY==
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 106
* COACTUPC.cbl
  5779*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3271,43,43)
  5780
  5781*    Current Balance
  5782*    COPY CSSETATY REPLACING
  5783*      ==(TESTVAR1)== BY ==CURR-BAL==
  5784*      ==(SCRNVAR2)== BY ==ACURBAL==
  5785*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3277,43,43)
  5786
  5787*    Current Cycle Credit
  5788*    COPY CSSETATY REPLACING
  5789*      ==(TESTVAR1)== BY ==CURR-CYC-CREDIT==
  5790*      ==(SCRNVAR2)== BY ==ACRCYCR==
  5791*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3283,43,43)
  5792
  5793*    Current Cycle Debit
  5794*    COPY CSSETATY REPLACING
  5795*      ==(TESTVAR1)== BY ==CURR-CYC-DEBIT==
  5796*      ==(SCRNVAR2)== BY ==ACRCYDB==
  5797*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3289,43,43)
  5798
  5799*    SSN Part 1
  5800*    COPY CSSETATY REPLACING
  5801*      ==(TESTVAR1)== BY ==EDIT-US-SSN-PART1==
  5802*      ==(SCRNVAR2)== BY ==ACTSSN1==
  5803*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3295,43,43)
  5804
  5805*    SSN Part 2
  5806*    COPY CSSETATY REPLACING
  5807*      ==(TESTVAR1)== BY ==EDIT-US-SSN-PART2==
  5808*      ==(SCRNVAR2)== BY ==ACTSSN2==
  5809*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3301,43,43)
  5810
  5811*    SSN Part 3
  5812*    COPY CSSETATY REPLACING
  5813*      ==(TESTVAR1)== BY ==EDIT-US-SSN-PART3==
  5814*      ==(SCRNVAR2)== BY ==ACTSSN3==
  5815*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3307,43,43)
  5816
  5817*    Date of Birth Year
  5818*    COPY CSSETATY REPLACING
  5819*      ==(TESTVAR1)== BY ==DT-OF-BIRTH-YEAR==
  5820*      ==(SCRNVAR2)== BY ==DOBYEAR==
  5821*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3313,43,43)
  5822
  5823*    Date of Birth Month
  5824*    COPY CSSETATY REPLACING
  5825*      ==(TESTVAR1)== BY ==DT-OF-BIRTH-MONTH==
  5826*      ==(SCRNVAR2)== BY ==DOBMON==
  5827*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3319,43,43)
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 107
* COACTUPC.cbl
  5828
  5829*    Date of Birth Day
  5830*    COPY CSSETATY REPLACING
  5831*      ==(TESTVAR1)== BY ==DT-OF-BIRTH-DAY==
  5832*      ==(SCRNVAR2)== BY ==DOBDAY==
  5833*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3325,43,43)
  5834
  5835*    FICO Score
  5836*    COPY CSSETATY REPLACING
  5837*      ==(TESTVAR1)== BY ==FICO-SCORE==
  5838*      ==(SCRNVAR2)== BY ==ACSTFCO==
  5839*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3331,43,43)
  5840
  5841*    First Name
  5842*    COPY CSSETATY REPLACING
  5843*      ==(TESTVAR1)== BY ==FIRST-NAME==
  5844*      ==(SCRNVAR2)== BY ==ACSFNAM==
  5845*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3337,43,43)
  5846
  5847*    Middle Name (no edits coded)
  5848*    COPY CSSETATY REPLACING
  5849*      ==(TESTVAR1)== BY ==MIDDLE-NAME==
  5850*      ==(SCRNVAR2)== BY ==ACSMNAM==
  5851*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3343,43,43)
  5852
  5853*    Last Name
  5854*    COPY CSSETATY REPLACING
  5855*      ==(TESTVAR1)== BY ==LAST-NAME==
  5856*      ==(SCRNVAR2)== BY ==ACSLNAM==
  5857*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3349,43,43)
  5858
  5859*    Address Line 1
  5860*    COPY CSSETATY REPLACING
  5861*      ==(TESTVAR1)== BY ==ADDRESS-LINE-1==
  5862*      ==(SCRNVAR2)== BY ==ACSADL1==
  5863*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3355,43,43)
  5864
  5865*    State
  5866*    COPY CSSETATY REPLACING
  5867*      ==(TESTVAR1)== BY ==STATE==
  5868*      ==(SCRNVAR2)== BY ==ACSSTTE==
  5869*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3361,43,43)
  5870
  5871*    Address Line 2 (NO EDITS CODED AS YET)
  5872*    COPY CSSETATY REPLACING
  5873*      ==(TESTVAR1)== BY ==ADDRESS-LINE-2==
  5874*      ==(SCRNVAR2)== BY ==ACSADL2==
  5875*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3367,43,43)
  5876
  5877*    State
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 108
* COACTUPC.cbl
  5878*    COPY CSSETATY REPLACING
  5879*      ==(TESTVAR1)== BY ==ZIPCODE==
  5880*      ==(SCRNVAR2)== BY ==ACSZIPC==
  5881*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3373,43,43)
  5882
  5883*    City
  5884*    COPY CSSETATY REPLACING
  5885*      ==(TESTVAR1)== BY ==CITY==
  5886*      ==(SCRNVAR2)== BY ==ACSCITY==
  5887*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3379,43,43)
  5888
  5889*    Country
  5890*    COPY CSSETATY REPLACING
  5891*      ==(TESTVAR1)== BY ==COUNTRY==
  5892*      ==(SCRNVAR2)== BY ==ACSCTRY==
  5893*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3385,43,43)
  5894
  5895*    Phone 1 Area Code
  5896*    COPY CSSETATY REPLACING
  5897*      ==(TESTVAR1)== BY ==PHONE-NUM-1A==
  5898*      ==(SCRNVAR2)== BY ==ACSPH1A==
  5899*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3391,43,43)
  5900
  5901*    Phone 1 Prefix
  5902*    COPY CSSETATY REPLACING
  5903*      ==(TESTVAR1)== BY ==PHONE-NUM-1B==
  5904*      ==(SCRNVAR2)== BY ==ACSPH1B==
  5905*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3397,43,43)
  5906*    Phone 1 Line number
  5907*    COPY CSSETATY REPLACING
  5908*      ==(TESTVAR1)== BY ==PHONE-NUM-1C==
  5909*      ==(SCRNVAR2)== BY ==ACSPH1C==
  5910*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3402,43,43)
  5911
  5912*    Phone 2 Area Code
  5913*    COPY CSSETATY REPLACING
  5914*      ==(TESTVAR1)== BY ==PHONE-NUM-2A==
  5915*      ==(SCRNVAR2)== BY ==ACSPH2A==
  5916*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3408,43,43)
  5917
  5918*    Phone 2 Prefix
  5919*    COPY CSSETATY REPLACING
  5920*      ==(TESTVAR1)== BY ==PHONE-NUM-2B==
  5921*      ==(SCRNVAR2)== BY ==ACSPH2B==
  5922*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3414,43,43)
  5923*    Phone 2 Line number
  5924*    COPY CSSETATY REPLACING
  5925*      ==(TESTVAR1)== BY ==PHONE-NUM-2C==
  5926*      ==(SCRNVAR2)== BY ==ACSPH2C==
  5927*      ==(MAPNAME3)== BY ==CACTUPA== .
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 109
* COACTUPC.cbl
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3419,43,43)
  5928*    EFT Account Id
  5929*    COPY CSSETATY REPLACING
  5930*      ==(TESTVAR1)== BY ==PRI-CARDHOLDER==
  5931*      ==(SCRNVAR2)== BY ==ACSPFLG==
  5932*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3424,43,43)
  5933*    Primary Card Holder
  5934*    COPY CSSETATY REPLACING
  5935*      ==(TESTVAR1)== BY ==EFT-ACCOUNT-ID==
  5936*      ==(SCRNVAR2)== BY ==ACSEFTC==
  5937*      ==(MAPNAME3)== BY ==CACTUPA== .
**    COBCH0008S Unknown copybook CSSETATY specified  : COACTUPC.cbl(3429,43,43)
  5938     .
  5939 3300-SETUP-SCREEN-ATTRS-EXIT.
  5940     EXIT
  5941     .
  5942
  5943 3310-PROTECT-ALL-ATTRS.
  5944     MOVE DFHBMPRF              TO ACCTSIDA OF CACTUPAI
  5945                                   ACSTTUSA OF CACTUPAI
  5946*Account Limits
  5947                                   ACRDLIMA OF CACTUPAI
  5948                                   ACSHLIMA OF CACTUPAI
  5949                                   ACURBALA OF CACTUPAI
  5950                                   ACRCYCRA OF CACTUPAI
  5951                                   ACRCYDBA OF CACTUPAI
  5952*Account dates
  5953                                   OPNYEARA OF CACTUPAI
  5954                                   OPNMONA  OF CACTUPAI
  5955                                   OPNDAYA  OF CACTUPAI
  5956                                   EXPYEARA OF CACTUPAI
  5957                                   EXPMONA  OF CACTUPAI
  5958                                   EXPDAYA  OF CACTUPAI
  5959                                   RISYEARA OF CACTUPAI
  5960                                   RISMONA  OF CACTUPAI
  5961                                   RISDAYA  OF CACTUPAI
  5962
  5963                                   AADDGRPA OF CACTUPAI
  5964*Customer data
  5965                                   ACSTNUMA OF CACTUPAI
  5966                                   ACTSSN1A OF CACTUPAI
  5967                                   ACTSSN2A OF CACTUPAI
  5968                                   ACTSSN3A OF CACTUPAI
  5969                                   ACSTFCOA OF CACTUPAI
  5970*Date of Birth
  5971                                   DOBYEARA OF CACTUPAI
  5972                                   DOBMONA  OF CACTUPAI
  5973                                   DOBDAYA  OF CACTUPAI
  5974
  5975                                   ACSFNAMA OF CACTUPAI
  5976                                   ACSMNAMA OF CACTUPAI
  5977                                   ACSLNAMA OF CACTUPAI
  5978*Address
  5979                                   ACSADL1A OF CACTUPAI
  5980                                   ACSADL2A OF CACTUPAI
  5981                                   ACSCITYA OF CACTUPAI
  5982                                   ACSSTTEA OF CACTUPAI
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 110
* COACTUPC.cbl
  5983                                   ACSZIPCA OF CACTUPAI
  5984                                   ACSCTRYA OF CACTUPAI
  5985
  5986                                   ACSPH1AA OF CACTUPAI
  5987                                   ACSPH1BA OF CACTUPAI
  5988                                   ACSPH1CA OF CACTUPAI
  5989                                   ACSPH2AA OF CACTUPAI
  5990                                   ACSPH2BA OF CACTUPAI
  5991                                   ACSPH2CA OF CACTUPAI
  5992
  5993                                   ACSGOVTA OF CACTUPAI
  5994                                   ACSEFTCA OF CACTUPAI
  5995                                   ACSPFLGA OF CACTUPAI
  5996                                   INFOMSGA OF CACTUPAI
  5997     .
  5998 3310-PROTECT-ALL-ATTRS-EXIT.
  5999     EXIT
  6000     .
  6001
  6002 3320-UNPROTECT-FEW-ATTRS.
  6003
  6004     MOVE DFHBMFSE              TO ACSTTUSA OF CACTUPAI
  6005*Account Limits
  6006                                   ACRDLIMA OF CACTUPAI
  6007                                   ACSHLIMA OF CACTUPAI
  6008                                   ACURBALA OF CACTUPAI
  6009                                   ACRCYCRA OF CACTUPAI
  6010                                   ACRCYDBA OF CACTUPAI
  6011*Account dates
  6012*Open Date
  6013                                   OPNYEARA OF CACTUPAI
  6014                                   OPNMONA  OF CACTUPAI
  6015                                   OPNDAYA  OF CACTUPAI
  6016*Expiry date
  6017                                   EXPYEARA OF CACTUPAI
  6018                                   EXPMONA  OF CACTUPAI
  6019                                   EXPDAYA  OF CACTUPAI
  6020*Reissue date
  6021                                   RISYEARA OF CACTUPAI
  6022                                   RISMONA  OF CACTUPAI
  6023                                   RISDAYA  OF CACTUPAI
  6024*Date of Birth
  6025                                   DOBYEARA OF CACTUPAI
  6026                                   DOBMONA  OF CACTUPAI
  6027                                   DOBDAYA  OF CACTUPAI
  6028
  6029
  6030
  6031                                   AADDGRPA OF CACTUPAI
  6032*Customer data
  6033      MOVE DFHBMPRF            TO  ACSTNUMA OF CACTUPAI
  6034      MOVE DFHBMFSE            TO  ACTSSN1A OF CACTUPAI
  6035                                   ACTSSN2A OF CACTUPAI
  6036                                   ACTSSN3A OF CACTUPAI
  6037                                   ACSTFCOA OF CACTUPAI
  6038
  6039                                   ACSFNAMA OF CACTUPAI
  6040                                   ACSMNAMA OF CACTUPAI
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 111
* COACTUPC.cbl
  6041                                   ACSLNAMA OF CACTUPAI
  6042*Address
  6043                                   ACSADL1A OF CACTUPAI
  6044                                   ACSADL2A OF CACTUPAI
  6045                                   ACSCITYA OF CACTUPAI
  6046                                   ACSSTTEA OF CACTUPAI
  6047                                   ACSZIPCA OF CACTUPAI
  6048*Since most of the edits are USA specific protected country
  6049     MOVE DFHBMPRF              TO ACSCTRYA OF CACTUPAI
  6050
  6051     MOVE DFHBMFSE              TO ACSPH1AA OF CACTUPAI
  6052                                   ACSPH1BA OF CACTUPAI
  6053                                   ACSPH1CA OF CACTUPAI
  6054
  6055     MOVE DFHBMFSE              TO ACSPH2AA OF CACTUPAI
  6056                                   ACSPH2BA OF CACTUPAI
  6057                                   ACSPH2CA OF CACTUPAI
  6058
  6059                                   ACSGOVTA OF CACTUPAI
  6060                                   ACSEFTCA OF CACTUPAI
  6061                                   ACSPFLGA OF CACTUPAI
  6062     MOVE DFHBMPRF              TO INFOMSGA OF CACTUPAI
  6063     .
  6064 3320-UNPROTECT-FEW-ATTRS-EXIT.
  6065     EXIT
  6066     .
  6067
  6068 3390-SETUP-INFOMSG-ATTRS.
  6069     IF  WS-NO-INFO-MESSAGE
  6070         MOVE DFHBMDAR           TO INFOMSGA OF CACTUPAI
  6071     ELSE
  6072         MOVE DFHBMASB           TO INFOMSGA OF CACTUPAI
  6073     END-IF
  6074
  6075     IF ACUP-CHANGES-MADE
  6076     AND NOT ACUP-CHANGES-OKAYED-AND-DONE
  6077         MOVE DFHBMASB           TO FKEY12A  OF CACTUPAI
  6078     END-IF
  6079
  6080     IF PROMPT-FOR-CONFIRMATION
  6081         MOVE DFHBMASB           TO FKEY05A  OF CACTUPAI
  6082         MOVE DFHBMASB           TO FKEY12A  OF CACTUPAI
  6083     END-IF
  6084
  6085     .
  6086 3390-SETUP-INFOMSG-ATTRS-EXIT.
  6087     EXIT
  6088     .
  6089
  6090
  6091 3400-SEND-SCREEN.
  6092
  6093     MOVE LIT-THISMAPSET         TO CCARD-NEXT-MAPSET
  6094     MOVE LIT-THISMAP            TO CCARD-NEXT-MAP
  6095
  6096     EXEC CICS SEND MAP(CCARD-NEXT-MAP)
**    COBCH1895S Communication Facility not supported  : COACTUPC.cbl(3588,25,22)
**    COBCH0012S Operand MAP is not declared  : COACTUPC.cbl(3588,29,27)
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 112
* COACTUPC.cbl
  6097                    MAPSET(CCARD-NEXT-MAPSET)
  6098                    FROM(CACTUPAO)
  6099                    CURSOR
  6100                    ERASE
  6101                    FREEKB
  6102                    RESP(WS-RESP-CD)
  6103     END-EXEC
  6104     .
  6105 3400-SEND-SCREEN-EXIT.
  6106     EXIT
  6107     .
  6108
  6109
  6110 9000-READ-ACCT.
  6111
  6112     INITIALIZE ACUP-OLD-DETAILS
  6113
  6114     SET  WS-NO-INFO-MESSAGE      TO TRUE
  6115
  6116     MOVE CC-ACCT-ID              TO ACUP-OLD-ACCT-ID
  6117                                     WS-CARD-RID-ACCT-ID
  6118
  6119     PERFORM 9200-GETCARDXREF-BYACCT
  6120        THRU 9200-GETCARDXREF-BYACCT-EXIT
  6121
  6122     IF FLG-ACCTFILTER-NOT-OK
  6123        GO TO 9000-READ-ACCT-EXIT
  6124     END-IF
  6125
  6126     PERFORM 9300-GETACCTDATA-BYACCT
  6127        THRU 9300-GETACCTDATA-BYACCT-EXIT
  6128
  6129     IF DID-NOT-FIND-ACCT-IN-ACCTDAT
  6130        GO TO 9000-READ-ACCT-EXIT
  6131     END-IF
  6132
  6133     MOVE CDEMO-CUST-ID TO WS-CARD-RID-CUST-ID
  6134
  6135     PERFORM 9400-GETCUSTDATA-BYCUST
  6136        THRU 9400-GETCUSTDATA-BYCUST-EXIT
  6137
  6138     IF DID-NOT-FIND-CUST-IN-CUSTDAT
  6139        GO TO 9000-READ-ACCT-EXIT
  6140     END-IF
  6141
  6142
  6143
  6144     PERFORM 9500-STORE-FETCHED-DATA
  6145        THRU 9500-STORE-FETCHED-DATA-EXIT
  6146     .
  6147
  6148
  6149 9000-READ-ACCT-EXIT.
  6150     EXIT
  6151     .
  6152 9200-GETCARDXREF-BYACCT.
  6153
  6154*    Read the Card file. Access via alternate index ACCTID
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 113
* COACTUPC.cbl
  6155*
  6156     EXEC CICS READ
**    COBCH0305S Procedure name EXEC same as data-name  : COACTUPC.cbl(3648,15,12)
**    COBCH0301S Unrecognized verb  : COACTUPC.cbl(3648,15,12)
  6157          DATASET   (LIT-CARDXREFNAME-ACCT-PATH)
**    COBCH0012S Operand DATASET is not declared  : COACTUPC.cbl(3649,23,17)
  6158          RIDFLD    (WS-CARD-RID-ACCT-ID-X)
  6159          KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)
  6160          INTO      (CARD-XREF-RECORD)
  6161          LENGTH    (LENGTH OF CARD-XREF-RECORD)
  6162          RESP      (WS-RESP-CD)
  6163          RESP2     (WS-REAS-CD)
  6164     END-EXEC
  6165
  6166     EVALUATE WS-RESP-CD
  6167         WHEN DFHRESP(NORMAL)
**    COBCH0012S Operand DFHRESP is not declared  : COACTUPC.cbl(3659,27,21)
**    COBCH0012S Operand NORMAL is not declared  : COACTUPC.cbl(3659,34,29)
  6168            MOVE XREF-CUST-ID               TO CDEMO-CUST-ID
  6169            MOVE XREF-CARD-NUM              TO CDEMO-CARD-NUM
  6170         WHEN DFHRESP(NOTFND)
**    COBCH0368S Exception phrase inappropriate  : COACTUPC.cbl(3662,19,16)
  6171            SET INPUT-ERROR                 TO TRUE
  6172            SET FLG-ACCTFILTER-NOT-OK       TO TRUE
  6173            IF WS-RETURN-MSG-OFF
  6174              MOVE WS-RESP-CD               TO ERROR-RESP
  6175              MOVE WS-REAS-CD               TO ERROR-RESP2
  6176              STRING
  6177              'Account:'
  6178               WS-CARD-RID-ACCT-ID-X
  6179              ' not found in'
  6180              ' Cross ref file.  Resp:'
  6181              ERROR-RESP
  6182              ' Reas:'
  6183              ERROR-RESP2
  6184              DELIMITED BY SIZE
  6185              INTO WS-RETURN-MSG
  6186              END-STRING
  6187            END-IF
  6188         WHEN OTHER
**    COBCH0368S Exception phrase inappropriate  : COACTUPC.cbl(3680,19,16)
  6189            SET INPUT-ERROR                 TO TRUE
  6190            SET FLG-ACCTFILTER-NOT-OK                TO TRUE
  6191            MOVE 'READ'                     TO ERROR-OPNAME
  6192            MOVE LIT-CARDXREFNAME-ACCT-PATH TO ERROR-FILE
  6193            MOVE WS-RESP-CD                 TO ERROR-RESP
  6194            MOVE WS-REAS-CD                 TO ERROR-RESP2
  6195            MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG
  6196*                                              WS-LONG-MSG
  6197*          PERFORM SEND-LONG-TEXT
  6198     END-EVALUATE
**    COBCH0564S A scope-delimiter did not have a matching verb and was discarded.  : COACTUPC.cbl(3690,23,12)
  6199     .
  6200 9200-GETCARDXREF-BYACCT-EXIT.
  6201     EXIT
  6202     .
  6203 9300-GETACCTDATA-BYACCT.
  6204
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 114
* COACTUPC.cbl
  6205     EXEC CICS READ
**    COBCH0305S Procedure name EXEC same as data-name  : COACTUPC.cbl(3697,15,12)
**    COBCH0301S Unrecognized verb  : COACTUPC.cbl(3697,15,12)
  6206          DATASET   (LIT-ACCTFILENAME)
  6207          RIDFLD    (WS-CARD-RID-ACCT-ID-X)
  6208          KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)
  6209          INTO      (ACCOUNT-RECORD)
  6210          LENGTH    (LENGTH OF ACCOUNT-RECORD)
  6211          RESP      (WS-RESP-CD)
  6212          RESP2     (WS-REAS-CD)
  6213     END-EXEC
  6214
  6215     EVALUATE WS-RESP-CD
  6216         WHEN DFHRESP(NORMAL)
  6217            SET FOUND-ACCT-IN-MASTER        TO TRUE
  6218         WHEN DFHRESP(NOTFND)
**    COBCH0368S Exception phrase inappropriate  : COACTUPC.cbl(3710,19,16)
  6219            SET INPUT-ERROR                 TO TRUE
  6220            SET FLG-ACCTFILTER-NOT-OK       TO TRUE
  6221*           SET DID-NOT-FIND-ACCT-IN-ACCTDAT TO TRUE
  6222            IF WS-RETURN-MSG-OFF
  6223              MOVE WS-RESP-CD               TO ERROR-RESP
  6224              MOVE WS-REAS-CD               TO ERROR-RESP2
  6225              STRING
  6226              'Account:'
  6227               WS-CARD-RID-ACCT-ID-X
  6228              ' not found in'
  6229              ' Acct Master file.Resp:'
  6230              ERROR-RESP
  6231              ' Reas:'
  6232              ERROR-RESP2
  6233              DELIMITED BY SIZE
  6234              INTO WS-RETURN-MSG
  6235              END-STRING
  6236            END-IF
  6237*
  6238         WHEN OTHER
**    COBCH0368S Exception phrase inappropriate  : COACTUPC.cbl(3730,19,16)
  6239            SET INPUT-ERROR                 TO TRUE
  6240            SET FLG-ACCTFILTER-NOT-OK                TO TRUE
  6241            MOVE 'READ'                     TO ERROR-OPNAME
  6242            MOVE LIT-ACCTFILENAME           TO ERROR-FILE
  6243            MOVE WS-RESP-CD                 TO ERROR-RESP
  6244            MOVE WS-REAS-CD                 TO ERROR-RESP2
  6245            MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG
  6246*                                              WS-LONG-MSG
  6247*           PERFORM SEND-LONG-TEXT
  6248     END-EVALUATE
**    COBCH0564S A scope-delimiter did not have a matching verb and was discarded.  : COACTUPC.cbl(3740,23,12)
  6249     .
  6250 9300-GETACCTDATA-BYACCT-EXIT.
  6251     EXIT
  6252     .
  6253
  6254 9400-GETCUSTDATA-BYCUST.
  6255     EXEC CICS READ
**    COBCH0305S Procedure name EXEC same as data-name  : COACTUPC.cbl(3747,15,12)
**    COBCH0301S Unrecognized verb  : COACTUPC.cbl(3747,15,12)
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 115
* COACTUPC.cbl
  6256          DATASET   (LIT-CUSTFILENAME)
  6257          RIDFLD    (WS-CARD-RID-CUST-ID-X)
  6258          KEYLENGTH (LENGTH OF WS-CARD-RID-CUST-ID-X)
  6259          INTO      (CUSTOMER-RECORD)
  6260          LENGTH    (LENGTH OF CUSTOMER-RECORD)
  6261          RESP      (WS-RESP-CD)
  6262          RESP2     (WS-REAS-CD)
  6263     END-EXEC
  6264
  6265     EVALUATE WS-RESP-CD
  6266         WHEN DFHRESP(NORMAL)
  6267            SET FOUND-CUST-IN-MASTER        TO TRUE
  6268         WHEN DFHRESP(NOTFND)
**    COBCH0368S Exception phrase inappropriate  : COACTUPC.cbl(3760,19,16)
  6269            SET INPUT-ERROR                 TO TRUE
  6270            SET FLG-CUSTFILTER-NOT-OK       TO TRUE
  6271*           SET DID-NOT-FIND-CUST-IN-CUSTDAT TO TRUE
  6272            MOVE WS-RESP-CD               TO ERROR-RESP
  6273            MOVE WS-REAS-CD               TO ERROR-RESP2
  6274            IF WS-RETURN-MSG-OFF
  6275              STRING
  6276              'CustId:'
  6277               WS-CARD-RID-CUST-ID-X
  6278              ' not found'
  6279              ' in customer master.Resp: '
  6280              ERROR-RESP
  6281              ' REAS:'
  6282              ERROR-RESP2
  6283              DELIMITED BY SIZE
  6284              INTO WS-RETURN-MSG
  6285              END-STRING
  6286            END-IF
  6287         WHEN OTHER
**    COBCH0368S Exception phrase inappropriate  : COACTUPC.cbl(3779,19,16)
  6288            SET INPUT-ERROR                 TO TRUE
  6289            SET FLG-CUSTFILTER-NOT-OK                TO TRUE
  6290            MOVE 'READ'                     TO ERROR-OPNAME
  6291            MOVE LIT-CUSTFILENAME           TO ERROR-FILE
  6292            MOVE WS-RESP-CD                 TO ERROR-RESP
  6293            MOVE WS-REAS-CD                 TO ERROR-RESP2
  6294            MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG
  6295*                                              WS-LONG-MSG
  6296*           PERFORM SEND-LONG-TEXT
  6297     END-EVALUATE
**    COBCH0564S A scope-delimiter did not have a matching verb and was discarded.  : COACTUPC.cbl(3789,23,12)
  6298     .
  6299 9400-GETCUSTDATA-BYCUST-EXIT.
  6300     EXIT
  6301     .
  6302
  6303 9500-STORE-FETCHED-DATA.
  6304
  6305*    Store Context in Commarea
  6306*
  6307     MOVE ACCT-ID                   TO CDEMO-ACCT-ID
  6308     MOVE CUST-ID                   TO CDEMO-CUST-ID
  6309     MOVE CUST-FIRST-NAME           TO CDEMO-CUST-FNAME
  6310     MOVE CUST-MIDDLE-NAME          TO CDEMO-CUST-MNAME
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 116
* COACTUPC.cbl
  6311     MOVE CUST-LAST-NAME            TO CDEMO-CUST-LNAME
  6312     MOVE ACCT-ACTIVE-STATUS        TO CDEMO-ACCT-STATUS
  6313     MOVE XREF-CARD-NUM             TO CDEMO-CARD-NUM
  6314
  6315     INITIALIZE ACUP-OLD-DETAILS
  6316******************************************************************
  6317*    Account Master data
  6318******************************************************************
  6319     MOVE ACCT-ID                  TO ACUP-OLD-ACCT-ID
  6320* Active Status
  6321     MOVE ACCT-ACTIVE-STATUS       TO ACUP-OLD-ACTIVE-STATUS
  6322* Current Balance
  6323     MOVE ACCT-CURR-BAL            TO ACUP-OLD-CURR-BAL-N
  6324* Credit Limit
  6325     MOVE ACCT-CREDIT-LIMIT        TO ACUP-OLD-CREDIT-LIMIT-N
  6326* Cash Limit
  6327     MOVE ACCT-CASH-CREDIT-LIMIT   TO ACUP-OLD-CASH-CREDIT-LIMIT-N
  6328* Current Cycle Credit
  6329     MOVE ACCT-CURR-CYC-CREDIT     TO ACUP-OLD-CURR-CYC-CREDIT-N
  6330* Current Cycle Debit
  6331     MOVE ACCT-CURR-CYC-DEBIT      TO ACUP-OLD-CURR-CYC-DEBIT-N
  6332* Open date
  6333*    MOVE ACCT-OPEN-DATE           TO ACUP-OLD-OPEN-DATE
  6334     MOVE ACCT-OPEN-DATE(1:4)      TO ACUP-OLD-OPEN-YEAR
  6335     MOVE ACCT-OPEN-DATE(6:2)      TO ACUP-OLD-OPEN-MON
  6336     MOVE ACCT-OPEN-DATE(9:2)      TO ACUP-OLD-OPEN-DAY
  6337* Expiry date
  6338*    MOVE ACCT-EXPIRAION-DATE      TO ACUP-OLD-EXPIRAION-DATE
  6339     MOVE ACCT-EXPIRAION-DATE(1:4) TO ACUP-OLD-EXP-YEAR
  6340     MOVE ACCT-EXPIRAION-DATE(6:2) TO ACUP-OLD-EXP-MON
  6341     MOVE ACCT-EXPIRAION-DATE(9:2) TO ACUP-OLD-EXP-DAY
  6342
  6343* Reissue date
  6344*    MOVE ACCT-REISSUE-DATE        TO ACUP-OLD-REISSUE-DATE
  6345     MOVE ACCT-REISSUE-DATE(1:4)   TO ACUP-OLD-REISSUE-YEAR
  6346     MOVE ACCT-REISSUE-DATE(6:2)   TO ACUP-OLD-REISSUE-MON
  6347     MOVE ACCT-REISSUE-DATE(9:2)   TO ACUP-OLD-REISSUE-DAY
  6348* Account Group
  6349     MOVE ACCT-GROUP-ID            TO ACUP-OLD-GROUP-ID
  6350******************************************************************
  6351*    Customer Master data
  6352******************************************************************
  6353*Customer Id (actually not editable)
  6354     MOVE CUST-ID                  TO ACUP-OLD-CUST-ID
  6355*Social Security Number
  6356     MOVE CUST-SSN                 TO ACUP-OLD-CUST-SSN
  6357*Date of birth
  6358*    MOVE CUST-DOB-YYYY-MM-DD      TO ACUP-OLD-CUST-DOB-YYYY-MM-DD
  6359     MOVE CUST-DOB-YYYY-MM-DD(1:4) TO ACUP-OLD-CUST-DOB-YEAR
  6360     MOVE CUST-DOB-YYYY-MM-DD(6:2) TO ACUP-OLD-CUST-DOB-MON
  6361     MOVE CUST-DOB-YYYY-MM-DD(9:2) TO ACUP-OLD-CUST-DOB-DAY
  6362*FICO
  6363     MOVE CUST-FICO-CREDIT-SCORE   TO ACUP-OLD-CUST-FICO-SCORE
  6364*First Name
  6365     MOVE CUST-FIRST-NAME          TO ACUP-OLD-CUST-FIRST-NAME
  6366*Middle Name
  6367     MOVE CUST-MIDDLE-NAME         TO ACUP-OLD-CUST-MIDDLE-NAME
  6368*Last Name
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 117
* COACTUPC.cbl
  6369     MOVE CUST-LAST-NAME           TO ACUP-OLD-CUST-LAST-NAME
  6370*Address
  6371     MOVE CUST-ADDR-LINE-1         TO ACUP-OLD-CUST-ADDR-LINE-1
  6372     MOVE CUST-ADDR-LINE-2         TO ACUP-OLD-CUST-ADDR-LINE-2
  6373     MOVE CUST-ADDR-LINE-3         TO ACUP-OLD-CUST-ADDR-LINE-3
  6374     MOVE CUST-ADDR-STATE-CD       TO ACUP-OLD-CUST-ADDR-STATE-CD
  6375     MOVE CUST-ADDR-COUNTRY-CD     TO
  6376                                    ACUP-OLD-CUST-ADDR-COUNTRY-CD
  6377     MOVE CUST-ADDR-ZIP            TO ACUP-OLD-CUST-ADDR-ZIP
  6378     MOVE CUST-PHONE-NUM-1         TO ACUP-OLD-CUST-PHONE-NUM-1
  6379     MOVE CUST-PHONE-NUM-2         TO ACUP-OLD-CUST-PHONE-NUM-2
  6380*Government Id
  6381     MOVE CUST-GOVT-ISSUED-ID      TO ACUP-OLD-CUST-GOVT-ISSUED-ID
  6382*EFT Code
  6383     MOVE CUST-EFT-ACCOUNT-ID      TO ACUP-OLD-CUST-EFT-ACCOUNT-ID
  6384*Primary Holder Indicator
  6385     MOVE CUST-PRI-CARD-HOLDER-IND TO ACUP-OLD-CUST-PRI-HOLDER-IND
  6386     .
  6387 9500-STORE-FETCHED-DATA-EXIT.
  6388     EXIT
  6389     .
  6390 9600-WRITE-PROCESSING.
  6391
  6392*    Read the account file for update
  6393
  6394     MOVE CC-ACCT-ID              TO WS-CARD-RID-ACCT-ID
  6395
  6396     EXEC CICS READ
  6397          FILE      (LIT-ACCTFILENAME)
**    COBCH0013S User-name required  : COACTUPC.cbl(3889,20,17)
  6398          UPDATE
  6399          RIDFLD    (WS-CARD-RID-ACCT-ID-X)
  6400          KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)
  6401          INTO      (ACCOUNT-RECORD)
  6402          LENGTH    (LENGTH OF ACCOUNT-RECORD)
  6403          RESP      (WS-RESP-CD)
  6404          RESP2     (WS-REAS-CD)
  6405     END-EXEC
  6406*****************************************************************
  6407*    Could we lock the account record ?
  6408*****************************************************************
  6409     IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)
  6410        CONTINUE
  6411     ELSE
**    COBCH0562S An "ELSE" phrase did not have a matching IF and was discarded.  : COACTUPC.cbl(3903,15,12)
  6412        SET INPUT-ERROR                    TO TRUE
  6413        IF  WS-RETURN-MSG-OFF
  6414            SET COULD-NOT-LOCK-ACCT-FOR-UPDATE  TO TRUE
  6415        END-IF
  6416        GO TO 9600-WRITE-PROCESSING-EXIT
  6417     END-IF
**    COBCH0564S A scope-delimiter did not have a matching verb and was discarded.  : COACTUPC.cbl(3909,17,12)
  6418
  6419*    Read the customer file for update
  6420
  6421     MOVE CDEMO-CUST-ID                   TO WS-CARD-RID-CUST-ID
  6422
  6423     EXEC CICS READ
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 118
* COACTUPC.cbl
  6424          FILE      (LIT-CUSTFILENAME)
**    COBCH0013S User-name required  : COACTUPC.cbl(3916,20,17)
  6425          UPDATE
  6426          RIDFLD    (WS-CARD-RID-CUST-ID-X)
  6427          KEYLENGTH (LENGTH OF WS-CARD-RID-CUST-ID-X)
  6428          INTO      (CUSTOMER-RECORD)
  6429          LENGTH    (LENGTH OF CUSTOMER-RECORD)
  6430          RESP      (WS-RESP-CD)
  6431          RESP2     (WS-REAS-CD)
  6432     END-EXEC
  6433*****************************************************************
  6434*    Could we lock the customer record ?
  6435*****************************************************************
  6436     IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)
  6437        CONTINUE
  6438     ELSE
**    COBCH0562S An "ELSE" phrase did not have a matching IF and was discarded.  : COACTUPC.cbl(3930,15,12)
  6439        SET INPUT-ERROR                    TO TRUE
  6440        IF  WS-RETURN-MSG-OFF
  6441            SET COULD-NOT-LOCK-CUST-FOR-UPDATE  TO TRUE
  6442        END-IF
  6443        GO TO 9600-WRITE-PROCESSING-EXIT
  6444     END-IF
**    COBCH0564S A scope-delimiter did not have a matching verb and was discarded.  : COACTUPC.cbl(3936,17,12)
  6445
  6446*****************************************************************
  6447*    Did someone change the record while we were out ?
  6448*****************************************************************
  6449     PERFORM 9700-CHECK-CHANGE-IN-REC
  6450        THRU 9700-CHECK-CHANGE-IN-REC-EXIT
  6451
  6452     IF DATA-WAS-CHANGED-BEFORE-UPDATE
  6453        GO TO 9600-WRITE-PROCESSING-EXIT
  6454     END-IF
  6455*****************************************************************
  6456* Prepare the update
  6457*****************************************************************
  6458     INITIALIZE ACCT-UPDATE-RECORD
  6459******************************************************************
  6460*    Account Master data
  6461******************************************************************
  6462     MOVE ACUP-NEW-ACCT-ID         TO ACCT-UPDATE-ID
  6463* Active Status
  6464     MOVE ACUP-NEW-ACTIVE-STATUS   TO ACCT-UPDATE-ACTIVE-STATUS
  6465* Current Balance
  6466     MOVE ACUP-NEW-CURR-BAL-N      TO ACCT-UPDATE-CURR-BAL
  6467* Credit Limit
  6468     MOVE ACUP-NEW-CREDIT-LIMIT-N  TO ACCT-UPDATE-CREDIT-LIMIT
  6469* Cash Limit
  6470     MOVE ACUP-NEW-CASH-CREDIT-LIMIT-N
  6471                                TO ACCT-UPDATE-CASH-CREDIT-LIMIT
  6472* Current Cycle Credit
  6473     MOVE ACUP-NEW-CURR-CYC-CREDIT-N
  6474                                    TO ACCT-UPDATE-CURR-CYC-CREDIT
  6475* Current Cycle Debit
  6476     MOVE ACUP-NEW-CURR-CYC-DEBIT-N TO ACCT-UPDATE-CURR-CYC-DEBIT
  6477* Open date
  6478     STRING ACUP-NEW-OPEN-YEAR
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 119
* COACTUPC.cbl
  6479            '-'
  6480            ACUP-NEW-OPEN-MON
  6481            '-'
  6482            ACUP-NEW-OPEN-DAY
  6483     DELIMITED BY SIZE
  6484                                 INTO ACCT-UPDATE-OPEN-DATE
  6485* Expiry date
  6486     STRING ACUP-NEW-EXP-YEAR
  6487            '-'
  6488            ACUP-NEW-EXP-MON
  6489            '-'
  6490            ACUP-NEW-EXP-DAY
  6491     DELIMITED BY SIZE
  6492                                 INTO ACCT-UPDATE-EXPIRAION-DATE
  6493
  6494* Reissue date
  6495     MOVE ACCT-REISSUE-DATE        TO ACCT-UPDATE-REISSUE-DATE
  6496     STRING ACUP-NEW-REISSUE-YEAR
  6497            '-'
  6498            ACUP-NEW-REISSUE-MON
  6499            '-'
  6500            ACUP-NEW-REISSUE-DAY
  6501     DELIMITED BY SIZE
  6502                                 INTO ACCT-UPDATE-REISSUE-DATE
  6503* Account Group
  6504     MOVE ACUP-NEW-GROUP-ID        TO ACCT-UPDATE-GROUP-ID
  6505
  6506******************************************************************
  6507*    Customer data
  6508******************************************************************
  6509     INITIALIZE CUST-UPDATE-RECORD
  6510
  6511     MOVE  ACUP-NEW-CUST-ID        TO CUST-UPDATE-ID
  6512     MOVE  ACUP-NEW-CUST-FIRST-NAME
  6513                             TO CUST-UPDATE-FIRST-NAME
  6514     MOVE  ACUP-NEW-CUST-MIDDLE-NAME
  6515                             TO CUST-UPDATE-MIDDLE-NAME
  6516     MOVE  ACUP-NEW-CUST-LAST-NAME TO CUST-UPDATE-LAST-NAME
  6517     MOVE  ACUP-NEW-CUST-ADDR-LINE-1
  6518                             TO CUST-UPDATE-ADDR-LINE-1
  6519     MOVE  ACUP-NEW-CUST-ADDR-LINE-2
  6520                             TO CUST-UPDATE-ADDR-LINE-2
  6521     MOVE  ACUP-NEW-CUST-ADDR-LINE-3
  6522                             TO CUST-UPDATE-ADDR-LINE-3
  6523     MOVE  ACUP-NEW-CUST-ADDR-STATE-CD
  6524                             TO CUST-UPDATE-ADDR-STATE-CD
  6525     MOVE  ACUP-NEW-CUST-ADDR-COUNTRY-CD
  6526                             TO CUST-UPDATE-ADDR-COUNTRY-CD
  6527     MOVE  ACUP-NEW-CUST-ADDR-ZIP  TO CUST-UPDATE-ADDR-ZIP
  6528
  6529     STRING '(',
  6530            ACUP-NEW-CUST-PHONE-NUM-1A,
  6531            ')',
  6532            ACUP-NEW-CUST-PHONE-NUM-1B,
  6533            '-',
  6534            ACUP-NEW-CUST-PHONE-NUM-1C
  6535     DELIMITED BY SIZE    INTO CUST-UPDATE-PHONE-NUM-1
  6536
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 120
* COACTUPC.cbl
  6537     STRING '(',
  6538            ACUP-NEW-CUST-PHONE-NUM-2A,
  6539            ')',
  6540            ACUP-NEW-CUST-PHONE-NUM-2B,
  6541            '-',
  6542            ACUP-NEW-CUST-PHONE-NUM-2C
  6543     DELIMITED BY SIZE    INTO CUST-UPDATE-PHONE-NUM-2
  6544
  6545
  6546     MOVE  ACUP-NEW-CUST-SSN       TO CUST-UPDATE-SSN
  6547     MOVE  ACUP-NEW-CUST-GOVT-ISSUED-ID
  6548                             TO CUST-UPDATE-GOVT-ISSUED-ID
  6549     STRING ACUP-NEW-CUST-DOB-YEAR
  6550            '-'
  6551            ACUP-NEW-CUST-DOB-MON
  6552            '-'
  6553            ACUP-NEW-CUST-DOB-DAY
  6554     DELIMITED BY SIZE           INTO CUST-UPDATE-DOB-YYYY-MM-DD
  6555
  6556     MOVE ACUP-NEW-CUST-EFT-ACCOUNT-ID
  6557                                   TO CUST-UPDATE-EFT-ACCOUNT-ID
  6558     MOVE ACUP-NEW-CUST-PRI-HOLDER-IND
  6559                                   TO CUST-UPDATE-PRI-CARD-IND
  6560     MOVE ACUP-NEW-CUST-FICO-SCORE TO
  6561                             CUST-UPDATE-FICO-CREDIT-SCORE
  6562*****************************************************************
  6563* Update account *
  6564*****************************************************************
  6565
  6566
  6567     EXEC CICS
  6568          REWRITE FILE(LIT-ACCTFILENAME)
**    COBCH0014S Invalid operand  : COACTUPC.cbl(4060,28,25)
  6569                  FROM(ACCT-UPDATE-RECORD)
  6570                  LENGTH(LENGTH OF ACCT-UPDATE-RECORD)
  6571                  RESP      (WS-RESP-CD)
  6572                  RESP2     (WS-REAS-CD)
  6573     END-EXEC.
  6574*
  6575*****************************************************************
  6576* Did account update succeed ?  *
  6577*****************************************************************
  6578     IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)
  6579       CONTINUE
  6580     ELSE
**    COBCH0562S An "ELSE" phrase did not have a matching IF and was discarded.  : COACTUPC.cbl(4072,15,12)
  6581       SET LOCKED-BUT-UPDATE-FAILED    TO TRUE
  6582       GO TO 9600-WRITE-PROCESSING-EXIT
  6583     END-IF
**    COBCH0564S A scope-delimiter did not have a matching verb and was discarded.  : COACTUPC.cbl(4075,17,12)
  6584*****************************************************************
  6585* Update customer *
  6586*****************************************************************
  6587     EXEC CICS
  6588                  REWRITE FILE(LIT-CUSTFILENAME)
**    COBCH0014S Invalid operand  : COACTUPC.cbl(4080,36,33)
  6589                  FROM(CUST-UPDATE-RECORD)
  6590                  LENGTH(LENGTH OF CUST-UPDATE-RECORD)
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 121
* COACTUPC.cbl
  6591                  RESP      (WS-RESP-CD)
  6592                  RESP2     (WS-REAS-CD)
  6593     END-EXEC.
  6594*****************************************************************
  6595* Did customer update succeed ? *
  6596*****************************************************************
  6597     IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)
  6598       CONTINUE
  6599     ELSE
**    COBCH0562S An "ELSE" phrase did not have a matching IF and was discarded.  : COACTUPC.cbl(4091,15,12)
  6600       SET LOCKED-BUT-UPDATE-FAILED    TO TRUE
  6601       EXEC CICS
**    COBCH0132S Repeated 'condition-name TO TRUE/FALSE' in SET statement.  : COACTUPC.cbl(4093,17,14)
  6602          SYNCPOINT ROLLBACK
  6603       END-EXEC
  6604       GO TO 9600-WRITE-PROCESSING-EXIT
  6605     END-IF
**    COBCH0564S A scope-delimiter did not have a matching verb and was discarded.  : COACTUPC.cbl(4097,17,12)
  6606     .
  6607 9600-WRITE-PROCESSING-EXIT.
  6608     EXIT
  6609     .
  6610
  6611 9700-CHECK-CHANGE-IN-REC.
  6612
  6613
  6614******************************************************************
  6615*    Account Master data
  6616******************************************************************
  6617     IF  ACCT-ACTIVE-STATUS      EQUAL ACUP-OLD-ACTIVE-STATUS
  6618* Current Balance
  6619     AND ACCT-CURR-BAL           EQUAL ACUP-OLD-CURR-BAL-N
  6620* Credit Limit
  6621     AND ACCT-CREDIT-LIMIT       EQUAL ACUP-OLD-CREDIT-LIMIT-N
  6622* Cash Limit
  6623     AND ACCT-CASH-CREDIT-LIMIT EQUAL ACUP-OLD-CASH-CREDIT-LIMIT-N
  6624* Current Cycle Credit
  6625     AND ACCT-CURR-CYC-CREDIT    EQUAL ACUP-OLD-CURR-CYC-CREDIT-N
  6626* Current Cycle Debit
  6627     AND ACCT-CURR-CYC-DEBIT     EQUAL ACUP-OLD-CURR-CYC-DEBIT-N
  6628* Open date
  6629     AND ACCT-OPEN-DATE(1:4)     EQUAL ACUP-OLD-OPEN-YEAR
  6630     AND ACCT-OPEN-DATE(6:2)     EQUAL ACUP-OLD-OPEN-MON
  6631     AND ACCT-OPEN-DATE(9:2)     EQUAL ACUP-OLD-OPEN-DAY
  6632* Expiry date
  6633     AND ACCT-EXPIRAION-DATE(1:4)EQUAL ACUP-OLD-EXP-YEAR
  6634     AND ACCT-EXPIRAION-DATE(6:2)EQUAL ACUP-OLD-EXP-MON
  6635     AND ACCT-EXPIRAION-DATE(9:2)EQUAL ACUP-OLD-EXP-DAY
  6636* Reissue date
  6637     AND ACCT-REISSUE-DATE(1:4)  EQUAL ACUP-OLD-REISSUE-YEAR
  6638     AND ACCT-REISSUE-DATE(6:2)  EQUAL ACUP-OLD-REISSUE-MON
  6639     AND ACCT-REISSUE-DATE(9:2)  EQUAL ACUP-OLD-REISSUE-DAY
  6640* Account Group
  6641     AND FUNCTION LOWER-CASE (ACCT-GROUP-ID)           EQUAL
  6642         FUNCTION LOWER-CASE (ACUP-OLD-GROUP-ID)
  6643         CONTINUE
  6644     ELSE
  6645        SET DATA-WAS-CHANGED-BEFORE-UPDATE TO TRUE
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 122
* COACTUPC.cbl
  6646        GO TO 9600-WRITE-PROCESSING-EXIT
  6647     END-IF
  6648
  6649******************************************************************
  6650*    Customer  data - Split into 2 IFs for easier reading
  6651*    And maybe put logic to update only 1 file if only date
  6652*    pertaining to one of them is updated
  6653******************************************************************
  6654     IF  FUNCTION UPPER-CASE (CUST-FIRST-NAME          ) EQUAL
  6655         FUNCTION UPPER-CASE (ACUP-OLD-CUST-FIRST-NAME )
  6656     AND FUNCTION UPPER-CASE (CUST-MIDDLE-NAME         ) EQUAL
  6657         FUNCTION UPPER-CASE (ACUP-OLD-CUST-MIDDLE-NAME)
  6658     AND FUNCTION UPPER-CASE (CUST-LAST-NAME           ) EQUAL
  6659         FUNCTION UPPER-CASE (ACUP-OLD-CUST-LAST-NAME  )
  6660     AND FUNCTION UPPER-CASE (CUST-ADDR-LINE-1         ) EQUAL
  6661         FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-LINE-1)
  6662     AND FUNCTION UPPER-CASE (CUST-ADDR-LINE-2         ) EQUAL
  6663         FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-LINE-2)
  6664     AND FUNCTION UPPER-CASE (CUST-ADDR-LINE-3         ) EQUAL
  6665         FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-LINE-3)
  6666     AND FUNCTION UPPER-CASE (CUST-ADDR-STATE-CD       ) EQUAL
  6667         FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-STATE-CD)
  6668     AND FUNCTION UPPER-CASE (CUST-ADDR-COUNTRY-CD     ) EQUAL
  6669         FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-COUNTRY-CD )
  6670     AND CUST-ADDR-ZIP           EQUAL ACUP-OLD-CUST-ADDR-ZIP
  6671     AND CUST-PHONE-NUM-1        EQUAL ACUP-OLD-CUST-PHONE-NUM-1
  6672     AND CUST-PHONE-NUM-2        EQUAL ACUP-OLD-CUST-PHONE-NUM-2
  6673     AND CUST-SSN                EQUAL ACUP-OLD-CUST-SSN
  6674     AND FUNCTION UPPER-CASE (CUST-GOVT-ISSUED-ID      ) EQUAL
  6675         FUNCTION UPPER-CASE (ACUP-OLD-CUST-GOVT-ISSUED-ID )
  6676     AND CUST-DOB-YYYY-MM-DD (1:4)                       EQUAL
  6677         ACUP-OLD-CUST-DOB-YYYY-MM-DD (1:4)
  6678     AND CUST-DOB-YYYY-MM-DD (6:2)                       EQUAL
  6679         ACUP-OLD-CUST-DOB-YYYY-MM-DD (5:2)
  6680     AND CUST-DOB-YYYY-MM-DD (9:2)                       EQUAL
  6681         ACUP-OLD-CUST-DOB-YYYY-MM-DD (7:2)
  6682
  6683     AND CUST-EFT-ACCOUNT-ID     EQUAL
  6684                                      ACUP-OLD-CUST-EFT-ACCOUNT-ID
  6685     AND CUST-PRI-CARD-HOLDER-IND
  6686                                 EQUAL
  6687                                      ACUP-OLD-CUST-PRI-HOLDER-IND
  6688     AND CUST-FICO-CREDIT-SCORE  EQUAL ACUP-OLD-CUST-FICO-SCORE
  6689         CONTINUE
  6690     ELSE
  6691        SET DATA-WAS-CHANGED-BEFORE-UPDATE TO TRUE
  6692        GO TO 9600-WRITE-PROCESSING-EXIT
  6693     END-IF
  6694     .
  6695 9700-CHECK-CHANGE-IN-REC-EXIT.
  6696     EXIT
  6697     .
  6698******************************************************************
  6699*Common code to store PFKey
  6700******************************************************************
  6701*COPY 'CSSTRPFY'
  6702*    .
**    COBCH0008S Unknown copybook CSSTRPFY specified  : COACTUPC.cbl(4194,11,11)
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 123
* COACTUPC.cbl
  6703
  6704
  6705 ABEND-ROUTINE.
**    COBCH0301S Unrecognized verb  : COACTUPC.cbl(4197,20,8)
**    COBCH0010S Word starts or is continued in wrong area of source line  : COACTUPC.cbl(4197,20,8)
  6706
  6707     IF ABEND-MSG EQUAL LOW-VALUES
  6708        MOVE 'UNEXPECTED ABEND OCCURRED.' TO ABEND-MSG
  6709     END-IF
  6710
  6711     MOVE LIT-THISPGM       TO ABEND-CULPRIT
  6712
  6713     EXEC CICS SEND
**    COBCH1895S Communication Facility not supported  : COACTUPC.cbl(4205,25,22)
  6714                      FROM (ABEND-DATA)
**    COBCH0013S User-name required  : COACTUPC.cbl(4206,32,29)
  6715                      LENGTH(LENGTH OF ABEND-DATA)
  6716                      NOHANDLE
  6717                      ERASE
  6718     END-EXEC
  6719
  6720     EXEC CICS HANDLE ABEND
  6721          CANCEL
  6722     END-EXEC
  6723
  6724     EXEC CICS ABEND
**    COBCH0012S Operand ABEND is not declared  : COACTUPC.cbl(4216,26,22)
  6725          ABCODE('9999')
  6726     END-EXEC
  6727     .
  6728 ABEND-ROUTINE-EXIT.
  6729     EXIT
  6730     .
  6731******************************************************************
  6732* Common Date Routines
  6733******************************************************************
  6734*COPY CSUTLDPY
  6735*    .
  6736******************************************************************
  6737*Procedure Division Copybook for DATE related code
  6738******************************************************************
  6739*Date validation paragraph for reuse and hopefully not misuse
  6740*Accompanying WORKING Storage is CSUTLDTR
  6741******************************************************************
  6742* ***  PERFORM EDIT-DATE-CCYYMMDD
  6743*         THRU EDIT-DATE-CCYYMMDD-EXIT
  6744*         to validate CCYYMMDD dates
  6745*      Reusable paras
  6746*      a) EDIT-YEAR-CCYY
  6747*      b) EDIT-MONTH
  6748*      c) EDIT-DAY
  6749*      d) EDIT-DATE-OF-BIRTH
  6750*      e) EDIT-DATE-OF-BIRTH
  6751******************************************************************
  6752
  6753 EDIT-DATE-CCYYMMDD.
  6754     SET WS-EDIT-DATE-IS-INVALID   TO TRUE
  6755     .
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 124
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSUTLDPY.c)
  6756
  6757******************************************************************
  6758*Check for valid year and century
  6759******************************************************************
  6760 EDIT-YEAR-CCYY.
  6761
  6762     SET FLG-YEAR-NOT-OK             TO TRUE
  6763
  6764*    Not supplied
  6765     IF WS-EDIT-DATE-CCYY            EQUAL LOW-VALUES
  6766     OR WS-EDIT-DATE-CCYY            EQUAL SPACES
  6767        SET INPUT-ERROR              TO TRUE
  6768        SET  FLG-YEAR-BLANK          TO TRUE
  6769        IF WS-RETURN-MSG-OFF
  6770           STRING
  6771             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  6772             ' : Year must be supplied.'
  6773             DELIMITED BY SIZE
  6774             INTO WS-RETURN-MSG
  6775        END-IF
  6776*       Intentional violation of structured programming norms
  6777        GO TO EDIT-YEAR-CCYY-EXIT
  6778     ELSE
  6779        CONTINUE
  6780     END-IF
  6781
  6782*    Not numeric
  6783     IF WS-EDIT-DATE-CCYY            IS NOT NUMERIC
  6784        SET INPUT-ERROR              TO TRUE
  6785        SET  FLG-YEAR-NOT-OK         TO TRUE
  6786        IF WS-RETURN-MSG-OFF
  6787           STRING
  6788             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  6789             ' must be 4 digit number.'
  6790             DELIMITED BY SIZE
  6791             INTO WS-RETURN-MSG
  6792        END-IF
  6793        GO TO EDIT-YEAR-CCYY-EXIT
  6794     ELSE
  6795        CONTINUE
  6796     END-IF
  6797
  6798******************************************************************
  6799*    Century not reasonable
  6800******************************************************************
  6801*  Not having learnt our lesson from history and Y2K
  6802*  And being unable to imagine COBOL in the 2100s
  6803*  We code only 19 and 20 as valid century values
  6804******************************************************************
  6805     IF THIS-CENTURY
  6806     OR LAST-CENTURY
  6807        CONTINUE
  6808     ELSE
  6809        SET INPUT-ERROR              TO TRUE
  6810        SET  FLG-YEAR-NOT-OK         TO TRUE
  6811        IF WS-RETURN-MSG-OFF
  6812           STRING
  6813             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 125
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSUTLDPY.c)
  6814             ' : Century is not valid.'
  6815             DELIMITED BY SIZE
  6816             INTO WS-RETURN-MSG
  6817        END-IF
  6818        GO TO EDIT-YEAR-CCYY-EXIT
  6819     END-IF
  6820
  6821     SET FLG-YEAR-ISVALID            TO TRUE
  6822     .
  6823 EDIT-YEAR-CCYY-EXIT.
  6824     EXIT
  6825     .
  6826 EDIT-MONTH.
  6827     SET FLG-MONTH-NOT-OK            TO TRUE
  6828
  6829     IF WS-EDIT-DATE-MM              EQUAL LOW-VALUES
  6830     OR WS-EDIT-DATE-MM              EQUAL SPACES
  6831        SET INPUT-ERROR              TO TRUE
  6832        SET  FLG-MONTH-BLANK         TO TRUE
  6833        IF WS-RETURN-MSG-OFF
  6834           STRING
  6835             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  6836             ' : Month must be supplied.'
  6837             DELIMITED BY SIZE
  6838             INTO WS-RETURN-MSG
  6839        END-IF
  6840        GO TO EDIT-MONTH-EXIT
  6841     ELSE
  6842        CONTINUE
  6843     END-IF
  6844
  6845*    Month not reasonable
  6846     IF WS-VALID-MONTH
  6847        CONTINUE
  6848     ELSE
  6849        SET INPUT-ERROR              TO TRUE
  6850        SET  FLG-MONTH-NOT-OK        TO TRUE
  6851        IF WS-RETURN-MSG-OFF
  6852           STRING
  6853             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  6854             ': Month must be a number between 1 and 12.'
  6855             DELIMITED BY SIZE
  6856             INTO WS-RETURN-MSG
  6857        END-IF
  6858        GO TO EDIT-MONTH-EXIT
  6859     END-IF
  6860
  6861     IF FUNCTION TEST-NUMVAL (WS-EDIT-DATE-MM) = 0
  6862        COMPUTE WS-EDIT-DATE-MM-N
  6863                    = FUNCTION NUMVAL (WS-EDIT-DATE-MM)
  6864        END-COMPUTE
  6865     ELSE
  6866        SET INPUT-ERROR              TO TRUE
  6867        SET  FLG-MONTH-NOT-OK        TO TRUE
  6868        IF WS-RETURN-MSG-OFF
  6869           STRING
  6870             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  6871             ': Month must be a number between 1 and 12.'
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 126
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSUTLDPY.c)
  6872             DELIMITED BY SIZE
  6873             INTO WS-RETURN-MSG
  6874        END-IF
  6875        GO TO EDIT-MONTH-EXIT
  6876     END-IF
  6877
  6878     SET FLG-MONTH-ISVALID           TO TRUE
  6879     .
  6880 EDIT-MONTH-EXIT.
  6881     EXIT
  6882     .
  6883
  6884
  6885 EDIT-DAY.
  6886
  6887     SET FLG-DAY-ISVALID             TO TRUE
  6888
  6889     IF WS-EDIT-DATE-DD              EQUAL LOW-VALUES
  6890     OR WS-EDIT-DATE-DD              EQUAL SPACES
  6891        SET INPUT-ERROR              TO TRUE
  6892        SET  FLG-DAY-BLANK           TO TRUE
  6893        IF WS-RETURN-MSG-OFF
  6894           STRING
  6895             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  6896             ' : Day must be supplied.'
  6897             DELIMITED BY SIZE
  6898             INTO WS-RETURN-MSG
  6899        END-IF
  6900        GO TO EDIT-DAY-EXIT
  6901     ELSE
  6902        CONTINUE
  6903     END-IF
  6904
  6905     IF FUNCTION TEST-NUMVAL (WS-EDIT-DATE-DD) = 0
  6906        COMPUTE WS-EDIT-DATE-DD-N
  6907                    = FUNCTION NUMVAL (WS-EDIT-DATE-DD)
  6908        END-COMPUTE
  6909     ELSE
  6910        SET INPUT-ERROR              TO TRUE
  6911        SET  FLG-DAY-NOT-OK          TO TRUE
  6912        IF WS-RETURN-MSG-OFF
  6913           STRING
  6914             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  6915             ':day must be a number between 1 and 31.'
  6916             DELIMITED BY SIZE
  6917             INTO WS-RETURN-MSG
  6918        END-IF
  6919        GO TO EDIT-DAY-EXIT
  6920     END-IF
  6921
  6922     IF WS-VALID-DAY
  6923        CONTINUE
  6924     ELSE
  6925        SET INPUT-ERROR              TO TRUE
  6926        SET FLG-DAY-NOT-OK          TO TRUE
  6927        IF WS-RETURN-MSG-OFF
  6928           STRING
  6929             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 127
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSUTLDPY.c)
  6930             ':day must be a number between 1 and 31.'
  6931             DELIMITED BY SIZE
  6932             INTO WS-RETURN-MSG
  6933        END-IF
  6934        GO TO EDIT-DAY-EXIT
  6935     END-IF
  6936     .
  6937
  6938     SET FLG-DAY-ISVALID           TO TRUE
  6939     .
  6940 EDIT-DAY-EXIT.
  6941     EXIT
  6942     .
  6943
  6944 EDIT-DAY-MONTH-YEAR.
  6945******************************************************************
  6946*    Checking for any other combinations
  6947******************************************************************
  6948     IF  NOT WS-31-DAY-MONTH
  6949     AND WS-DAY-31
  6950        SET INPUT-ERROR              TO TRUE
  6951        SET FLG-DAY-NOT-OK           TO TRUE
  6952        SET FLG-MONTH-NOT-OK         TO TRUE
  6953        IF WS-RETURN-MSG-OFF
  6954           STRING
  6955             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  6956             ':Cannot have 31 days in this month.'
  6957             DELIMITED BY SIZE
  6958             INTO WS-RETURN-MSG
  6959        END-IF
  6960        GO TO EDIT-DATE-CCYYMMDD-EXIT
  6961     END-IF
  6962
  6963     IF  WS-FEBRUARY
  6964     AND WS-DAY-30
  6965        SET INPUT-ERROR              TO TRUE
  6966        SET FLG-DAY-NOT-OK           TO TRUE
  6967        SET FLG-MONTH-NOT-OK         TO TRUE
  6968        IF WS-RETURN-MSG-OFF
  6969           STRING
  6970             FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  6971             ':Cannot have 30 days in this month.'
  6972             DELIMITED BY SIZE
  6973             INTO WS-RETURN-MSG
  6974        END-IF
  6975        GO TO EDIT-DATE-CCYYMMDD-EXIT
  6976     END-IF
  6977
  6978     IF  WS-FEBRUARY
  6979     AND WS-DAY-29
  6980         IF WS-EDIT-DATE-YY-N = 0
  6981            MOVE 400                TO  WS-DIV-BY
  6982         ELSE
  6983            MOVE 4                  TO  WS-DIV-BY
  6984         END-IF
  6985
  6986         DIVIDE WS-EDIT-DATE-CCYY-N
  6987             BY WS-DIV-BY
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 128
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSUTLDPY.c)
  6988         GIVING WS-DIVIDEND
  6989         REMAINDER WS-REMAINDER
  6990
  6991         IF WS-REMAINDER = ZEROES
  6992            CONTINUE
  6993         ELSE
  6994            SET INPUT-ERROR          TO TRUE
  6995            SET FLG-DAY-NOT-OK       TO TRUE
  6996            SET FLG-MONTH-NOT-OK     TO TRUE
  6997            SET FLG-YEAR-NOT-OK      TO TRUE
  6998            IF WS-RETURN-MSG-OFF
  6999            STRING
  7000              FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  7001             ':Not a leap year.Cannot have 29 days in this month.'
  7002              DELIMITED BY SIZE
  7003             INTO WS-RETURN-MSG
  7004            END-IF
  7005            GO TO EDIT-DATE-CCYYMMDD-EXIT
  7006         END-IF
  7007     END-IF
  7008
  7009     IF WS-EDIT-DATE-IS-VALID
  7010        CONTINUE
  7011     ELSE
  7012        GO TO EDIT-DATE-CCYYMMDD-EXIT
  7013     END-IF
  7014     .
  7015 EDIT-DAY-MONTH-YEAR-EXIT.
  7016     EXIT
  7017     .
  7018
  7019 EDIT-DATE-LE.
  7020******************************************************************
  7021*    In case some one managed to enter a bad date that passsed all
  7022*    the edits above ......
  7023*                  Use LE Services to verify the supplied date
  7024******************************************************************
  7025     INITIALIZE WS-DATE-VALIDATION-RESULT
  7026     MOVE 'YYYYMMDD'                   TO WS-DATE-FORMAT
  7027
  7028     CALL 'CSUTLDTC'
  7029     USING WS-EDIT-DATE-CCYYMMDD
  7030         , WS-DATE-FORMAT
  7031         , WS-DATE-VALIDATION-RESULT
  7032
  7033     IF WS-SEVERITY-N = 0
  7034        CONTINUE
  7035     ELSE
  7036        SET INPUT-ERROR                TO TRUE
  7037        SET FLG-DAY-NOT-OK             TO TRUE
  7038        SET FLG-MONTH-NOT-OK           TO TRUE
  7039        SET FLG-YEAR-NOT-OK            TO TRUE
  7040        IF WS-RETURN-MSG-OFF
  7041        STRING
  7042          FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  7043          ' validation error Sev code: '
  7044          WS-SEVERITY
  7045          ' Message code: '
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 129
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSUTLDPY.c)
  7046          WS-MSG-NO
  7047          DELIMITED BY SIZE
  7048         INTO WS-RETURN-MSG
  7049        END-IF
  7050        GO TO EDIT-DATE-LE-EXIT
  7051     END-IF
  7052
  7053     IF NOT INPUT-ERROR
  7054        SET FLG-DAY-ISVALID           TO TRUE
  7055     END-IF
  7056     .
  7057
  7058 EDIT-DATE-LE-EXIT.
  7059     EXIT
  7060     .
  7061*    If we got here all edits were cleared
  7062     SET WS-EDIT-DATE-IS-VALID        TO TRUE
  7063     .
  7064 EDIT-DATE-CCYYMMDD-EXIT.
  7065     EXIT
  7066     .
  7067
  7068******************************************************************
  7069*Date of Birth Reasonableness check
  7070******************************************************************
  7071*  At the time of writing this program
  7072*  Time travel was not possible.
  7073*  Date of birth in the future is not acceptable
  7074******************************************************************
  7075*
  7076 EDIT-DATE-OF-BIRTH.
  7077
  7078     MOVE FUNCTION CURRENT-DATE TO WS-CURRENT-DATE-YYYYMMDD
  7079
  7080     COMPUTE WS-EDIT-DATE-BINARY =
  7081         FUNCTION INTEGER-OF-DATE (WS-EDIT-DATE-CCYYMMDD-N)
  7082     COMPUTE WS-CURRENT-DATE-BINARY =
  7083         FUNCTION INTEGER-OF-DATE (WS-CURRENT-DATE-YYYYMMDD-N)
  7084
  7085     IF WS-CURRENT-DATE-BINARY > WS-EDIT-DATE-BINARY
  7086*    IF FUNCTION FIND-DURATION(FUNCTION CURRENT-DATE
  7087*                             ,WS-EDIT-DATE-CCYYMMDD)
  7088*                             ,DAYS) > 0
  7089        CONTINUE
  7090     ELSE
  7091        SET INPUT-ERROR                TO TRUE
  7092        SET FLG-DAY-NOT-OK             TO TRUE
  7093        SET FLG-MONTH-NOT-OK           TO TRUE
  7094        SET FLG-YEAR-NOT-OK            TO TRUE
  7095        IF WS-RETURN-MSG-OFF
  7096        STRING
  7097          FUNCTION TRIM(WS-EDIT-VARIABLE-NAME)
  7098          ':cannot be in the future '
  7099          DELIMITED BY SIZE
  7100         INTO WS-RETURN-MSG
  7101        END-IF
  7102        GO TO EDIT-DATE-OF-BIRTH-EXIT
  7103     END-IF
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 130
* COACTUPC.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CSUTLDPY.c)
  7104     .
  7105 EDIT-DATE-OF-BIRTH-EXIT.
  7106     EXIT
  7107     .
  7108*
  7109* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:59 CDT
  7110*
  7111*
  7112* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:32 CDT
  7113*
*      ABEND-ROUTINE
**    COBCH0498S Procedure name ABEND-ROUTINE undeclared, line 5141  : COACTUPC.cbl(2633,40,28)
*      YYYY-STORE-PFKEY-EXIT
**    COBCH0498S Procedure name YYYY-STORE-PFKEY-EXIT undeclared, line 3401  : COACTUPC.cbl(893,40,20)
*      YYYY-STORE-PFKEY
**    COBCH0498S Procedure name YYYY-STORE-PFKEY undeclared, line 3400  : COACTUPC.cbl(892,35,20)
*
*
* Errors
* -Line- Col Code/severity Description
*                          *      EIBCALEN
*   3358  59  245-S        DEPENDING ON item EIBCALEN missing or illegal
*   3364  16  301-S        Unrecognized verb
*   3382  23   12-S        Operand EIBCALEN is not declared
*   3454  24   12-S        Operand EXEC is not declared
*   3454  29   12-S        Operand CICS is not declared
*   3455  34   12-S        Operand SYNCPOINT is not declared
*   3456  28   12-S        Operand END-EXEC is not declared
*   3458  34   12-S        Operand XCTL is not declared
*   3518  24   12-S        Operand TRANSID is not declared
*   3542  16  305-S        Procedure name EXEC same as data-name
*   3542  16  301-S        Unrecognized verb
*   3542  29 1895-S        Communication Facility not supported
*   3542  33   12-S        Operand MAP is not declared
*   5713  44    8-S        Unknown copybook CSSETATY specified
*   5719  44    8-S        Unknown copybook CSSETATY specified
*   5725  44    8-S        Unknown copybook CSSETATY specified
*   5731  44    8-S        Unknown copybook CSSETATY specified
*   5737  44    8-S        Unknown copybook CSSETATY specified
*   5743  44    8-S        Unknown copybook CSSETATY specified
*   5749  44    8-S        Unknown copybook CSSETATY specified
*   5755  44    8-S        Unknown copybook CSSETATY specified
*   5761  44    8-S        Unknown copybook CSSETATY specified
*   5767  44    8-S        Unknown copybook CSSETATY specified
*   5773  44    8-S        Unknown copybook CSSETATY specified
*   5779  44    8-S        Unknown copybook CSSETATY specified
*   5785  44    8-S        Unknown copybook CSSETATY specified
*   5791  44    8-S        Unknown copybook CSSETATY specified
*   5797  44    8-S        Unknown copybook CSSETATY specified
*   5803  44    8-S        Unknown copybook CSSETATY specified
*   5809  44    8-S        Unknown copybook CSSETATY specified
*   5815  44    8-S        Unknown copybook CSSETATY specified
*   5821  44    8-S        Unknown copybook CSSETATY specified
*   5827  44    8-S        Unknown copybook CSSETATY specified
*   5833  44    8-S        Unknown copybook CSSETATY specified
*   5839  44    8-S        Unknown copybook CSSETATY specified
*   5845  44    8-S        Unknown copybook CSSETATY specified
*   5851  44    8-S        Unknown copybook CSSETATY specified
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 131
* COACTUPC.cbl
*   5857  44    8-S        Unknown copybook CSSETATY specified
*   5863  44    8-S        Unknown copybook CSSETATY specified
*   5869  44    8-S        Unknown copybook CSSETATY specified
*   5875  44    8-S        Unknown copybook CSSETATY specified
*   5881  44    8-S        Unknown copybook CSSETATY specified
*   5887  44    8-S        Unknown copybook CSSETATY specified
*   5893  44    8-S        Unknown copybook CSSETATY specified
*   5899  44    8-S        Unknown copybook CSSETATY specified
*   5905  44    8-S        Unknown copybook CSSETATY specified
*   5910  44    8-S        Unknown copybook CSSETATY specified
*   5916  44    8-S        Unknown copybook CSSETATY specified
*   5922  44    8-S        Unknown copybook CSSETATY specified
*   5927  44    8-S        Unknown copybook CSSETATY specified
*   5932  44    8-S        Unknown copybook CSSETATY specified
*   5937  44    8-S        Unknown copybook CSSETATY specified
*   6096  26 1895-S        Communication Facility not supported
*   6096  30   12-S        Operand MAP is not declared
*   6156  16  305-S        Procedure name EXEC same as data-name
*   6156  16  301-S        Unrecognized verb
*   6157  24   12-S        Operand DATASET is not declared
*   6167  28   12-S        Operand DFHRESP is not declared
*   6167  35   12-S        Operand NORMAL is not declared
*   6170  20  368-S        Exception phrase inappropriate
*   6188  20  368-S        Exception phrase inappropriate
*   6198  24  564-S        A scope-delimiter did not have a matching verb and
*                          was discarded.
*   6205  16  305-S        Procedure name EXEC same as data-name
*   6205  16  301-S        Unrecognized verb
*   6218  20  368-S        Exception phrase inappropriate
*   6238  20  368-S        Exception phrase inappropriate
*   6248  24  564-S        A scope-delimiter did not have a matching verb and
*                          was discarded.
*   6255  16  305-S        Procedure name EXEC same as data-name
*   6255  16  301-S        Unrecognized verb
*   6268  20  368-S        Exception phrase inappropriate
*   6287  20  368-S        Exception phrase inappropriate
*   6297  24  564-S        A scope-delimiter did not have a matching verb and
*                          was discarded.
*   6397  21   13-S        User-name required
*   6411  16  562-S        An "ELSE" phrase did not have a matching IF and was
*                          discarded.
*   6417  18  564-S        A scope-delimiter did not have a matching verb and
*                          was discarded.
*   6424  21   13-S        User-name required
*   6438  16  562-S        An "ELSE" phrase did not have a matching IF and was
*                          discarded.
*   6444  18  564-S        A scope-delimiter did not have a matching verb and
*                          was discarded.
*   6568  29   14-S        Invalid operand
*   6580  16  562-S        An "ELSE" phrase did not have a matching IF and was
*                          discarded.
*   6583  18  564-S        A scope-delimiter did not have a matching verb and
*                          was discarded.
*   6588  37   14-S        Invalid operand
*   6599  16  562-S        An "ELSE" phrase did not have a matching IF and was
*                          discarded.
*   6601  18  132-S        Repeated 'condition-name TO TRUE/FALSE' in SET
*                          statement.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page 132
* COACTUPC.cbl
*   6605  18  564-S        A scope-delimiter did not have a matching verb and
*                          was discarded.
*   6702  12    8-S        Unknown copybook CSSTRPFY specified
*   6705  21  301-S        Unrecognized verb
*   6705  21   10-S        Word starts or is continued in wrong area of source
*                          line
*   6713  26 1895-S        Communication Facility not supported
*   6714  33   13-S        User-name required
*   6724  27   12-S        Operand ABEND is not declared
*                          *      ABEND-ROUTINE
*   5141  41  498-S        Procedure name ABEND-ROUTINE undeclared, line 5141
*                          *      YYYY-STORE-PFKEY-EXIT
*   3401  41  498-S        Procedure name YYYY-STORE-PFKEY-EXIT undeclared,
*                          line 3401
*                          *      YYYY-STORE-PFKEY
*   3400  36  498-S        Procedure name YYYY-STORE-PFKEY undeclared, line 3400
* Micro Focus COBOL                  V9.0 revision 000 Compiler
* (C) Copyright 1984-2024 Micro Focus or one of its affiliates.
*                                                        REF GKR-081900000A0
* Last message on page:  130
* Total Messages:    94
* Unrecoverable :     0                    Severe  :    94
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:        8928     Code:           0
