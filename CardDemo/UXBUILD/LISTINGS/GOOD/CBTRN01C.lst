* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   1
* CBTRN01C.cbl
* Options: int("CBTRN01C.int") verbose
*          USE(/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/DIRECTIVES/DI
*          RFOLDER/CBTRN01C.cbl.dir)
*          USE(/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/DIRECTIVES/DE
*          FAULTDIR/DUMMY.DIR)
*          USE(/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/DIRECTIVES/DE
*          FAULTDIR/DUMMY.DIR)
*          USE(/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/DIRECTIVES/DE
*          FAULTDIR/DUMMY.DIR)
* Setting: NOACCEPTREFRESH
*          NOACU
*          NOACUCOMMENT
*          NOACUSYNC
*          NOACU-UNDERSCORE
*            ADV
*            ALIGN"8 OPT"
*            ALPHALITCONT"MARGIN"
*            ALPHASTART"1"
*            ALTER
*          NOAMODE
*            ANIM
*            ANS85
*            APOST
*            AREACHECK
*            ARITH"EXTEND"
*            ARITHMETIC"ENTCOBOL"
*            ASSIGN"EXTERNAL"
*          NOASSIGN-PRINTER
*          NOAUTOLOCK
*          NOBELL
*            BINLIT"BOOLEAN"
*          NOBOUND
*          NOBRIEF
*          NOBS2000
*            BWZSTAR
*            BYTEMODEMOVE
*            CALLFH"EXTFH"
*          NOCALLRECOVERY
*            CALLSORT"EXTSM"
*            CANCEL
*            CANCELLBR
*          NOCHANGEMESSAGE
*            CHARSET"EBCDIC"
*            CHECKDIV"ENTCOBOL"
*          NOCHECKREFMOD
*          NOCICS
*            CICS-CPY
*          NOCICSOPTIMIZE
*          NOCMPR2
*            COBFSTATCONV
*          NOCOBIDY
*          NOCOBOL370
*          NOCOBOLDIR
*          NOCOMMANDLINELINKAGE
*            COLLECTION"CardDemo"
*          NOCOMP
*            COMP"BINARY"
*            COMP1"FLOAT"
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   2
* CBTRN01C.cbl
*            COMP2"FLOAT"
*            COMP-5"2"
*            COMP-6"2"
*            CONFIRM
*          NOCONVERTRET
*            CONVSPACE
*            COPYEXT"cpy,cbl"
*            COPYLBR
*            COPYLIST
*            COPYLISTCOMMENT"7"
*            COPYSEARCH"MF"
*            CSI
*            CURRENCY-SIGN"36"
*            CURRENT-DATE"MMDDYY"
*          NODATA
*            DATACOMPRESS"0"
*          NODATA-CONTEXT
*          NODATAMAP
*            DATE
*            DBCHECK
*            DBCS"3"
*            DBCSSOSI"14""15"
*            DBSPACE
*            DE-EDIT"2"
*            DEFAULTBYTE"0"
*          NODEFAULTCALLS
*            DETECTLOCK
*          NODG
*            DIALECT"ENTCOBOL"
*          NODIRECTIVES-IN-COMMENTS
*            DISPLAY"CONSOLE"
*          NODISPLAYAT
*            DISPLAYPICU"ANSI"
*            DISPSIGN"COMPAT"
*          NODOSVS
*          NODOTNET
*            DPCINDATA"XML"
*            DPCINSUBSCRIPT
*          NODYNAM
*          NOEARLY-RELEASE
*            EBCCOLSEQ"1"
*            ECHO
*          NOECHOALL
*            ENTCOBOL
*          NOEOF1A
*            ERRFORMAT"2"
*            ERRLIST"VERBOSE"
*          NOERRQ
*          NOEXECSQLFLAG
*            EXITPROGRAM"ANSI"
*          NOFASTINIT
*            FASTSORT
*            FCD3
*          NOFCDALIGN
*          NOFCDREG
*            FDCLEAR"3"
*          NOFILESHARE
*            FILETYPE"0"
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   3
* CBTRN01C.cbl
*            FLAG"ENTCOBOL"
*            FLAGAS"S"
*          NOFLAGEUC
*          NOFLAGMIG
*          NOFLAGQ
*            FLAGSINEDIT
*          NOFLAGSTD
*            FOLDCALLNAME"UPPER"
*            FOLDCOPYNAME"UPPER"
*            FORM"60"
*            FP-ROUNDING"ENTCOBOL"
*          NOHOSTARITHMETIC
*            HOSTCONTZERO
*            HOST-NUMCOMPARE
*            HOST-NUMMOVE
*            HOSTFD
*          NOHOSTRW
*          NOIBM-MS
*            IBMCOMP
*            IDENTIFIERLEN"30"
*            IDXFORMAT"0"
*          NOIGNOREEXEC
*          NOIL
*          NOILGEN
*          NOILEMIT
*            IMPLICITSCOPE
*            INCFORMAT"PC"
*            INDD"SYSIN 80 R"
*          NOIDYSRCPATH
*            INFORETURN"0"
*          NOINITCALL
*            INITIAL"1"
*          NOINITPTR
*          NOINITBYTYPE
*            INT"CBTRN01C.int"
*            INTDATE"ANSI"
*            INTLEVEL"9"
*            IOCONV
*          NOISO2002
*          NOIXNLSKEY
*          NOIXNUMKEY
*          NOJAVACALLABLE
*          NOJAVAGENPROGS
*          NOJAVAGENSTRG
*            JAVAOUTPUTPATH""
*            JAVAPACKAGENAME"com.microfocus.COBOL"
*          NOJVMGEN
*            KEYCHECK
*            KEYCOMPRESS"0"
*          NOLIBRARIAN
*          NOLINE-COUNT
*            LIST"CBTRN01C.lst"
*            LISTPATH...
*          ..."/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/LISTINGS/CO"
*            LISTWIDTH"80"
*            LITVAL-SIZE"4"
*          NOLOCALSOURCEFORMAT
*            LOCKTYPE"0"
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   4
* CBTRN01C.cbl
*            MAPNAME
*          NOMAINFRAMEFLOATINGPOINT
*          NOMAXERROR
*            METHODDEFAULT"REFERENCE"
*          NOMF
*          NOMFCOMMENT
*          NOMFSYNC
*          NOMOVELENCHECK
*          NOMS
*          NOMVS
*            NATIONAL"1"
*            NATIVE"EBCDIC"
*          NONATIVEFLOATINGPOINT
*          NONCHAR
*          NONLS
*          NONLSCURRENCYLENGTH
*            NSYMBOL"NATIONAL"
*            NULLESCAPE
*          NOODOOSVS
*            ODOSLIDE
*          NOOLDBLANKLINE
*          NOOLDCOPY
*          NOOLDINDEX
*          NOOLDNEXTSENTENCE
*          NOOLDREADINTO
*          NOOLDSTRMIX
*            OOCTRL"-C-E-G+L-P+Q+R-S+W"
*          NOOPTIONAL-FILE
*          NOOS390
*            OSEXT""
*          NOOSVS
*            OUTDD"SYSOUT 121 R"
*            P64
*          NOPANVALET
*            PANVALET-INCLUDES-IN-COMMENTS
*            PERFORM-TYPE"ENTCOBOL"
*          NOPREPLIST
*          NOPREPROCESS
*            PRESERVECASE
*          NOPRINT-EXT
*          NOPROFILE
*          NOPROGID-COMMENT
*          NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE
*            PROTOTYPE"RELAXED"
*            QUAL
*            QUALPROC
*          NOQUERY
*          NOQUOTE
*          NORAWLIST
*            RDW
*            RECMODE"ENTCOBOL"
*          NOREENTRANT
*          NOREF
*          NOREFNO
*            REMAINDER"2"
*            REPLACE"NOKEEPSEQ"
*            REPORT-LINE"256"
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   5
* CBTRN01C.cbl
*            RESEQ
*          NORETRYLOCK
*            REWRITE-LS
*          NORM
*          NORM-FILE-ERRORS
*            RTNCODE-SIZE"2"
*            RTNCODE-TYPE"COMP"
*          NORWHARDPAGE
*          NOSAA
*          NOSEG
*          NOSEQCHK
*            SEQUENTIAL"RECORD"
*          NOSERIAL
*            SETTING"COL"
*          NOSHAREOUTDD
*          NOSHOW-DIR
*            SIGN"EBCDIC"
*            SIGN"TRAILING"
*          NOSIGNDISCARD
*          NOSIGNFIXUP
*            SORTTYPE"DFSORT"
*          NOSOURCEENCODING
*            SOURCEFORMAT"FIXED"
*            SOURCETABSTOP"4"
*          NOSPZERO
*          NOSSRANGE
*            STDERR
*            STICKY-LINKAGE"1"
*          NOSTICKY-PERFORM
*            SUPFF
*            SWITCHTYPE"1"
*            SYMBSTART"1"
*            SYSPUNCH"80"
*            TERMPAGE
*          NOTESTCOVER
*            TIME
*          NOTRACE
*          NOTRUNC
*            TRUNCCALLNAME"8"
*            TRUNCCOPY"8"
*            TRUNCINC"10"
*            UNICODE"PORTABLE"
*            VERBOSE
*          NOVISUALSTUDIO
*          NOVSC2
*          NOWARNASERROR
*            WARNING"1"
*            WEBSERVER"CGI"
*          NOWRITELOCK
*          NOWRITETHRU
*          NOXMLGEN
*            XMLPARSE"XMLSS"
*          NOXOPEN
*          NOXREF
*            ZEROLENGTHFALSE
*          NOZEROSEQ
*            ZWB
     1 IDENTIFICATION DIVISION.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   6
* CBTRN01C.cbl
     2 PROGRAM-ID.    CBTRN01C.
     3 AUTHOR.        AWS.
     4
     5 ENVIRONMENT DIVISION.
     6 INPUT-OUTPUT SECTION.
     7 FILE-CONTROL.
     8     SELECT DALYTRAN-FILE ASSIGN TO DALYTRAN
     9            ORGANIZATION IS SEQUENTIAL
    10            ACCESS MODE  IS SEQUENTIAL
    11            FILE STATUS  IS DALYTRAN-STATUS.
    12
    13     SELECT CUSTOMER-FILE ASSIGN TO   CUSTFILE
    14            ORGANIZATION IS INDEXED
    15            ACCESS MODE  IS RANDOM
    16            RECORD KEY   IS FD-CUST-ID
    17            FILE STATUS  IS CUSTFILE-STATUS.
    18
    19     SELECT XREF-FILE ASSIGN TO   XREFFILE
    20            ORGANIZATION IS INDEXED
    21            ACCESS MODE  IS RANDOM
    22            RECORD KEY   IS FD-XREF-CARD-NUM
    23            FILE STATUS  IS XREFFILE-STATUS.
    24
    25     SELECT CARD-FILE ASSIGN TO   CARDFILE
    26            ORGANIZATION IS INDEXED
    27            ACCESS MODE  IS RANDOM
    28            RECORD KEY   IS FD-CARD-NUM
    29            FILE STATUS  IS CARDFILE-STATUS.
    30
    31     SELECT ACCOUNT-FILE ASSIGN TO   ACCTFILE
    32            ORGANIZATION IS INDEXED
    33            ACCESS MODE  IS RANDOM
    34            RECORD KEY   IS FD-ACCT-ID
    35            FILE STATUS  IS ACCTFILE-STATUS.
    36
    37     SELECT TRANSACT-FILE ASSIGN TO   TRANFILE
    38            ORGANIZATION IS INDEXED
    39            ACCESS MODE  IS RANDOM
    40            RECORD KEY   IS FD-TRANS-ID
    41            FILE STATUS  IS TRANFILE-STATUS.
    42*
    43 DATA DIVISION.
    44 FILE SECTION.
    45 FD  DALYTRAN-FILE.
    46 01  FD-TRAN-RECORD.
    47     05 FD-TRAN-ID                        PIC X(16).
    48     05 FD-CUST-DATA                      PIC X(334).
    49
    50 FD  CUSTOMER-FILE.
    51 01  FD-CUSTFILE-REC.
    52     05 FD-CUST-ID                        PIC 9(09).
    53     05 FD-CUST-DATA                      PIC X(491).
    54
    55 FD  XREF-FILE.
    56 01  FD-XREFFILE-REC.
    57     05 FD-XREF-CARD-NUM                  PIC X(16).
    58     05 FD-XREF-DATA                      PIC X(34).
    59
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   7
* CBTRN01C.cbl
    60 FD  CARD-FILE.
    61 01  FD-CARDFILE-REC.
    62     05 FD-CARD-NUM                       PIC X(16).
    63     05 FD-CARD-DATA                      PIC X(134).
    64
    65 FD  ACCOUNT-FILE.
    66 01  FD-ACCTFILE-REC.
    67     05 FD-ACCT-ID                        PIC 9(11).
    68     05 FD-ACCT-DATA                      PIC X(289).
    69
    70 FD  TRANSACT-FILE.
    71 01  FD-TRANFILE-REC.
    72     05 FD-TRANS-ID                       PIC X(16).
    73     05 FD-ACCT-DATA                      PIC X(334).
    74
    75 WORKING-STORAGE SECTION.
    76
    77*****************************************************************
    78*COPY CVTRA06Y.
    79*****************************************************************
    80*    Data-structure for DALYTRANsaction record (RECLN = 350)
    81*****************************************************************
    82 01  DALYTRAN-RECORD.
    83     05  DALYTRAN-ID                             PIC X(16).
    84     05  DALYTRAN-TYPE-CD                        PIC X(02).
    85     05  DALYTRAN-CAT-CD                         PIC 9(04).
    86     05  DALYTRAN-SOURCE                         PIC X(10).
    87     05  DALYTRAN-DESC                           PIC X(100).
    88     05  DALYTRAN-AMT                            PIC S9(09)V99.
    89     05  DALYTRAN-MERCHANT-ID                    PIC 9(09).
    90     05  DALYTRAN-MERCHANT-NAME                  PIC X(50).
    91     05  DALYTRAN-MERCHANT-CITY                  PIC X(50).
    92     05  DALYTRAN-MERCHANT-ZIP                   PIC X(10).
    93     05  DALYTRAN-CARD-NUM                       PIC X(16).
    94     05  DALYTRAN-ORIG-TS                        PIC X(26).
    95     05  DALYTRAN-PROC-TS                        PIC X(26).
    96     05  FILLER                                  PIC X(20).
    97*
    98* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:01 CDT
    99*
   100 01  DALYTRAN-STATUS.
   101     05  DALYTRAN-STAT1      PIC X.
   102     05  DALYTRAN-STAT2      PIC X.
   103
   104*COPY CVCUS01Y.
   105*****************************************************************
   106*    Data-structure for Customer entity (RECLN 500)
   107*****************************************************************
   108 01  CUSTOMER-RECORD.
   109     05  CUST-ID                                 PIC 9(09).
   110     05  CUST-FIRST-NAME                         PIC X(25).
   111     05  CUST-MIDDLE-NAME                        PIC X(25).
   112     05  CUST-LAST-NAME                          PIC X(25).
   113     05  CUST-ADDR-LINE-1                        PIC X(50).
   114     05  CUST-ADDR-LINE-2                        PIC X(50).
   115     05  CUST-ADDR-LINE-3                        PIC X(50).
   116     05  CUST-ADDR-STATE-CD                      PIC X(02).
   117     05  CUST-ADDR-COUNTRY-CD                    PIC X(03).
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   8
* CBTRN01C.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CVCUS01Y.c)
   118     05  CUST-ADDR-ZIP                           PIC X(10).
   119     05  CUST-PHONE-NUM-1                        PIC X(15).
   120     05  CUST-PHONE-NUM-2                        PIC X(15).
   121     05  CUST-SSN                                PIC 9(09).
   122     05  CUST-GOVT-ISSUED-ID                     PIC X(20).
   123     05  CUST-DOB-YYYY-MM-DD                     PIC X(10).
   124     05  CUST-EFT-ACCOUNT-ID                     PIC X(10).
   125     05  CUST-PRI-CARD-HOLDER-IND                PIC X(01).
   126     05  CUST-FICO-CREDIT-SCORE                  PIC 9(03).
   127     05  FILLER                                  PIC X(168).
   128*
   129* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:00 CDT
   130*
   131 01  CUSTFILE-STATUS.
   132     05  CUSTFILE-STAT1      PIC X.
   133     05  CUSTFILE-STAT2      PIC X.
   134
   135*COPY CVACT03Y.
   136*****************************************************************
   137*    Data-structure for card xref (RECLN 50)
   138*****************************************************************
   139 01 CARD-XREF-RECORD.
   140     05  XREF-CARD-NUM                     PIC X(16).
   141     05  XREF-CUST-ID                      PIC 9(09).
   142     05  XREF-ACCT-ID                      PIC 9(11).
   143     05  FILLER                            PIC X(14).
   144*
   145* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:00 CDT
   146*
   147 01  XREFFILE-STATUS.
   148     05  XREFFILE-STAT1      PIC X.
   149     05  XREFFILE-STAT2      PIC X.
   150
   151*COPY CVACT02Y.
   152*****************************************************************
   153*    Data-structure for card entity (RECLN 150)
   154*****************************************************************
   155 01  CARD-RECORD.
   156     05  CARD-NUM                          PIC X(16).
   157     05  CARD-ACCT-ID                      PIC 9(11).
   158     05  CARD-CVV-CD                       PIC 9(03).
   159     05  CARD-EMBOSSED-NAME                PIC X(50).
   160     05  CARD-EXPIRAION-DATE               PIC X(10).
   161     05  CARD-ACTIVE-STATUS                PIC X(01).
   162     05  FILLER                            PIC X(59).
   163*
   164* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:00 CDT
   165*
   166 01  CARDFILE-STATUS.
   167     05  CARDFILE-STAT1      PIC X.
   168     05  CARDFILE-STAT2      PIC X.
   169
   170*COPY CVACT01Y.
   171*****************************************************************
   172*    Data-structure for  account entity (RECLN 300)
   173*****************************************************************
   174 01  ACCOUNT-RECORD.
   175     05  ACCT-ID                           PIC 9(11).
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   9
* CBTRN01C.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/CVACT01Y.c)
   176     05  ACCT-ACTIVE-STATUS                PIC X(01).
   177     05  ACCT-CURR-BAL                     PIC S9(10)V99.
   178     05  ACCT-CREDIT-LIMIT                 PIC S9(10)V99.
   179     05  ACCT-CASH-CREDIT-LIMIT            PIC S9(10)V99.
   180     05  ACCT-OPEN-DATE                    PIC X(10).
   181     05  ACCT-EXPIRAION-DATE               PIC X(10).
   182     05  ACCT-REISSUE-DATE                 PIC X(10).
   183     05  ACCT-CURR-CYC-CREDIT              PIC S9(10)V99.
   184     05  ACCT-CURR-CYC-DEBIT               PIC S9(10)V99.
   185     05  ACCT-ADDR-ZIP                     PIC X(10).
   186     05  ACCT-GROUP-ID                     PIC X(10).
   187     05  FILLER                            PIC X(178).
   188*
   189* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:59 CDT
   190*
   191 01  ACCTFILE-STATUS.
   192     05  ACCTFILE-STAT1      PIC X.
   193     05  ACCTFILE-STAT2      PIC X.
   194
   195*COPY CVTRA05Y.
   196*****************************************************************
   197*    Data-structure for TRANsaction record (RECLN = 350)
   198*****************************************************************
   199 01  TRAN-RECORD.
   200     05  TRAN-ID                                 PIC X(16).
   201     05  TRAN-TYPE-CD                            PIC X(02).
   202     05  TRAN-CAT-CD                             PIC 9(04).
   203     05  TRAN-SOURCE                             PIC X(10).
   204     05  TRAN-DESC                               PIC X(100).
   205     05  TRAN-AMT                                PIC S9(09)V99.
   206     05  TRAN-MERCHANT-ID                        PIC 9(09).
   207     05  TRAN-MERCHANT-NAME                      PIC X(50).
   208     05  TRAN-MERCHANT-CITY                      PIC X(50).
   209     05  TRAN-MERCHANT-ZIP                       PIC X(10).
   210     05  TRAN-CARD-NUM                           PIC X(16).
   211     05  TRAN-ORIG-TS                            PIC X(26).
   212     05  TRAN-PROC-TS                            PIC X(26).
   213     05  FILLER                                  PIC X(20).
   214*
   215* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:01 CDT
   216*
   217 01  TRANFILE-STATUS.
   218     05  TRANFILE-STAT1      PIC X.
   219     05  TRANFILE-STAT2      PIC X.
   220
   221 01  IO-STATUS.
   222     05  IO-STAT1            PIC X.
   223     05  IO-STAT2            PIC X.
   224
   225 01  TWO-BYTES-BINARY        PIC 9(4) BINARY.
   226 01  TWO-BYTES-ALPHA         REDEFINES TWO-BYTES-BINARY.
   227     05  TWO-BYTES-LEFT      PIC X.
   228     05  TWO-BYTES-RIGHT     PIC X.
   229
   230 01  IO-STATUS-04.
   231     05  IO-STATUS-0401      PIC 9   VALUE 0.
   232     05  IO-STATUS-0403      PIC 999 VALUE 0.
   233
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  10
* CBTRN01C.cbl
   234 01  APPL-RESULT             PIC S9(9)   COMP.
   235     88  APPL-AOK            VALUE 0.
   236     88  APPL-EOF            VALUE 16.
   237
   238 01  END-OF-DAILY-TRANS-FILE             PIC X(01)    VALUE 'N'.
   239 01  ABCODE                  PIC S9(9) BINARY.
   240 01  TIMING                  PIC S9(9) BINARY.
   241 01  WS-MISC-VARIABLES.
   242     05 WS-XREF-READ-STATUS  PIC 9(04).
   243     05 WS-ACCT-READ-STATUS  PIC 9(04).
   244
   245*****************************************************************
   246 PROCEDURE DIVISION.
   247 MAIN-PARA.
   248     DISPLAY 'START OF EXECUTION OF PROGRAM CBTRN01C'.
   249     PERFORM 0000-DALYTRAN-OPEN.
   250     PERFORM 0100-CUSTFILE-OPEN.
   251     PERFORM 0200-XREFFILE-OPEN.
   252     PERFORM 0300-CARDFILE-OPEN.
   253     PERFORM 0400-ACCTFILE-OPEN.
   254     PERFORM 0500-TRANFILE-OPEN.
   255
   256     PERFORM UNTIL END-OF-DAILY-TRANS-FILE = 'Y'
   257         IF  END-OF-DAILY-TRANS-FILE = 'N'
   258             PERFORM 1000-DALYTRAN-GET-NEXT
   259             IF  END-OF-DAILY-TRANS-FILE = 'N'
   260                 DISPLAY DALYTRAN-RECORD
   261             END-IF
   262             MOVE 0                 TO WS-XREF-READ-STATUS
   263             MOVE DALYTRAN-CARD-NUM TO XREF-CARD-NUM
   264             PERFORM 2000-LOOKUP-XREF
   265             IF WS-XREF-READ-STATUS = 0
   266               MOVE 0            TO WS-ACCT-READ-STATUS
   267               MOVE XREF-ACCT-ID TO ACCT-ID
   268               PERFORM 3000-READ-ACCOUNT
   269               IF WS-ACCT-READ-STATUS NOT = 0
   270                   DISPLAY 'ACCOUNT ' ACCT-ID ' NOT FOUND'
   271               END-IF
   272             ELSE
   273               DISPLAY 'CARD NUMBER ' DALYTRAN-CARD-NUM
   274               ' COULD NOT BE VERIFIED. SKIPPING TRANSACTION ID-'
   275               DALYTRAN-ID
   276             END-IF
   277         END-IF
   278     END-PERFORM.
   279
   280     PERFORM 9000-DALYTRAN-CLOSE.
   281     PERFORM 9100-CUSTFILE-CLOSE.
   282     PERFORM 9200-XREFFILE-CLOSE.
   283     PERFORM 9300-CARDFILE-CLOSE.
   284     PERFORM 9400-ACCTFILE-CLOSE.
   285     PERFORM 9500-TRANFILE-CLOSE.
   286
   287     DISPLAY 'END OF EXECUTION OF PROGRAM CBTRN01C'.
   288
   289     GOBACK.
   290
   291*****************************************************************
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  11
* CBTRN01C.cbl
   292* READS FILE                                                    *
   293*****************************************************************
   294 1000-DALYTRAN-GET-NEXT.
   295     READ DALYTRAN-FILE INTO DALYTRAN-RECORD.
   296     IF  DALYTRAN-STATUS = '00'
   297         MOVE 0 TO APPL-RESULT
   298     ELSE
   299         IF  DALYTRAN-STATUS = '10'
   300             MOVE 16 TO APPL-RESULT
   301         ELSE
   302             MOVE 12 TO APPL-RESULT
   303         END-IF
   304     END-IF
   305     IF  APPL-AOK
   306         CONTINUE
   307     ELSE
   308         IF  APPL-EOF
   309             MOVE 'Y' TO END-OF-DAILY-TRANS-FILE
   310         ELSE
   311             DISPLAY 'ERROR READING DAILY TRANSACTION FILE'
   312             MOVE DALYTRAN-STATUS TO IO-STATUS
   313             PERFORM Z-DISPLAY-IO-STATUS
   314             PERFORM Z-ABEND-PROGRAM
   315         END-IF
   316     END-IF
   317     EXIT.
   318*---------------------------------------------------------------*
   319 2000-LOOKUP-XREF.
   320     MOVE XREF-CARD-NUM TO FD-XREF-CARD-NUM
   321     READ XREF-FILE  RECORD INTO CARD-XREF-RECORD
   322     KEY IS FD-XREF-CARD-NUM
   323          INVALID KEY
   324            DISPLAY 'INVALID CARD NUMBER FOR XREF'
   325            MOVE 4 TO WS-XREF-READ-STATUS
   326          NOT INVALID KEY
   327            DISPLAY 'SUCCESSFUL READ OF XREF'
   328            DISPLAY 'CARD NUMBER: ' XREF-CARD-NUM
   329            DISPLAY 'ACCOUNT ID : ' XREF-ACCT-ID
   330            DISPLAY 'CUSTOMER ID: ' XREF-CUST-ID
   331     END-READ.
   332*---------------------------------------------------------------*
   333 3000-READ-ACCOUNT.
   334     MOVE ACCT-ID TO FD-ACCT-ID
   335     READ ACCOUNT-FILE RECORD INTO ACCOUNT-RECORD
   336     KEY IS FD-ACCT-ID
   337          INVALID KEY
   338            DISPLAY 'INVALID ACCOUNT NUMBER FOUND'
   339            MOVE 4 TO WS-ACCT-READ-STATUS
   340          NOT INVALID KEY
   341            DISPLAY 'SUCCESSFUL READ OF ACCOUNT FILE'
   342     END-READ.
   343*---------------------------------------------------------------*
   344 0000-DALYTRAN-OPEN.
   345     MOVE 8 TO APPL-RESULT.
   346     OPEN INPUT DALYTRAN-FILE
   347     IF  DALYTRAN-STATUS = '00'
   348         MOVE 0 TO APPL-RESULT
   349     ELSE
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  12
* CBTRN01C.cbl
   350         MOVE 12 TO APPL-RESULT
   351     END-IF
   352     IF  APPL-AOK
   353         CONTINUE
   354     ELSE
   355         DISPLAY 'ERROR OPENING DAILY TRANSACTION FILE'
   356         MOVE DALYTRAN-STATUS TO IO-STATUS
   357         PERFORM Z-DISPLAY-IO-STATUS
   358         PERFORM Z-ABEND-PROGRAM
   359     END-IF
   360     EXIT.
   361
   362*---------------------------------------------------------------*
   363 0100-CUSTFILE-OPEN.
   364     MOVE 8 TO APPL-RESULT.
   365     OPEN INPUT CUSTOMER-FILE
   366     IF  CUSTFILE-STATUS = '00'
   367         MOVE 0 TO APPL-RESULT
   368     ELSE
   369         MOVE 12 TO APPL-RESULT
   370     END-IF
   371     IF  APPL-AOK
   372         CONTINUE
   373     ELSE
   374         DISPLAY 'ERROR OPENING CUSTOMER FILE'
   375         MOVE CUSTFILE-STATUS TO IO-STATUS
   376         PERFORM Z-DISPLAY-IO-STATUS
   377         PERFORM Z-ABEND-PROGRAM
   378     END-IF
   379     EXIT.
   380*---------------------------------------------------------------*
   381 0200-XREFFILE-OPEN.
   382     MOVE 8 TO APPL-RESULT.
   383     OPEN INPUT XREF-FILE
   384     IF  XREFFILE-STATUS = '00'
   385         MOVE 0 TO APPL-RESULT
   386     ELSE
   387         MOVE 12 TO APPL-RESULT
   388     END-IF
   389     IF  APPL-AOK
   390         CONTINUE
   391     ELSE
   392         DISPLAY 'ERROR OPENING CROSS REF FILE'
   393         MOVE XREFFILE-STATUS TO IO-STATUS
   394         PERFORM Z-DISPLAY-IO-STATUS
   395         PERFORM Z-ABEND-PROGRAM
   396     END-IF
   397     EXIT.
   398*---------------------------------------------------------------*
   399 0300-CARDFILE-OPEN.
   400     MOVE 8 TO APPL-RESULT.
   401     OPEN INPUT CARD-FILE
   402     IF  CARDFILE-STATUS = '00'
   403         MOVE 0 TO APPL-RESULT
   404     ELSE
   405         MOVE 12 TO APPL-RESULT
   406     END-IF
   407     IF  APPL-AOK
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  13
* CBTRN01C.cbl
   408         CONTINUE
   409     ELSE
   410         DISPLAY 'ERROR OPENING CARD FILE'
   411         MOVE CARDFILE-STATUS TO IO-STATUS
   412         PERFORM Z-DISPLAY-IO-STATUS
   413         PERFORM Z-ABEND-PROGRAM
   414     END-IF
   415     EXIT.
   416*---------------------------------------------------------------*
   417 0400-ACCTFILE-OPEN.
   418     MOVE 8 TO APPL-RESULT.
   419     OPEN INPUT ACCOUNT-FILE
   420     IF  ACCTFILE-STATUS = '00'
   421         MOVE 0 TO APPL-RESULT
   422     ELSE
   423         MOVE 12 TO APPL-RESULT
   424     END-IF
   425     IF  APPL-AOK
   426         CONTINUE
   427     ELSE
   428         DISPLAY 'ERROR OPENING ACCOUNT FILE'
   429         MOVE ACCTFILE-STATUS TO IO-STATUS
   430         PERFORM Z-DISPLAY-IO-STATUS
   431         PERFORM Z-ABEND-PROGRAM
   432     END-IF
   433     EXIT.
   434*---------------------------------------------------------------*
   435 0500-TRANFILE-OPEN.
   436     MOVE 8 TO APPL-RESULT.
   437     OPEN INPUT TRANSACT-FILE
   438     IF  TRANFILE-STATUS = '00'
   439         MOVE 0 TO APPL-RESULT
   440     ELSE
   441         MOVE 12 TO APPL-RESULT
   442     END-IF
   443     IF  APPL-AOK
   444         CONTINUE
   445     ELSE
   446         DISPLAY 'ERROR OPENING TRANSACTION FILE'
   447         MOVE TRANFILE-STATUS TO IO-STATUS
   448         PERFORM Z-DISPLAY-IO-STATUS
   449         PERFORM Z-ABEND-PROGRAM
   450     END-IF
   451     EXIT.
   452*---------------------------------------------------------------*
   453 9000-DALYTRAN-CLOSE.
   454     ADD 8 TO ZERO GIVING APPL-RESULT.
   455     CLOSE DALYTRAN-FILE
   456     IF  DALYTRAN-STATUS = '00'
   457         MOVE 0 TO APPL-RESULT
   458     ELSE
   459         MOVE 12 TO APPL-RESULT
   460     END-IF
   461     IF  APPL-AOK
   462         CONTINUE
   463     ELSE
   464         DISPLAY 'ERROR CLOSING CUSTOMER FILE'
   465         MOVE CUSTFILE-STATUS TO IO-STATUS
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  14
* CBTRN01C.cbl
   466         PERFORM Z-DISPLAY-IO-STATUS
   467         PERFORM Z-ABEND-PROGRAM
   468     END-IF
   469     EXIT.
   470*---------------------------------------------------------------*
   471 9100-CUSTFILE-CLOSE.
   472     ADD 8 TO ZERO GIVING APPL-RESULT.
   473     CLOSE CUSTOMER-FILE
   474     IF  CUSTFILE-STATUS = '00'
   475         MOVE 0 TO APPL-RESULT
   476     ELSE
   477         MOVE 12 TO APPL-RESULT
   478     END-IF
   479     IF  APPL-AOK
   480         CONTINUE
   481     ELSE
   482         DISPLAY 'ERROR CLOSING CUSTOMER FILE'
   483         MOVE CUSTFILE-STATUS TO IO-STATUS
   484         PERFORM Z-DISPLAY-IO-STATUS
   485         PERFORM Z-ABEND-PROGRAM
   486     END-IF
   487     EXIT.
   488*---------------------------------------------------------------*
   489 9200-XREFFILE-CLOSE.
   490     ADD 8 TO ZERO GIVING APPL-RESULT.
   491     CLOSE XREF-FILE
   492     IF  XREFFILE-STATUS = '00'
   493         MOVE 0 TO APPL-RESULT
   494     ELSE
   495         MOVE 12 TO APPL-RESULT
   496     END-IF
   497     IF  APPL-AOK
   498         CONTINUE
   499     ELSE
   500         DISPLAY 'ERROR CLOSING CROSS REF FILE'
   501         MOVE XREFFILE-STATUS TO IO-STATUS
   502         PERFORM Z-DISPLAY-IO-STATUS
   503         PERFORM Z-ABEND-PROGRAM
   504     END-IF
   505     EXIT.
   506*---------------------------------------------------------------*
   507 9300-CARDFILE-CLOSE.
   508     ADD 8 TO ZERO GIVING APPL-RESULT.
   509     CLOSE CARD-FILE
   510     IF  CARDFILE-STATUS = '00'
   511         MOVE 0 TO APPL-RESULT
   512     ELSE
   513         MOVE 12 TO APPL-RESULT
   514     END-IF
   515     IF  APPL-AOK
   516         CONTINUE
   517     ELSE
   518         DISPLAY 'ERROR CLOSING CARD FILE'
   519         MOVE CARDFILE-STATUS TO IO-STATUS
   520         PERFORM Z-DISPLAY-IO-STATUS
   521         PERFORM Z-ABEND-PROGRAM
   522     END-IF
   523     EXIT.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  15
* CBTRN01C.cbl
   524*---------------------------------------------------------------*
   525 9400-ACCTFILE-CLOSE.
   526     ADD 8 TO ZERO GIVING APPL-RESULT.
   527     CLOSE ACCOUNT-FILE
   528     IF  ACCTFILE-STATUS = '00'
   529         MOVE 0 TO APPL-RESULT
   530     ELSE
   531         MOVE 12 TO APPL-RESULT
   532     END-IF
   533     IF  APPL-AOK
   534         CONTINUE
   535     ELSE
   536         DISPLAY 'ERROR CLOSING ACCOUNT FILE'
   537         MOVE ACCTFILE-STATUS TO IO-STATUS
   538         PERFORM Z-DISPLAY-IO-STATUS
   539         PERFORM Z-ABEND-PROGRAM
   540     END-IF
   541     EXIT.
   542*---------------------------------------------------------------*
   543 9500-TRANFILE-CLOSE.
   544     ADD 8 TO ZERO GIVING APPL-RESULT.
   545     CLOSE TRANSACT-FILE
   546     IF  TRANFILE-STATUS = '00'
   547         MOVE 0 TO APPL-RESULT
   548     ELSE
   549         MOVE 12 TO APPL-RESULT
   550     END-IF
   551     IF  APPL-AOK
   552         CONTINUE
   553     ELSE
   554         DISPLAY 'ERROR CLOSING TRANSACTION FILE'
   555         MOVE TRANFILE-STATUS TO IO-STATUS
   556         PERFORM Z-DISPLAY-IO-STATUS
   557         PERFORM Z-ABEND-PROGRAM
   558     END-IF
   559     EXIT.
   560
   561 Z-ABEND-PROGRAM.
   562     DISPLAY 'ABENDING PROGRAM'
   563     MOVE 0 TO TIMING
   564     MOVE 999 TO ABCODE
   565     CALL 'CEE3ABD'.
   566
   567*****************************************************************
   568 Z-DISPLAY-IO-STATUS.
   569     IF  IO-STATUS NOT NUMERIC
   570     OR  IO-STAT1 = '9'
   571         MOVE IO-STAT1 TO IO-STATUS-04(1:1)
   572         MOVE 0        TO TWO-BYTES-BINARY
   573         MOVE IO-STAT2 TO TWO-BYTES-RIGHT
   574         MOVE TWO-BYTES-BINARY TO IO-STATUS-0403
   575         DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04
   576     ELSE
   577         MOVE '0000' TO IO-STATUS-04
   578         MOVE IO-STATUS TO IO-STATUS-04(3:2)
   579         DISPLAY 'FILE STATUS IS: NNNN' IO-STATUS-04
   580     END-IF
   581     EXIT.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  16
* CBTRN01C.cbl
   582
*
*
* Errors
* -Line- Col Code/severity Description
* Micro Focus COBOL                  V9.0 revision 000 Compiler
* (C) Copyright 1984-2024 Micro Focus or one of its affiliates.
*                                                        REF GKR-081900000A0
* Total Messages:     0
* Data:        8176     Code:       11608
