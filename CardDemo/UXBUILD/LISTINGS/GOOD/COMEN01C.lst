* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   1
* COMEN01C.cbl
* Options: int("COMEN01C.int") verbose
*          USE(/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/DIRECTIVES/DI
*          RFOLDER/COMEN01C.cbl.dir)
*          USE(/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/DIRECTIVES/DE
*          FAULTDIR/DUMMY.DIR)
*          USE(/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/DIRECTIVES/DE
*          FAULTDIR/DUMMY.DIR)
*          USE(/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/DIRECTIVES/DE
*          FAULTDIR/DUMMY.DIR)
* Setting: NOACCEPTREFRESH
*          NOACU
*          NOACUCOMMENT
*          NOACUSYNC
*          NOACU-UNDERSCORE
*            ADV
*            ALIGN"8 OPT"
*            ALPHALITCONT"MARGIN"
*            ALPHASTART"1"
*            ALTER
*          NOAMODE
*            ANIM
*            ANS85
*            APOST
*            AREACHECK
*            ARITH"EXTEND"
*            ARITHMETIC"ENTCOBOL"
*            ASSIGN"EXTERNAL"
*          NOASSIGN-PRINTER
*          NOAUTOLOCK
*          NOBELL
*            BINLIT"BOOLEAN"
*          NOBOUND
*          NOBRIEF
*          NOBS2000
*            BWZSTAR
*            BYTEMODEMOVE
*            CALLFH"EXTFH"
*          NOCALLRECOVERY
*            CALLSORT"EXTSM"
*            CANCEL
*            CANCELLBR
*            CHANGEMESSAGE"2000 N"
*            CHARSET"EBCDIC"
*            CHECKDIV"ENTCOBOL"
*          NOCHECKREFMOD
*          NOCICS
*          NOCICS-CPY
*          NOCICSOPTIMIZE
*          NOCMPR2
*            COBFSTATCONV
*          NOCOBIDY
*          NOCOBOL370
*          NOCOBOLDIR
*          NOCOMMANDLINELINKAGE
*            COLLECTION"CardDemo"
*          NOCOMP
*            COMP"BINARY"
*            COMP1"FLOAT"
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   2
* COMEN01C.cbl
*            COMP2"FLOAT"
*            COMP-5"2"
*            COMP-6"2"
*            CONFIRM
*          NOCONVERTRET
*            CONVSPACE
*            COPYEXT"cpy,cbl"
*            COPYLBR
*            COPYLIST
*            COPYLISTCOMMENT"7"
*            COPYSEARCH"MF"
*            CSI
*            CURRENCY-SIGN"36"
*            CURRENT-DATE"MMDDYY"
*          NODATA
*            DATACOMPRESS"0"
*          NODATA-CONTEXT
*          NODATAMAP
*            DATE
*            DBCHECK
*            DBCS"3"
*            DBCSSOSI"14""15"
*            DBSPACE
*            DE-EDIT"2"
*            DEFAULTBYTE"0"
*          NODEFAULTCALLS
*            DETECTLOCK
*          NODG
*            DIALECT"ENTCOBOL"
*          NODIRECTIVES-IN-COMMENTS
*            DISPLAY"CONSOLE"
*          NODISPLAYAT
*            DISPLAYPICU"ANSI"
*            DISPSIGN"COMPAT"
*          NODOSVS
*          NODOTNET
*            DPCINDATA"XML"
*            DPCINSUBSCRIPT
*          NODYNAM
*          NOEARLY-RELEASE
*            EBCCOLSEQ"1"
*            ECHO
*          NOECHOALL
*            ENTCOBOL
*          NOEOF1A
*            ERRFORMAT"2"
*            ERRLIST"VERBOSE"
*          NOERRQ
*          NOEXECSQLFLAG
*            EXITPROGRAM"ANSI"
*          NOFASTINIT
*            FASTSORT
*            FCD3
*          NOFCDALIGN
*          NOFCDREG
*            FDCLEAR"3"
*          NOFILESHARE
*            FILETYPE"0"
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   3
* COMEN01C.cbl
*            FLAG"ENTCOBOL"
*            FLAGAS"S"
*          NOFLAGEUC
*          NOFLAGMIG
*          NOFLAGQ
*            FLAGSINEDIT
*          NOFLAGSTD
*            FOLDCALLNAME"UPPER"
*            FOLDCOPYNAME"UPPER"
*            FORM"60"
*            FP-ROUNDING"ENTCOBOL"
*          NOHOSTARITHMETIC
*            HOSTCONTZERO
*            HOST-NUMCOMPARE
*            HOST-NUMMOVE
*            HOSTFD
*          NOHOSTRW
*          NOIBM-MS
*            IBMCOMP
*            IDENTIFIERLEN"30"
*            IDXFORMAT"0"
*          NOIGNOREEXEC
*          NOIL
*          NOILGEN
*          NOILEMIT
*            IMPLICITSCOPE
*            INCFORMAT"PC"
*            INDD"SYSIN 80 R"
*          NOIDYSRCPATH
*            INFORETURN"0"
*          NOINITCALL
*            INITIAL"1"
*          NOINITPTR
*          NOINITBYTYPE
*            INT"COMEN01C.int"
*            INTDATE"ANSI"
*            INTLEVEL"9"
*            IOCONV
*          NOISO2002
*          NOIXNLSKEY
*          NOIXNUMKEY
*          NOJAVACALLABLE
*          NOJAVAGENPROGS
*          NOJAVAGENSTRG
*            JAVAOUTPUTPATH""
*            JAVAPACKAGENAME"com.microfocus.COBOL"
*          NOJVMGEN
*            KEYCHECK
*            KEYCOMPRESS"0"
*          NOLIBRARIAN
*          NOLINE-COUNT
*            LIST"COMEN01C.lst"
*            LISTPATH...
*          ..."/home/ec2-user/CrossPlatformBuild/CardDemo/UXBUILD/LISTINGS/CO"
*            LISTWIDTH"80"
*            LITVAL-SIZE"4"
*          NOLOCALSOURCEFORMAT
*            LOCKTYPE"0"
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   4
* COMEN01C.cbl
*            MAPNAME
*          NOMAINFRAMEFLOATINGPOINT
*          NOMAXERROR
*            METHODDEFAULT"REFERENCE"
*          NOMF
*          NOMFCOMMENT
*          NOMFSYNC
*          NOMOVELENCHECK
*          NOMS
*          NOMVS
*            NATIONAL"1"
*            NATIVE"EBCDIC"
*          NONATIVEFLOATINGPOINT
*          NONCHAR
*          NONLS
*          NONLSCURRENCYLENGTH
*            NSYMBOL"NATIONAL"
*            NULLESCAPE
*          NOODOOSVS
*            ODOSLIDE
*          NOOLDBLANKLINE
*          NOOLDCOPY
*          NOOLDINDEX
*          NOOLDNEXTSENTENCE
*          NOOLDREADINTO
*          NOOLDSTRMIX
*            OOCTRL"-C-E-G+L-P+Q+R-S+W"
*          NOOPTIONAL-FILE
*          NOOS390
*            OSEXT""
*          NOOSVS
*            OUTDD"SYSOUT 121 R"
*            P64
*          NOPANVALET
*            PANVALET-INCLUDES-IN-COMMENTS
*            PERFORM-TYPE"ENTCOBOL"
*          NOPREPLIST
*          NOPREPROCESS
*            PRESERVECASE
*          NOPRINT-EXT
*          NOPROFILE
*          NOPROGID-COMMENT
*          NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE
*            PROTOTYPE"RELAXED"
*            QUAL
*            QUALPROC
*          NOQUERY
*          NOQUOTE
*          NORAWLIST
*            RDW
*            RECMODE"ENTCOBOL"
*          NOREENTRANT
*          NOREF
*          NOREFNO
*            REMAINDER"2"
*            REPLACE"NOKEEPSEQ"
*            REPORT-LINE"256"
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   5
* COMEN01C.cbl
*            RESEQ
*          NORETRYLOCK
*            REWRITE-LS
*          NORM
*          NORM-FILE-ERRORS
*            RTNCODE-SIZE"2"
*            RTNCODE-TYPE"COMP"
*          NORWHARDPAGE
*          NOSAA
*          NOSEG
*          NOSEQCHK
*            SEQUENTIAL"RECORD"
*          NOSERIAL
*            SETTING"COL"
*          NOSHAREOUTDD
*          NOSHOW-DIR
*            SIGN"EBCDIC"
*            SIGN"TRAILING"
*          NOSIGNDISCARD
*          NOSIGNFIXUP
*            SORTTYPE"DFSORT"
*          NOSOURCEENCODING
*            SOURCEFORMAT"FIXED"
*            SOURCETABSTOP"4"
*          NOSPZERO
*          NOSSRANGE
*            STDERR
*            STICKY-LINKAGE"1"
*          NOSTICKY-PERFORM
*            SUPFF
*            SWITCHTYPE"1"
*            SYMBSTART"1"
*            SYSPUNCH"80"
*            TERMPAGE
*          NOTESTCOVER
*            TIME
*          NOTRACE
*          NOTRUNC
*            TRUNCCALLNAME"8"
*            TRUNCCOPY"8"
*            TRUNCINC"10"
*            UNICODE"PORTABLE"
*            VERBOSE
*          NOVISUALSTUDIO
*          NOVSC2
*          NOWARNASERROR
*            WARNING"1"
*            WEBSERVER"CGI"
*          NOWRITELOCK
*          NOWRITETHRU
*          NOXMLGEN
*            XMLPARSE"XMLSS"
*          NOXOPEN
*          NOXREF
*            ZEROLENGTHFALSE
*          NOZEROSEQ
*            ZWB
     1******************************************************************
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   6
* COMEN01C.cbl
     2* Program     : COMEN01C.CBL
     3* Application : CardDemo
     4* Type        : CICS COBOL Program
     5* Function    : Main Menu for the Regular users
     6******************************************************************
     7 IDENTIFICATION DIVISION.
     8 PROGRAM-ID. COMEN01C.
     9 AUTHOR.     AWS.
    10
    11 ENVIRONMENT DIVISION.
    12 CONFIGURATION SECTION.
    13
    14 DATA DIVISION.
    15*----------------------------------------------------------------*
    16*                     WORKING STORAGE SECTION
    17*----------------------------------------------------------------*
    18 WORKING-STORAGE SECTION.
    19
    20 01 WS-VARIABLES.
    21   05 WS-PGMNAME                 PIC X(08) VALUE 'COMEN01C'.
    22   05 WS-TRANID                  PIC X(04) VALUE 'CM00'.
    23   05 WS-MESSAGE                 PIC X(80) VALUE SPACES.
    24   05 WS-USRSEC-FILE             PIC X(08) VALUE 'USRSEC  '.
    25   05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.
    26     88 ERR-FLG-ON                         VALUE 'Y'.
    27     88 ERR-FLG-OFF                        VALUE 'N'.
    28   05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.
    29   05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.
    30   05 WS-OPTION-X                PIC X(02) JUST RIGHT.
    31   05 WS-OPTION                  PIC 9(02) VALUE 0.
    32   05 WS-IDX                     PIC S9(04) COMP VALUE ZEROS.
    33   05 WS-MENU-OPT-TXT            PIC X(40) VALUE SPACES.
    34
    35*COPY COCOM01Y.
    36******************************************************************
    37* Communication area for CardDemo application programs
    38******************************************************************
    39 01 CARDDEMO-COMMAREA.
    40    05 CDEMO-GENERAL-INFO.
    41       10 CDEMO-FROM-TRANID             PIC X(04).
    42       10 CDEMO-FROM-PROGRAM            PIC X(08).
    43       10 CDEMO-TO-TRANID               PIC X(04).
    44       10 CDEMO-TO-PROGRAM              PIC X(08).
    45       10 CDEMO-USER-ID                 PIC X(08).
    46       10 CDEMO-USER-TYPE               PIC X(01).
    47          88 CDEMO-USRTYP-ADMIN         VALUE 'A'.
    48          88 CDEMO-USRTYP-USER          VALUE 'U'.
    49       10 CDEMO-PGM-CONTEXT             PIC 9(01).
    50          88 CDEMO-PGM-ENTER            VALUE 0.
    51          88 CDEMO-PGM-REENTER          VALUE 1.
    52    05 CDEMO-CUSTOMER-INFO.
    53       10 CDEMO-CUST-ID                 PIC 9(09).
    54       10 CDEMO-CUST-FNAME              PIC X(25).
    55       10 CDEMO-CUST-MNAME              PIC X(25).
    56       10 CDEMO-CUST-LNAME              PIC X(25).
    57    05 CDEMO-ACCOUNT-INFO.
    58       10 CDEMO-ACCT-ID                 PIC 9(11).
    59       10 CDEMO-ACCT-STATUS             PIC X(01).
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   7
* COMEN01C.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/COCOM01Y.c)
    60    05 CDEMO-CARD-INFO.
    61       10 CDEMO-CARD-NUM                PIC 9(16).
    62    05 CDEMO-MORE-INFO.
    63       10  CDEMO-LAST-MAP               PIC X(7).
    64       10  CDEMO-LAST-MAPSET            PIC X(7).
    65*
    66* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:57 CDT
    67*
    68*COPY COMEN02Y.
    69******************************************************************
    70* CardDemo - Admin Menu Options
    71******************************************************************
    72 01 CARDDEMO-MAIN-MENU-OPTIONS.
    73
    74   05 CDEMO-MENU-OPT-COUNT           PIC 9(02) VALUE 10.
    75
    76   05 CDEMO-MENU-OPTIONS-DATA.
    77
    78     10 FILLER                       PIC 9(02) VALUE 1.
    79     10 FILLER                       PIC X(35) VALUE
    80         'Account View                       '.
    81     10 FILLER                       PIC X(08) VALUE 'COACTVWC'.
    82     10 FILLER                       PIC X(01) VALUE 'U'.
    83
    84     10 FILLER                       PIC 9(02) VALUE 2.
    85     10 FILLER                       PIC X(35) VALUE
    86         'Account Update                     '.
    87     10 FILLER                       PIC X(08) VALUE 'COACTUPC'.
    88     10 FILLER                       PIC X(01) VALUE 'U'.
    89
    90     10 FILLER                       PIC 9(02) VALUE 3.
    91     10 FILLER                       PIC X(35) VALUE
    92         'Credit Card List                   '.
    93     10 FILLER                       PIC X(08) VALUE 'COCRDLIC'.
    94     10 FILLER                       PIC X(01) VALUE 'U'.
    95
    96     10 FILLER                       PIC 9(02) VALUE 4.
    97     10 FILLER                       PIC X(35) VALUE
    98         'Credit Card View                   '.
    99     10 FILLER                       PIC X(08) VALUE 'COCRDSLC'.
   100     10 FILLER                       PIC X(01) VALUE 'U'.
   101
   102     10 FILLER                       PIC 9(02) VALUE 5.
   103     10 FILLER                       PIC X(35) VALUE
   104         'Credit Card Update                 '.
   105     10 FILLER                       PIC X(08) VALUE 'COCRDUPC'.
   106     10 FILLER                       PIC X(01) VALUE 'U'.
   107
   108     10 FILLER                       PIC 9(02) VALUE 6.
   109     10 FILLER                       PIC X(35) VALUE
   110         'Transaction List                   '.
   111     10 FILLER                       PIC X(08) VALUE 'COTRN00C'.
   112     10 FILLER                       PIC X(01) VALUE 'U'.
   113
   114     10 FILLER                       PIC 9(02) VALUE 7.
   115     10 FILLER                       PIC X(35) VALUE
   116         'Transaction View                   '.
   117     10 FILLER                       PIC X(08) VALUE 'COTRN01C'.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   8
* COMEN01C.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/COMEN02Y.c)
   118     10 FILLER                       PIC X(01) VALUE 'U'.
   119
   120     10 FILLER                        PIC 9(02) VALUE 8.
   121     10 FILLER                       PIC X(35) VALUE
   122*        'Transaction Add (Admin Only)       '.
   123         'Transaction Add                    '.
   124     10 FILLER                       PIC X(08) VALUE 'COTRN02C'.
   125     10 FILLER                       PIC X(01) VALUE 'U'.
   126
   127     10 FILLER                       PIC 9(02) VALUE 9.
   128     10 FILLER                       PIC X(35) VALUE
   129         'Transaction Reports                '.
   130     10 FILLER                       PIC X(08) VALUE 'CORPT00C'.
   131     10 FILLER                       PIC X(01) VALUE 'U'.
   132
   133     10 FILLER                       PIC 9(02) VALUE 10.
   134     10 FILLER                       PIC X(35) VALUE
   135         'Bill Payment                       '.
   136     10 FILLER                       PIC X(08) VALUE 'COBIL00C'.
   137     10 FILLER                       PIC X(01) VALUE 'U'.
   138     10 FILLER                       PIC X(92).
   139
   140
   141   05 CDEMO-MENU-OPTIONS REDEFINES CDEMO-MENU-OPTIONS-DATA.
   142     10 CDEMO-MENU-OPT OCCURS 12 TIMES.
   143       15 CDEMO-MENU-OPT-NUM           PIC 9(02).
   144       15 CDEMO-MENU-OPT-NAME          PIC X(35).
   145       15 CDEMO-MENU-OPT-PGMNAME       PIC X(08).
   146       15 CDEMO-MENU-OPT-USRTYPE       PIC X(01).
   147*
   148* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT
   149*
   150
   151*COPY COMEN01.
   152*   Micro Focus COBOL 2017  7.0.00247
   153*   Micro Focus BMS Screen Painter
   154*   MapSet Name   COMEN01
   155*   Date Created  08/05/2022
   156*   Time Created  16:44:45
   157
   158*  Input Data For Map COMEN1A
   159   01 COMEN1AI.
   160      03 FILLER                         PIC X(12).
   161      03 TRNNAMEL                       PIC S9(4) COMP.
   162      03 TRNNAMEF                       PIC X.
   163      03 FILLER REDEFINES TRNNAMEF.
   164         05 TRNNAMEA                       PIC X.
   165      03 FILLER                         PIC X(4).
   166      03 TRNNAMEI                       PIC X(4).
   167      03 TITLE01L                       PIC S9(4) COMP.
   168      03 TITLE01F                       PIC X.
   169      03 FILLER REDEFINES TITLE01F.
   170         05 TITLE01A                       PIC X.
   171      03 FILLER                         PIC X(4).
   172      03 TITLE01I                       PIC X(40).
   173      03 CURDATEL                       PIC S9(4) COMP.
   174      03 CURDATEF                       PIC X.
   175      03 FILLER REDEFINES CURDATEF.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page   9
* COMEN01C.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COMEN01.cpy)
   176         05 CURDATEA                       PIC X.
   177      03 FILLER                         PIC X(4).
   178      03 CURDATEI                       PIC X(8).
   179      03 PGMNAMEL                       PIC S9(4) COMP.
   180      03 PGMNAMEF                       PIC X.
   181      03 FILLER REDEFINES PGMNAMEF.
   182         05 PGMNAMEA                       PIC X.
   183      03 FILLER                         PIC X(4).
   184      03 PGMNAMEI                       PIC X(8).
   185      03 TITLE02L                       PIC S9(4) COMP.
   186      03 TITLE02F                       PIC X.
   187      03 FILLER REDEFINES TITLE02F.
   188         05 TITLE02A                       PIC X.
   189      03 FILLER                         PIC X(4).
   190      03 TITLE02I                       PIC X(40).
   191      03 CURTIMEL                       PIC S9(4) COMP.
   192      03 CURTIMEF                       PIC X.
   193      03 FILLER REDEFINES CURTIMEF.
   194         05 CURTIMEA                       PIC X.
   195      03 FILLER                         PIC X(4).
   196      03 CURTIMEI                       PIC X(8).
   197      03 OPTN001L                       PIC S9(4) COMP.
   198      03 OPTN001F                       PIC X.
   199      03 FILLER REDEFINES OPTN001F.
   200         05 OPTN001A                       PIC X.
   201      03 FILLER                         PIC X(4).
   202      03 OPTN001I                       PIC X(40).
   203      03 OPTN002L                       PIC S9(4) COMP.
   204      03 OPTN002F                       PIC X.
   205      03 FILLER REDEFINES OPTN002F.
   206         05 OPTN002A                       PIC X.
   207      03 FILLER                         PIC X(4).
   208      03 OPTN002I                       PIC X(40).
   209      03 OPTN003L                       PIC S9(4) COMP.
   210      03 OPTN003F                       PIC X.
   211      03 FILLER REDEFINES OPTN003F.
   212         05 OPTN003A                       PIC X.
   213      03 FILLER                         PIC X(4).
   214      03 OPTN003I                       PIC X(40).
   215      03 OPTN004L                       PIC S9(4) COMP.
   216      03 OPTN004F                       PIC X.
   217      03 FILLER REDEFINES OPTN004F.
   218         05 OPTN004A                       PIC X.
   219      03 FILLER                         PIC X(4).
   220      03 OPTN004I                       PIC X(40).
   221      03 OPTN005L                       PIC S9(4) COMP.
   222      03 OPTN005F                       PIC X.
   223      03 FILLER REDEFINES OPTN005F.
   224         05 OPTN005A                       PIC X.
   225      03 FILLER                         PIC X(4).
   226      03 OPTN005I                       PIC X(40).
   227      03 OPTN006L                       PIC S9(4) COMP.
   228      03 OPTN006F                       PIC X.
   229      03 FILLER REDEFINES OPTN006F.
   230         05 OPTN006A                       PIC X.
   231      03 FILLER                         PIC X(4).
   232      03 OPTN006I                       PIC X(40).
   233      03 OPTN007L                       PIC S9(4) COMP.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  10
* COMEN01C.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COMEN01.cpy)
   234      03 OPTN007F                       PIC X.
   235      03 FILLER REDEFINES OPTN007F.
   236         05 OPTN007A                       PIC X.
   237      03 FILLER                         PIC X(4).
   238      03 OPTN007I                       PIC X(40).
   239      03 OPTN008L                       PIC S9(4) COMP.
   240      03 OPTN008F                       PIC X.
   241      03 FILLER REDEFINES OPTN008F.
   242         05 OPTN008A                       PIC X.
   243      03 FILLER                         PIC X(4).
   244      03 OPTN008I                       PIC X(40).
   245      03 OPTN009L                       PIC S9(4) COMP.
   246      03 OPTN009F                       PIC X.
   247      03 FILLER REDEFINES OPTN009F.
   248         05 OPTN009A                       PIC X.
   249      03 FILLER                         PIC X(4).
   250      03 OPTN009I                       PIC X(40).
   251      03 OPTN010L                       PIC S9(4) COMP.
   252      03 OPTN010F                       PIC X.
   253      03 FILLER REDEFINES OPTN010F.
   254         05 OPTN010A                       PIC X.
   255      03 FILLER                         PIC X(4).
   256      03 OPTN010I                       PIC X(40).
   257      03 OPTN011L                       PIC S9(4) COMP.
   258      03 OPTN011F                       PIC X.
   259      03 FILLER REDEFINES OPTN011F.
   260         05 OPTN011A                       PIC X.
   261      03 FILLER                         PIC X(4).
   262      03 OPTN011I                       PIC X(40).
   263      03 OPTN012L                       PIC S9(4) COMP.
   264      03 OPTN012F                       PIC X.
   265      03 FILLER REDEFINES OPTN012F.
   266         05 OPTN012A                       PIC X.
   267      03 FILLER                         PIC X(4).
   268      03 OPTN012I                       PIC X(40).
   269      03 OPTIONL                        PIC S9(4) COMP.
   270      03 OPTIONF                        PIC X.
   271      03 FILLER REDEFINES OPTIONF.
   272         05 OPTIONA                        PIC X.
   273      03 FILLER                         PIC X(4).
   274      03 OPTIONI                        PIC X(2).
   275      03 ERRMSGL                        PIC S9(4) COMP.
   276      03 ERRMSGF                        PIC X.
   277      03 FILLER REDEFINES ERRMSGF.
   278         05 ERRMSGA                        PIC X.
   279      03 FILLER                         PIC X(4).
   280      03 ERRMSGI                        PIC X(78).
   281
   282*  Output Data For Map COMEN1A
   283   01 COMEN1AO REDEFINES COMEN1AI.
   284      03 FILLER                         PIC X(12).
   285      03 FILLER                         PIC X(3).
   286      03 TRNNAMEC                       PIC X.
   287      03 TRNNAMEP                       PIC X.
   288      03 TRNNAMEH                       PIC X.
   289      03 TRNNAMEV                       PIC X.
   290      03 TRNNAMEO                       PIC X(4).
   291      03 FILLER                         PIC X(3).
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  11
* COMEN01C.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COMEN01.cpy)
   292      03 TITLE01C                       PIC X.
   293      03 TITLE01P                       PIC X.
   294      03 TITLE01H                       PIC X.
   295      03 TITLE01V                       PIC X.
   296      03 TITLE01O                       PIC X(40).
   297      03 FILLER                         PIC X(3).
   298      03 CURDATEC                       PIC X.
   299      03 CURDATEP                       PIC X.
   300      03 CURDATEH                       PIC X.
   301      03 CURDATEV                       PIC X.
   302      03 CURDATEO                       PIC X(8).
   303      03 FILLER                         PIC X(3).
   304      03 PGMNAMEC                       PIC X.
   305      03 PGMNAMEP                       PIC X.
   306      03 PGMNAMEH                       PIC X.
   307      03 PGMNAMEV                       PIC X.
   308      03 PGMNAMEO                       PIC X(8).
   309      03 FILLER                         PIC X(3).
   310      03 TITLE02C                       PIC X.
   311      03 TITLE02P                       PIC X.
   312      03 TITLE02H                       PIC X.
   313      03 TITLE02V                       PIC X.
   314      03 TITLE02O                       PIC X(40).
   315      03 FILLER                         PIC X(3).
   316      03 CURTIMEC                       PIC X.
   317      03 CURTIMEP                       PIC X.
   318      03 CURTIMEH                       PIC X.
   319      03 CURTIMEV                       PIC X.
   320      03 CURTIMEO                       PIC X(8).
   321      03 FILLER                         PIC X(3).
   322      03 OPTN001C                       PIC X.
   323      03 OPTN001P                       PIC X.
   324      03 OPTN001H                       PIC X.
   325      03 OPTN001V                       PIC X.
   326      03 OPTN001O                       PIC X(40).
   327      03 FILLER                         PIC X(3).
   328      03 OPTN002C                       PIC X.
   329      03 OPTN002P                       PIC X.
   330      03 OPTN002H                       PIC X.
   331      03 OPTN002V                       PIC X.
   332      03 OPTN002O                       PIC X(40).
   333      03 FILLER                         PIC X(3).
   334      03 OPTN003C                       PIC X.
   335      03 OPTN003P                       PIC X.
   336      03 OPTN003H                       PIC X.
   337      03 OPTN003V                       PIC X.
   338      03 OPTN003O                       PIC X(40).
   339      03 FILLER                         PIC X(3).
   340      03 OPTN004C                       PIC X.
   341      03 OPTN004P                       PIC X.
   342      03 OPTN004H                       PIC X.
   343      03 OPTN004V                       PIC X.
   344      03 OPTN004O                       PIC X(40).
   345      03 FILLER                         PIC X(3).
   346      03 OPTN005C                       PIC X.
   347      03 OPTN005P                       PIC X.
   348      03 OPTN005H                       PIC X.
   349      03 OPTN005V                       PIC X.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  12
* COMEN01C.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/BMSCOPY/COMEN01.cpy)
   350      03 OPTN005O                       PIC X(40).
   351      03 FILLER                         PIC X(3).
   352      03 OPTN006C                       PIC X.
   353      03 OPTN006P                       PIC X.
   354      03 OPTN006H                       PIC X.
   355      03 OPTN006V                       PIC X.
   356      03 OPTN006O                       PIC X(40).
   357      03 FILLER                         PIC X(3).
   358      03 OPTN007C                       PIC X.
   359      03 OPTN007P                       PIC X.
   360      03 OPTN007H                       PIC X.
   361      03 OPTN007V                       PIC X.
   362      03 OPTN007O                       PIC X(40).
   363      03 FILLER                         PIC X(3).
   364      03 OPTN008C                       PIC X.
   365      03 OPTN008P                       PIC X.
   366      03 OPTN008H                       PIC X.
   367      03 OPTN008V                       PIC X.
   368      03 OPTN008O                       PIC X(40).
   369      03 FILLER                         PIC X(3).
   370      03 OPTN009C                       PIC X.
   371      03 OPTN009P                       PIC X.
   372      03 OPTN009H                       PIC X.
   373      03 OPTN009V                       PIC X.
   374      03 OPTN009O                       PIC X(40).
   375      03 FILLER                         PIC X(3).
   376      03 OPTN010C                       PIC X.
   377      03 OPTN010P                       PIC X.
   378      03 OPTN010H                       PIC X.
   379      03 OPTN010V                       PIC X.
   380      03 OPTN010O                       PIC X(40).
   381      03 FILLER                         PIC X(3).
   382      03 OPTN011C                       PIC X.
   383      03 OPTN011P                       PIC X.
   384      03 OPTN011H                       PIC X.
   385      03 OPTN011V                       PIC X.
   386      03 OPTN011O                       PIC X(40).
   387      03 FILLER                         PIC X(3).
   388      03 OPTN012C                       PIC X.
   389      03 OPTN012P                       PIC X.
   390      03 OPTN012H                       PIC X.
   391      03 OPTN012V                       PIC X.
   392      03 OPTN012O                       PIC X(40).
   393      03 FILLER                         PIC X(3).
   394      03 OPTIONC                        PIC X.
   395      03 OPTIONP                        PIC X.
   396      03 OPTIONH                        PIC X.
   397      03 OPTIONV                        PIC X.
   398      03 OPTIONO                        PIC X(2).
   399      03 FILLER                         PIC X(3).
   400      03 ERRMSGC                        PIC X.
   401      03 ERRMSGP                        PIC X.
   402      03 ERRMSGH                        PIC X.
   403      03 ERRMSGV                        PIC X.
   404      03 ERRMSGO                        PIC X(78).
   405
   406
   407*COPY COTTL01Y.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  13
* COMEN01C.cbl (/home/ec2-user/CrossPlatformBuild/CardDemo/COPYBOOKS/COTTL01Y.c)
   408 01 CCDA-SCREEN-TITLE.
   409   05 CCDA-TITLE01    PIC X(40) VALUE
   410      '      AWS Mainframe Modernization       '.
   411   05 CCDA-TITLE02    PIC X(40) VALUE
   412*     '  Credit Card Demo Application (CCDA)   '.
   413      '              CardDemo                  '.
   414   05 CCDA-THANK-YOU  PIC X(40) VALUE
   415      'Thank you for using CCDA application... '.
   416*
   417* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT
   418*
   419*COPY CSDAT01Y.
   420 01 WS-DATE-TIME.
   421   05 WS-CURDATE-DATA.
   422     10  WS-CURDATE.
   423       15  WS-CURDATE-YEAR         PIC 9(04).
   424       15  WS-CURDATE-MONTH        PIC 9(02).
   425       15  WS-CURDATE-DAY          PIC 9(02).
   426     10 WS-CURDATE-N REDEFINES WS-CURDATE PIC 9(08).
   427     10  WS-CURTIME.
   428       15  WS-CURTIME-HOURS        PIC 9(02).
   429       15  WS-CURTIME-MINUTE       PIC 9(02).
   430       15  WS-CURTIME-SECOND       PIC 9(02).
   431       15  WS-CURTIME-MILSEC       PIC 9(02).
   432     10 WS-CURTIME-N REDEFINES WS-CURTIME PIC 9(08).
   433   05 WS-CURDATE-MM-DD-YY.
   434     10  WS-CURDATE-MM             PIC 9(02).
   435     10  FILLER                    PIC X(01) VALUE '/'.
   436     10  WS-CURDATE-DD             PIC 9(02).
   437     10  FILLER                    PIC X(01) VALUE '/'.
   438     10  WS-CURDATE-YY             PIC 9(02).
   439   05 WS-CURTIME-HH-MM-SS.
   440     10  WS-CURTIME-HH             PIC 9(02).
   441     10  FILLER                    PIC X(01) VALUE ':'.
   442     10  WS-CURTIME-MM             PIC 9(02).
   443     10  FILLER                    PIC X(01) VALUE ':'.
   444     10  WS-CURTIME-SS             PIC 9(02).
   445   05 WS-TIMESTAMP.
   446     10  WS-TIMESTAMP-DT-YYYY      PIC 9(04).
   447     10  FILLER                    PIC X(01) VALUE '-'.
   448     10  WS-TIMESTAMP-DT-MM        PIC 9(02).
   449     10  FILLER                    PIC X(01) VALUE '-'.
   450     10  WS-TIMESTAMP-DT-DD        PIC 9(02).
   451     10  FILLER                    PIC X(01) VALUE ' '.
   452     10  WS-TIMESTAMP-TM-HH        PIC 9(02).
   453     10  FILLER                    PIC X(01) VALUE ':'.
   454     10  WS-TIMESTAMP-TM-MM        PIC 9(02).
   455     10  FILLER                    PIC X(01) VALUE ':'.
   456     10  WS-TIMESTAMP-TM-SS        PIC 9(02).
   457     10  FILLER                    PIC X(01) VALUE '.'.
   458     10  WS-TIMESTAMP-TM-MS6       PIC 9(06).
   459*
   460* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT
   461*
   462*COPY CSMSG01Y.
   463 01 CCDA-COMMON-MESSAGES.
   464   05 CCDA-MSG-THANK-YOU         PIC X(50) VALUE
   465        'Thank you for using CardDemo application...      '.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  14
* COMEN01C.cbl
   466   05 CCDA-MSG-INVALID-KEY       PIC X(50) VALUE
   467        'Invalid key pressed. Please see below...         '.
   468*
   469* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT
   470*
   471*COPY CSUSR01Y.
   472 01 SEC-USER-DATA.
   473   05 SEC-USR-ID                 PIC X(08).
   474   05 SEC-USR-FNAME              PIC X(20).
   475   05 SEC-USR-LNAME              PIC X(20).
   476   05 SEC-USR-PWD                PIC X(08).
   477   05 SEC-USR-TYPE               PIC X(01).
   478   05 SEC-USR-FILLER             PIC X(23).
   479*
   480* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:59 CDT
   481*
   482
   483*COPY DFHAID.
   484*<CR_TAG_DEMO_BEGIN>
   485*
   486*  Copyright (C) 2024 Micro Focus or one of its affiliates.
   487*  All rights reserved.
   488*
   489*  This sample code is supplied for demonstration purposes only
   490*  on an "as is" basis and "is for use at your own risk".
   491*
   492*<CR_TAG_DEMO_END>
   493*----------------------------------------------------------------*
   494* dfhaid.cpy
   495*----------------------------------------------------------------*
   496 01  DFHAID.
   497     02  DFHNULL         PIC X   VALUE IS LOW-VALUE.
   498     02  DFHENTER        PIC X   VALUE IS ''''.
   499     02  DFHCLEAR        PIC X   VALUE IS '_'.
   500     02  DFHPEN          PIC X   VALUE IS '='.
   501     02  DFHOPID         PIC X   VALUE IS 'W'.
   502     02  DFHMSRE         PIC X   VALUE IS 'X'.
   503     02  DFHSTRF         PIC X   VALUE IS ' '.
   504     02  DFHTRIG         PIC X   VALUE IS '"'.
   505     02  DFHPA1          PIC X   VALUE IS '%'.
   506     02  DFHPA2          PIC X   VALUE IS '>'.
   507     02  DFHPA3          PIC X   VALUE IS ','.
   508     02  DFHPF1          PIC X   VALUE IS '1'.
   509     02  DFHPF2          PIC X   VALUE IS '2'.
   510     02  DFHPF3          PIC X   VALUE IS '3'.
   511     02  DFHPF4          PIC X   VALUE IS '4'.
   512     02  DFHPF5          PIC X   VALUE IS '5'.
   513     02  DFHPF6          PIC X   VALUE IS '6'.
   514     02  DFHPF7          PIC X   VALUE IS '7'.
   515     02  DFHPF8          PIC X   VALUE IS '8'.
   516     02  DFHPF9          PIC X   VALUE IS '9'.
   517     02  DFHPF10         PIC X   VALUE IS ':'.
   518     02  DFHPF11         PIC X   VALUE IS '#'.
   519     02  DFHPF12         PIC X   VALUE IS '@'.
   520     02  DFHPF13         PIC X   VALUE IS 'A'.
   521     02  DFHPF14         PIC X   VALUE IS 'B'.
   522     02  DFHPF15         PIC X   VALUE IS 'C'.
   523     02  DFHPF16         PIC X   VALUE IS 'D'.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  15
* COMEN01C.cbl (/opt/microfocus/EnterpriseBuildTools/cpylib/DFHAID.cpy)
   524     02  DFHPF17         PIC X   VALUE IS 'E'.
   525     02  DFHPF18         PIC X   VALUE IS 'F'.
   526     02  DFHPF19         PIC X   VALUE IS 'G'.
   527     02  DFHPF20         PIC X   VALUE IS 'H'.
   528     02  DFHPF21         PIC X   VALUE IS 'I'.
   529     02  DFHPF22         PIC X   VALUE IS ' '.
   530*    Note: CICS ECM alters the line above to...
   531*          Value for ASCII  is X'5B'
   532*          Value for EBCDIC is X'4A'
   533     02  DFHPF23         PIC X   VALUE IS '.'.
   534     02  DFHPF24         PIC X   VALUE IS '<'.
   535*----------------------------------------------------------------*
   536* dfhaid.cpy end
   537*----------------------------------------------------------------*
   538*COPY DFHBMSCA.
   539*----------------------------------------------------------------*
   540* dfhbmsca.cpy
   541*<CR_TAG_DEMO_BEGIN>
   542*
   543*  Copyright (C) 2024 Micro Focus or one of its affiliates.
   544*  All rights reserved.
   545*
   546*  This sample code is supplied for demonstration purposes only
   547*  on an "as is" basis and "is for use at your own risk".
   548*
   549*<CR_TAG_DEMO_END>
   550***---------------------------------------------------------*
   551***CONTROL BLOCK NAME= DFHBMSCA                             *
   552***                                                         *
   553***NAME OF MATCHING ASSEMBLER CONTROL BLOCK = NONE          *
   554***                                                         *
   555***DESCRIPTIVE NAME = 3270 ATTRIBUTE VALUES                 *
   556***                                                         *
   557***FUNCTION =  Provides the values for 3270 attribute bytes *
   558***            used by the BMS support.                     *
   559***                                                         *
   560***---------------------------------------------------------*
   561 01      DFHBMSCA.
   562*                                               X'1915'.
   563   02    DFHBMPEM-BIN  PICTURE 9(4) COMP VALUE IS 6421.
   564   02    FILLER REDEFINES DFHBMPEM-BIN.
   565     03  DFHBMPEM  PICTURE X.
   566     03  DFHBMPNL  PICTURE X.
   567*                                               X'0C0D'.
   568   02    DFHBMPFF-BIN  PICTURE 9(4) COMP VALUE IS 3085.
   569   02    FILLER REDEFINES DFHBMPFF-BIN.
   570     03  DFHBMPFF  PICTURE X.
   571     03  DFHBMPCR  PICTURE X.
   572   02    DFHBMASK  PICTURE X   VALUE  IS  '0'.
   573   02    DFHBMUNP  PICTURE X   VALUE  IS  ' '.
   574   02    DFHBMUNN  PICTURE X   VALUE  IS  '&'.
   575   02    DFHBMPRO  PICTURE X   VALUE  IS  '-'.
   576   02    DFHBMBRY  PICTURE X   VALUE  IS  'H'.
   577   02    DFHBMDAR  PICTURE X   VALUE  IS  '<'.
   578   02    DFHBMFSE  PICTURE X   VALUE  IS  'A'.
   579   02    DFHBMPRF  PICTURE X   VALUE  IS  '/'.
   580   02    DFHBMASF  PICTURE X   VALUE  IS  '1'.
   581   02    DFHBMASB  PICTURE X   VALUE  IS  '8'.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  16
* COMEN01C.cbl (/opt/microfocus/EnterpriseBuildTools/cpylib/DFHBMSCA.cpy)
   582*                                               X'0E0F'.
   583   02    DFHBMPSO-BIN  PICTURE 9(4) COMP VALUE IS 3599.
   584   02    FILLER REDEFINES DFHBMPSO-BIN.
   585     03  DFHBMPSO  PICTURE X.
   586     03  DFHBMPSI  PICTURE X.
   587*                                               X'0080'.
   588   02    DFHBMEOF-BIN  PICTURE 9(4) COMP VALUE IS 128.
   589   02    FILLER REDEFINES DFHBMEOF-BIN.
   590     03  FILLER    PICTURE X.
   591     03  DFHBMEOF  PICTURE X.
   592*                                               X'0282'.
   593   02    DFHBMCUR-BIN  PICTURE 9(4) COMP VALUE IS 642.
   594   02    FILLER REDEFINES DFHBMCUR-BIN.
   595     03  DFHBMCUR  PICTURE X.
   596     03  DFHBMEC   PICTURE X.
   597*                                               X'0082'.
   598   02    DFHBMFLG-BIN  PICTURE 9(4) COMP VALUE IS 130.
   599       88    DFHERASE VALUES ARE 128, 130.
   600       88    DFHCURSR VALUES ARE   2, 130.
   601   02    FILLER REDEFINES DFHBMFLG-BIN.
   602     03  FILLER    PICTURE X.
   603     03  DFHBMFLG  PICTURE X.
   604   02    DFHBMDET  PICTURE X   VALUE  IS  HIGH-VALUES.
   605   02    FILLER    PICTURE X.
   606*                                               X'0028'.
   607   02    DFHSA-BIN  PICTURE 9(4) COMP VALUE IS 40.
   608   02    FILLER REDEFINES DFHSA-BIN.
   609     03  FILLER    PICTURE X.
   610     03  DFHSA     PICTURE X.
   611*                                               X'003F'.
   612   02    DFHERROR-BIN  PICTURE 9(4) COMP VALUE IS 63.
   613   02    FILLER REDEFINES DFHERROR-BIN.
   614     03  FILLER    PICTURE X.
   615     03  DFHERROR  PICTURE X.
   616*                                               X'0042'.
   617   02    DFHCOLOR-BIN  PICTURE 9(4) COMP VALUE IS 66.
   618   02    FILLER REDEFINES DFHCOLOR-BIN.
   619     03  FILLER    PICTURE X.
   620     03  DFHCOLOR  PICTURE X.
   621*                                               X'0043'.
   622   02    DFHPS-BIN  PICTURE 9(4) COMP VALUE IS 67.
   623   02    FILLER REDEFINES DFHPS-BIN.
   624     03  FILLER    PICTURE X.
   625     03  DFHPS     PICTURE X.
   626*                                               X'0041'.
   627   02    DFHHLT-BIN  PICTURE 9(4) COMP VALUE IS 65.
   628   02    FILLER REDEFINES DFHHLT-BIN.
   629     03  FILLER    PICTURE X.
   630     03  DFHHLT    PICTURE X.
   631*                                               X'00C0'.
   632   02    DFH3270-BIN   PICTURE 9(4) COMP VALUE IS 192.
   633   02    FILLER REDEFINES DFH3270-BIN.
   634     03  FILLER    PICTURE X.
   635     03  DFH3270   PICTURE X.
   636   02    DFHVAL    PICTURE X   VALUE  IS  'A'.
   637   02    DFHOUTLN  PICTURE X   VALUE  IS  'B'.
   638*                                               X'0046'.
   639   02    DFHBKTRN-BIN  PICTURE 9(4) COMP VALUE IS 70.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  17
* COMEN01C.cbl (/opt/microfocus/EnterpriseBuildTools/cpylib/DFHBMSCA.cpy)
   640   02    FILLER REDEFINES DFHBKTRN-BIN.
   641     03  FILLER    PICTURE X.
   642     03  DFHBKTRN  PICTURE X.
   643   02    DFHALL    PICTURE X   VALUE  IS  LOW-VALUES.
   644   02    DFHDFT    PICTURE X   VALUE  IS  HIGH-VALUES.
   645   02    DFHDFCOL  PICTURE X   VALUE  IS  LOW-VALUES.
   646   02    DFHBLUE   PICTURE X   VALUE  IS  '1'.
   647   02    DFHRED    PICTURE X   VALUE  IS  '2'.
   648   02    DFHPINK   PICTURE X   VALUE  IS  '3'.
   649   02    DFHGREEN  PICTURE X   VALUE  IS  '4'.
   650   02    DFHTURQ   PICTURE X   VALUE  IS  '5'.
   651   02    DFHYELLO  PICTURE X   VALUE  IS  '6'.
   652   02    DFHNEUTR  PICTURE X   VALUE  IS  '7'.
   653   02    DFHBASE   PICTURE X   VALUE  IS  LOW-VALUES.
   654   02    DFHDFHI   PICTURE X   VALUE  IS  LOW-VALUES.
   655   02    DFHBLINK  PICTURE X   VALUE  IS  '1'.
   656   02    DFHREVRS  PICTURE X   VALUE  IS  '2'.
   657   02    DFHUNDLN  PICTURE X   VALUE  IS  '4'.
   658*                                               X'0402'.
   659   02    DFHMFIL-BIN  PICTURE 9(4) COMP VALUE IS 1026.
   660   02    FILLER REDEFINES DFHMFIL-BIN.
   661     03  DFHMFIL   PICTURE X.
   662     03  DFHMENT   PICTURE X.
   663*                                               X'0601'.
   664   02    DFHMFE-BIN  PICTURE 9(4) COMP VALUE IS 1537.
   665   02    FILLER REDEFINES DFHMFE-BIN.
   666     03  DFHMFE    PICTURE X.
   667     03  DFHMT     PICTURE X.
   668*                                               X'0503'.
   669   02    DFHMFT-BIN  PICTURE 9(4) COMP VALUE IS 1283.
   670   02    FILLER REDEFINES DFHMFT-BIN.
   671     03  DFHMFT    PICTURE X.
   672     03  DFHMET    PICTURE X.
   673*                                               X'0007'.
   674   02    DFHMFET-BIN  PICTURE 9(4) COMP VALUE IS 7.
   675   02    FILLER REDEFINES DFHMFET-BIN.
   676     03  FILLER    PICTURE X.
   677     03  DFHMFET   PICTURE X.
   678   02    DFHUNNOD  PICTURE X   VALUE  IS  '('.
   679   02    DFHUNIMD  PICTURE X   VALUE  IS  'I'.
   680   02    DFHUNNUM  PICTURE X   VALUE  IS  'J'.
   681   02    DFHUNNUB  PICTURE X   VALUE  IS  'Q'.
   682   02    DFHUNINT  PICTURE X   VALUE  IS  'R'.
   683   02    DFHUNNON  PICTURE X   VALUE  IS  ')'.
   684   02    DFHPROTI  PICTURE X   VALUE  IS  'Y'.
   685   02    DFHPROTN  PICTURE X   VALUE  IS  '%'.
   686   02    DFHDFFR   PICTURE X   VALUE  IS  LOW-VALUES.
   687*                                               X'0102'.
   688   02    DFHUNDER-BIN  PICTURE 9(4) COMP VALUE IS 258.
   689   02    FILLER REDEFINES DFHUNDER-BIN.
   690     03  DFHUNDER  PICTURE X.
   691     03  DFHRIGHT  PICTURE X.
   692*                                               X'0408'.
   693   02    DFHOVER-BIN  PICTURE 9(4) COMP VALUE IS 1032.
   694   02    FILLER REDEFINES DFHOVER-BIN.
   695     03  DFHOVER   PICTURE X.
   696     03  DFHLEFT   PICTURE X.
   697*                                               X'000F'.
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  18
* COMEN01C.cbl (/opt/microfocus/EnterpriseBuildTools/cpylib/DFHBMSCA.cpy)
   698   02    DFHBOX-BIN   PICTURE 9(4) COMP VALUE IS 15.
   699   02    FILLER REDEFINES DFHBOX-BIN.
   700     03  FILLER    PICTURE X.
   701     03  DFHBOX    PICTURE X.
   702*                                               X'0001'.
   703   02    DFHSOSI-BIN  PICTURE 9(4) COMP VALUE IS 1.
   704   02    FILLER REDEFINES DFHSOSI-BIN.
   705     03  FILLER    PICTURE X.
   706     03  DFHSOSI   PICTURE X.
   707   02    DFHTRANS  PICTURE X   VALUE  IS  '0'.
   708   02    DFHOPAQ   PICTURE X   VALUE  IS  HIGH-VALUES.
   709*----------------------------------------------------------------*
   710* dfhbmsca.cpy end
   711*----------------------------------------------------------------*
   712
   713*----------------------------------------------------------------*
   714*                        LINKAGE SECTION
   715*----------------------------------------------------------------*
   716 LINKAGE SECTION.
   717 01  DFHCOMMAREA.
   718   05  LK-COMMAREA                           PIC X(01)
   719       OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.
   720
   721*----------------------------------------------------------------*
   722*                       PROCEDURE DIVISION
   723*----------------------------------------------------------------*
   724 PROCEDURE DIVISION.
   725 MAIN-PARA.
   726
   727     SET ERR-FLG-OFF TO TRUE
   728
   729     MOVE SPACES TO WS-MESSAGE
   730                    ERRMSGO OF COMEN1AO
   731
   732     IF EIBCALEN = 0
   733         MOVE 'COSGN00C' TO CDEMO-FROM-PROGRAM
   734         PERFORM RETURN-TO-SIGNON-SCREEN
   735     ELSE
   736         MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA
   737         IF NOT CDEMO-PGM-REENTER
   738             SET CDEMO-PGM-REENTER    TO TRUE
   739             MOVE LOW-VALUES          TO COMEN1AO
   740             PERFORM SEND-MENU-SCREEN
   741         ELSE
   742             PERFORM RECEIVE-MENU-SCREEN
   743             EVALUATE EIBAID
   744                 WHEN DFHENTER
   745                     PERFORM PROCESS-ENTER-KEY
   746                 WHEN DFHPF3
   747                     MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM
   748                     PERFORM RETURN-TO-SIGNON-SCREEN
   749                 WHEN OTHER
   750                     MOVE 'Y'                       TO WS-ERR-FLG
   751                     MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE
   752                     PERFORM SEND-MENU-SCREEN
   753             END-EVALUATE
   754         END-IF
   755     END-IF
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  19
* COMEN01C.cbl
   756
   757     EXEC CICS RETURN
   758               TRANSID (WS-TRANID)
   759               COMMAREA (CARDDEMO-COMMAREA)
   760     END-EXEC.
   761
   762*----------------------------------------------------------------*
   763*                      PROCESS-ENTER-KEY
   764*----------------------------------------------------------------*
   765 PROCESS-ENTER-KEY.
   766
   767     PERFORM VARYING WS-IDX
   768             FROM LENGTH OF OPTIONI OF COMEN1AI BY -1 UNTIL
   769             OPTIONI OF COMEN1AI(WS-IDX:1) NOT = SPACES OR
   770             WS-IDX = 1
   771     END-PERFORM
   772     MOVE OPTIONI OF COMEN1AI(1:WS-IDX) TO WS-OPTION-X
   773     INSPECT WS-OPTION-X REPLACING ALL ' ' BY '0'
   774     MOVE WS-OPTION-X              TO WS-OPTION
   775     MOVE WS-OPTION                TO OPTIONO OF COMEN1AO
   776
   777     IF WS-OPTION IS NOT NUMERIC OR
   778        WS-OPTION > CDEMO-MENU-OPT-COUNT OR
   779        WS-OPTION = ZEROS
   780         MOVE 'Y'     TO WS-ERR-FLG
   781         MOVE 'Please enter a valid option number...' TO
   782                         WS-MESSAGE
   783         PERFORM SEND-MENU-SCREEN
   784     END-IF
   785
   786     IF CDEMO-USRTYP-USER AND
   787        CDEMO-MENU-OPT-USRTYPE(WS-OPTION) = 'A'
   788         SET ERR-FLG-ON          TO TRUE
   789         MOVE SPACES             TO WS-MESSAGE
   790         MOVE 'No access - Admin Only option... ' TO
   791                                 WS-MESSAGE
   792         PERFORM SEND-MENU-SCREEN
   793     END-IF
   794
   795     IF NOT ERR-FLG-ON
   796         IF CDEMO-MENU-OPT-PGMNAME(WS-OPTION)(1:5) NOT = 'DUMMY'
   797             MOVE WS-TRANID    TO CDEMO-FROM-TRANID
   798             MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM
   799*            MOVE WS-USER-ID   TO CDEMO-USER-ID
   800*            MOVE SEC-USR-TYPE TO CDEMO-USER-TYPE
   801             MOVE ZEROS        TO CDEMO-PGM-CONTEXT
   802             EXEC CICS
   803                 XCTL PROGRAM(CDEMO-MENU-OPT-PGMNAME(WS-OPTION))
   804                 COMMAREA(CARDDEMO-COMMAREA)
   805             END-EXEC
   806         END-IF
   807         MOVE SPACES             TO WS-MESSAGE
   808         MOVE DFHGREEN           TO ERRMSGC  OF COMEN1AO
   809         STRING 'This option '       DELIMITED BY SIZE
   810                 CDEMO-MENU-OPT-NAME(WS-OPTION)
   811                                 DELIMITED BY SPACE
   812                 'is coming soon ...'   DELIMITED BY SIZE
   813            INTO WS-MESSAGE
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  20
* COMEN01C.cbl
   814         PERFORM SEND-MENU-SCREEN
   815     END-IF.
   816
   817*----------------------------------------------------------------*
   818*                      RETURN-TO-SIGNON-SCREEN
   819*----------------------------------------------------------------*
   820 RETURN-TO-SIGNON-SCREEN.
   821
   822     IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES
   823         MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM
   824     END-IF
   825     EXEC CICS
   826         XCTL PROGRAM(CDEMO-TO-PROGRAM)
   827     END-EXEC.
   828
   829*----------------------------------------------------------------*
   830*                      SEND-MENU-SCREEN
   831*----------------------------------------------------------------*
   832 SEND-MENU-SCREEN.
   833
   834     PERFORM POPULATE-HEADER-INFO
   835     PERFORM BUILD-MENU-OPTIONS
   836
   837     MOVE WS-MESSAGE TO ERRMSGO OF COMEN1AO
   838
   839     EXEC CICS SEND
   840               MAP('COMEN1A')
   841               MAPSET('COMEN01')
   842               FROM(COMEN1AO)
   843               ERASE
   844     END-EXEC.
   845
   846*----------------------------------------------------------------*
   847*                      RECEIVE-MENU-SCREEN
   848*----------------------------------------------------------------*
   849 RECEIVE-MENU-SCREEN.
   850
   851     EXEC CICS RECEIVE
   852               MAP('COMEN1A')
   853               MAPSET('COMEN01')
   854               INTO(COMEN1AI)
   855               RESP(WS-RESP-CD)
   856               RESP2(WS-REAS-CD)
   857     END-EXEC.
   858
   859*----------------------------------------------------------------*
   860*                      POPULATE-HEADER-INFO
   861*----------------------------------------------------------------*
   862 POPULATE-HEADER-INFO.
   863
   864     MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA
   865
   866     MOVE CCDA-TITLE01           TO TITLE01O OF COMEN1AO
   867     MOVE CCDA-TITLE02           TO TITLE02O OF COMEN1AO
   868     MOVE WS-TRANID              TO TRNNAMEO OF COMEN1AO
   869     MOVE WS-PGMNAME             TO PGMNAMEO OF COMEN1AO
   870
   871     MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  21
* COMEN01C.cbl
   872     MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD
   873     MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY
   874
   875     MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF COMEN1AO
   876
   877     MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH
   878     MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM
   879     MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS
   880
   881     MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF COMEN1AO.
   882
   883*----------------------------------------------------------------*
   884*                      BUILD-MENU-OPTIONS
   885*----------------------------------------------------------------*
   886 BUILD-MENU-OPTIONS.
   887
   888     PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL
   889                     WS-IDX > CDEMO-MENU-OPT-COUNT
   890
   891         MOVE SPACES             TO WS-MENU-OPT-TXT
   892
   893         STRING CDEMO-MENU-OPT-NUM(WS-IDX)  DELIMITED BY SIZE
   894                '. '                         DELIMITED BY SIZE
   895                CDEMO-MENU-OPT-NAME(WS-IDX) DELIMITED BY SIZE
   896           INTO WS-MENU-OPT-TXT
   897
   898         EVALUATE WS-IDX
   899             WHEN 1
   900                 MOVE WS-MENU-OPT-TXT TO OPTN001O
   901             WHEN 2
   902                 MOVE WS-MENU-OPT-TXT TO OPTN002O
   903             WHEN 3
   904                 MOVE WS-MENU-OPT-TXT TO OPTN003O
   905             WHEN 4
   906                 MOVE WS-MENU-OPT-TXT TO OPTN004O
   907             WHEN 5
   908                 MOVE WS-MENU-OPT-TXT TO OPTN005O
   909             WHEN 6
   910                 MOVE WS-MENU-OPT-TXT TO OPTN006O
   911             WHEN 7
   912                 MOVE WS-MENU-OPT-TXT TO OPTN007O
   913             WHEN 8
   914                 MOVE WS-MENU-OPT-TXT TO OPTN008O
   915             WHEN 9
   916                 MOVE WS-MENU-OPT-TXT TO OPTN009O
   917             WHEN 10
   918                 MOVE WS-MENU-OPT-TXT TO OPTN010O
   919             WHEN 11
   920                 MOVE WS-MENU-OPT-TXT TO OPTN011O
   921             WHEN 12
   922                 MOVE WS-MENU-OPT-TXT TO OPTN012O
   923             WHEN OTHER
   924                 CONTINUE
   925         END-EVALUATE
   926
   927     END-PERFORM.
   928
   929
* Micro Focus COBOL                  V9.0 revision 000 12-Jul-24 07:58 Page  22
* COMEN01C.cbl
   930*
   931* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT
   932*
*
*
* Errors
* -Line- Col Code/severity Description
* Micro Focus COBOL                  V9.0 revision 000 Compiler
* (C) Copyright 1984-2024 Micro Focus or one of its affiliates.
*                                                        REF GKR-081900000A0
* Total Messages:     0
* Data:        6480     Code:        3292
