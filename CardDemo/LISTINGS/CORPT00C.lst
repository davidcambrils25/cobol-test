* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page   1
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl
* Options: DELINT
*          USE"C:\CrossPlatformBuild\CardDemo\RELEASE\LOADLIB\CORPT00C.cbl.dir"
* Setting: NOACCEPTREFRESH
*          NOACU
*          NOACUCOMMENT
*          NOACUSYNC
*          NOACU-UNDERSCORE
*            ADV
*            ALIGN"8 OPT"
*            ALPHALITCONT"MARGIN"
*            ALPHASTART"1"
*            ALTER
*          NOAMODE
*            ANIM
*            ANS85
*            APOST
*            AREACHECK
*            ARITH"EXTEND"
*            ARITHMETIC"ENTCOBOL"
*            ASSIGN"EXTERNAL"
*          NOASSIGN-PRINTER
*          NOAUTOLOCK
*          NOBELL
*            BINLIT"BOOLEAN"
*          NOBOUND
*          NOBRIEF
*          NOBS2000
*            BWZSTAR
*            BYTEMODEMOVE
*            CALLFH"EXTFH"
*          NOCALLRECOVERY
*            CALLSORT"EXTSM"
*            CANCEL
*            CANCELLBR
*            CHANGEMESSAGE"677 N 1126 N 1152 N 2000 N"
*            CHARSET"EBCDIC"
*            CHECKDIV"ENTCOBOL"
*          NOCHECKREFMOD
*          NOCICS
*          NOCICS-CPY
*          NOCICSOPTIMIZE
*          NOCMPR2
*            COBFSTATCONV
*          NOCOBIDY
*          NOCOBOL370
*          NOCOBOLDIR
*          NOCOMMANDLINELINKAGE
*            COLLECTION"CardDemo"
*          NOCOMP
*            COMP"BINARY"
*            COMP1"FLOAT"
*            COMP2"FLOAT"
*            COMP-5"2"
*            COMP-6"2"
*            CONFIRM
*          NOCONVERTRET
*            CONVSPACE
*            COPYEXT"CBL,CPY"
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page   2
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl
*            COPYLBR
*            COPYLIST
*            COPYLISTCOMMENT"7"
*            COPYSEARCH"MF"
*            CSI
*            CURRENCY-SIGN"36"
*            CURRENT-DATE"MMDDYY"
*          NODATA
*            DATACOMPRESS"0"
*          NODATA-CONTEXT
*          NODATAMAP
*            DATE
*            DBCHECK
*            DBCS"3"
*            DBCSSOSI"14""15"
*            DBSPACE
*            DE-EDIT"2"
*            DEFAULTBYTE"0"
*          NODEFAULTCALLS
*            DETECTLOCK
*          NODG
*            DIALECT"ENTCOBOL"
*          NODIRECTIVES-IN-COMMENTS
*            DISPLAY"CONSOLE"
*          NODISPLAYAT
*            DISPLAYPICU"ANSI"
*            DISPSIGN"COMPAT"
*          NODOSVS
*          NODOTNET
*            DPCINDATA"XML"
*            DPCINSUBSCRIPT
*          NODYNAM
*          NOEARLY-RELEASE
*            EBCCOLSEQ"1"
*            ECHO
*          NOECHOALL
*            ENTCOBOL
*            EOF1A
*            ERRFORMAT"2"
*            ERRLIST"VERBOSE"
*          NOERRQ
*          NOEXECSQLFLAG
*            EXITPROGRAM"ANSI"
*          NOFASTINIT
*            FASTSORT
*            FCD3
*          NOFCDALIGN
*          NOFCDREG
*            FDCLEAR"3"
*          NOFILESHARE
*            FILETYPE"0"
*            FLAG"ENTCOBOL"
*            FLAGAS"S"
*          NOFLAGEUC
*          NOFLAGMIG
*          NOFLAGQ
*            FLAGSINEDIT
*          NOFLAGSTD
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page   3
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl
*            FOLDCALLNAME"UPPER"
*            FOLDCOPYNAME"UPPER"
*            FORM"60"
*            FP-ROUNDING"ENTCOBOL"
*          NOHOSTARITHMETIC
*            HOSTCONTZERO
*            HOST-NUMCOMPARE
*            HOST-NUMMOVE
*            HOSTFD
*          NOHOSTRW
*            IBMCOMP
*            IDENTIFIERLEN"30"
*            IDXFORMAT"0"
*          NOIGNOREEXEC
*          NOIL
*          NOILGEN
*          NOILEMIT
*            IMPLICITSCOPE
*            INDD"SYSIN 80 R"
*          NOIDYSRCPATH
*            INFORETURN"0"
*          NOINITCALL
*            INITIAL"1"
*          NOINITPTR
*          NOINITBYTYPE
*            INT"C:\CrossPlatformBuild\CardDemo\RELEASE\LOADLIB\CORPT00C.int"
*            INTDATE"ANSI"
*            INTLEVEL"9"
*            IOCONV
*          NOISO2002
*          NOIXNLSKEY
*          NOIXNUMKEY
*          NOJVMGEN
*            KEYCHECK
*            KEYCOMPRESS"0"
*          NOLIBRARIAN
*          NOLINE-COUNT
*            LIST"CORPT00C.lst"
*            LISTPATH"C:\CrossPlatformBuild\CardDemo\LISTINGS"
*            LISTWIDTH"80"
*            LITVAL-SIZE"4"
*          NOLOCALSOURCEFORMAT
*            LOCKTYPE"0"
*            MAPNAME
*          NOMAINFRAMEFLOATINGPOINT
*          NOMAXERROR
*            METHODDEFAULT"REFERENCE"
*          NOMF
*          NOMFCOMMENT
*          NOMFSYNC
*          NOMOVELENCHECK
*          NOMS
*          NOMVS
*            NATIONAL"1"
*            NATIVE"EBCDIC"
*          NONATIVEFLOATINGPOINT
*          NONCHAR
*          NONLS
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page   4
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl
*          NONLSCURRENCYLENGTH
*            NSYMBOL"NATIONAL"
*            NULLESCAPE
*          NOODOOSVS
*            ODOSLIDE
*          NOOLDBLANKLINE
*          NOOLDCOPY
*          NOOLDINDEX
*          NOOLDNEXTSENTENCE
*          NOOLDREADINTO
*          NOOLDSTRMIX
*            OOCTRL"-C-E-G+L-P+Q+R-S+W"
*          NOOPTIONAL-FILE
*          NOOS390
*            OSEXT"cbl"
*          NOOSVS
*            OUTDD"SYSOUT 121 R"
*            P64
*          NOPANVALET
*            PANVALET-INCLUDES-IN-COMMENTS
*          NOPC1
*            PERFORM-TYPE"ENTCOBOL"
*          NOPREPLIST
*          NOPREPROCESS
*            PRESERVECASE
*          NOPRINT-EXT
*          NOPROFILE
*          NOPROGID-COMMENT
*          NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE
*            PROTOTYPE"RELAXED"
*            QUAL
*            QUALPROC
*          NOQUERY
*          NOQUOTE
*          NORAWLIST
*            RDW
*            RECMODE"ENTCOBOL"
*          NOREENTRANT
*          NOREF
*          NOREFNO
*            REMAINDER"2"
*            REPLACE"NOKEEPSEQ"
*            REPORT-LINE"256"
*            RESEQ
*          NORETRYLOCK
*            REWRITE-LS
*          NORM
*          NORM-FILE-ERRORS
*            RTNCODE-SIZE"2"
*            RTNCODE-TYPE"COMP"
*          NORWHARDPAGE
*          NOSAA
*          NOSEG
*          NOSEQCHK
*            SEQUENTIAL"RECORD"
*          NOSERIAL
*            SETTING"COL"
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page   5
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl
*          NOSHAREOUTDD
*          NOSHOW-DIR
*            SIGN"EBCDIC"
*            SIGN"TRAILING"
*          NOSIGNDISCARD
*          NOSIGNFIXUP
*            SORTTYPE"DFSORT"
*          NOSOURCEENCODING
*            SOURCEFORMAT"FIXED"
*            SOURCETABSTOP"4"
*          NOSPZERO
*          NOSSRANGE
*            STDERR
*            STICKY-LINKAGE"1"
*          NOSTICKY-PERFORM
*            SUPFF
*            SWITCHTYPE"1"
*            SYMBSTART"1"
*            SYSPUNCH"80"
*            TERMPAGE
*          NOTESTCOVER
*            TIME
*          NOTRACE
*          NOTRUNC
*            TRUNCCALLNAME"8"
*            TRUNCCOPY"8"
*            TRUNCINC"10"
*            UNICODE"PORTABLE"
*            VERBOSE
*          NOVISUALSTUDIO
*          NOVSC2
*          NOWARNASERROR
*            WARNING"3"
*            WEBSERVER"CGI"
*          NOWRITELOCK
*          NOWRITETHRU
*          NOXMLGEN
*            XMLPARSE"XMLSS"
*          NOXOPEN
*          NOXREF
*            ZEROLENGTHFALSE
*          NOZEROSEQ
*            ZWB
     1******************************************************************
     2* Program     : CORPT00C.CBL
     3* Application : CardDemo
     4* Type        : CICS COBOL Program
     5* Function    : Print Transaction reports by submitting batch
     6*               job from online using extra partition TDQ.
     7******************************************************************
     8 IDENTIFICATION DIVISION.
     9 PROGRAM-ID. CORPT00C.
    10 AUTHOR.     AWS.
    11
    12 ENVIRONMENT DIVISION.
    13 CONFIGURATION SECTION.
    14
    15 DATA DIVISION.
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page   6
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl
    16*----------------------------------------------------------------*
    17*                     WORKING STORAGE SECTION
    18*----------------------------------------------------------------*
    19 WORKING-STORAGE SECTION.
    20
    21 01 WS-VARIABLES.
    22   05 WS-PGMNAME                 PIC X(08) VALUE 'CORPT00C'.
    23   05 WS-TRANID                  PIC X(04) VALUE 'CR00'.
    24   05 WS-MESSAGE                 PIC X(80) VALUE SPACES.
    25   05 WS-TRANSACT-FILE             PIC X(08) VALUE 'TRANSACT'.
    26   05 WS-ERR-FLG                 PIC X(01) VALUE 'N'.
    27     88 ERR-FLG-ON                         VALUE 'Y'.
    28     88 ERR-FLG-OFF                        VALUE 'N'.
    29   05 WS-TRANSACT-EOF            PIC X(01) VALUE 'N'.
    30     88 TRANSACT-EOF                       VALUE 'Y'.
    31     88 TRANSACT-NOT-EOF                   VALUE 'N'.
    32   05 WS-SEND-ERASE-FLG          PIC X(01) VALUE 'Y'.
    33     88 SEND-ERASE-YES                     VALUE 'Y'.
    34     88 SEND-ERASE-NO                      VALUE 'N'.
    35   05 WS-END-LOOP                PIC X(01) VALUE 'N'.
    36     88 END-LOOP-YES                       VALUE 'Y'.
    37     88 END-LOOP-NO                        VALUE 'N'.
    38
    39   05 WS-RESP-CD                 PIC S9(09) COMP VALUE ZEROS.
    40   05 WS-REAS-CD                 PIC S9(09) COMP VALUE ZEROS.
    41   05 WS-REC-COUNT               PIC S9(04) COMP VALUE ZEROS.
    42   05 WS-IDX                     PIC S9(04) COMP VALUE ZEROS.
    43   05 WS-REPORT-NAME             PIC X(10) VALUE SPACES.
    44
    45   05 WS-START-DATE.
    46      10 WS-START-DATE-YYYY      PIC X(04) VALUE SPACES.
    47      10 FILLER                  PIC X(01) VALUE '-'.
    48      10 WS-START-DATE-MM        PIC X(02) VALUE SPACES.
    49      10 FILLER                  PIC X(01) VALUE '-'.
    50      10 WS-START-DATE-DD        PIC X(02) VALUE SPACES.
    51   05 WS-END-DATE.
    52      10 WS-END-DATE-YYYY        PIC X(04) VALUE SPACES.
    53      10 FILLER                  PIC X(01) VALUE '-'.
    54      10 WS-END-DATE-MM          PIC X(02) VALUE SPACES.
    55      10 FILLER                  PIC X(01) VALUE '-'.
    56      10 WS-END-DATE-DD          PIC X(02) VALUE SPACES.
    57   05 WS-DATE-FORMAT             PIC X(10) VALUE 'YYYY-MM-DD'.
    58
    59   05 WS-NUM-99                  PIC 99   VALUE 0.
    60   05 WS-NUM-9999                PIC 9999 VALUE 0.
    61
    62   05 WS-TRAN-AMT                PIC +99999999.99.
    63   05 WS-TRAN-DATE               PIC X(08) VALUE '00/00/00'.
    64   05 JCL-RECORD                 PIC X(80) VALUE ' '.
    65
    66 01 JOB-DATA.
    67  02 JOB-DATA-1.
    68   05 FILLER                     PIC X(80) VALUE
    69   "//TRNRPT00 JOB 'TRAN REPORT',CLASS=A,MSGCLASS=0,".
    70   05 FILLER                     PIC X(80) VALUE
    71   "// NOTIFY=&SYSUID".
    72   05 FILLER                     PIC X(80) VALUE
    73   "//*".
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page   7
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl
    74   05 FILLER                     PIC X(80) VALUE
    75   "//JOBLIB JCLLIB ORDER=('AWS.M2.CARDDEMO.PROC')".
    76   05 FILLER                     PIC X(80) VALUE
    77   "//*".
    78   05 FILLER                     PIC X(80) VALUE
    79   "//STEP10 EXEC PROC=TRANREPT".
    80   05 FILLER                     PIC X(80) VALUE
    81   "//*".
    82   05 FILLER                     PIC X(80) VALUE
    83   "//STEP05R.SYMNAMES DD *".
    84   05 FILLER                     PIC X(80) VALUE
    85   "TRAN-CARD-NUM,263,16,ZD".
    86   05 FILLER                     PIC X(80) VALUE
    87   "TRAN-PROC-DT,305,10,CH".
    88   05 FILLER-1.
    89      10 FILLER                  PIC X(18) VALUE
    90   "PARM-START-DATE,C'".
    91      10 PARM-START-DATE-1       PIC X(10) VALUE SPACES.
    92      10 FILLER                  PIC X(52) VALUE "'".
    93   05 FILLER-2.
    94      10 FILLER                  PIC X(16) VALUE
    95   "PARM-END-DATE,C'".
    96      10 PARM-END-DATE-1         PIC X(10) VALUE SPACES.
    97      10 FILLER                  PIC X(54) VALUE "'".
    98   05 FILLER                     PIC X(80) VALUE
    99   "/*".
   100   05 FILLER                     PIC X(80) VALUE
   101   "//STEP10R.DATEPARM DD *".
   102   05 FILLER-3.
   103      10 PARM-START-DATE-2       PIC X(10) VALUE SPACES.
   104      10 FILLER                  PIC X VALUE SPACE.
   105      10 PARM-END-DATE-2         PIC X(10) VALUE SPACES.
   106      10 FILLER                  PIC X(59) VALUE SPACES.
   107   05 FILLER                     PIC X(80) VALUE
   108   "/*".
   109   05 FILLER                     PIC X(80) VALUE
   110   "/*EOF".
   111  02 JOB-DATA-2 REDEFINES JOB-DATA-1.
   112   05 JOB-LINES OCCURS 17 TIMES PIC X(80).
   113
   114 01 CSUTLDTC-PARM.
   115    05 CSUTLDTC-DATE                   PIC X(10).
   116    05 CSUTLDTC-DATE-FORMAT            PIC X(10).
   117    05 CSUTLDTC-RESULT.
   118       10 CSUTLDTC-RESULT-SEV-CD       PIC X(04).
   119       10 FILLER                       PIC X(11).
   120       10 CSUTLDTC-RESULT-MSG-NUM      PIC X(04).
   121       10 CSUTLDTC-RESULT-MSG          PIC X(61).
   122
   123*COPY COCOM01Y.
   124******************************************************************
   125* Communication area for CardDemo application programs
   126******************************************************************
   127 01 CARDDEMO-COMMAREA.
   128    05 CDEMO-GENERAL-INFO.
   129       10 CDEMO-FROM-TRANID             PIC X(04).
   130       10 CDEMO-FROM-PROGRAM            PIC X(08).
   131       10 CDEMO-TO-TRANID               PIC X(04).
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page   8
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl (C:\CrossPlatformBuild\Card)
   132       10 CDEMO-TO-PROGRAM              PIC X(08).
   133       10 CDEMO-USER-ID                 PIC X(08).
   134       10 CDEMO-USER-TYPE               PIC X(01).
   135          88 CDEMO-USRTYP-ADMIN         VALUE 'A'.
   136          88 CDEMO-USRTYP-USER          VALUE 'U'.
   137       10 CDEMO-PGM-CONTEXT             PIC 9(01).
   138          88 CDEMO-PGM-ENTER            VALUE 0.
   139          88 CDEMO-PGM-REENTER          VALUE 1.
   140    05 CDEMO-CUSTOMER-INFO.
   141       10 CDEMO-CUST-ID                 PIC 9(09).
   142       10 CDEMO-CUST-FNAME              PIC X(25).
   143       10 CDEMO-CUST-MNAME              PIC X(25).
   144       10 CDEMO-CUST-LNAME              PIC X(25).
   145    05 CDEMO-ACCOUNT-INFO.
   146       10 CDEMO-ACCT-ID                 PIC 9(11).
   147       10 CDEMO-ACCT-STATUS             PIC X(01).
   148    05 CDEMO-CARD-INFO.
   149       10 CDEMO-CARD-NUM                PIC 9(16).
   150    05 CDEMO-MORE-INFO.
   151       10  CDEMO-LAST-MAP               PIC X(7).
   152       10  CDEMO-LAST-MAPSET            PIC X(7).
   153*
   154* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:57 CDT
   155*
   156
   157*COPY CORPT00.
   158*   Micro Focus COBOL 2017  7.0.00247
   159*   Micro Focus BMS Screen Painter
   160*   MapSet Name   CORPT00
   161*   Date Created  08/05/2022
   162*   Time Created  16:44:45
   163
   164*  Input Data For Map CORPT0A
   165   01 CORPT0AI.
   166      03 FILLER                         PIC X(12).
   167      03 TRNNAMEL                       PIC S9(4) COMP.
   168      03 TRNNAMEF                       PIC X.
   169      03 FILLER REDEFINES TRNNAMEF.
   170         05 TRNNAMEA                       PIC X.
   171      03 FILLER                         PIC X(4).
   172      03 TRNNAMEI                       PIC X(4).
   173      03 TITLE01L                       PIC S9(4) COMP.
   174      03 TITLE01F                       PIC X.
   175      03 FILLER REDEFINES TITLE01F.
   176         05 TITLE01A                       PIC X.
   177      03 FILLER                         PIC X(4).
   178      03 TITLE01I                       PIC X(40).
   179      03 CURDATEL                       PIC S9(4) COMP.
   180      03 CURDATEF                       PIC X.
   181      03 FILLER REDEFINES CURDATEF.
   182         05 CURDATEA                       PIC X.
   183      03 FILLER                         PIC X(4).
   184      03 CURDATEI                       PIC X(8).
   185      03 PGMNAMEL                       PIC S9(4) COMP.
   186      03 PGMNAMEF                       PIC X.
   187      03 FILLER REDEFINES PGMNAMEF.
   188         05 PGMNAMEA                       PIC X.
   189      03 FILLER                         PIC X(4).
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page   9
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl (C:\CrossPlatformBuild\Card)
   190      03 PGMNAMEI                       PIC X(8).
   191      03 TITLE02L                       PIC S9(4) COMP.
   192      03 TITLE02F                       PIC X.
   193      03 FILLER REDEFINES TITLE02F.
   194         05 TITLE02A                       PIC X.
   195      03 FILLER                         PIC X(4).
   196      03 TITLE02I                       PIC X(40).
   197      03 CURTIMEL                       PIC S9(4) COMP.
   198      03 CURTIMEF                       PIC X.
   199      03 FILLER REDEFINES CURTIMEF.
   200         05 CURTIMEA                       PIC X.
   201      03 FILLER                         PIC X(4).
   202      03 CURTIMEI                       PIC X(8).
   203      03 MONTHLYL                       PIC S9(4) COMP.
   204      03 MONTHLYF                       PIC X.
   205      03 FILLER REDEFINES MONTHLYF.
   206         05 MONTHLYA                       PIC X.
   207      03 FILLER                         PIC X(4).
   208      03 MONTHLYI                       PIC X(1).
   209      03 YEARLYL                        PIC S9(4) COMP.
   210      03 YEARLYF                        PIC X.
   211      03 FILLER REDEFINES YEARLYF.
   212         05 YEARLYA                        PIC X.
   213      03 FILLER                         PIC X(4).
   214      03 YEARLYI                        PIC X(1).
   215      03 CUSTOML                        PIC S9(4) COMP.
   216      03 CUSTOMF                        PIC X.
   217      03 FILLER REDEFINES CUSTOMF.
   218         05 CUSTOMA                        PIC X.
   219      03 FILLER                         PIC X(4).
   220      03 CUSTOMI                        PIC X(1).
   221      03 SDTMML                         PIC S9(4) COMP.
   222      03 SDTMMF                         PIC X.
   223      03 FILLER REDEFINES SDTMMF.
   224         05 SDTMMA                         PIC X.
   225      03 FILLER                         PIC X(4).
   226      03 SDTMMI                         PIC X(2).
   227      03 SDTDDL                         PIC S9(4) COMP.
   228      03 SDTDDF                         PIC X.
   229      03 FILLER REDEFINES SDTDDF.
   230         05 SDTDDA                         PIC X.
   231      03 FILLER                         PIC X(4).
   232      03 SDTDDI                         PIC X(2).
   233      03 SDTYYYYL                       PIC S9(4) COMP.
   234      03 SDTYYYYF                       PIC X.
   235      03 FILLER REDEFINES SDTYYYYF.
   236         05 SDTYYYYA                       PIC X.
   237      03 FILLER                         PIC X(4).
   238      03 SDTYYYYI                       PIC X(4).
   239      03 EDTMML                         PIC S9(4) COMP.
   240      03 EDTMMF                         PIC X.
   241      03 FILLER REDEFINES EDTMMF.
   242         05 EDTMMA                         PIC X.
   243      03 FILLER                         PIC X(4).
   244      03 EDTMMI                         PIC X(2).
   245      03 EDTDDL                         PIC S9(4) COMP.
   246      03 EDTDDF                         PIC X.
   247      03 FILLER REDEFINES EDTDDF.
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page  10
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl (C:\CrossPlatformBuild\Card)
   248         05 EDTDDA                         PIC X.
   249      03 FILLER                         PIC X(4).
   250      03 EDTDDI                         PIC X(2).
   251      03 EDTYYYYL                       PIC S9(4) COMP.
   252      03 EDTYYYYF                       PIC X.
   253      03 FILLER REDEFINES EDTYYYYF.
   254         05 EDTYYYYA                       PIC X.
   255      03 FILLER                         PIC X(4).
   256      03 EDTYYYYI                       PIC X(4).
   257      03 CONFIRML                       PIC S9(4) COMP.
   258      03 CONFIRMF                       PIC X.
   259      03 FILLER REDEFINES CONFIRMF.
   260         05 CONFIRMA                       PIC X.
   261      03 FILLER                         PIC X(4).
   262      03 CONFIRMI                       PIC X(1).
   263      03 ERRMSGL                        PIC S9(4) COMP.
   264      03 ERRMSGF                        PIC X.
   265      03 FILLER REDEFINES ERRMSGF.
   266         05 ERRMSGA                        PIC X.
   267      03 FILLER                         PIC X(4).
   268      03 ERRMSGI                        PIC X(78).
   269
   270*  Output Data For Map CORPT0A
   271   01 CORPT0AO REDEFINES CORPT0AI.
   272      03 FILLER                         PIC X(12).
   273      03 FILLER                         PIC X(3).
   274      03 TRNNAMEC                       PIC X.
   275      03 TRNNAMEP                       PIC X.
   276      03 TRNNAMEH                       PIC X.
   277      03 TRNNAMEV                       PIC X.
   278      03 TRNNAMEO                       PIC X(4).
   279      03 FILLER                         PIC X(3).
   280      03 TITLE01C                       PIC X.
   281      03 TITLE01P                       PIC X.
   282      03 TITLE01H                       PIC X.
   283      03 TITLE01V                       PIC X.
   284      03 TITLE01O                       PIC X(40).
   285      03 FILLER                         PIC X(3).
   286      03 CURDATEC                       PIC X.
   287      03 CURDATEP                       PIC X.
   288      03 CURDATEH                       PIC X.
   289      03 CURDATEV                       PIC X.
   290      03 CURDATEO                       PIC X(8).
   291      03 FILLER                         PIC X(3).
   292      03 PGMNAMEC                       PIC X.
   293      03 PGMNAMEP                       PIC X.
   294      03 PGMNAMEH                       PIC X.
   295      03 PGMNAMEV                       PIC X.
   296      03 PGMNAMEO                       PIC X(8).
   297      03 FILLER                         PIC X(3).
   298      03 TITLE02C                       PIC X.
   299      03 TITLE02P                       PIC X.
   300      03 TITLE02H                       PIC X.
   301      03 TITLE02V                       PIC X.
   302      03 TITLE02O                       PIC X(40).
   303      03 FILLER                         PIC X(3).
   304      03 CURTIMEC                       PIC X.
   305      03 CURTIMEP                       PIC X.
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page  11
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl (C:\CrossPlatformBuild\Card)
   306      03 CURTIMEH                       PIC X.
   307      03 CURTIMEV                       PIC X.
   308      03 CURTIMEO                       PIC X(8).
   309      03 FILLER                         PIC X(3).
   310      03 MONTHLYC                       PIC X.
   311      03 MONTHLYP                       PIC X.
   312      03 MONTHLYH                       PIC X.
   313      03 MONTHLYV                       PIC X.
   314      03 MONTHLYO                       PIC X(1).
   315      03 FILLER                         PIC X(3).
   316      03 YEARLYC                        PIC X.
   317      03 YEARLYP                        PIC X.
   318      03 YEARLYH                        PIC X.
   319      03 YEARLYV                        PIC X.
   320      03 YEARLYO                        PIC X(1).
   321      03 FILLER                         PIC X(3).
   322      03 CUSTOMC                        PIC X.
   323      03 CUSTOMP                        PIC X.
   324      03 CUSTOMH                        PIC X.
   325      03 CUSTOMV                        PIC X.
   326      03 CUSTOMO                        PIC X(1).
   327      03 FILLER                         PIC X(3).
   328      03 SDTMMC                         PIC X.
   329      03 SDTMMP                         PIC X.
   330      03 SDTMMH                         PIC X.
   331      03 SDTMMV                         PIC X.
   332      03 SDTMMO                         PIC X(2).
   333      03 FILLER                         PIC X(3).
   334      03 SDTDDC                         PIC X.
   335      03 SDTDDP                         PIC X.
   336      03 SDTDDH                         PIC X.
   337      03 SDTDDV                         PIC X.
   338      03 SDTDDO                         PIC X(2).
   339      03 FILLER                         PIC X(3).
   340      03 SDTYYYYC                       PIC X.
   341      03 SDTYYYYP                       PIC X.
   342      03 SDTYYYYH                       PIC X.
   343      03 SDTYYYYV                       PIC X.
   344      03 SDTYYYYO                       PIC X(4).
   345      03 FILLER                         PIC X(3).
   346      03 EDTMMC                         PIC X.
   347      03 EDTMMP                         PIC X.
   348      03 EDTMMH                         PIC X.
   349      03 EDTMMV                         PIC X.
   350      03 EDTMMO                         PIC X(2).
   351      03 FILLER                         PIC X(3).
   352      03 EDTDDC                         PIC X.
   353      03 EDTDDP                         PIC X.
   354      03 EDTDDH                         PIC X.
   355      03 EDTDDV                         PIC X.
   356      03 EDTDDO                         PIC X(2).
   357      03 FILLER                         PIC X(3).
   358      03 EDTYYYYC                       PIC X.
   359      03 EDTYYYYP                       PIC X.
   360      03 EDTYYYYH                       PIC X.
   361      03 EDTYYYYV                       PIC X.
   362      03 EDTYYYYO                       PIC X(4).
   363      03 FILLER                         PIC X(3).
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page  12
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl (C:\CrossPlatformBuild\Card)
   364      03 CONFIRMC                       PIC X.
   365      03 CONFIRMP                       PIC X.
   366      03 CONFIRMH                       PIC X.
   367      03 CONFIRMV                       PIC X.
   368      03 CONFIRMO                       PIC X(1).
   369      03 FILLER                         PIC X(3).
   370      03 ERRMSGC                        PIC X.
   371      03 ERRMSGP                        PIC X.
   372      03 ERRMSGH                        PIC X.
   373      03 ERRMSGV                        PIC X.
   374      03 ERRMSGO                        PIC X(78).
   375
   376
   377*COPY COTTL01Y.
   378 01 CCDA-SCREEN-TITLE.
   379   05 CCDA-TITLE01    PIC X(40) VALUE
   380      '      AWS Mainframe Modernization       '.
   381   05 CCDA-TITLE02    PIC X(40) VALUE
   382*     '  Credit Card Demo Application (CCDA)   '.
   383      '              CardDemo                  '.
   384   05 CCDA-THANK-YOU  PIC X(40) VALUE
   385      'Thank you for using CCDA application... '.
   386*
   387* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT
   388*
   389*COPY CSDAT01Y.
   390 01 WS-DATE-TIME.
   391   05 WS-CURDATE-DATA.
   392     10  WS-CURDATE.
   393       15  WS-CURDATE-YEAR         PIC 9(04).
   394       15  WS-CURDATE-MONTH        PIC 9(02).
   395       15  WS-CURDATE-DAY          PIC 9(02).
   396     10 WS-CURDATE-N REDEFINES WS-CURDATE PIC 9(08).
   397     10  WS-CURTIME.
   398       15  WS-CURTIME-HOURS        PIC 9(02).
   399       15  WS-CURTIME-MINUTE       PIC 9(02).
   400       15  WS-CURTIME-SECOND       PIC 9(02).
   401       15  WS-CURTIME-MILSEC       PIC 9(02).
   402     10 WS-CURTIME-N REDEFINES WS-CURTIME PIC 9(08).
   403   05 WS-CURDATE-MM-DD-YY.
   404     10  WS-CURDATE-MM             PIC 9(02).
   405     10  FILLER                    PIC X(01) VALUE '/'.
   406     10  WS-CURDATE-DD             PIC 9(02).
   407     10  FILLER                    PIC X(01) VALUE '/'.
   408     10  WS-CURDATE-YY             PIC 9(02).
   409   05 WS-CURTIME-HH-MM-SS.
   410     10  WS-CURTIME-HH             PIC 9(02).
   411     10  FILLER                    PIC X(01) VALUE ':'.
   412     10  WS-CURTIME-MM             PIC 9(02).
   413     10  FILLER                    PIC X(01) VALUE ':'.
   414     10  WS-CURTIME-SS             PIC 9(02).
   415   05 WS-TIMESTAMP.
   416     10  WS-TIMESTAMP-DT-YYYY      PIC 9(04).
   417     10  FILLER                    PIC X(01) VALUE '-'.
   418     10  WS-TIMESTAMP-DT-MM        PIC 9(02).
   419     10  FILLER                    PIC X(01) VALUE '-'.
   420     10  WS-TIMESTAMP-DT-DD        PIC 9(02).
   421     10  FILLER                    PIC X(01) VALUE ' '.
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page  13
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl (C:\CrossPlatformBuild\Card)
   422     10  WS-TIMESTAMP-TM-HH        PIC 9(02).
   423     10  FILLER                    PIC X(01) VALUE ':'.
   424     10  WS-TIMESTAMP-TM-MM        PIC 9(02).
   425     10  FILLER                    PIC X(01) VALUE ':'.
   426     10  WS-TIMESTAMP-TM-SS        PIC 9(02).
   427     10  FILLER                    PIC X(01) VALUE '.'.
   428     10  WS-TIMESTAMP-TM-MS6       PIC 9(06).
   429*
   430* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT
   431*
   432*COPY CSMSG01Y.
   433 01 CCDA-COMMON-MESSAGES.
   434   05 CCDA-MSG-THANK-YOU         PIC X(50) VALUE
   435        'Thank you for using CardDemo application...      '.
   436   05 CCDA-MSG-INVALID-KEY       PIC X(50) VALUE
   437        'Invalid key pressed. Please see below...         '.
   438*
   439* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:15:58 CDT
   440*
   441
   442*COPY CVTRA05Y.
   443*****************************************************************
   444*    Data-structure for TRANsaction record (RECLN = 350)
   445*****************************************************************
   446 01  TRAN-RECORD.
   447     05  TRAN-ID                                 PIC X(16).
   448     05  TRAN-TYPE-CD                            PIC X(02).
   449     05  TRAN-CAT-CD                             PIC 9(04).
   450     05  TRAN-SOURCE                             PIC X(10).
   451     05  TRAN-DESC                               PIC X(100).
   452     05  TRAN-AMT                                PIC S9(09)V99.
   453     05  TRAN-MERCHANT-ID                        PIC 9(09).
   454     05  TRAN-MERCHANT-NAME                      PIC X(50).
   455     05  TRAN-MERCHANT-CITY                      PIC X(50).
   456     05  TRAN-MERCHANT-ZIP                       PIC X(10).
   457     05  TRAN-CARD-NUM                           PIC X(16).
   458     05  TRAN-ORIG-TS                            PIC X(26).
   459     05  TRAN-PROC-TS                            PIC X(26).
   460     05  FILLER                                  PIC X(20).
   461*
   462* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:16:01 CDT
   463*
   464
   465*COPY DFHAID.
   466*<CR_TAG_DEMO_BEGIN>
   467*
   468*  Copyright (C) 2023 Micro Focus or one of its affiliates.
   469*  All rights reserved.
   470*
   471*  This sample code is supplied for demonstration purposes only
   472*  on an "as is" basis and "is for use at your own risk".
   473*
   474*<CR_TAG_DEMO_END>
   475*----------------------------------------------------------------*
   476* dfhaid.cpy
   477*----------------------------------------------------------------*
   478 01  DFHAID.
   479     02  DFHNULL         PIC X   VALUE IS LOW-VALUE.
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page  14
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl ("C:\Program)
   480     02  DFHENTER        PIC X   VALUE IS ''''.
   481     02  DFHCLEAR        PIC X   VALUE IS '_'.
   482     02  DFHPEN          PIC X   VALUE IS '='.
   483     02  DFHOPID         PIC X   VALUE IS 'W'.
   484     02  DFHMSRE         PIC X   VALUE IS 'X'.
   485     02  DFHSTRF         PIC X   VALUE IS ' '.
   486     02  DFHTRIG         PIC X   VALUE IS '"'.
   487     02  DFHPA1          PIC X   VALUE IS '%'.
   488     02  DFHPA2          PIC X   VALUE IS '>'.
   489     02  DFHPA3          PIC X   VALUE IS ','.
   490     02  DFHPF1          PIC X   VALUE IS '1'.
   491     02  DFHPF2          PIC X   VALUE IS '2'.
   492     02  DFHPF3          PIC X   VALUE IS '3'.
   493     02  DFHPF4          PIC X   VALUE IS '4'.
   494     02  DFHPF5          PIC X   VALUE IS '5'.
   495     02  DFHPF6          PIC X   VALUE IS '6'.
   496     02  DFHPF7          PIC X   VALUE IS '7'.
   497     02  DFHPF8          PIC X   VALUE IS '8'.
   498     02  DFHPF9          PIC X   VALUE IS '9'.
   499     02  DFHPF10         PIC X   VALUE IS ':'.
   500     02  DFHPF11         PIC X   VALUE IS '#'.
   501     02  DFHPF12         PIC X   VALUE IS '@'.
   502     02  DFHPF13         PIC X   VALUE IS 'A'.
   503     02  DFHPF14         PIC X   VALUE IS 'B'.
   504     02  DFHPF15         PIC X   VALUE IS 'C'.
   505     02  DFHPF16         PIC X   VALUE IS 'D'.
   506     02  DFHPF17         PIC X   VALUE IS 'E'.
   507     02  DFHPF18         PIC X   VALUE IS 'F'.
   508     02  DFHPF19         PIC X   VALUE IS 'G'.
   509     02  DFHPF20         PIC X   VALUE IS 'H'.
   510     02  DFHPF21         PIC X   VALUE IS 'I'.
   511     02  DFHPF22         PIC X   VALUE IS ' '.
   512*    Note: CICS ECM alters the line above to...
   513*          Value for ASCII  is X'5B'
   514*          Value for EBCDIC is X'4A'
   515     02  DFHPF23         PIC X   VALUE IS '.'.
   516     02  DFHPF24         PIC X   VALUE IS '<'.
   517*----------------------------------------------------------------*
   518* dfhaid.cpy end
   519*----------------------------------------------------------------*
   520*COPY DFHBMSCA.
   521*----------------------------------------------------------------*
   522* dfhbmsca.cpy
   523*<CR_TAG_DEMO_BEGIN>
   524*
   525*  Copyright (C) 2023 Micro Focus or one of its affiliates.
   526*  All rights reserved.
   527*
   528*  This sample code is supplied for demonstration purposes only
   529*  on an "as is" basis and "is for use at your own risk".
   530*
   531*<CR_TAG_DEMO_END>
   532***---------------------------------------------------------*
   533***CONTROL BLOCK NAME= DFHBMSCA                             *
   534***                                                         *
   535***NAME OF MATCHING ASSEMBLER CONTROL BLOCK = NONE          *
   536***                                                         *
   537***DESCRIPTIVE NAME = 3270 ATTRIBUTE VALUES                 *
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page  15
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl ("C:\Program)
   538***                                                         *
   539***FUNCTION =  Provides the values for 3270 attribute bytes *
   540***            used by the BMS support.                     *
   541***                                                         *
   542***---------------------------------------------------------*
   543 01      DFHBMSCA.
   544*                                               X'1915'.
   545   02    DFHBMPEM-BIN  PICTURE 9(4) COMP VALUE IS 6421.
   546   02    FILLER REDEFINES DFHBMPEM-BIN.
   547     03  DFHBMPEM  PICTURE X.
   548     03  DFHBMPNL  PICTURE X.
   549*                                               X'0C0D'.
   550   02    DFHBMPFF-BIN  PICTURE 9(4) COMP VALUE IS 3085.
   551   02    FILLER REDEFINES DFHBMPFF-BIN.
   552     03  DFHBMPFF  PICTURE X.
   553     03  DFHBMPCR  PICTURE X.
   554   02    DFHBMASK  PICTURE X   VALUE  IS  '0'.
   555   02    DFHBMUNP  PICTURE X   VALUE  IS  ' '.
   556   02    DFHBMUNN  PICTURE X   VALUE  IS  '&'.
   557   02    DFHBMPRO  PICTURE X   VALUE  IS  '-'.
   558   02    DFHBMBRY  PICTURE X   VALUE  IS  'H'.
   559   02    DFHBMDAR  PICTURE X   VALUE  IS  '<'.
   560   02    DFHBMFSE  PICTURE X   VALUE  IS  'A'.
   561   02    DFHBMPRF  PICTURE X   VALUE  IS  '/'.
   562   02    DFHBMASF  PICTURE X   VALUE  IS  '1'.
   563   02    DFHBMASB  PICTURE X   VALUE  IS  '8'.
   564*                                               X'0E0F'.
   565   02    DFHBMPSO-BIN  PICTURE 9(4) COMP VALUE IS 3599.
   566   02    FILLER REDEFINES DFHBMPSO-BIN.
   567     03  DFHBMPSO  PICTURE X.
   568     03  DFHBMPSI  PICTURE X.
   569*                                               X'0080'.
   570   02    DFHBMEOF-BIN  PICTURE 9(4) COMP VALUE IS 128.
   571   02    FILLER REDEFINES DFHBMEOF-BIN.
   572     03  FILLER    PICTURE X.
   573     03  DFHBMEOF  PICTURE X.
   574*                                               X'0282'.
   575   02    DFHBMCUR-BIN  PICTURE 9(4) COMP VALUE IS 642.
   576   02    FILLER REDEFINES DFHBMCUR-BIN.
   577     03  DFHBMCUR  PICTURE X.
   578     03  DFHBMEC   PICTURE X.
   579*                                               X'0082'.
   580   02    DFHBMFLG-BIN  PICTURE 9(4) COMP VALUE IS 130.
   581       88    DFHERASE VALUES ARE 128, 130.
   582       88    DFHCURSR VALUES ARE   2, 130.
   583   02    FILLER REDEFINES DFHBMFLG-BIN.
   584     03  FILLER    PICTURE X.
   585     03  DFHBMFLG  PICTURE X.
   586   02    DFHBMDET  PICTURE X   VALUE  IS  HIGH-VALUES.
   587   02    FILLER    PICTURE X.
   588*                                               X'0028'.
   589   02    DFHSA-BIN  PICTURE 9(4) COMP VALUE IS 40.
   590   02    FILLER REDEFINES DFHSA-BIN.
   591     03  FILLER    PICTURE X.
   592     03  DFHSA     PICTURE X.
   593*                                               X'003F'.
   594   02    DFHERROR-BIN  PICTURE 9(4) COMP VALUE IS 63.
   595   02    FILLER REDEFINES DFHERROR-BIN.
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page  16
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl ("C:\Program)
   596     03  FILLER    PICTURE X.
   597     03  DFHERROR  PICTURE X.
   598*                                               X'0042'.
   599   02    DFHCOLOR-BIN  PICTURE 9(4) COMP VALUE IS 66.
   600   02    FILLER REDEFINES DFHCOLOR-BIN.
   601     03  FILLER    PICTURE X.
   602     03  DFHCOLOR  PICTURE X.
   603*                                               X'0043'.
   604   02    DFHPS-BIN  PICTURE 9(4) COMP VALUE IS 67.
   605   02    FILLER REDEFINES DFHPS-BIN.
   606     03  FILLER    PICTURE X.
   607     03  DFHPS     PICTURE X.
   608*                                               X'0041'.
   609   02    DFHHLT-BIN  PICTURE 9(4) COMP VALUE IS 65.
   610   02    FILLER REDEFINES DFHHLT-BIN.
   611     03  FILLER    PICTURE X.
   612     03  DFHHLT    PICTURE X.
   613*                                               X'00C0'.
   614   02    DFH3270-BIN   PICTURE 9(4) COMP VALUE IS 192.
   615   02    FILLER REDEFINES DFH3270-BIN.
   616     03  FILLER    PICTURE X.
   617     03  DFH3270   PICTURE X.
   618   02    DFHVAL    PICTURE X   VALUE  IS  'A'.
   619   02    DFHOUTLN  PICTURE X   VALUE  IS  'B'.
   620*                                               X'0046'.
   621   02    DFHBKTRN-BIN  PICTURE 9(4) COMP VALUE IS 70.
   622   02    FILLER REDEFINES DFHBKTRN-BIN.
   623     03  FILLER    PICTURE X.
   624     03  DFHBKTRN  PICTURE X.
   625   02    DFHALL    PICTURE X   VALUE  IS  LOW-VALUES.
   626   02    DFHDFT    PICTURE X   VALUE  IS  HIGH-VALUES.
   627   02    DFHDFCOL  PICTURE X   VALUE  IS  LOW-VALUES.
   628   02    DFHBLUE   PICTURE X   VALUE  IS  '1'.
   629   02    DFHRED    PICTURE X   VALUE  IS  '2'.
   630   02    DFHPINK   PICTURE X   VALUE  IS  '3'.
   631   02    DFHGREEN  PICTURE X   VALUE  IS  '4'.
   632   02    DFHTURQ   PICTURE X   VALUE  IS  '5'.
   633   02    DFHYELLO  PICTURE X   VALUE  IS  '6'.
   634   02    DFHNEUTR  PICTURE X   VALUE  IS  '7'.
   635   02    DFHBASE   PICTURE X   VALUE  IS  LOW-VALUES.
   636   02    DFHDFHI   PICTURE X   VALUE  IS  LOW-VALUES.
   637   02    DFHBLINK  PICTURE X   VALUE  IS  '1'.
   638   02    DFHREVRS  PICTURE X   VALUE  IS  '2'.
   639   02    DFHUNDLN  PICTURE X   VALUE  IS  '4'.
   640*                                               X'0402'.
   641   02    DFHMFIL-BIN  PICTURE 9(4) COMP VALUE IS 1026.
   642   02    FILLER REDEFINES DFHMFIL-BIN.
   643     03  DFHMFIL   PICTURE X.
   644     03  DFHMENT   PICTURE X.
   645*                                               X'0601'.
   646   02    DFHMFE-BIN  PICTURE 9(4) COMP VALUE IS 1537.
   647   02    FILLER REDEFINES DFHMFE-BIN.
   648     03  DFHMFE    PICTURE X.
   649     03  DFHMT     PICTURE X.
   650*                                               X'0503'.
   651   02    DFHMFT-BIN  PICTURE 9(4) COMP VALUE IS 1283.
   652   02    FILLER REDEFINES DFHMFT-BIN.
   653     03  DFHMFT    PICTURE X.
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page  17
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl ("C:\Program)
   654     03  DFHMET    PICTURE X.
   655*                                               X'0007'.
   656   02    DFHMFET-BIN  PICTURE 9(4) COMP VALUE IS 7.
   657   02    FILLER REDEFINES DFHMFET-BIN.
   658     03  FILLER    PICTURE X.
   659     03  DFHMFET   PICTURE X.
   660   02    DFHUNNOD  PICTURE X   VALUE  IS  '('.
   661   02    DFHUNIMD  PICTURE X   VALUE  IS  'I'.
   662   02    DFHUNNUM  PICTURE X   VALUE  IS  'J'.
   663   02    DFHUNNUB  PICTURE X   VALUE  IS  'Q'.
   664   02    DFHUNINT  PICTURE X   VALUE  IS  'R'.
   665   02    DFHUNNON  PICTURE X   VALUE  IS  ')'.
   666   02    DFHPROTI  PICTURE X   VALUE  IS  'Y'.
   667   02    DFHPROTN  PICTURE X   VALUE  IS  '%'.
   668   02    DFHDFFR   PICTURE X   VALUE  IS  LOW-VALUES.
   669*                                               X'0102'.
   670   02    DFHUNDER-BIN  PICTURE 9(4) COMP VALUE IS 258.
   671   02    FILLER REDEFINES DFHUNDER-BIN.
   672     03  DFHUNDER  PICTURE X.
   673     03  DFHRIGHT  PICTURE X.
   674*                                               X'0408'.
   675   02    DFHOVER-BIN  PICTURE 9(4) COMP VALUE IS 1032.
   676   02    FILLER REDEFINES DFHOVER-BIN.
   677     03  DFHOVER   PICTURE X.
   678     03  DFHLEFT   PICTURE X.
   679*                                               X'000F'.
   680   02    DFHBOX-BIN   PICTURE 9(4) COMP VALUE IS 15.
   681   02    FILLER REDEFINES DFHBOX-BIN.
   682     03  FILLER    PICTURE X.
   683     03  DFHBOX    PICTURE X.
   684*                                               X'0001'.
   685   02    DFHSOSI-BIN  PICTURE 9(4) COMP VALUE IS 1.
   686   02    FILLER REDEFINES DFHSOSI-BIN.
   687     03  FILLER    PICTURE X.
   688     03  DFHSOSI   PICTURE X.
   689   02    DFHTRANS  PICTURE X   VALUE  IS  '0'.
   690   02    DFHOPAQ   PICTURE X   VALUE  IS  HIGH-VALUES.
   691*----------------------------------------------------------------*
   692* dfhbmsca.cpy end
   693*----------------------------------------------------------------*
   694
   695*----------------------------------------------------------------*
   696*                        LINKAGE SECTION
   697*----------------------------------------------------------------*
   698 LINKAGE SECTION.
   699 01  DFHCOMMAREA.
   700   05  LK-COMMAREA                           PIC X(01)
   701       OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.
   702
   703*----------------------------------------------------------------*
   704*                       PROCEDURE DIVISION
   705*----------------------------------------------------------------*
   706 PROCEDURE DIVISION.
   707 MAIN-PARA.
   708
   709     SET ERR-FLG-OFF TO TRUE
   710     SET TRANSACT-NOT-EOF TO TRUE
   711     SET SEND-ERASE-YES TO TRUE
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page  18
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl
   712
   713     MOVE SPACES TO WS-MESSAGE
   714                    ERRMSGO OF CORPT0AO
   715
   716     IF EIBCALEN = 0
   717         MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM
   718         PERFORM RETURN-TO-PREV-SCREEN
   719     ELSE
   720         MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA
   721         IF NOT CDEMO-PGM-REENTER
   722             SET CDEMO-PGM-REENTER    TO TRUE
   723             MOVE LOW-VALUES          TO CORPT0AO
   724             MOVE -1       TO MONTHLYL OF CORPT0AI
   725             PERFORM SEND-TRNRPT-SCREEN
   726         ELSE
   727             PERFORM RECEIVE-TRNRPT-SCREEN
   728             EVALUATE EIBAID
   729                 WHEN DFHENTER
   730                     PERFORM PROCESS-ENTER-KEY
   731                 WHEN DFHPF3
   732                     MOVE 'COMEN01C' TO CDEMO-TO-PROGRAM
   733                     PERFORM RETURN-TO-PREV-SCREEN
   734                 WHEN OTHER
   735                     MOVE 'Y'                       TO WS-ERR-FLG
   736                     MOVE -1       TO MONTHLYL OF CORPT0AI
   737                     MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE
   738                     PERFORM SEND-TRNRPT-SCREEN
   739             END-EVALUATE
   740         END-IF
   741     END-IF
   742
   743     EXEC CICS RETURN
   744               TRANSID (WS-TRANID)
   745               COMMAREA (CARDDEMO-COMMAREA)
   746     END-EXEC.
   747
   748
   749*----------------------------------------------------------------*
   750*                      PROCESS-ENTER-KEY
   751*----------------------------------------------------------------*
   752 PROCESS-ENTER-KEY.
   753
   754     DISPLAY 'PROCESS ENTER KEY'
   755
   756     EVALUATE TRUE
   757         WHEN MONTHLYI OF CORPT0AI NOT = SPACES AND LOW-VALUES
   758             MOVE 'Monthly'   TO WS-REPORT-NAME
   759             MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA
   760
   761             MOVE WS-CURDATE-YEAR     TO WS-START-DATE-YYYY
   762             MOVE WS-CURDATE-MONTH    TO WS-START-DATE-MM
   763             MOVE '01'                TO WS-START-DATE-DD
   764             MOVE WS-START-DATE       TO PARM-START-DATE-1
   765                                         PARM-START-DATE-2
   766
   767             MOVE 1              TO WS-CURDATE-DAY
   768             ADD 1               TO WS-CURDATE-MONTH
   769             IF WS-CURDATE-MONTH > 12
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page  19
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl
   770                 ADD 1           TO WS-CURDATE-YEAR
   771                 MOVE 1          TO WS-CURDATE-MONTH
   772             END-IF
   773             COMPUTE WS-CURDATE-N = FUNCTION DATE-OF-INTEGER(
   774                     FUNCTION INTEGER-OF-DATE(WS-CURDATE-N) - 1)
   775
   776             MOVE WS-CURDATE-YEAR     TO WS-END-DATE-YYYY
   777             MOVE WS-CURDATE-MONTH    TO WS-END-DATE-MM
   778             MOVE WS-CURDATE-DAY      TO WS-END-DATE-DD
   779             MOVE WS-END-DATE         TO PARM-END-DATE-1
   780                                         PARM-END-DATE-2
   781
   782             PERFORM SUBMIT-JOB-TO-INTRDR
   783         WHEN YEARLYI OF CORPT0AI NOT = SPACES AND LOW-VALUES
   784             MOVE 'Yearly'   TO WS-REPORT-NAME
   785             MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA
   786
   787             MOVE WS-CURDATE-YEAR     TO WS-START-DATE-YYYY
   788                                         WS-END-DATE-YYYY
   789             MOVE '01'                TO WS-START-DATE-MM
   790                                         WS-START-DATE-DD
   791             MOVE WS-START-DATE       TO PARM-START-DATE-1
   792                                         PARM-START-DATE-2
   793
   794             MOVE '12'                TO WS-END-DATE-MM
   795             MOVE '31'                TO WS-END-DATE-DD
   796             MOVE WS-END-DATE         TO PARM-END-DATE-1
   797                                         PARM-END-DATE-2
   798
   799             PERFORM SUBMIT-JOB-TO-INTRDR
   800         WHEN CUSTOMI OF CORPT0AI NOT = SPACES AND LOW-VALUES
   801
   802             EVALUATE TRUE
   803                 WHEN SDTMMI OF CORPT0AI = SPACES OR
   804                                             LOW-VALUES
   805                     MOVE 'Start Date - Month can NOT be empty...'
   806                       TO WS-MESSAGE
   807                     MOVE 'Y'     TO WS-ERR-FLG
   808                     MOVE -1       TO SDTMML OF CORPT0AI
   809                     PERFORM SEND-TRNRPT-SCREEN
   810                 WHEN SDTDDI OF CORPT0AI = SPACES OR
   811                                             LOW-VALUES
   812                     MOVE 'Start Date - Day can NOT be empty...'
   813                       TO WS-MESSAGE
   814                     MOVE 'Y'     TO WS-ERR-FLG
   815                     MOVE -1       TO SDTDDL OF CORPT0AI
   816                     PERFORM SEND-TRNRPT-SCREEN
   817                 WHEN SDTYYYYI OF CORPT0AI = SPACES OR
   818                                             LOW-VALUES
   819                     MOVE 'Start Date - Year can NOT be empty...'
   820                       TO WS-MESSAGE
   821                     MOVE 'Y'     TO WS-ERR-FLG
   822                     MOVE -1       TO SDTYYYYL OF CORPT0AI
   823                     PERFORM SEND-TRNRPT-SCREEN
   824                 WHEN EDTMMI OF CORPT0AI = SPACES OR
   825                                             LOW-VALUES
   826                     MOVE 'End Date - Month can NOT be empty...'
   827                       TO WS-MESSAGE
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page  20
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl
   828                     MOVE 'Y'     TO WS-ERR-FLG
   829                     MOVE -1       TO EDTMML OF CORPT0AI
   830                     PERFORM SEND-TRNRPT-SCREEN
   831                 WHEN EDTDDI OF CORPT0AI = SPACES OR
   832                                             LOW-VALUES
   833                     MOVE 'End Date - Day can NOT be empty...'
   834                       TO WS-MESSAGE
   835                     MOVE 'Y'     TO WS-ERR-FLG
   836                     MOVE -1       TO EDTDDL OF CORPT0AI
   837                     PERFORM SEND-TRNRPT-SCREEN
   838                 WHEN EDTYYYYI OF CORPT0AI = SPACES OR
   839                                             LOW-VALUES
   840                     MOVE 'End Date - Year can NOT be empty...'
   841                       TO WS-MESSAGE
   842                     MOVE 'Y'     TO WS-ERR-FLG
   843                     MOVE -1       TO EDTYYYYL OF CORPT0AI
   844                     PERFORM SEND-TRNRPT-SCREEN
   845                 WHEN OTHER
   846                     CONTINUE
   847             END-EVALUATE
   848
   849             COMPUTE WS-NUM-99 = FUNCTION NUMVAL-C
   850                                   (SDTMMI OF CORPT0AI)
   851             MOVE WS-NUM-99      TO SDTMMI OF CORPT0AI
   852
   853             COMPUTE WS-NUM-99 = FUNCTION NUMVAL-C
   854                                   (SDTDDI OF CORPT0AI)
   855             MOVE WS-NUM-99      TO SDTDDI OF CORPT0AI
   856
   857             COMPUTE WS-NUM-9999 = FUNCTION NUMVAL-C
   858                                     (SDTYYYYI OF CORPT0AI)
   859             MOVE WS-NUM-9999      TO SDTYYYYI OF CORPT0AI
   860
   861             COMPUTE WS-NUM-99 = FUNCTION NUMVAL-C
   862                                   (EDTMMI OF CORPT0AI)
   863             MOVE WS-NUM-99      TO EDTMMI OF CORPT0AI
   864
   865             COMPUTE WS-NUM-99 = FUNCTION NUMVAL-C
   866                                   (EDTDDI OF CORPT0AI)
   867             MOVE WS-NUM-99      TO EDTDDI OF CORPT0AI
   868
   869             COMPUTE WS-NUM-9999 = FUNCTION NUMVAL-C
   870                                     (EDTYYYYI OF CORPT0AI)
   871             MOVE WS-NUM-9999      TO EDTYYYYI OF CORPT0AI
   872
   873             IF SDTMMI OF CORPT0AI IS NOT NUMERIC OR
   874                SDTMMI OF CORPT0AI > '12'
   875                 MOVE 'Start Date - Not a valid Month...'
   876                   TO WS-MESSAGE
   877                 MOVE 'Y'     TO WS-ERR-FLG
   878                 MOVE -1       TO SDTMML OF CORPT0AI
   879                 PERFORM SEND-TRNRPT-SCREEN
   880             END-IF
   881
   882             IF SDTDDI OF CORPT0AI IS NOT NUMERIC OR
   883                SDTDDI OF CORPT0AI > '31'
   884                 MOVE 'Start Date - Not a valid Day...'
   885                   TO WS-MESSAGE
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page  21
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl
   886                 MOVE 'Y'     TO WS-ERR-FLG
   887                 MOVE -1       TO SDTDDL OF CORPT0AI
   888                 PERFORM SEND-TRNRPT-SCREEN
   889             END-IF
   890
   891             IF SDTYYYYI OF CORPT0AI IS NOT NUMERIC
   892                 MOVE 'Start Date - Not a valid Year...'
   893                   TO WS-MESSAGE
   894                 MOVE 'Y'     TO WS-ERR-FLG
   895                 MOVE -1       TO SDTYYYYL OF CORPT0AI
   896                 PERFORM SEND-TRNRPT-SCREEN
   897             END-IF
   898
   899             IF EDTMMI OF CORPT0AI IS NOT NUMERIC OR
   900                EDTMMI OF CORPT0AI > '12'
   901                 MOVE 'End Date - Not a valid Month...'
   902                   TO WS-MESSAGE
   903                 MOVE 'Y'     TO WS-ERR-FLG
   904                 MOVE -1       TO EDTMML OF CORPT0AI
   905                 PERFORM SEND-TRNRPT-SCREEN
   906             END-IF
   907
   908             IF EDTDDI OF CORPT0AI IS NOT NUMERIC OR
   909                EDTDDI OF CORPT0AI > '31'
   910                 MOVE 'End Date - Not a valid Day...'
   911                   TO WS-MESSAGE
   912                 MOVE 'Y'     TO WS-ERR-FLG
   913                 MOVE -1       TO EDTDDL OF CORPT0AI
   914                 PERFORM SEND-TRNRPT-SCREEN
   915             END-IF
   916
   917             IF EDTYYYYI OF CORPT0AI IS NOT NUMERIC
   918                 MOVE 'End Date - Not a valid Year...'
   919                   TO WS-MESSAGE
   920                 MOVE 'Y'     TO WS-ERR-FLG
   921                 MOVE -1       TO EDTYYYYL OF CORPT0AI
   922                 PERFORM SEND-TRNRPT-SCREEN
   923             END-IF
   924
   925             MOVE SDTYYYYI OF CORPT0AI TO WS-START-DATE-YYYY
   926             MOVE SDTMMI   OF CORPT0AI TO WS-START-DATE-MM
   927             MOVE SDTDDI   OF CORPT0AI TO WS-START-DATE-DD
   928             MOVE EDTYYYYI OF CORPT0AI TO WS-END-DATE-YYYY
   929             MOVE EDTMMI   OF CORPT0AI TO WS-END-DATE-MM
   930             MOVE EDTDDI   OF CORPT0AI TO WS-END-DATE-DD
   931
   932             MOVE WS-START-DATE        TO CSUTLDTC-DATE
   933             MOVE WS-DATE-FORMAT       TO CSUTLDTC-DATE-FORMAT
   934             MOVE SPACES               TO CSUTLDTC-RESULT
   935
   936             CALL 'CSUTLDTC' USING   CSUTLDTC-DATE
   937                                     CSUTLDTC-DATE-FORMAT
   938                                     CSUTLDTC-RESULT
   939
   940             IF CSUTLDTC-RESULT-SEV-CD = '0000'
   941                 CONTINUE
   942             ELSE
   943                 IF CSUTLDTC-RESULT-MSG-NUM NOT = '2513'
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page  22
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl
   944                     MOVE 'Start Date - Not a valid date...'
   945                       TO WS-MESSAGE
   946                     MOVE 'Y'     TO WS-ERR-FLG
   947                     MOVE -1       TO SDTMML OF CORPT0AI
   948                     PERFORM SEND-TRNRPT-SCREEN
   949                 END-IF
   950             END-IF
   951
   952             MOVE WS-END-DATE          TO CSUTLDTC-DATE
   953             MOVE WS-DATE-FORMAT       TO CSUTLDTC-DATE-FORMAT
   954             MOVE SPACES               TO CSUTLDTC-RESULT
   955
   956             CALL 'CSUTLDTC' USING   CSUTLDTC-DATE
   957                                     CSUTLDTC-DATE-FORMAT
   958                                     CSUTLDTC-RESULT
   959
   960             IF CSUTLDTC-RESULT-SEV-CD = '0000'
   961                 CONTINUE
   962             ELSE
   963                 IF CSUTLDTC-RESULT-MSG-NUM NOT = '2513'
   964                     MOVE 'End Date - Not a valid date...'
   965                       TO WS-MESSAGE
   966                     MOVE 'Y'     TO WS-ERR-FLG
   967                     MOVE -1       TO EDTMML OF CORPT0AI
   968                     PERFORM SEND-TRNRPT-SCREEN
   969                 END-IF
   970             END-IF
   971
   972
   973             MOVE WS-START-DATE       TO PARM-START-DATE-1
   974                                         PARM-START-DATE-2
   975             MOVE WS-END-DATE         TO PARM-END-DATE-1
   976                                         PARM-END-DATE-2
   977             MOVE 'Custom'   TO WS-REPORT-NAME
   978             IF NOT ERR-FLG-ON
   979                 PERFORM SUBMIT-JOB-TO-INTRDR
   980             END-IF
   981         WHEN OTHER
   982             MOVE 'Select a report type to print report...' TO
   983                             WS-MESSAGE
   984             MOVE 'Y'     TO WS-ERR-FLG
   985             MOVE -1       TO MONTHLYL OF CORPT0AI
   986             PERFORM SEND-TRNRPT-SCREEN
   987     END-EVALUATE
   988
   989     IF NOT ERR-FLG-ON
   990
   991         PERFORM INITIALIZE-ALL-FIELDS
   992         MOVE DFHGREEN           TO ERRMSGC  OF CORPT0AO
   993         STRING WS-REPORT-NAME   DELIMITED BY SPACE
   994           ' report submitted for printing ...'
   995                                 DELIMITED BY SIZE
   996           INTO WS-MESSAGE
   997         MOVE -1       TO MONTHLYL OF CORPT0AI
   998         PERFORM SEND-TRNRPT-SCREEN
   999
  1000     END-IF.
  1001
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page  23
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl
  1002
  1003*----------------------------------------------------------------*
  1004*                      SUBMIT-JOB-TO-INTRDR
  1005*----------------------------------------------------------------*
  1006 SUBMIT-JOB-TO-INTRDR.
  1007
  1008     IF CONFIRMI OF CORPT0AI = SPACES OR LOW-VALUES
  1009         STRING
  1010           'Please confirm to print the '
  1011                             DELIMITED BY SIZE
  1012           WS-REPORT-NAME    DELIMITED BY SPACE
  1013           ' report...'      DELIMITED BY SIZE
  1014           INTO WS-MESSAGE
  1015         MOVE 'Y'     TO WS-ERR-FLG
  1016         MOVE -1       TO CONFIRML OF CORPT0AI
  1017         PERFORM SEND-TRNRPT-SCREEN
  1018     END-IF
  1019
  1020     IF NOT ERR-FLG-ON
  1021         EVALUATE TRUE
  1022             WHEN CONFIRMI OF CORPT0AI = 'Y' OR 'y'
  1023                 CONTINUE
  1024             WHEN CONFIRMI OF CORPT0AI = 'N' OR 'n'
  1025                 PERFORM INITIALIZE-ALL-FIELDS
  1026                 MOVE 'Y'     TO WS-ERR-FLG
  1027                 PERFORM SEND-TRNRPT-SCREEN
  1028             WHEN OTHER
  1029                 STRING
  1030                   '"'               DELIMITED BY SIZE
  1031                   CONFIRMI OF CORPT0AI    DELIMITED BY SPACE
  1032                   '" is not a valid value to confirm...'
  1033                                     DELIMITED BY SIZE
  1034                   INTO WS-MESSAGE
  1035                 MOVE 'Y'     TO WS-ERR-FLG
  1036                 MOVE -1       TO CONFIRML OF CORPT0AI
  1037                 PERFORM SEND-TRNRPT-SCREEN
  1038         END-EVALUATE
  1039
  1040         SET END-LOOP-NO TO TRUE
  1041
  1042         PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL WS-IDX > 1000 OR
  1043                                END-LOOP-YES  OR ERR-FLG-ON
  1044
  1045             MOVE JOB-LINES(WS-IDX) TO JCL-RECORD
  1046             IF JCL-RECORD = '/*EOF' OR
  1047                JCL-RECORD = SPACES OR LOW-VALUES
  1048                 SET END-LOOP-YES TO TRUE
  1049             END-IF
  1050
  1051             PERFORM WIRTE-JOBSUB-TDQ
  1052         END-PERFORM
  1053
  1054     END-IF.
  1055
  1056*----------------------------------------------------------------*
  1057*                      WIRTE-JOBSUB-TDQ
  1058*----------------------------------------------------------------*
  1059 WIRTE-JOBSUB-TDQ.
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page  24
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl
  1060
  1061     EXEC CICS WRITEQ TD
  1062       QUEUE ('JOBS')
  1063       FROM (JCL-RECORD)
  1064       LENGTH (LENGTH OF JCL-RECORD)
  1065       RESP(WS-RESP-CD)
  1066       RESP2(WS-REAS-CD)
  1067     END-EXEC.
  1068
  1069     EVALUATE WS-RESP-CD
  1070         WHEN DFHRESP(NORMAL)
  1071             CONTINUE
  1072         WHEN OTHER
  1073             DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD
  1074             MOVE 'Y'     TO WS-ERR-FLG
  1075             MOVE 'Unable to Write TDQ (JOBS)...' TO
  1076                             WS-MESSAGE
  1077             MOVE -1       TO MONTHLYL OF CORPT0AI
  1078             PERFORM SEND-TRNRPT-SCREEN
  1079     END-EVALUATE.
  1080
  1081*----------------------------------------------------------------*
  1082*                      RETURN-TO-PREV-SCREEN
  1083*----------------------------------------------------------------*
  1084 RETURN-TO-PREV-SCREEN.
  1085
  1086     IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES
  1087         MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM
  1088     END-IF
  1089     MOVE WS-TRANID    TO CDEMO-FROM-TRANID
  1090     MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM
  1091     MOVE ZEROS        TO CDEMO-PGM-CONTEXT
  1092     EXEC CICS
  1093         XCTL PROGRAM(CDEMO-TO-PROGRAM)
  1094         COMMAREA(CARDDEMO-COMMAREA)
  1095     END-EXEC.
  1096
  1097*----------------------------------------------------------------*
  1098*                      SEND-TRNRPT-SCREEN
  1099*----------------------------------------------------------------*
  1100 SEND-TRNRPT-SCREEN.
  1101
  1102     PERFORM POPULATE-HEADER-INFO
  1103
  1104     MOVE WS-MESSAGE TO ERRMSGO OF CORPT0AO
  1105
  1106     IF SEND-ERASE-YES
  1107         EXEC CICS SEND
  1108                   MAP('CORPT0A')
  1109                   MAPSET('CORPT00')
  1110                   FROM(CORPT0AO)
  1111                   ERASE
  1112                   CURSOR
  1113         END-EXEC
  1114     ELSE
  1115         EXEC CICS SEND
  1116                   MAP('CORPT0A')
  1117                   MAPSET('CORPT00')
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page  25
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl
  1118                   FROM(CORPT0AO)
  1119*                  ERASE
  1120                   CURSOR
  1121         END-EXEC
  1122     END-IF.
  1123
  1124     GO TO RETURN-TO-CICS.
  1125
  1126*----------------------------------------------------------------*
  1127*                         RETURN-TO-CICS
  1128*----------------------------------------------------------------*
  1129 RETURN-TO-CICS.
  1130
  1131     EXEC CICS RETURN
  1132               TRANSID (WS-TRANID)
  1133               COMMAREA (CARDDEMO-COMMAREA)
  1134*              LENGTH(LENGTH OF CARDDEMO-COMMAREA)
  1135     END-EXEC.
  1136
  1137*----------------------------------------------------------------*
  1138*                      RECEIVE-TRNRPT-SCREEN
  1139*----------------------------------------------------------------*
  1140 RECEIVE-TRNRPT-SCREEN.
  1141
  1142     EXEC CICS RECEIVE
  1143               MAP('CORPT0A')
  1144               MAPSET('CORPT00')
  1145               INTO(CORPT0AI)
  1146               RESP(WS-RESP-CD)
  1147               RESP2(WS-REAS-CD)
  1148     END-EXEC.
  1149
  1150*----------------------------------------------------------------*
  1151*                      POPULATE-HEADER-INFO
  1152*----------------------------------------------------------------*
  1153 POPULATE-HEADER-INFO.
  1154
  1155     MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA
  1156
  1157     MOVE CCDA-TITLE01           TO TITLE01O OF CORPT0AO
  1158     MOVE CCDA-TITLE02           TO TITLE02O OF CORPT0AO
  1159     MOVE WS-TRANID              TO TRNNAMEO OF CORPT0AO
  1160     MOVE WS-PGMNAME             TO PGMNAMEO OF CORPT0AO
  1161
  1162     MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM
  1163     MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD
  1164     MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY
  1165
  1166     MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF CORPT0AO
  1167
  1168     MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH
  1169     MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM
  1170     MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS
  1171
  1172     MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF CORPT0AO.
  1173
  1174*----------------------------------------------------------------*
  1175*                      INITIALIZE-ALL-FIELDS
* Micro Focus COBOL                  V8.0 revision 000 14-Mar-24 15:59 Page  26
* C:\CrossPlatformBuild\CardDemo\COBOL\CORPT00C.cbl
  1176*----------------------------------------------------------------*
  1177 INITIALIZE-ALL-FIELDS.
  1178
  1179     MOVE -1              TO MONTHLYL OF CORPT0AI
  1180     INITIALIZE              MONTHLYI OF CORPT0AI
  1181                             YEARLYI  OF CORPT0AI
  1182                             CUSTOMI  OF CORPT0AI
  1183                             SDTMMI   OF CORPT0AI
  1184                             SDTDDI   OF CORPT0AI
  1185                             SDTYYYYI OF CORPT0AI
  1186                             EDTMMI   OF CORPT0AI
  1187                             EDTDDI   OF CORPT0AI
  1188                             EDTYYYYI OF CORPT0AI
  1189                             CONFIRMI OF CORPT0AI
  1190                             WS-MESSAGE.
  1191*
  1192* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT
  1193*
*
*
* Errors
* -Line- Col Code/severity Description
* Micro Focus COBOL                  V8.0 revision 000 Compiler
* (C) Copyright 1984-2023 Micro Focus or one of its affiliates.
*                                                        REF GKR-101800000A0
* Total Messages:     0
* Data:        8480     Code:        6750
